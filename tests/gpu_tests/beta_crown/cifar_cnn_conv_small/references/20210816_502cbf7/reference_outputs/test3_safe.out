Experiments at Thu Nov  4 23:11:19 2021 on huan-Naples-server
Namespace(batch_size=2048, beta_warmup=True, branching_candidates=3, branching_method='kfsb', branching_reduceop='min', complete_verifier='bab', conv_mode='patches', crown=False, data='CIFAR_ERAN', decision_thresh=0, deterministic=False, device='cuda', double_fp=False, end=921, epsilon=None, incomplete=True, init_iteration=100, intermediate_refinement_layers=[-1], iteration=20, load='eran_models/cifar_conv_small_pgd.pth', loss_reduction_func='sum', lp_test=None, lr_alpha=0.01, lr_beta=0.05, lr_decay=0.98, lr_init_alpha=0.1, lr_intermediate_beta=0.05, max_refinement_domains=1000, max_subproblems_list=200000, mip_multi_proc=None, mip_perneuron_refine_timeout=15, mip_refine_timeout=0.8, mip_threads=1, mode='verified-acc', model='cifar_conv_small', no_beta=False, no_joint_opt=False, no_warm=False, norm=inf, opt_bias=False, opt_coeffs=False, opt_intermediate_beta=False, optimizer='adam', pgd_order='before', record_lb=False, refinement_batch_size=-1, seed=100, share_slopes=False, solve_slope=True, start=920, timeout=120.0)
Sequential(
  (0): Conv2d(3, 16, kernel_size=(4, 4), stride=(2, 2))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1152, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
complete verification for verified accuracy, set decision_thresh to be 0
############################
Sampled data loaded. Data already preprocessed!
Shape: torch.Size([1000, 3, 32, 32]) torch.Size([1000]) torch.Size([1000])
X range: tensor(2.7537) tensor(-2.4291) tensor(0.0238)
Note runnerup label is empty here!
############################
epsilon after preprocession: tensor([[[[0.0388]],

         [[0.0393]],

         [[0.0390]]]]), data_max = tensor([[[[2.5141]],

         [[2.5968]],

         [[2.7537]]]]), data_min = tensor([[[[-2.4291]],

         [[-2.4183]],

         [[-2.2214]]]])
saving results to Verified_ret_[cifar_conv_small]_start=920_end=921_iter=20_b=2048_int-beta=False_timeout=120.0_branching=kfsb-min-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 920 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  6  correct label  6 logits tensor([ 0.8211, -3.5389,  2.3878,  1.3320,  1.9461, -1.4003,  3.7240, -0.6937,
         0.9622, -3.5892], grad_fn=<SelectBackward>)
##### PGD attack: True label: 6, Tested against: all others ######
pgd prediction: tensor([ 0.9317, -3.5736,  2.9251,  1.2274,  1.9785, -1.3486,  3.0391, -0.4958,
         1.0435, -3.8133], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([2.1074, 6.6127, 0.1140, 1.8117, 1.0606, 4.3876,    inf, 3.5348, 1.9956,
        6.8524], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[ 0.8211, -3.5389,  2.3878,  1.3320,  1.9461, -1.4003,  3.7240, -0.6937,
          0.9622, -3.5892]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
best_l after optimization: -10.033517837524414 with beta sum per layer: []
optimal alpha/beta time: 4.530655860900879
initial alpha-CROWN bounds: tensor([[-0.2179,  4.3615, -1.1640,  0.1798, -0.4224,  2.5507,  1.0529, -0.3576,
          4.0505]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:920] Tested against 0 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 15, 15]) != torch.Size([2, 9, 1, 16, 15, 15]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 6, 6]) != torch.Size([2, 9, 1, 32, 6, 6]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 15, 15])
1 /11 torch.Size([1, 32, 6, 6])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.21792936325073242 with beta sum per layer: []
optimal alpha/beta time: 0.9250962734222412
alpha-CROWN with fixed intermediate bounds: tensor([[-0.2179]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.21792936325073242
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
# of unstable neurons: 491
splitting decisions: [[2, 52]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.03168463706970215 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006655693054199219
This batch time : update_bounds func: 0.0082	 prepare: 0.0009	 bound: 0.0068	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 0.0082	 prepare: 0.0009	 bound: 0.0068	 transfer: 0.0003	 finalize: 0.0002
batch bounding time:  0.008195161819458008
Current worst domains: []
length of domains: 0
Total time: 0.0242	 pickout: 0.0006	 decision: 0.0154	 get_bound: 0.0082	 add_domain: 0.0000
No domains left, verification finished!
Image 920 pidx 0 verify end, Time cost: 1.3562817573547363
920 999
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0]]
##### [0:920] Tested against 1 ######
init opt crown verified for label 1 with bound 4.3614888191223145
Image 920 pidx 1 verify end, Time cost: 0.00022482872009277344
920 4.3614888191223145
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1]]
##### [0:920] Tested against 2 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 15, 15]) != torch.Size([2, 9, 1, 16, 15, 15]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 6, 6]) != torch.Size([2, 9, 1, 32, 6, 6]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 15, 15])
1 /11 torch.Size([1, 32, 6, 6])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.164036512374878 with beta sum per layer: []
optimal alpha/beta time: 0.7350318431854248
alpha-CROWN with fixed intermediate bounds: tensor([[-1.1640]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.164036512374878
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
# of unstable neurons: 491
splitting decisions: [[2, 52]]
single_node_split: True
best_l after optimization: 1.9004976749420166 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1692812442779541
This batch time : update_bounds func: 0.1709	 prepare: 0.0009	 bound: 0.1694	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.1791	 prepare: 0.0018	 bound: 0.1762	 transfer: 0.0004	 finalize: 0.0004
batch bounding time:  0.17093896865844727
Current worst domains: [-0.9717989563941956, -0.9286987781524658]
length of domains: 2
Total time: 0.1865	 pickout: 0.0005	 decision: 0.0150	 get_bound: 0.1710	 add_domain: 0.0001
Current lb:-0.9717989563941956
2 neurons visited

splitting decisions: [[2, 23], [2, 23]]
single_node_split: True
best_l after optimization: 3.213489055633545 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1704268455505371
This batch time : update_bounds func: 0.1723	 prepare: 0.0010	 bound: 0.1706	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.3514	 prepare: 0.0028	 bound: 0.3467	 transfer: 0.0004	 finalize: 0.0007
batch bounding time:  0.17235422134399414
Current worst domains: [-0.824697732925415, -0.823712944984436, -0.7844235897064209, -0.7806546092033386]
length of domains: 4
Total time: 0.1882	 pickout: 0.0006	 decision: 0.0152	 get_bound: 0.1724	 add_domain: 0.0001
Current lb:-0.824697732925415
6 neurons visited

splitting decisions: [[2, 99], [2, 99], [2, 99], [2, 99]]
single_node_split: True
best_l after optimization: 3.71036696434021 with beta sum per layer: [0.0, 0.0, 2.204704523086548]
optimal alpha/beta time: 0.17206239700317383
This batch time : update_bounds func: 0.1745	 prepare: 0.0013	 bound: 0.1722	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 0.5259	 prepare: 0.0041	 bound: 0.5189	 transfer: 0.0005	 finalize: 0.0013
batch bounding time:  0.1745600700378418
Current worst domains: [-0.6843798160552979, -0.6824860572814941, -0.6459372043609619, -0.6373313069343567, -0.29781055450439453, -0.2907745838165283, -0.2502708435058594, -0.22137665748596191]
length of domains: 8
Total time: 0.1909	 pickout: 0.0007	 decision: 0.0154	 get_bound: 0.1746	 add_domain: 0.0002
Current lb:-0.6843798160552979
14 neurons visited

splitting decisions: [[2, 40], [2, 40], [2, 40], [2, 40], [2, 40], [2, 40], [2, 40], [2, 40]]
single_node_split: True
best_l after optimization: 4.999682426452637 with beta sum per layer: [0.0, 0.0, 4.383359909057617]
optimal alpha/beta time: 0.17255783081054688
This batch time : update_bounds func: 0.1760	 prepare: 0.0018	 bound: 0.1727	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 0.7019	 prepare: 0.0059	 bound: 0.6916	 transfer: 0.0006	 finalize: 0.0022
batch bounding time:  0.176025390625
Current worst domains: [-0.5497686862945557, -0.543827474117279, -0.5217886567115784, -0.5201560258865356, -0.5132910013198853, -0.5017709136009216, -0.48058944940567017, -0.4723691940307617, -0.1706695556640625, -0.1650329828262329]
length of domains: 16
Total time: 0.1964	 pickout: 0.0011	 decision: 0.0187	 get_bound: 0.1761	 add_domain: 0.0005
Current lb:-0.5497686862945557
30 neurons visited

splitting decisions: [[2, 13], [2, 85], [2, 13], [2, 13], [2, 13], [2, 13], [2, 13], [2, 13], [2, 85], [2, 85]]
single_node_split: True
best_l after optimization: 5.748484134674072 with beta sum per layer: [0.0, 0.0, 13.1444091796875]
optimal alpha/beta time: 0.1733996868133545
This batch time : update_bounds func: 0.1789	 prepare: 0.0027	 bound: 0.1735	 transfer: 0.0008	 finalize: 0.0018
Accumulated time: update_bounds func: 0.8808	 prepare: 0.0086	 bound: 0.8651	 transfer: 0.0008	 finalize: 0.0040
batch bounding time:  0.1789073944091797
Current worst domains: [-0.478360116481781, -0.4743884205818176, -0.4518773555755615, -0.44995391368865967, -0.44887518882751465, -0.4392250180244446, -0.42812323570251465, -0.4050915837287903, -0.3981367349624634, -0.29157185554504395]
length of domains: 24
Total time: 0.2003	 pickout: 0.0017	 decision: 0.0189	 get_bound: 0.1790	 add_domain: 0.0007
Current lb:-0.478360116481781
62 neurons visited

splitting decisions: [[2, 85], [2, 13], [2, 13], [2, 85], [2, 85], [2, 85], [2, 85], [2, 85], [2, 85], [2, 85]]
single_node_split: True
best_l after optimization: 6.713603496551514 with beta sum per layer: [0.0, 0.0, 22.976879119873047]
optimal alpha/beta time: 0.17372703552246094
This batch time : update_bounds func: 0.1812	 prepare: 0.0037	 bound: 0.1739	 transfer: 0.0009	 finalize: 0.0026
Accumulated time: update_bounds func: 1.0619	 prepare: 0.0123	 bound: 1.0390	 transfer: 0.0009	 finalize: 0.0065
batch bounding time:  0.18122458457946777
Current worst domains: [-0.40910476446151733, -0.4045369625091553, -0.38346606492996216, -0.3829215168952942, -0.38267266750335693, -0.38156068325042725, -0.37707704305648804, -0.3657795786857605, -0.3528391718864441, -0.35092759132385254]
length of domains: 33
Total time: 0.2027	 pickout: 0.0024	 decision: 0.0179	 get_bound: 0.1813	 add_domain: 0.0010
Current lb:-0.40910476446151733
110 neurons visited

splitting decisions: [[2, 82], [2, 82], [2, 82], [2, 82], [2, 82], [2, 82], [2, 82], [2, 44], [2, 82], [2, 82]]
single_node_split: True
best_l after optimization: 3.548837900161743 with beta sum per layer: [0.0, 0.0, 31.55113983154297]
optimal alpha/beta time: 0.17476892471313477
This batch time : update_bounds func: 0.1851	 prepare: 0.0048	 bound: 0.1749	 transfer: 0.0018	 finalize: 0.0035
Accumulated time: update_bounds func: 1.2471	 prepare: 0.0170	 bound: 1.2139	 transfer: 0.0018	 finalize: 0.0100
batch bounding time:  0.1851813793182373
Current worst domains: [-0.3488703966140747, -0.3454829454421997, -0.32432931661605835, -0.3235183358192444, -0.32235652208328247, -0.31934207677841187, -0.31727367639541626, -0.3074585795402527, -0.2974305748939514, -0.2936111092567444]
length of domains: 39
Total time: 0.2097	 pickout: 0.0032	 decision: 0.0198	 get_bound: 0.1853	 add_domain: 0.0013
Current lb:-0.3488703966140747
176 neurons visited

splitting decisions: [[2, 44], [2, 44], [2, 44], [2, 44], [2, 44], [2, 44], [2, 44], [2, 82], [2, 82], [2, 44]]
single_node_split: True
best_l after optimization: 5.436915874481201 with beta sum per layer: [0.0, 0.0, 39.981964111328125]
optimal alpha/beta time: 0.17648792266845703
This batch time : update_bounds func: 0.1880	 prepare: 0.0055	 bound: 0.1767	 transfer: 0.0018	 finalize: 0.0040
Accumulated time: update_bounds func: 1.4351	 prepare: 0.0225	 bound: 1.3905	 transfer: 0.0018	 finalize: 0.0140
batch bounding time:  0.18810820579528809
Current worst domains: [-0.2945433259010315, -0.28939586877822876, -0.2734827995300293, -0.27328550815582275, -0.26956868171691895, -0.268640398979187, -0.26784461736679077, -0.2640221118927002, -0.25913965702056885, -0.24926233291625977]
length of domains: 52
Total time: 0.2147	 pickout: 0.0038	 decision: 0.0208	 get_bound: 0.1882	 add_domain: 0.0019
Current lb:-0.2945433259010315
254 neurons visited

splitting decisions: [[2, 50], [2, 50], [2, 50], [2, 50], [2, 50], [2, 50], [2, 50], [2, 50], [2, 50], [2, 50]]
single_node_split: True
best_l after optimization: 6.988981246948242 with beta sum per layer: [0.0, 0.0, 63.705474853515625]
optimal alpha/beta time: 0.17974352836608887
This batch time : update_bounds func: 0.1950	 prepare: 0.0070	 bound: 0.1799	 transfer: 0.0027	 finalize: 0.0052
Accumulated time: update_bounds func: 1.6301	 prepare: 0.0295	 bound: 1.5704	 transfer: 0.0027	 finalize: 0.0192
batch bounding time:  0.19511961936950684
Current worst domains: [-0.25654923915863037, -0.25253796577453613, -0.23708254098892212, -0.2355021834373474, -0.23366981744766235, -0.23162555694580078, -0.22980499267578125, -0.2271861433982849, -0.22162890434265137, -0.21286851167678833]
length of domains: 72
Total time: 0.2270	 pickout: 0.0049	 decision: 0.0241	 get_bound: 0.1953	 add_domain: 0.0028
Current lb:-0.25654923915863037
358 neurons visited

splitting decisions: [[2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92]]
single_node_split: True
best_l after optimization: 3.160767078399658 with beta sum per layer: [0.0, 0.0, 88.16627502441406]
optimal alpha/beta time: 0.189347505569458
This batch time : update_bounds func: 0.2106	 prepare: 0.0093	 bound: 0.1895	 transfer: 0.0041	 finalize: 0.0074
Accumulated time: update_bounds func: 1.8408	 prepare: 0.0388	 bound: 1.7599	 transfer: 0.0041	 finalize: 0.0266
batch bounding time:  0.21078014373779297
Current worst domains: [-0.22225838899612427, -0.21795636415481567, -0.20216679573059082, -0.20147091150283813, -0.19827336072921753, -0.19662874937057495, -0.19415009021759033, -0.19062280654907227, -0.186662495136261, -0.17858415842056274]
length of domains: 72
Total time: 0.2481	 pickout: 0.0066	 decision: 0.0275	 get_bound: 0.2110	 add_domain: 0.0030
Current lb:-0.22225838899612427
502 neurons visited

splitting decisions: [[2, 71], [2, 71], [2, 71], [2, 71], [2, 71], [2, 71], [2, 71], [2, 71], [2, 71], [2, 71]]
single_node_split: True
best_l after optimization: -18.178144454956055 with beta sum per layer: [0.0, 0.0, 68.02991485595703]
optimal alpha/beta time: 0.18897652626037598
This batch time : update_bounds func: 0.2087	 prepare: 0.0095	 bound: 0.1891	 transfer: 0.0024	 finalize: 0.0074
Accumulated time: update_bounds func: 2.0495	 prepare: 0.0483	 bound: 1.9490	 transfer: 0.0024	 finalize: 0.0340
batch bounding time:  0.20883655548095703
Current worst domains: [-0.19280493259429932, -0.1892033815383911, -0.1732398271560669, -0.17167401313781738, -0.16871875524520874, -0.16701394319534302, -0.16479510068893433, -0.16161715984344482, -0.15546780824661255, -0.1479143500328064]
length of domains: 42
Total time: 0.2454	 pickout: 0.0066	 decision: 0.0279	 get_bound: 0.2090	 add_domain: 0.0018
Current lb:-0.19280493259429932
646 neurons visited

splitting decisions: [[2, 76], [2, 57], [2, 57], [2, 76], [2, 57], [2, 57], [2, 76], [2, 57], [2, 76], [2, 57]]
single_node_split: True
best_l after optimization: -3.0964436531066895 with beta sum per layer: [0.0, 0.0, 27.747608184814453]
optimal alpha/beta time: 0.17866277694702148
This batch time : update_bounds func: 0.1906	 prepare: 0.0058	 bound: 0.1788	 transfer: 0.0013	 finalize: 0.0044
Accumulated time: update_bounds func: 2.2400	 prepare: 0.0541	 bound: 2.1278	 transfer: 0.0013	 finalize: 0.0384
batch bounding time:  0.1906428337097168
Current worst domains: [-0.16909658908843994, -0.16511261463165283, -0.1490015983581543, -0.14681971073150635, -0.14333069324493408, -0.14310336112976074, -0.14133882522583008, -0.1377493143081665, -0.13067764043807983, -0.12271332740783691]
length of domains: 34
Total time: 0.2180	 pickout: 0.0040	 decision: 0.0216	 get_bound: 0.1908	 add_domain: 0.0016
Current lb:-0.16909658908843994
730 neurons visited

splitting decisions: [[2, 57], [2, 76], [2, 76], [2, 57], [2, 76], [2, 76], [2, 57], [2, 76], [2, 57], [2, 76]]
single_node_split: True
best_l after optimization: -1.1933094263076782 with beta sum per layer: [0.0, 0.0, 18.323652267456055]
optimal alpha/beta time: 0.17732477188110352
This batch time : update_bounds func: 0.1881	 prepare: 0.0049	 bound: 0.1775	 transfer: 0.0019	 finalize: 0.0037
Accumulated time: update_bounds func: 2.4282	 prepare: 0.0590	 bound: 2.3053	 transfer: 0.0019	 finalize: 0.0421
batch bounding time:  0.1882185935974121
Current worst domains: [-0.14561009407043457, -0.14229846000671387, -0.12577152252197266, -0.12368643283843994, -0.12033247947692871, -0.1192731261253357, -0.11799812316894531, -0.11503016948699951, -0.10619968175888062, -0.09878528118133545]
length of domains: 32
Total time: 0.2134	 pickout: 0.0034	 decision: 0.0201	 get_bound: 0.1883	 add_domain: 0.0016
Current lb:-0.14561009407043457
798 neurons visited

splitting decisions: [[2, 93], [2, 93], [2, 93], [2, 93], [2, 93], [2, 93], [2, 93], [2, 93], [1, 267], [1, 267]]
single_node_split: True
best_l after optimization: 1.0718145370483398 with beta sum per layer: [0.0, 0.0025067366659641266, 17.6854190826416]
optimal alpha/beta time: 0.18053340911865234
This batch time : update_bounds func: 0.1908	 prepare: 0.0048	 bound: 0.1807	 transfer: 0.0016	 finalize: 0.0035
Accumulated time: update_bounds func: 2.6190	 prepare: 0.0639	 bound: 2.4860	 transfer: 0.0016	 finalize: 0.0457
batch bounding time:  0.19089102745056152
Current worst domains: [-0.13109612464904785, -0.12815523147583008, -0.11201989650726318, -0.10914599895477295, -0.10579681396484375, -0.10429298877716064, -0.1034090518951416, -0.10104334354400635, -0.08596301078796387, -0.08569073677062988]
length of domains: 40
Total time: 0.2162	 pickout: 0.0033	 decision: 0.0198	 get_bound: 0.1910	 add_domain: 0.0021
Current lb:-0.13109612464904785
862 neurons visited

splitting decisions: [[1, 606], [2, 94], [2, 94], [1, 606], [2, 94], [1, 606], [1, 1096], [2, 94], [2, 93], [2, 93]]
single_node_split: True
best_l after optimization: 0.7157446146011353 with beta sum per layer: [0.0, 0.41488203406333923, 15.160526275634766]
optimal alpha/beta time: 0.18014788627624512
This batch time : update_bounds func: 0.1923	 prepare: 0.0060	 bound: 0.1803	 transfer: 0.0015	 finalize: 0.0042
Accumulated time: update_bounds func: 2.8112	 prepare: 0.0699	 bound: 2.6663	 transfer: 0.0015	 finalize: 0.0499
batch bounding time:  0.1923360824584961
Current worst domains: [-0.120810866355896, -0.1191030740737915, -0.1078348159790039, -0.10321664810180664, -0.09947466850280762, -0.09664773941040039, -0.09450829029083252, -0.09414446353912354, -0.09220242500305176, -0.08237552642822266]
length of domains: 45
Total time: 0.2201	 pickout: 0.0041	 decision: 0.0211	 get_bound: 0.1925	 add_domain: 0.0024
Current lb:-0.120810866355896
942 neurons visited

splitting decisions: [[2, 94], [1, 23], [2, 94], [1, 23], [1, 1096], [1, 416], [2, 94], [1, 1096], [1, 1096], [2, 94]]
single_node_split: True
best_l after optimization: 1.9013326168060303 with beta sum per layer: [0.0, 2.290886878967285, 11.519412994384766]
optimal alpha/beta time: 0.17999792098999023
This batch time : update_bounds func: 0.1935	 prepare: 0.0069	 bound: 0.1801	 transfer: 0.0017	 finalize: 0.0047
Accumulated time: update_bounds func: 3.0048	 prepare: 0.0768	 bound: 2.8464	 transfer: 0.0017	 finalize: 0.0546
batch bounding time:  0.19363808631896973
Current worst domains: [-0.11230778694152832, -0.11205184459686279, -0.09898495674133301, -0.09615862369537354, -0.09078860282897949, -0.0898888111114502, -0.08615541458129883, -0.08484494686126709, -0.08376097679138184, -0.08275079727172852]
length of domains: 57
Total time: 0.2237	 pickout: 0.0045	 decision: 0.0222	 get_bound: 0.1938	 add_domain: 0.0032
Current lb:-0.11230778694152832
1032 neurons visited

splitting decisions: [[1, 1096], [1, 1096], [1, 1096], [1, 1096], [1, 1096], [2, 94], [1, 485], [2, 94], [1, 485], [1, 1096]]
single_node_split: True
best_l after optimization: 2.5698153972625732 with beta sum per layer: [0.0, 6.447446823120117, 11.508042335510254]
optimal alpha/beta time: 0.18414568901062012
This batch time : update_bounds func: 0.2038	 prepare: 0.0107	 bound: 0.1846	 transfer: 0.0024	 finalize: 0.0060
Accumulated time: update_bounds func: 3.2086	 prepare: 0.0875	 bound: 3.0310	 transfer: 0.0024	 finalize: 0.0606
batch bounding time:  0.20394515991210938
Current worst domains: [-0.10355985164642334, -0.10277330875396729, -0.08968830108642578, -0.08709347248077393, -0.08323884010314941, -0.08164405822753906, -0.08121919631958008, -0.07910895347595215, -0.07758486270904541, -0.07591837644577026]
length of domains: 89
Total time: 0.2393	 pickout: 0.0056	 decision: 0.0243	 get_bound: 0.2041	 add_domain: 0.0052
Current lb:-0.10355985164642334
1146 neurons visited

splitting decisions: [[1, 735], [1, 407], [1, 407], [1, 416], [1, 407], [1, 416], [1, 23], [1, 606], [2, 3], [1, 407]]
single_node_split: True
best_l after optimization: 2.3548316955566406 with beta sum per layer: [0.0, 12.136377334594727, 18.79303550720215]
optimal alpha/beta time: 0.19957399368286133
This batch time : update_bounds func: 0.2247	 prepare: 0.0127	 bound: 0.1997	 transfer: 0.0028	 finalize: 0.0092
Accumulated time: update_bounds func: 3.4333	 prepare: 0.1002	 bound: 3.2307	 transfer: 0.0028	 finalize: 0.0697
batch bounding time:  0.22487545013427734
Current worst domains: [-0.09467804431915283, -0.09360408782958984, -0.08834326267242432, -0.08569681644439697, -0.08039534091949463, -0.07662069797515869, -0.07506883144378662, -0.0736384391784668, -0.07297980785369873, -0.07168889045715332]
length of domains: 118
Total time: 0.2761	 pickout: 0.0087	 decision: 0.0351	 get_bound: 0.2251	 add_domain: 0.0072
Current lb:-0.09467804431915283
1324 neurons visited

splitting decisions: [[1, 416], [1, 23], [1, 23], [1, 416], [1, 23], [1, 735], [1, 23], [1, 407], [2, 3], [1, 23]]
single_node_split: True
best_l after optimization: 3.786064386367798 with beta sum per layer: [0.0, 17.546846389770508, 29.42877769470215]
optimal alpha/beta time: 0.2165212631225586
This batch time : update_bounds func: 0.2858	 prepare: 0.0174	 bound: 0.2167	 transfer: 0.0056	 finalize: 0.0121
Accumulated time: update_bounds func: 3.7191	 prepare: 0.1175	 bound: 3.4474	 transfer: 0.0056	 finalize: 0.0819
batch bounding time:  0.2860109806060791
Current worst domains: [-0.0862424373626709, -0.08420145511627197, -0.08098435401916504, -0.08020210266113281, -0.0747750997543335, -0.07306599617004395, -0.07261574268341064, -0.07253134250640869, -0.06790435314178467, -0.0677495002746582]
length of domains: 161
Total time: 0.3507	 pickout: 0.0113	 decision: 0.0429	 get_bound: 0.2864	 add_domain: 0.0101
Current lb:-0.0862424373626709
1560 neurons visited

splitting decisions: [[2, 3], [1, 606], [2, 3], [1, 606], [1, 606], [2, 3], [2, 3], [1, 606], [1, 379], [2, 3]]
single_node_split: True
best_l after optimization: 3.936091423034668 with beta sum per layer: [0.0, 24.909404754638672, 45.501060485839844]
optimal alpha/beta time: 0.24480438232421875
This batch time : update_bounds func: 0.2918	 prepare: 0.0224	 bound: 0.2450	 transfer: 0.0070	 finalize: 0.0169
Accumulated time: update_bounds func: 4.0110	 prepare: 0.1399	 bound: 3.6924	 transfer: 0.0070	 finalize: 0.0987
batch bounding time:  0.29209113121032715
Current worst domains: [-0.07764184474945068, -0.07672703266143799, -0.0727083683013916, -0.07237696647644043, -0.06736111640930176, -0.06506955623626709, -0.06445026397705078, -0.06354904174804688, -0.06354069709777832, -0.060915589332580566]
length of domains: 212
Total time: 0.3761	 pickout: 0.0154	 decision: 0.0543	 get_bound: 0.2925	 add_domain: 0.0139
Current lb:-0.07764184474945068
1882 neurons visited

splitting decisions: [[1, 305], [2, 3], [2, 3], [1, 305], [2, 3], [2, 3], [1, 305], [1, 305], [2, 3], [1, 606]]
single_node_split: True
best_l after optimization: 1.8825280666351318 with beta sum per layer: [0.0, 31.893299102783203, 67.50306701660156]
optimal alpha/beta time: 0.29009199142456055
This batch time : update_bounds func: 0.3492	 prepare: 0.0292	 bound: 0.2902	 transfer: 0.0070	 finalize: 0.0220
Accumulated time: update_bounds func: 4.3601	 prepare: 0.1691	 bound: 3.9826	 transfer: 0.0070	 finalize: 0.1207
batch bounding time:  0.3495035171508789
Current worst domains: [-0.06842648983001709, -0.06701004505157471, -0.06689870357513428, -0.06428837776184082, -0.0620424747467041, -0.06166791915893555, -0.058822035789489746, -0.056400179862976074, -0.055199623107910156, -0.05437278747558594]
length of domains: 217
Total time: 0.4415	 pickout: 0.0199	 decision: 0.0567	 get_bound: 0.3501	 add_domain: 0.0148
Current lb:-0.06842648983001709
2306 neurons visited

splitting decisions: [[1, 379], [1, 485], [1, 485], [1, 379], [1, 485], [1, 485], [1, 379], [1, 379], [1, 379], [1, 485]]
single_node_split: True
best_l after optimization: 2.5733437538146973 with beta sum per layer: [0.0, 37.84771728515625, 44.0002326965332]
optimal alpha/beta time: 0.29422950744628906
This batch time : update_bounds func: 0.3538	 prepare: 0.0293	 bound: 0.2944	 transfer: 0.0067	 finalize: 0.0225
Accumulated time: update_bounds func: 4.7139	 prepare: 0.1984	 bound: 4.2770	 transfer: 0.0067	 finalize: 0.1432
batch bounding time:  0.35411739349365234
Current worst domains: [-0.06283688545227051, -0.06057167053222656, -0.06008195877075195, -0.059051513671875, -0.0551755428314209, -0.055014848709106445, -0.05297994613647461, -0.05115795135498047, -0.049651265144348145, -0.04835712909698486]
length of domains: 249
Total time: 0.4511	 pickout: 0.0206	 decision: 0.0582	 get_bound: 0.3547	 add_domain: 0.0175
Current lb:-0.06283688545227051
2740 neurons visited

splitting decisions: [[1, 407], [1, 416], [1, 416], [1, 407], [1, 416], [1, 416], [1, 407], [1, 407], [1, 407], [1, 416]]
single_node_split: True
best_l after optimization: 2.693843364715576 with beta sum per layer: [0.0, 44.74091339111328, 32.299591064453125]
optimal alpha/beta time: 0.3185100555419922
This batch time : update_bounds func: 0.3930	 prepare: 0.0365	 bound: 0.3187	 transfer: 0.0103	 finalize: 0.0266
Accumulated time: update_bounds func: 5.1069	 prepare: 0.2348	 bound: 4.5957	 transfer: 0.0103	 finalize: 0.1698
batch bounding time:  0.39340877532958984
Current worst domains: [-0.05721151828765869, -0.05327200889587402, -0.05112040042877197, -0.05070829391479492, -0.05032062530517578, -0.04970228672027588, -0.04933023452758789, -0.0470203161239624, -0.04611003398895264, -0.045853257179260254]
length of domains: 279
Total time: 0.5323	 pickout: 0.0240	 decision: 0.0938	 get_bound: 0.3941	 add_domain: 0.0204
Current lb:-0.05721151828765869
3238 neurons visited

splitting decisions: [[1, 485], [1, 485], [1, 735], [1, 735], [1, 485], [1, 735], [1, 735], [1, 485], [1, 485], [1, 735]]
single_node_split: True
best_l after optimization: 1.7984446287155151 with beta sum per layer: [0.0, 49.974483489990234, 30.61315155029297]
optimal alpha/beta time: 0.34159064292907715
This batch time : update_bounds func: 0.4191	 prepare: 0.0374	 bound: 0.3418	 transfer: 0.0103	 finalize: 0.0287
Accumulated time: update_bounds func: 5.5260	 prepare: 0.2722	 bound: 4.9375	 transfer: 0.0103	 finalize: 0.1985
batch bounding time:  0.41952085494995117
Current worst domains: [-0.051737189292907715, -0.04787123203277588, -0.04461491107940674, -0.0442732572555542, -0.04388916492462158, -0.042490482330322266, -0.04213070869445801, -0.04172468185424805, -0.040911078453063965, -0.04052877426147461]
length of domains: 311
Total time: 0.5452	 pickout: 0.0297	 decision: 0.0720	 get_bound: 0.4203	 add_domain: 0.0233
Current lb:-0.051737189292907715
3796 neurons visited

splitting decisions: [[1, 305], [1, 305], [1, 305], [1, 340], [1, 340], [1, 340], [1, 340], [1, 305], [1, 340], [1, 340]]
single_node_split: True
best_l after optimization: 0.43560320138931274 with beta sum per layer: [0.0, 47.455448150634766, 25.98973846435547]
optimal alpha/beta time: 0.37024641036987305
This batch time : update_bounds func: 0.4542	 prepare: 0.0419	 bound: 0.3704	 transfer: 0.0090	 finalize: 0.0318
Accumulated time: update_bounds func: 5.9802	 prepare: 0.3140	 bound: 5.3079	 transfer: 0.0090	 finalize: 0.2302
batch bounding time:  0.4546670913696289
Current worst domains: [-0.04287087917327881, -0.04259359836578369, -0.03903329372406006, -0.03877973556518555, -0.03704845905303955, -0.03656649589538574, -0.03624081611633301, -0.03565168380737305, -0.03555881977081299, -0.0355219841003418]
length of domains: 303
Total time: 0.6231	 pickout: 0.0307	 decision: 0.1135	 get_bound: 0.4555	 add_domain: 0.0234
Current lb:-0.04287087917327881
4418 neurons visited

splitting decisions: [[1, 717], [1, 717], [1, 267], [1, 267], [1, 1124], [1, 1124], [1, 717], [1, 1124], [1, 717], [1, 1124]]
single_node_split: True
best_l after optimization: 1.8468115329742432 with beta sum per layer: [0.0, 35.96460723876953, 21.71634864807129]
optimal alpha/beta time: 0.36208581924438477
This batch time : update_bounds func: 0.4414	 prepare: 0.0403	 bound: 0.3622	 transfer: 0.0072	 finalize: 0.0305
Accumulated time: update_bounds func: 6.4216	 prepare: 0.3543	 bound: 5.6701	 transfer: 0.0072	 finalize: 0.2608
batch bounding time:  0.4418373107910156
Current worst domains: [-0.036714911460876465, -0.03644680976867676, -0.03393447399139404, -0.03378784656524658, -0.03141224384307861, -0.030878067016601562, -0.030208945274353027, -0.03001558780670166, -0.02986586093902588, -0.029839754104614258]
length of domains: 329
Total time: 0.5736	 pickout: 0.0293	 decision: 0.0751	 get_bound: 0.4427	 add_domain: 0.0265
Current lb:-0.036714911460876465
5024 neurons visited

splitting decisions: [[1, 267], [1, 267], [1, 717], [1, 717], [1, 267], [1, 267], [1, 267], [1, 267], [1, 267], [1, 267]]
single_node_split: True
best_l after optimization: 0.11286365985870361 with beta sum per layer: [0.0, 34.84117889404297, 15.48716926574707]
optimal alpha/beta time: 0.3831784725189209
This batch time : update_bounds func: 0.5007	 prepare: 0.0446	 bound: 0.3833	 transfer: 0.0064	 finalize: 0.0335
Accumulated time: update_bounds func: 6.9223	 prepare: 0.3989	 bound: 6.0535	 transfer: 0.0064	 finalize: 0.2943
batch bounding time:  0.5011677742004395
Current worst domains: [-0.03143799304962158, -0.031279921531677246, -0.027547717094421387, -0.027442097663879395, -0.02620387077331543, -0.02572619915008545, -0.025304436683654785, -0.024949073791503906, -0.02494680881500244, -0.024553775787353516]
length of domains: 316
Total time: 0.6410	 pickout: 0.0319	 decision: 0.0811	 get_bound: 0.5021	 add_domain: 0.0260
Current lb:-0.03143799304962158
5682 neurons visited

splitting decisions: [[1, 340], [1, 340], [1, 967], [1, 967], [1, 970], [1, 970], [1, 967], [1, 970], [1, 970], [1, 967]]
single_node_split: True
best_l after optimization: 0.2942357063293457 with beta sum per layer: [0.0, 30.74367904663086, 6.5226521492004395]
optimal alpha/beta time: 0.37051868438720703
This batch time : update_bounds func: 0.4519	 prepare: 0.0422	 bound: 0.3707	 transfer: 0.0059	 finalize: 0.0320
Accumulated time: update_bounds func: 7.3742	 prepare: 0.4411	 bound: 6.4242	 transfer: 0.0059	 finalize: 0.3263
batch bounding time:  0.4524049758911133
Current worst domains: [-0.024761080741882324, -0.02465510368347168, -0.024225711822509766, -0.023597240447998047, -0.022527456283569336, -0.02246391773223877, -0.020344018936157227, -0.02011585235595703, -0.01985311508178711, -0.019348859786987305]
length of domains: 286
Total time: 0.5855	 pickout: 0.0306	 decision: 0.0775	 get_bound: 0.4533	 add_domain: 0.0240
Current lb:-0.024761080741882324
6314 neurons visited

splitting decisions: [[1, 1124], [1, 1124], [1, 1124], [1, 1124], [1, 1124], [1, 1124], [1, 379], [1, 591], [1, 379], [1, 591]]
single_node_split: True
best_l after optimization: -4.721462726593018 with beta sum per layer: [0.0, 30.597497940063477, 2.2778639793395996]
optimal alpha/beta time: 0.34658169746398926
This batch time : update_bounds func: 0.4503	 prepare: 0.0382	 bound: 0.3467	 transfer: 0.0054	 finalize: 0.0589
Accumulated time: update_bounds func: 7.8245	 prepare: 0.4793	 bound: 6.7709	 transfer: 0.0054	 finalize: 0.3852
batch bounding time:  0.4507889747619629
Current worst domains: [-0.020640969276428223, -0.020537495613098145, -0.02010345458984375, -0.019482851028442383, -0.018281936645507812, -0.01822340488433838, -0.01578700542449951, -0.015259981155395508, -0.014876484870910645, -0.014610767364501953]
length of domains: 171
Total time: 0.5667	 pickout: 0.0276	 decision: 0.0728	 get_bound: 0.4516	 add_domain: 0.0147
Current lb:-0.020640969276428223
6886 neurons visited

splitting decisions: [[1, 967], [1, 967], [1, 967], [1, 967], [1, 591], [1, 591], [1, 753], [1, 753], [1, 1124], [1, 753]]
single_node_split: True
best_l after optimization: -5.648051738739014 with beta sum per layer: [0.0, 13.879343032836914, 0.7477954626083374]
optimal alpha/beta time: 0.25127696990966797
This batch time : update_bounds func: 0.2967	 prepare: 0.0233	 bound: 0.2514	 transfer: 0.0036	 finalize: 0.0178
Accumulated time: update_bounds func: 8.1212	 prepare: 0.5026	 bound: 7.0223	 transfer: 0.0036	 finalize: 0.4030
batch bounding time:  0.29697394371032715
Current worst domains: [-0.015781521797180176, -0.01567232608795166, -0.015222668647766113, -0.014613032341003418, -0.013089656829833984, -0.01305234432220459, -0.012109756469726562, -0.011603116989135742, -0.010937094688415527, -0.010791420936584473]
length of domains: 102
Total time: 0.3715	 pickout: 0.0168	 decision: 0.0482	 get_bound: 0.2975	 add_domain: 0.0090
Current lb:-0.015781521797180176
7228 neurons visited

splitting decisions: [[1, 591], [1, 591], [1, 591], [1, 591], [1, 340], [1, 625], [2, 75], [2, 75], [2, 75], [2, 75]]
single_node_split: True
best_l after optimization: -0.6164638996124268 with beta sum per layer: [0.0, 6.386569023132324, 0.4479285478591919]
optimal alpha/beta time: 0.20426654815673828
This batch time : update_bounds func: 0.2325	 prepare: 0.0146	 bound: 0.2044	 transfer: 0.0024	 finalize: 0.0104
Accumulated time: update_bounds func: 8.3537	 prepare: 0.5173	 bound: 7.2268	 transfer: 0.0024	 finalize: 0.4134
batch bounding time:  0.23267030715942383
Current worst domains: [-0.010890483856201172, -0.010758399963378906, -0.010337233543395996, -0.009856224060058594, -0.008111715316772461, -0.007690787315368652, -0.007582426071166992, -0.0069168806076049805, -0.006861448287963867, -0.006834268569946289]
length of domains: 46
Total time: 0.2810	 pickout: 0.0100	 decision: 0.0338	 get_bound: 0.2330	 add_domain: 0.0043
Current lb:-0.010890483856201172
7432 neurons visited

splitting decisions: [[1, 625], [1, 625], [1, 625], [1, 625], [1, 567], [1, 753], [1, 567], [1, 567], [1, 625], [1, 567]]
single_node_split: True
best_l after optimization: -0.4774019122123718 with beta sum per layer: [0.0, 2.1612892150878906, 0.0]
optimal alpha/beta time: 0.18033957481384277
This batch time : update_bounds func: 0.1941	 prepare: 0.0071	 bound: 0.1805	 transfer: 0.0014	 finalize: 0.0049
Accumulated time: update_bounds func: 8.5478	 prepare: 0.5243	 bound: 7.4072	 transfer: 0.0014	 finalize: 0.4182
batch bounding time:  0.1941542625427246
Current worst domains: [-0.005956411361694336, -0.005809307098388672, -0.0053550004959106445, -0.00487673282623291, -0.0042798519134521484, -0.004044294357299805, -0.0034971237182617188, -0.002930283546447754, -0.0028754472732543945, -0.002141118049621582]
length of domains: 17
Total time: 0.2234	 pickout: 0.0047	 decision: 0.0227	 get_bound: 0.1943	 add_domain: 0.0016
Current lb:-0.005956411361694336
7524 neurons visited

splitting decisions: [[1, 483], [1, 753], [1, 753], [2, 75], [1, 340], [1, 591], [1, 591], [1, 591], [1, 591], [1, 483]]
single_node_split: True
best_l after optimization: -0.3526139259338379 with beta sum per layer: [0.0, 0.2074364423751831, 0.0]
optimal alpha/beta time: 0.17690467834472656
This batch time : update_bounds func: 0.1832	 prepare: 0.0032	 bound: 0.1770	 transfer: 0.0008	 finalize: 0.0020
Accumulated time: update_bounds func: 8.7310	 prepare: 0.5275	 bound: 7.5843	 transfer: 0.0008	 finalize: 0.4202
batch bounding time:  0.18320918083190918
Current worst domains: [-0.0023953914642333984, -0.0019418001174926758, -0.0009683370590209961, -0.00012183189392089844]
length of domains: 4
Total time: 0.2032	 pickout: 0.0020	 decision: 0.0175	 get_bound: 0.1833	 add_domain: 0.0004
Current lb:-0.0023953914642333984
7558 neurons visited

splitting decisions: [[1, 483], [2, 75], [1, 753], [1, 753]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.15924620628356934 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006566286087036133
This batch time : update_bounds func: 0.0091	 prepare: 0.0015	 bound: 0.0067	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 8.7400	 prepare: 0.5290	 bound: 7.5910	 transfer: 0.0004	 finalize: 0.4208
batch bounding time:  0.009117603302001953
Current worst domains: []
length of domains: 0
Total time: 0.0271	 pickout: 0.0008	 decision: 0.0171	 get_bound: 0.0091	 add_domain: 0.0000
No domains left, verification finished!
Image 920 pidx 2 verify end, Time cost: 11.572993993759155
920 999
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2]]
##### [0:920] Tested against 3 ######
init opt crown verified for label 3 with bound 0.17981797456741333
Image 920 pidx 3 verify end, Time cost: 0.0002574920654296875
920 0.17981797456741333
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3]]
##### [0:920] Tested against 4 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 15, 15]) != torch.Size([2, 9, 1, 16, 15, 15]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 6, 6]) != torch.Size([2, 9, 1, 32, 6, 6]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 15, 15])
1 /11 torch.Size([1, 32, 6, 6])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.4223688840866089 with beta sum per layer: []
optimal alpha/beta time: 0.7179663181304932
alpha-CROWN with fixed intermediate bounds: tensor([[-0.4224]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.4223688840866089
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
# of unstable neurons: 491
splitting decisions: [[2, 44]]
single_node_split: True
best_l after optimization: 0.4039726257324219 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.16897821426391602
This batch time : update_bounds func: 0.1706	 prepare: 0.0009	 bound: 0.1691	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 8.9107	 prepare: 0.5299	 bound: 7.7601	 transfer: 0.0004	 finalize: 0.4210bab_verification_eran.py:104: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  model = LiRPAConvNet(model_ori, torch.tensor(pred), target, solve_slope=args.solve_slope, device=args.device,

batch bounding time:  0.17079448699951172
Current worst domains: [-0.20241355895996094, -0.20155906677246094]
length of domains: 2
Total time: 0.1865	 pickout: 0.0005	 decision: 0.0151	 get_bound: 0.1708	 add_domain: 0.0001
Current lb:-0.20241355895996094
2 neurons visited

splitting decisions: [[2, 52], [2, 52]]
single_node_split: True

all verified at 11th iter
best_l after optimization: -0.0744553804397583 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.10029411315917969
This batch time : update_bounds func: 0.1022	 prepare: 0.0010	 bound: 0.1004	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 9.0129	 prepare: 0.5309	 bound: 7.8605	 transfer: 0.0005	 finalize: 0.4213
batch bounding time:  0.10226225852966309
Current worst domains: []
length of domains: 0
Total time: 0.1179	 pickout: 0.0006	 decision: 0.0151	 get_bound: 0.1023	 add_domain: 0.0000
No domains left, verification finished!
Image 920 pidx 4 verify end, Time cost: 1.0785343647003174
920 999
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3], [920, 999, 6, 1.0785343647003174, 0, 4]]
##### [0:920] Tested against 5 ######
init opt crown verified for label 5 with bound 2.550689458847046
Image 920 pidx 5 verify end, Time cost: 0.00022649765014648438
920 2.550689458847046
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3], [920, 999, 6, 1.0785343647003174, 0, 4], [920, 2.550689458847046, 0, 0.00022649765014648438, 0, 5]]
##### [0:920] Tested against 6 ######
correct label, skip!
##### [0:920] Tested against 7 ######
init opt crown verified for label 7 with bound 1.0529122352600098
Image 920 pidx 7 verify end, Time cost: 0.0003070831298828125
920 1.0529122352600098
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3], [920, 999, 6, 1.0785343647003174, 0, 4], [920, 2.550689458847046, 0, 0.00022649765014648438, 0, 5], [920, 0, 0, 0, 0, 6], [920, 1.0529122352600098, 0, 0.0003070831298828125, 0, 7]]
##### [0:920] Tested against 8 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 15, 15]) != torch.Size([2, 9, 1, 16, 15, 15]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 6, 6]) != torch.Size([2, 9, 1, 32, 6, 6]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 15, 15])
1 /11 torch.Size([1, 32, 6, 6])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.3575599193572998 with beta sum per layer: []
optimal alpha/beta time: 0.7294192314147949
alpha-CROWN with fixed intermediate bounds: tensor([[-0.3576]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.3575599193572998
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
# of unstable neurons: 491
splitting decisions: [[2, 52]]
single_node_split: True
best_l after optimization: 0.3215951919555664 with beta sum per layer: [0.0, 0.0, 0.04701124131679535]
optimal alpha/beta time: 0.17019057273864746
This batch time : update_bounds func: 0.1718	 prepare: 0.0009	 bound: 0.1703	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 9.1847	 prepare: 0.5318	 bound: 8.0308	 transfer: 0.0004	 finalize: 0.4215
batch bounding time:  0.17184972763061523
Current worst domains: [-0.188399076461792, -0.13319611549377441]
length of domains: 2
Total time: 0.1875	 pickout: 0.0005	 decision: 0.0150	 get_bound: 0.1719	 add_domain: 0.0001
Current lb:-0.188399076461792
2 neurons visited

splitting decisions: [[2, 44], [2, 44]]
single_node_split: True
best_l after optimization: 0.03696465492248535 with beta sum per layer: [0.0, 0.0, 0.19048021733760834]
optimal alpha/beta time: 0.170396089553833
This batch time : update_bounds func: 0.1723	 prepare: 0.0011	 bound: 0.1705	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 9.3571	 prepare: 0.5329	 bound: 8.2013	 transfer: 0.0004	 finalize: 0.4218
batch bounding time:  0.17237544059753418
Current worst domains: [-0.05430746078491211, -0.016247272491455078]
length of domains: 2
Total time: 0.1882	 pickout: 0.0006	 decision: 0.0152	 get_bound: 0.1724	 add_domain: 0.0001
Current lb:-0.05430746078491211
6 neurons visited

splitting decisions: [[2, 40], [2, 40]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.26632022857666016 with beta sum per layer: [0.0, 0.0, 0.19291545450687408]
optimal alpha/beta time: 0.006436586380004883
This batch time : update_bounds func: 0.0083	 prepare: 0.0010	 bound: 0.0065	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 9.3653	 prepare: 0.5339	 bound: 8.2079	 transfer: 0.0004	 finalize: 0.4221
batch bounding time:  0.008290290832519531
Current worst domains: []
length of domains: 0
Total time: 0.0239	 pickout: 0.0006	 decision: 0.0150	 get_bound: 0.0083	 add_domain: 0.0000
No domains left, verification finished!
Image 920 pidx 8 verify end, Time cost: 1.1848700046539307
920 999
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3], [920, 999, 6, 1.0785343647003174, 0, 4], [920, 2.550689458847046, 0, 0.00022649765014648438, 0, 5], [920, 0, 0, 0, 0, 6], [920, 1.0529122352600098, 0, 0.0003070831298828125, 0, 7], [920, 999, 10, 1.1848700046539307, 0, 8]]
##### [0:920] Tested against 9 ######
init opt crown verified for label 9 with bound 4.050507545471191
Image 920 pidx 9 verify end, Time cost: 0.00022602081298828125
920 4.050507545471191
[[920, 0, 0, 5.145306348800659, 0, -1], [920, 999, 2, 1.3562817573547363, 0, 0], [920, 4.3614888191223145, 0, 0.00022482872009277344, 0, 1], [920, 999, 7566, 11.572993993759155, 0, 2], [920, 0.17981797456741333, 0, 0.0002574920654296875, 0, 3], [920, 999, 6, 1.0785343647003174, 0, 4], [920, 2.550689458847046, 0, 0.00022649765014648438, 0, 5], [920, 0, 0, 0, 0, 6], [920, 1.0529122352600098, 0, 0.0003070831298828125, 0, 7], [920, 999, 10, 1.1848700046539307, 0, 8], [920, 4.050507545471191, 0, 0.00022602081298828125, 0, 9]]
[[ 920.            0.            0.            5.14530635    0.
    -1.        ]
 [ 920.          999.            2.            1.35628176    0.
     0.        ]
 [ 920.            4.36148882    0.            0.00022483    0.
     1.        ]
 [ 920.          999.         7566.           11.57299399    0.
     2.        ]
 [ 920.            0.17981797    0.            0.00025749    0.
     3.        ]
 [ 920.          999.            6.            1.07853436    0.
     4.        ]
 [ 920.            2.55068946    0.            0.0002265     0.
     5.        ]
 [ 920.            0.            0.            0.            0.
     6.        ]
 [ 920.            1.05291224    0.            0.00030708    0.
     7.        ]
 [ 920.          999.           10.            1.18487       0.
     8.        ]
 [ 920.            4.05050755    0.            0.00022602    0.
     9.        ]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [total:1]: 20.33922839164734
mean time [cnt:1]: 20.33922839164734

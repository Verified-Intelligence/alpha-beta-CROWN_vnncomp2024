Configurations:

general:
  device: cuda
  seed: 100
  conv_mode: patches
  deterministic: false
  double_fp: false
  loss_reduction_func: sum
  record_bounds: false
  sparse_alpha: true
  save_adv_example: false
  precompile_jit: false
  complete_verifier: bab
  enable_incomplete_verification: true
  get_crown_verified_acc: false
  csv_name: null
  results_file: out.txt
  root_path: ''
model:
  name: cifar_conv_small
  path: cifar_conv_small_pgd.pth
  onnx_path: null
  onnx_path_prefix: ''
  cache_onnx_conversion: false
  onnx_quirks: null
  input_shape: null
  onnx_loader: default_onnx_and_vnnlib_loader
  onnx_optimization_flags: none
data:
  start: 920
  end: 921
  select_instance: null
  num_outputs: 10
  mean: 0.0
  std: 1.0
  pkl_path: null
  dataset: CIFAR_ERAN
  data_filter_path: null
  data_idx_file: null
specification:
  type: lp
  robustness_type: verified-acc
  norm: .inf
  epsilon: 0.00784313725
  vnnlib_path: null
  vnnlib_path_prefix: ''
solver:
  batch_size: 2048
  min_batch_size_ratio: 0.1
  use_float64_in_last_iteration: false
  early_stop_patience: 10
  start_save_best: 0.5
  bound_prop_method: alpha-crown
  prune_after_crown: false
  crown:
    batch_size: 1000000000
    max_crown_size: 1000000000
  alpha-crown:
    alpha: true
    lr_alpha: 0.1
    iteration: 100
    share_slopes: false
    no_joint_opt: false
    lr_decay: 0.98
    full_conv_alpha: true
  beta-crown:
    lr_alpha: 0.01
    lr_beta: 0.05
    lr_decay: 0.98
    optimizer: adam
    iteration: 20
    beta: true
    beta_warmup: true
    enable_opt_interm_bounds: false
    all_node_split_LP: false
  forward:
    refine: false
    dynamic: false
    max_dim: 10000
  multi_class:
    multi_class_method: allclass_domain
    label_batch_size: 32
    skip_with_refined_bound: true
  mip:
    parallel_solvers: null
    solver_threads: 1
    refine_neuron_timeout: 15
    refine_neuron_time_percentage: 0.8
    early_stop: true
    adv_warmup: true
    mip_solver: gurobi
bab:
  initial_max_domains: 1
  max_domains: .inf
  decision_thresh: 0
  timeout: 120
  timeout_scale: 1
  override_timeout: null
  get_upper_bound: false
  dfs_percent: 0.0
  pruning_in_iteration: true
  pruning_in_iteration_ratio: 0.2
  sort_targets: false
  batched_domain_list: true
  optimized_intermediate_layers: ''
  interm_transfer: true
  cut:
    enabled: false
    bab_cut: false
    lp_cut: false
    method: null
    lr: 0.01
    lr_decay: 1.0
    iteration: 100
    bab_iteration: -1
    early_stop_patience: -1
    lr_beta: 0.02
    number_cuts: 50
    topk_cuts_in_filter: 100
    batch_size_primal: 100
    _tmp_cuts: null
    max_num: 1000000000
    fixed_cuts: false
    patches_cut: false
    cplex_cuts: false
    cplex_cuts_wait: 0
    cplex_cuts_revpickup: true
    cut_reference_bounds: true
    fix_intermediate_bounds: false
  branching:
    method: kfsb
    candidates: 3
    reduceop: min
    sb_coeff_thresh: 0.001
    input_split:
      enable: false
      enhanced_bound_prop_method: alpha-crown
      enhanced_branching_method: naive
      enhanced_bound_patience: 100000000.0
      attack_patience: 100000000.0
      adv_check: 0
      sort_domain_interval: -1
  attack:
    enabled: false
    beam_candidates: 8
    beam_depth: 7
    max_dive_fix_ratio: 0.8
    min_local_free_ratio: 0.2
    mip_start_iteration: 5
    mip_timeout: 30.0
    adv_pool_threshold: null
    refined_mip_attacker: false
    refined_batch_size: null
attack:
  pgd_order: before
  pgd_steps: 100
  pgd_restarts: 100
  pgd_early_stop: true
  pgd_lr_decay: 0.99
  pgd_alpha: auto
  pgd_loss_mode: null
  enable_mip_attack: false
  cex_path: ./test_cex.txt
  attack_mode: PGD
  gama_lambda: 10.0
  gama_decay: 0.9
  check_clean: false
  input_split:
    pgd_steps: 100
    pgd_restarts: 30
    pgd_alpha: auto
  input_split_enhanced:
    pgd_steps: 200
    pgd_restarts: 5000000
    pgd_alpha: auto
  input_split_check_adv:
    pgd_steps: 5
    pgd_restarts: 5
    pgd_alpha: auto
debug:
  lp_test: null

Experiments at Wed Sep 14 15:28:38 2022 on diablo.cs.ucla.edu
Sequential(
  (0): Conv2d(3, 16, kernel_size=(4, 4), stride=(2, 2))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1152, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Sampled data loaded. Data already preprocessed!
Shape: torch.Size([1000, 3, 32, 32]) torch.Size([1000]) torch.Size([1000])
X range: tensor(2.75373125) tensor(-2.42906570) tensor(0.02377951)
Note runnerup label is empty here!
############################
Internal results will be saved to Verified_ret_[cifar_conv_small]_start=920_end=921_iter=20_b=2048_timeout=120_branching=kfsb-min-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before_cplex_cuts=False_multiclass=allclass_domain.npy.

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0, vnnlib ID: 920 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Attack parameters: initialization=uniform, steps=100, restarts=100, alpha=0.009833425283432007, initialization=uniform, GAMA=False
Model output of first 5 examples:
 tensor([[ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
         -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151]],
       device='cuda:0')
Adv example prediction (first 2 examples and 2 restarts):
 tensor([[[ 0.93139106, -3.57527089,  2.92499661,  1.22705936,  1.97891057,
          -1.34895492,  3.03913283, -0.49327534,  1.04279959, -3.81289339],
         [ 0.93139106, -3.57527089,  2.92499661,  1.22705936,  1.97891057,
          -1.34895492,  3.03913283, -0.49327534,  1.04279959, -3.81289339]]],
       device='cuda:0')
PGD attack margin (first 2 examles and 10 specs):
 tensor([[[2.10774183, 6.61440372, 0.11413622, 1.81207347, 1.06022227,
          4.38808775, 3.53240824, 1.99633324, 6.85202599]]], device='cuda:0')
number of violation:  0
Attack finished in 2.0256 seconds.
PGD attack failed
Model prediction is: tensor([[ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
         -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151]],
       device='cuda:0')
layer /input.4 using sparse-features alpha with shape [333]; unstable size 333; total size 3600 (torch.Size([1, 16, 15, 15]))
layer /input.4 start_node /input.8 using sparse-spec alpha with unstable size 125 total_size 1152 output_shape (32, 6, 6)
layer /input.4 start_node /input.12 using sparse-spec alpha with unstable size 38 total_size 100 output_shape torch.Size([100])
layer /input.4 start_node /23 using full alpha with unstable size None total_size 9 output_shape 9
layer /12 using sparse-features alpha with shape [125]; unstable size 125; total size 1152 (torch.Size([1, 32, 6, 6]))
layer /12 start_node /input.12 using sparse-spec alpha with unstable size 38 total_size 100 output_shape torch.Size([100])
layer /12 start_node /23 using full alpha with unstable size None total_size 9 output_shape 9
layer /22 using sparse-features alpha with shape [38]; unstable size 38; total size 100 (torch.Size([1, 100]))
layer /22 start_node /23 using full alpha with unstable size None total_size 9 output_shape 9
Optimizable variables initialized.
initial CROWN bounds: tensor([[-0.31881928,  4.24345160, -1.24988985,  0.11432922, -0.48922682,
          2.47788668,  0.96317601, -0.44299245,  3.95066214]], device='cuda:0') None
best_l after optimization: 10.04015064239502 with beta sum per layer: []
alpha/beta optimization time: 5.629740953445435
initial alpha-CROWN bounds: tensor([[-0.21689653,  4.36211538, -1.16341138,  0.18048096, -0.42166305,
          2.55125093,  1.05386662, -0.35705924,  4.05146742]], device='cuda:0')
Worst class: (+ rhs) -1.1634113788604736
Total VNNLIB file length: 9, max property batch size: 1, total number of batches: 9
lA shape: [torch.Size([1, 9, 16, 15, 15]), torch.Size([1, 9, 32, 6, 6]), torch.Size([1, 9, 100])]

Properties batch 0, size 1
Remaining timeout: 109.19888925552368
##### Instance 0 first 10 spec matrices: [[[-1.  0.  0.  0.  0.  0.  1.  0.  0.  0.]]]
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-0.21689653]], device='cuda:0') need to verify.
Model prediction is: tensor([ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
        -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151],
       device='cuda:0')
build_the_model_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /23 with alignment adjustment
setting alpha for layer /12 start_node /23 with alignment adjustment
setting alpha for layer /22 start_node /23 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 15, 15]), torch.Size([1, 1, 32, 6, 6]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.21689653]], device='cuda:0') tensor([[inf]], device='cuda:0')
Keeping slopes for these layers: ['/23']
Keeping slopes for these layers: ['/23']
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
-----------------
# of unstable neurons: 491
-----------------

batch:  torch.Size([1, 16, 15, 15]) pre split depth:  7
batch:  torch.Size([1, 16, 15, 15]) post split depth:  7
splitting decisions: 
split level 0: [2, 52] 
split level 1: [2, 93] 
split level 2: [2, 44] 
split level 3: [2, 3] 
split level 4: [2, 34] 
split level 5: [2, 85] 
split level 6: [2, 82] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 128 / 128 = 1.0
pruning-in-iteration extra time: 0.0001087188720703125
Tensors transferred: pre=1.1846M lA=0.5923M alpha=0.1211M beta=0.0009M
This batch time : update_bounds func: 0.0240	 prepare: 0.0096	 bound: 0.0088	 transfer: 0.0024	 finalize: 0.0030
Accumulated time: update_bounds func: 0.0240	 prepare: 0.0096	 bound: 0.0088	 transfer: 0.0024	 finalize: 0.0030
batch bounding time:  0.024074792861938477
length of domains: 0
Total time: 0.4522	 pickout: 0.0012	 decision: 0.4095	 get_bound: 0.0402	 add_domain: 0.0013
Accumulated time:	 pickout: 0.0012	 decision: 0.4095	 get_bound: 0.0402	 add_domain: 0.0013
No domains left, verification finished!
128 domains visited
Cumulative time: 0.5013484954833984


Properties batch 1, size 1
Remaining timeout: 108.47336101531982
##### Instance 0 first 10 spec matrices: [[[ 0. -1.  0.  0.  0.  0.  1.  0.  0.  0.]]]
thresholds: [0] ######
Initial alpha-CROWN verified for spec index [0] with bound 4.362115383148193.

Properties batch 2, size 1
Remaining timeout: 108.42634868621826
##### Instance 0 first 10 spec matrices: [[[ 0.  0. -1.  0.  0.  0.  1.  0.  0.  0.]]]
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-1.16341138]], device='cuda:0') need to verify.
Model prediction is: tensor([ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
        -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151],
       device='cuda:0')
build_the_model_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /23 with alignment adjustment
setting alpha for layer /12 start_node /23 with alignment adjustment
setting alpha for layer /22 start_node /23 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 15, 15]), torch.Size([1, 1, 32, 6, 6]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-1.16341138]], device='cuda:0') tensor([[inf]], device='cuda:0')
Keeping slopes for these layers: ['/23']
Keeping slopes for these layers: ['/23']
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
-----------------
# of unstable neurons: 491
-----------------

batch:  torch.Size([1, 16, 15, 15]) pre split depth:  7
batch:  torch.Size([1, 16, 15, 15]) post split depth:  7
splitting decisions: 
split level 0: [2, 52] 
split level 1: [2, 23] 
split level 2: [2, 99] 
split level 3: [2, 40] 
split level 4: [2, 13] 
split level 5: [2, 85] 
split level 6: [2, 82] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])
pruning_in_iteration open status: True
ratio of positive domain = 96 / 128 = 0.75
pruning-in-iteration extra time: 0.01235055923461914
Tensors transferred: pre=1.1846M lA=0.1481M alpha=0.1211M beta=0.0009M
This batch time : update_bounds func: 0.6076	 prepare: 0.0095	 bound: 0.5924	 transfer: 0.0024	 finalize: 0.0030
Accumulated time: update_bounds func: 0.6316	 prepare: 0.0191	 bound: 0.6013	 transfer: 0.0048	 finalize: 0.0060
batch bounding time:  0.6076674461364746
Current worst splitting domains lb-rhs (depth):
-0.35049 (7), -0.34644 (7), -0.32643 (7), -0.32612 (7), -0.32372 (7), -0.32096 (7), -0.32062 (7), -0.31066 (7), -0.29638 (7), -0.29245 (7), -0.28853 (7), -0.28036 (7), -0.25858 (7), -0.25590 (7), -0.23041 (7), -0.22814 (7), -0.17594 (7), -0.16017 (7), -0.15538 (7), -0.15410 (7), 
length of domains: 32
Total time: 0.6757	 pickout: 0.0011	 decision: 0.0458	 get_bound: 0.6248	 add_domain: 0.0041
Accumulated time:	 pickout: 0.0011	 decision: 0.0458	 get_bound: 0.6248	 add_domain: 0.0041
Current (lb-rhs): -0.3504921793937683
96 domains visited
Cumulative time: 0.6819007396697998

batch:  torch.Size([32, 16, 15, 15]) pre split depth:  2
batch:  torch.Size([32, 16, 15, 15]) post split depth:  2
splitting decisions: 
split level 0: [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] [2, 44] 
split level 1: [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] [2, 50] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])
pruning_in_iteration open status: True
ratio of positive domain = 57 / 128 = 0.4453125
pruning-in-iteration extra time: 0.01504373550415039
Tensors transferred: pre=1.1846M lA=0.3285M alpha=0.1211M beta=0.0011M
This batch time : update_bounds func: 0.2656	 prepare: 0.0102	 bound: 0.2496	 transfer: 0.0025	 finalize: 0.0030
Accumulated time: update_bounds func: 0.8973	 prepare: 0.0293	 bound: 0.8509	 transfer: 0.0074	 finalize: 0.0090
batch bounding time:  0.2656865119934082
Current worst splitting domains lb-rhs (depth):
-0.25733 (9), -0.25258 (9), -0.23760 (9), -0.23595 (9), -0.23419 (9), -0.23322 (9), -0.23054 (9), -0.22774 (9), -0.22326 (9), -0.21410 (9), -0.21320 (9), -0.21155 (9), -0.21014 (9), -0.20807 (9), -0.20807 (9), -0.20564 (9), -0.20249 (9), -0.20124 (9), -0.19270 (9), -0.18526 (9), 
length of domains: 71
Total time: 0.3104	 pickout: 0.0014	 decision: 0.0275	 get_bound: 0.2743	 add_domain: 0.0073
Accumulated time:	 pickout: 0.0025	 decision: 0.0732	 get_bound: 0.8991	 add_domain: 0.0113
Current (lb-rhs): -0.2573291063308716
153 domains visited
Cumulative time: 0.9928925037384033

batch:  torch.Size([71, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([71, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] [2, 92] 
(142, 3, 32, 32) torch.Size([142, 1, 10]) torch.Size([142, 1])
pruning_in_iteration open status: True
ratio of positive domain = 70 / 142 = 0.49295774647887325
pruning-in-iteration extra time: 0.011556863784790039
Tensors transferred: pre=1.3141M lA=0.3332M alpha=0.1343M beta=0.0014M
This batch time : update_bounds func: 0.2533	 prepare: 0.0111	 bound: 0.2362	 transfer: 0.0027	 finalize: 0.0032
Accumulated time: update_bounds func: 1.1506	 prepare: 0.0404	 bound: 1.0871	 transfer: 0.0100	 finalize: 0.0122
batch bounding time:  0.2534012794494629
Current worst splitting domains lb-rhs (depth):
-0.22247 (10), -0.21769 (10), -0.20217 (10), -0.20135 (10), -0.19822 (10), -0.19723 (10), -0.19424 (10), -0.19083 (10), -0.18720 (10), -0.17884 (10), -0.17755 (10), -0.17425 (10), -0.17369 (10), -0.17187 (10), -0.17182 (10), -0.17080 (10), -0.16497 (10), -0.16432 (10), -0.15633 (10), -0.14963 (10), 
length of domains: 72
Total time: 0.2936	 pickout: 0.0017	 decision: 0.0314	 get_bound: 0.2534	 add_domain: 0.0071
Accumulated time:	 pickout: 0.0041	 decision: 0.1046	 get_bound: 1.1525	 add_domain: 0.0184
Current (lb-rhs): -0.22247004508972168
223 domains visited
Cumulative time: 1.2871754169464111

batch:  torch.Size([72, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([72, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] [2, 71] 
(144, 3, 32, 32) torch.Size([144, 1, 10]) torch.Size([144, 1])
pruning_in_iteration open status: True
ratio of positive domain = 102 / 144 = 0.7083333333333333
pruning-in-iteration extra time: 0.011808156967163086
Tensors transferred: pre=1.3326M lA=0.1943M alpha=0.1362M beta=0.0015M
This batch time : update_bounds func: 0.2619	 prepare: 0.0114	 bound: 0.2419	 transfer: 0.0052	 finalize: 0.0033
Accumulated time: update_bounds func: 1.4126	 prepare: 0.0518	 bound: 1.3289	 transfer: 0.0153	 finalize: 0.0154
batch bounding time:  0.26201915740966797
Current worst splitting domains lb-rhs (depth):
-0.19284 (11), -0.18895 (11), -0.17312 (11), -0.17149 (11), -0.16846 (11), -0.16721 (11), -0.16467 (11), -0.16163 (11), -0.15559 (11), -0.14780 (11), -0.14504 (11), -0.14466 (11), -0.14341 (11), -0.14188 (11), -0.14175 (11), -0.13873 (11), -0.13515 (11), -0.13430 (11), -0.12355 (11), -0.11793 (11), 
length of domains: 42
Total time: 0.2996	 pickout: 0.0016	 decision: 0.0308	 get_bound: 0.2621	 add_domain: 0.0052
Accumulated time:	 pickout: 0.0057	 decision: 0.1354	 get_bound: 1.4146	 add_domain: 0.0236
Current (lb-rhs): -0.19284403324127197
325 domains visited
Cumulative time: 1.5889434814453125

batch:  torch.Size([42, 16, 15, 15]) pre split depth:  2
batch:  torch.Size([42, 16, 15, 15]) post split depth:  2
splitting decisions: 
split level 0: [2, 76] [2, 76] [2, 57] [2, 76] [2, 76] [2, 57] [2, 57] [2, 76] [2, 76] [2, 57] 
split level 1: [2, 57] [2, 57] [2, 76] [2, 57] [2, 57] [2, 76] [2, 76] [2, 57] [2, 57] [2, 76] 
(168, 3, 32, 32) torch.Size([168, 1, 10]) torch.Size([168, 1])
pruning_in_iteration open status: True
ratio of positive domain = 136 / 168 = 0.8095238095238095
pruning-in-iteration extra time: 0.01165151596069336
Tensors transferred: pre=1.5547M lA=0.1481M alpha=0.1589M beta=0.0021M
This batch time : update_bounds func: 0.2591	 prepare: 0.0128	 bound: 0.2390	 transfer: 0.0032	 finalize: 0.0037
Accumulated time: update_bounds func: 1.6717	 prepare: 0.0646	 bound: 1.5680	 transfer: 0.0184	 finalize: 0.0191
batch bounding time:  0.25918006896972656
Current worst splitting domains lb-rhs (depth):
-0.14556 (13), -0.14211 (13), -0.12566 (13), -0.12351 (13), -0.12018 (13), -0.11941 (13), -0.11785 (13), -0.11491 (13), -0.10624 (13), -0.09868 (13), -0.09717 (13), -0.09524 (13), -0.09481 (13), -0.09411 (13), -0.09321 (13), -0.08914 (13), -0.08748 (13), -0.08730 (13), -0.07534 (13), -0.06932 (13), 
length of domains: 32
Total time: 0.3085	 pickout: 0.0015	 decision: 0.0304	 get_bound: 0.2710	 add_domain: 0.0056
Accumulated time:	 pickout: 0.0072	 decision: 0.1658	 get_bound: 1.6856	 add_domain: 0.0291
Current (lb-rhs): -0.14555788040161133
461 domains visited
Cumulative time: 1.898179531097412

batch:  torch.Size([32, 16, 15, 15]) pre split depth:  2
batch:  torch.Size([32, 16, 15, 15]) post split depth:  2
splitting decisions: 
split level 0: [1, 267] [2, 93] [1, 267] [2, 93] [1, 267] [2, 93] [1, 267] [2, 93] [1, 267] [2, 93] 
split level 1: [2, 93] [1, 1124] [2, 93] [2, 94] [2, 93] [1, 1124] [2, 93] [2, 94] [2, 93] [2, 94] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])
pruning_in_iteration open status: True
ratio of positive domain = 86 / 128 = 0.671875
pruning-in-iteration extra time: 0.011579036712646484
Tensors transferred: pre=1.1846M lA=0.1943M alpha=0.1211M beta=0.0020M
This batch time : update_bounds func: 0.2586	 prepare: 0.0108	 bound: 0.2420	 transfer: 0.0025	 finalize: 0.0032
Accumulated time: update_bounds func: 1.9303	 prepare: 0.0754	 bound: 1.8100	 transfer: 0.0209	 finalize: 0.0223
batch bounding time:  0.25870323181152344
Current worst splitting domains lb-rhs (depth):
-0.12369 (15), -0.12063 (15), -0.10774 (15), -0.10684 (15), -0.09928 (15), -0.09647 (15), -0.09522 (15), -0.09480 (15), -0.09198 (15), -0.08218 (15), -0.07511 (15), -0.07447 (15), -0.07111 (15), -0.07099 (15), -0.06997 (15), -0.06984 (15), -0.06649 (15), -0.06411 (15), -0.06400 (15), -0.06228 (15), 
length of domains: 42
Total time: 0.3038	 pickout: 0.0014	 decision: 0.0281	 get_bound: 0.2679	 add_domain: 0.0064
Accumulated time:	 pickout: 0.0086	 decision: 0.1939	 get_bound: 1.9535	 add_domain: 0.0355
Current (lb-rhs): -0.1236875057220459
547 domains visited
Cumulative time: 2.20257568359375

batch:  torch.Size([42, 16, 15, 15]) pre split depth:  2
batch:  torch.Size([42, 16, 15, 15]) post split depth:  2
splitting decisions: 
split level 0: [1, 416] [2, 94] [2, 94] [2, 94] [2, 94] [2, 94] [1, 416] [2, 94] [1, 1096] [2, 94] 
split level 1: [2, 94] [1, 23] [1, 23] [1, 1124] [1, 1124] [1, 1124] [2, 94] [1, 1124] [2, 94] [1, 1124] 
(168, 3, 32, 32) torch.Size([168, 1, 10]) torch.Size([168, 1])
pruning_in_iteration open status: True
ratio of positive domain = 102 / 168 = 0.6071428571428572
pruning-in-iteration extra time: 0.011653423309326172
Tensors transferred: pre=1.5547M lA=0.3054M alpha=0.1589M beta=0.0027M
This batch time : update_bounds func: 0.2633	 prepare: 0.0135	 bound: 0.2426	 transfer: 0.0032	 finalize: 0.0037
Accumulated time: update_bounds func: 2.1936	 prepare: 0.0889	 bound: 2.0526	 transfer: 0.0241	 finalize: 0.0260
batch bounding time:  0.2633085250854492
Current worst splitting domains lb-rhs (depth):
-0.10770 (17), -0.10606 (17), -0.09298 (17), -0.09084 (17), -0.08610 (17), -0.08409 (17), -0.07967 (17), -0.07921 (17), -0.07739 (17), -0.07584 (17), -0.07570 (17), -0.06701 (17), -0.06408 (17), -0.06108 (17), -0.05981 (17), -0.05545 (17), -0.05525 (17), -0.05452 (17), -0.05180 (17), -0.05122 (17), 
length of domains: 66
Total time: 0.3173	 pickout: 0.0014	 decision: 0.0321	 get_bound: 0.2753	 add_domain: 0.0084
Accumulated time:	 pickout: 0.0101	 decision: 0.2260	 get_bound: 2.2288	 add_domain: 0.0439
Current (lb-rhs): -0.10770058631896973
649 domains visited
Cumulative time: 2.5205841064453125

batch:  torch.Size([66, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([66, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 591] [1, 1096] [1, 416] [1, 416] [1, 591] [2, 3] [1, 416] [2, 3] [1, 416] [1, 735] 
(132, 3, 32, 32) torch.Size([132, 1, 10]) torch.Size([132, 1])
pruning_in_iteration open status: True
ratio of positive domain = 36 / 132 = 0.2727272727272727
pruning-in-iteration extra time: 0.01047825813293457
Tensors transferred: pre=1.2216M lA=0.4488M alpha=0.1249M beta=0.0024M
This batch time : update_bounds func: 0.2691	 prepare: 0.0134	 bound: 0.2475	 transfer: 0.0047	 finalize: 0.0032
Accumulated time: update_bounds func: 2.4627	 prepare: 0.1023	 bound: 2.3001	 transfer: 0.0288	 finalize: 0.0292
batch bounding time:  0.2691628932952881
Current worst splitting domains lb-rhs (depth):
-0.09853 (18), -0.09685 (18), -0.08967 (18), -0.08372 (18), -0.08038 (18), -0.07705 (18), -0.07652 (18), -0.07460 (18), -0.07219 (18), -0.07083 (18), -0.07083 (18), -0.06888 (18), -0.06852 (18), -0.06730 (18), -0.06584 (18), -0.06344 (18), -0.06223 (18), -0.05750 (18), -0.05479 (18), -0.05324 (18), 
length of domains: 96
Total time: 0.3124	 pickout: 0.0016	 decision: 0.0305	 get_bound: 0.2692	 add_domain: 0.0111
Accumulated time:	 pickout: 0.0117	 decision: 0.2565	 get_bound: 2.4980	 add_domain: 0.0550
Current (lb-rhs): -0.0985262393951416
685 domains visited
Cumulative time: 2.8337929248809814

batch:  torch.Size([96, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([96, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [2, 3] [1, 606] [1, 407] [1, 970] [1, 485] [1, 407] [1, 1096] [1, 416] [1, 407] [2, 3] 
(192, 3, 32, 32) torch.Size([192, 1, 10]) torch.Size([192, 1])
pruning_in_iteration open status: True
ratio of positive domain = 63 / 192 = 0.328125
pruning-in-iteration extra time: 0.011822700500488281
Tensors transferred: pre=1.7769M lA=0.5969M alpha=0.1816M beta=0.0037M
This batch time : update_bounds func: 0.2792	 prepare: 0.0154	 bound: 0.2527	 transfer: 0.0061	 finalize: 0.0047
Accumulated time: update_bounds func: 2.7419	 prepare: 0.1177	 bound: 2.5528	 transfer: 0.0349	 finalize: 0.0340
batch bounding time:  0.27937841415405273
Current worst splitting domains lb-rhs (depth):
-0.08806 (19), -0.08774 (19), -0.08403 (19), -0.08238 (19), -0.07877 (19), -0.07665 (19), -0.07452 (19), -0.07148 (19), -0.06903 (19), -0.06598 (19), -0.06569 (19), -0.06546 (19), -0.06465 (19), -0.06378 (19), -0.06365 (19), -0.06309 (19), -0.06175 (19), -0.06125 (19), -0.06017 (19), -0.05987 (19), 
length of domains: 129
Total time: 0.3347	 pickout: 0.0019	 decision: 0.0400	 get_bound: 0.2794	 add_domain: 0.0133
Accumulated time:	 pickout: 0.0136	 decision: 0.2966	 get_bound: 2.7774	 add_domain: 0.0683
Current (lb-rhs): -0.08805572986602783
748 domains visited
Cumulative time: 3.1695289611816406

batch:  torch.Size([129, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([129, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 485] [2, 3] [1, 23] [1, 735] [1, 485] [1, 735] [1, 1096] [1, 416] [2, 3] [1, 735] 
(258, 3, 32, 32) torch.Size([258, 1, 10]) torch.Size([258, 1])
pruning_in_iteration open status: True
ratio of positive domain = 90 / 258 = 0.34883720930232553
pruning-in-iteration extra time: 0.011970281600952148
Tensors transferred: pre=2.3876M lA=0.7774M alpha=0.2441M beta=0.0052M
This batch time : update_bounds func: 0.2868	 prepare: 0.0200	 bound: 0.2543	 transfer: 0.0059	 finalize: 0.0062
Accumulated time: update_bounds func: 3.0287	 prepare: 0.1377	 bound: 2.8071	 transfer: 0.0408	 finalize: 0.0402
batch bounding time:  0.2868506908416748
Current worst splitting domains lb-rhs (depth):
-0.07977 (20), -0.07914 (20), -0.07563 (20), -0.07375 (20), -0.07008 (20), -0.06784 (20), -0.06595 (20), -0.06260 (20), -0.06038 (20), -0.05786 (20), -0.05692 (20), -0.05652 (20), -0.05641 (20), -0.05593 (20), -0.05432 (20), -0.05424 (20), -0.05327 (20), -0.05253 (20), -0.05218 (20), -0.05162 (20), 
length of domains: 168
Total time: 0.3474	 pickout: 0.0022	 decision: 0.0412	 get_bound: 0.2869	 add_domain: 0.0171
Accumulated time:	 pickout: 0.0158	 decision: 0.3378	 get_bound: 3.0644	 add_domain: 0.0854
Current (lb-rhs): -0.0797654390335083
838 domains visited
Cumulative time: 3.5183064937591553

batch:  torch.Size([168, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([168, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 735] [2, 3] [1, 970] [2, 3] [2, 3] [1, 23] [1, 416] [1, 416] [1, 591] [2, 3] 
(336, 3, 32, 32) torch.Size([336, 1, 10]) torch.Size([336, 1])
pruning_in_iteration open status: True
ratio of positive domain = 174 / 336 = 0.5178571428571428
pruning-in-iteration extra time: 0.011853218078613281
Tensors transferred: pre=3.1095M lA=0.7496M alpha=0.3179M beta=0.0070M
This batch time : update_bounds func: 0.2950	 prepare: 0.0252	 bound: 0.2555	 transfer: 0.0057	 finalize: 0.0082
Accumulated time: update_bounds func: 3.3237	 prepare: 0.1628	 bound: 3.0626	 transfer: 0.0465	 finalize: 0.0483
batch bounding time:  0.29505419731140137
Current worst splitting domains lb-rhs (depth):
-0.07141 (21), -0.06875 (21), -0.06827 (21), -0.06714 (21), -0.06328 (21), -0.06321 (21), -0.06146 (21), -0.05916 (21), -0.05584 (21), -0.05551 (21), -0.05514 (21), -0.04999 (21), -0.04993 (21), -0.04984 (21), -0.04864 (21), -0.04833 (21), -0.04811 (21), -0.04756 (21), -0.04577 (21), -0.04561 (21), 
length of domains: 162
Total time: 0.3647	 pickout: 0.0027	 decision: 0.0509	 get_bound: 0.2951	 add_domain: 0.0161
Accumulated time:	 pickout: 0.0184	 decision: 0.3887	 get_bound: 3.3594	 add_domain: 0.1015
Current (lb-rhs): -0.07140696048736572
1012 domains visited
Cumulative time: 3.884532928466797

batch:  torch.Size([162, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([162, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 606] [1, 606] [1, 305] [1, 305] [1, 485] [1, 267] [1, 23] [1, 416] [1, 970] [1, 305] 
(324, 3, 32, 32) torch.Size([324, 1, 10]) torch.Size([324, 1])
pruning_in_iteration open status: True
ratio of positive domain = 132 / 324 = 0.40740740740740744
pruning-in-iteration extra time: 0.011915922164916992
Tensors transferred: pre=2.9984M lA=0.8931M alpha=0.3065M beta=0.0071M
This batch time : update_bounds func: 0.2925	 prepare: 0.0238	 bound: 0.2571	 transfer: 0.0035	 finalize: 0.0076
Accumulated time: update_bounds func: 3.6161	 prepare: 0.1867	 bound: 3.3196	 transfer: 0.0500	 finalize: 0.0560
batch bounding time:  0.29253673553466797
Current worst splitting domains lb-rhs (depth):
-0.06401 (22), -0.06124 (22), -0.06101 (22), -0.05986 (22), -0.05609 (22), -0.05574 (22), -0.05414 (22), -0.05187 (22), -0.05080 (22), -0.04900 (22), -0.04806 (22), -0.04788 (22), -0.04765 (22), -0.04648 (22), -0.04566 (22), -0.04364 (22), -0.04324 (22), -0.04281 (22), -0.04251 (22), -0.04081 (22), 
length of domains: 192
Total time: 0.3588	 pickout: 0.0025	 decision: 0.0447	 get_bound: 0.2926	 add_domain: 0.0190
Accumulated time:	 pickout: 0.0210	 decision: 0.4333	 get_bound: 3.6520	 add_domain: 0.1205
Current (lb-rhs): -0.06400668621063232
1144 domains visited
Cumulative time: 4.244765758514404

batch:  torch.Size([192, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([192, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 407] [1, 23] [1, 485] [1, 416] [1, 305] [1, 23] [1, 485] [1, 485] [1, 591] [1, 379] 
(384, 3, 32, 32) torch.Size([384, 1, 10]) torch.Size([384, 1])
pruning_in_iteration open status: True
ratio of positive domain = 150 / 384 = 0.390625
pruning-in-iteration extra time: 0.011748790740966797
Tensors transferred: pre=3.5537M lA=1.0874M alpha=0.3633M beta=0.0088M
This batch time : update_bounds func: 0.2966	 prepare: 0.0275	 bound: 0.2538	 transfer: 0.0059	 finalize: 0.0089
Accumulated time: update_bounds func: 3.9128	 prepare: 0.2141	 bound: 3.5734	 transfer: 0.0559	 finalize: 0.0649
batch bounding time:  0.29670286178588867
Current worst splitting domains lb-rhs (depth):
-0.05841 (23), -0.05418 (23), -0.05173 (23), -0.05167 (23), -0.05038 (23), -0.05037 (23), -0.04831 (23), -0.04705 (23), -0.04672 (23), -0.04633 (23), -0.04594 (23), -0.04537 (23), -0.04523 (23), -0.04499 (23), -0.04075 (23), -0.04068 (23), -0.03930 (23), -0.03904 (23), -0.03890 (23), -0.03836 (23), 
length of domains: 234
Total time: 0.3807	 pickout: 0.0027	 decision: 0.0505	 get_bound: 0.2967	 add_domain: 0.0308
Accumulated time:	 pickout: 0.0237	 decision: 0.4838	 get_bound: 3.9488	 add_domain: 0.1513
Current (lb-rhs): -0.05841028690338135
1294 domains visited
Cumulative time: 4.627659320831299

batch:  torch.Size([234, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([234, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 485] [1, 485] [1, 735] [1, 407] [1, 485] [1, 735] [1, 407] [1, 485] [1, 735] [1, 485] 
(468, 3, 32, 32) torch.Size([468, 1, 10]) torch.Size([468, 1])
pruning_in_iteration open status: True
ratio of positive domain = 205 / 468 = 0.43803418803418803
pruning-in-iteration extra time: 0.011917591094970703
Tensors transferred: pre=4.3311M lA=1.2216M alpha=0.4427M beta=0.0107M
This batch time : update_bounds func: 0.3781	 prepare: 0.0339	 bound: 0.2566	 transfer: 0.0116	 finalize: 0.0106
Accumulated time: update_bounds func: 4.2909	 prepare: 0.2480	 bound: 3.8300	 transfer: 0.0676	 finalize: 0.0755
batch bounding time:  0.3781604766845703
Current worst splitting domains lb-rhs (depth):
-0.05280 (24), -0.04873 (24), -0.04490 (24), -0.04474 (24), -0.04325 (24), -0.04314 (24), -0.04237 (24), -0.04143 (24), -0.04136 (24), -0.04129 (24), -0.04067 (24), -0.04034 (24), -0.04027 (24), -0.03971 (24), -0.03942 (24), -0.03904 (24), -0.03775 (24), -0.03736 (24), -0.03660 (24), -0.03616 (24), 
length of domains: 263
Total time: 0.4652	 pickout: 0.0033	 decision: 0.0569	 get_bound: 0.3782	 add_domain: 0.0268
Accumulated time:	 pickout: 0.0269	 decision: 0.5407	 get_bound: 4.3270	 add_domain: 0.1781
Current (lb-rhs): -0.05280005931854248
1499 domains visited
Cumulative time: 5.095270156860352

batch:  torch.Size([263, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([263, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 485] [1, 485] [1, 485] [1, 305] [1, 485] [1, 485] [1, 970] [1, 735] [1, 485] [1, 485] 
(526, 3, 32, 32) torch.Size([526, 1, 10]) torch.Size([526, 1])
pruning_in_iteration open status: True
ratio of positive domain = 245 / 526 = 0.4657794676806084
pruning-in-iteration extra time: 0.012315511703491211
Tensors transferred: pre=4.8678M lA=1.3003M alpha=0.4976M beta=0.0125M
This batch time : update_bounds func: 0.3204	 prepare: 0.0366	 bound: 0.2641	 transfer: 0.0073	 finalize: 0.0116
Accumulated time: update_bounds func: 4.6112	 prepare: 0.2846	 bound: 4.0942	 transfer: 0.0749	 finalize: 0.0871
batch bounding time:  0.3204193115234375
Current worst splitting domains lb-rhs (depth):
-0.04402 (25), -0.04398 (25), -0.03994 (25), -0.03965 (25), -0.03773 (25), -0.03752 (25), -0.03640 (25), -0.03635 (25), -0.03615 (25), -0.03597 (25), -0.03481 (25), -0.03469 (25), -0.03406 (25), -0.03394 (25), -0.03352 (25), -0.03350 (25), -0.03319 (25), -0.03315 (25), -0.03308 (25), -0.03296 (25), 
length of domains: 281
Total time: 0.4149	 pickout: 0.0035	 decision: 0.0614	 get_bound: 0.3205	 add_domain: 0.0295
Accumulated time:	 pickout: 0.0305	 decision: 0.6021	 get_bound: 4.6475	 add_domain: 0.2076
Current (lb-rhs): -0.04401600360870361
1744 domains visited
Cumulative time: 5.5123820304870605

batch:  torch.Size([281, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([281, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 340] [1, 967] [1, 379] [1, 485] [1, 967] [1, 340] [1, 379] [1, 485] [1, 606] [1, 305] 
(562, 3, 32, 32) torch.Size([562, 1, 10]) torch.Size([562, 1])
pruning_in_iteration open status: True
ratio of positive domain = 259 / 562 = 0.4608540925266904
pruning-in-iteration extra time: 0.011914253234863281
Tensors transferred: pre=5.2010M lA=1.4067M alpha=0.5317M beta=0.0139M
This batch time : update_bounds func: 0.3214	 prepare: 0.0409	 bound: 0.2589	 transfer: 0.0062	 finalize: 0.0146
Accumulated time: update_bounds func: 4.9326	 prepare: 0.3256	 bound: 4.3531	 transfer: 0.0811	 finalize: 0.1017
batch bounding time:  0.32149219512939453
Current worst splitting domains lb-rhs (depth):
-0.03799 (26), -0.03793 (26), -0.03377 (26), -0.03353 (26), -0.03118 (26), -0.03065 (26), -0.03056 (26), -0.03053 (26), -0.02979 (26), -0.02964 (26), -0.02961 (26), -0.02910 (26), -0.02814 (26), -0.02801 (26), -0.02777 (26), -0.02723 (26), -0.02705 (26), -0.02692 (26), -0.02666 (26), -0.02658 (26), 
length of domains: 303
Total time: 0.4189	 pickout: 0.0036	 decision: 0.0628	 get_bound: 0.3215	 add_domain: 0.0310
Accumulated time:	 pickout: 0.0341	 decision: 0.6649	 get_bound: 4.9690	 add_domain: 0.2386
Current (lb-rhs): -0.03798568248748779
2003 domains visited
Cumulative time: 5.933558464050293

batch:  torch.Size([303, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([303, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 606] [1, 970] [1, 970] [1, 970] [1, 970] [1, 735] [1, 970] [1, 970] [1, 970] [1, 416] 
(606, 3, 32, 32) torch.Size([606, 1, 10]) torch.Size([606, 1])
pruning_in_iteration open status: True
ratio of positive domain = 317 / 606 = 0.523102310231023
pruning-in-iteration extra time: 0.011929750442504883
Tensors transferred: pre=5.6082M lA=1.3373M alpha=0.5733M beta=0.0156M
This batch time : update_bounds func: 0.3179	 prepare: 0.0423	 bound: 0.2550	 transfer: 0.0063	 finalize: 0.0133
Accumulated time: update_bounds func: 5.2505	 prepare: 0.3679	 bound: 4.6081	 transfer: 0.0874	 finalize: 0.1151
batch bounding time:  0.31795334815979004
Current worst splitting domains lb-rhs (depth):
-0.03237 (27), -0.03206 (27), -0.02854 (27), -0.02829 (27), -0.02598 (27), -0.02585 (27), -0.02550 (27), -0.02520 (27), -0.02472 (27), -0.02472 (27), -0.02443 (27), -0.02414 (27), -0.02385 (27), -0.02337 (27), -0.02257 (27), -0.02252 (27), -0.02172 (27), -0.02112 (27), -0.02101 (27), -0.02100 (27), 
length of domains: 289
Total time: 0.4199	 pickout: 0.0038	 decision: 0.0681	 get_bound: 0.3180	 add_domain: 0.0300
Accumulated time:	 pickout: 0.0379	 decision: 0.7329	 get_bound: 5.2870	 add_domain: 0.2686
Current (lb-rhs): -0.0323714017868042
2320 domains visited
Cumulative time: 6.3559770584106445

batch:  torch.Size([289, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([289, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 23] [1, 23] [1, 23] [1, 735] [1, 379] [1, 967] [1, 379] [1, 967] [1, 753] [1, 379] 
(578, 3, 32, 32) torch.Size([578, 1, 10]) torch.Size([578, 1])
pruning_in_iteration open status: True
ratio of positive domain = 330 / 578 = 0.5709342560553633
pruning-in-iteration extra time: 0.011902809143066406
Tensors transferred: pre=5.3491M lA=1.1568M alpha=0.5468M beta=0.0154M
This batch time : update_bounds func: 0.3806	 prepare: 0.0440	 bound: 0.2536	 transfer: 0.0049	 finalize: 0.0128
Accumulated time: update_bounds func: 5.6312	 prepare: 0.4119	 bound: 4.8617	 transfer: 0.0923	 finalize: 0.1278
batch bounding time:  0.3806746006011963
Current worst splitting domains lb-rhs (depth):
-0.02554 (28), -0.02554 (28), -0.02518 (28), -0.02449 (28), -0.02321 (28), -0.02314 (28), -0.02045 (28), -0.02013 (28), -0.01974 (28), -0.01964 (28), -0.01892 (28), -0.01885 (28), -0.01791 (28), -0.01738 (28), -0.01735 (28), -0.01735 (28), -0.01699 (28), -0.01668 (28), -0.01658 (28), -0.01640 (28), 
length of domains: 248
Total time: 0.4754	 pickout: 0.0041	 decision: 0.0637	 get_bound: 0.3807	 add_domain: 0.0268
Accumulated time:	 pickout: 0.0420	 decision: 0.7966	 get_bound: 5.6678	 add_domain: 0.2954
Current (lb-rhs): -0.025537729263305664
2650 domains visited
Cumulative time: 6.833727836608887

batch:  torch.Size([248, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([248, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 735] [1, 591] [1, 967] [1, 967] [1, 379] [1, 379] [1, 379] [1, 735] [1, 379] [1, 379] 
(496, 3, 32, 32) torch.Size([496, 1, 10]) torch.Size([496, 1])
pruning_in_iteration open status: True
ratio of positive domain = 323 / 496 = 0.6512096774193548
pruning-in-iteration extra time: 0.011966228485107422
Tensors transferred: pre=4.5902M lA=0.8005M alpha=0.4692M beta=0.0137M
This batch time : update_bounds func: 0.3109	 prepare: 0.0351	 bound: 0.2526	 transfer: 0.0115	 finalize: 0.0111
Accumulated time: update_bounds func: 5.9421	 prepare: 0.4470	 bound: 5.1143	 transfer: 0.1037	 finalize: 0.1389
batch bounding time:  0.31099796295166016
Current worst splitting domains lb-rhs (depth):
-0.02041 (29), -0.02031 (29), -0.01989 (29), -0.01925 (29), -0.01813 (29), -0.01806 (29), -0.01557 (29), -0.01518 (29), -0.01505 (29), -0.01444 (29), -0.01440 (29), -0.01426 (29), -0.01352 (29), -0.01301 (29), -0.01239 (29), -0.01219 (29), -0.01200 (29), -0.01190 (29), -0.01154 (29), -0.01087 (29), 
length of domains: 173
Total time: 0.4008	 pickout: 0.0033	 decision: 0.0642	 get_bound: 0.3111	 add_domain: 0.0222
Accumulated time:	 pickout: 0.0453	 decision: 0.8608	 get_bound: 5.9788	 add_domain: 0.3176
Current (lb-rhs): -0.020409822463989258
2973 domains visited
Cumulative time: 7.236689329147339

batch:  torch.Size([173, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([173, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 267] [1, 267] [1, 267] [1, 267] [1, 591] [1, 591] [1, 267] [1, 591] [1, 753] [1, 267] 
(346, 3, 32, 32) torch.Size([346, 1, 10]) torch.Size([346, 1])
pruning_in_iteration open status: True
ratio of positive domain = 244 / 346 = 0.7052023121387283
pruning-in-iteration extra time: 0.011831998825073242
Tensors transferred: pre=3.2020M lA=0.4720M alpha=0.3273M beta=0.0099M
This batch time : update_bounds func: 0.2880	 prepare: 0.0254	 bound: 0.2507	 transfer: 0.0036	 finalize: 0.0078
Accumulated time: update_bounds func: 6.2301	 prepare: 0.4724	 bound: 5.3650	 transfer: 0.1073	 finalize: 0.1467
batch bounding time:  0.28804445266723633
Current worst splitting domains lb-rhs (depth):
-0.01555 (30), -0.01543 (30), -0.01499 (30), -0.01438 (30), -0.01291 (30), -0.01288 (30), -0.01192 (30), -0.01141 (30), -0.01075 (30), -0.01060 (30), -0.01040 (30), -0.00981 (30), -0.00957 (30), -0.00934 (30), -0.00873 (30), -0.00853 (30), -0.00719 (30), -0.00707 (30), -0.00691 (30), -0.00679 (30), 
length of domains: 102
Total time: 0.3508	 pickout: 0.0026	 decision: 0.0465	 get_bound: 0.2881	 add_domain: 0.0136
Accumulated time:	 pickout: 0.0479	 decision: 0.9073	 get_bound: 6.2669	 add_domain: 0.3312
Current (lb-rhs): -0.015546917915344238
3217 domains visited
Cumulative time: 7.589051723480225

batch:  torch.Size([102, 16, 15, 15]) pre split depth:  1
batch:  torch.Size([102, 16, 15, 15]) post split depth:  1
splitting decisions: 
split level 0: [1, 402] [1, 340] [1, 340] [1, 402] [1, 340] [1, 402] [1, 625] [1, 402] [1, 625] [1, 591] 
(204, 3, 32, 32) torch.Size([204, 1, 10]) torch.Size([204, 1])
pruning_in_iteration open status: True
ratio of positive domain = 161 / 204 = 0.7892156862745098
pruning-in-iteration extra time: 0.011810779571533203
Tensors transferred: pre=1.8879M lA=0.2036M alpha=0.1930M beta=0.0062M
This batch time : update_bounds func: 0.2745	 prepare: 0.0164	 bound: 0.2499	 transfer: 0.0026	 finalize: 0.0050
Accumulated time: update_bounds func: 6.5045	 prepare: 0.4888	 bound: 5.6149	 transfer: 0.1099	 finalize: 0.1517
batch bounding time:  0.2745208740234375
Current worst splitting domains lb-rhs (depth):
-0.01065 (31), -0.01052 (31), -0.01011 (31), -0.00962 (31), -0.00792 (31), -0.00748 (31), -0.00738 (31), -0.00673 (31), -0.00665 (31), -0.00664 (31), -0.00613 (31), -0.00583 (31), -0.00565 (31), -0.00532 (31), -0.00472 (31), -0.00458 (31), -0.00446 (31), -0.00355 (31), -0.00238 (31), -0.00236 (31), 
length of domains: 43
Total time: 0.3204	 pickout: 0.0020	 decision: 0.0361	 get_bound: 0.2746	 add_domain: 0.0078
Accumulated time:	 pickout: 0.0498	 decision: 0.9434	 get_bound: 6.5415	 add_domain: 0.3390
Current (lb-rhs): -0.010653853416442871
3378 domains visited
Cumulative time: 7.91070294380188

batch:  torch.Size([43, 16, 15, 15]) pre split depth:  2
batch:  torch.Size([43, 16, 15, 15]) post split depth:  2
splitting decisions: 
split level 0: [1, 625] [1, 625] [1, 625] [1, 753] [1, 625] [1, 625] [1, 625] [1, 625] [1, 591] [1, 591] 
split level 1: [1, 753] [1, 753] [1, 753] [1, 402] [1, 753] [1, 753] [1, 753] [1, 753] [1, 753] [1, 753] 
(172, 3, 32, 32) torch.Size([172, 1, 10]) torch.Size([172, 1])
pruning_in_iteration open status: True
ratio of positive domain = 165 / 172 = 0.9593023255813954
pruning-in-iteration extra time: 0.011865615844726562
Tensors transferred: pre=1.5918M lA=0.0324M alpha=0.1627M beta=0.0056M
This batch time : update_bounds func: 0.2725	 prepare: 0.0139	 bound: 0.2518	 transfer: 0.0023	 finalize: 0.0042
Accumulated time: update_bounds func: 6.7770	 prepare: 0.5028	 bound: 5.8667	 transfer: 0.1122	 finalize: 0.1559
batch bounding time:  0.27254176139831543
Current worst splitting domains lb-rhs (depth):
-0.00234 (33), -0.00220 (33), -0.00174 (33), -0.00125 (33), -0.00084 (33), -0.00084 (33), -0.00029 (33), 
length of domains: 7
Total time: 0.3226	 pickout: 0.0014	 decision: 0.0314	 get_bound: 0.2866	 add_domain: 0.0031
Accumulated time:	 pickout: 0.0512	 decision: 0.9749	 get_bound: 6.8281	 add_domain: 0.3422
Current (lb-rhs): -0.0023429393768310547
3543 domains visited
Cumulative time: 8.23413348197937

batch:  torch.Size([7, 16, 15, 15]) pre split depth:  4
batch:  torch.Size([7, 16, 15, 15]) post split depth:  4
splitting decisions: 
split level 0: [1, 340] [1, 483] [1, 483] [1, 483] [1, 483] [1, 775] [1, 775] 
split level 1: [1, 970] [2, 75] [2, 75] [2, 75] [2, 75] [1, 625] [1, 625] 
split level 2: [2, 75] [1, 402] [1, 402] [1, 402] [1, 402] [1, 591] [1, 591] 
split level 3: [2, 83] [2, 83] [2, 83] [2, 83] [2, 83] [2, 83] [2, 83] 
(112, 3, 32, 32) torch.Size([112, 1, 10]) torch.Size([112, 1])

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 112 / 112 = 1.0
pruning-in-iteration extra time: 0.00010848045349121094
Tensors transferred: pre=1.0365M lA=0.5182M alpha=0.1060M beta=0.0040M
This batch time : update_bounds func: 0.0219	 prepare: 0.0097	 bound: 0.0074	 transfer: 0.0019	 finalize: 0.0025
Accumulated time: update_bounds func: 6.7988	 prepare: 0.5124	 bound: 5.8740	 transfer: 0.1141	 finalize: 0.1584
batch bounding time:  0.021888256072998047
length of domains: 0
Total time: 0.0713	 pickout: 0.0012	 decision: 0.0306	 get_bound: 0.0382	 add_domain: 0.0013
Accumulated time:	 pickout: 0.0525	 decision: 1.0055	 get_bound: 6.8663	 add_domain: 0.3434
No domains left, verification finished!
3655 domains visited
Cumulative time: 8.305895328521729


Properties batch 3, size 1
Remaining timeout: 100.00361180305481
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0. -1.  0.  0.  1.  0.  0.  0.]]]
thresholds: [0] ######
Initial alpha-CROWN verified for spec index [0] with bound 0.18048095703125.

Properties batch 4, size 1
Remaining timeout: 99.91962051391602
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0.  0. -1.  0.  1.  0.  0.  0.]]]
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-0.42166305]], device='cuda:0') need to verify.
Model prediction is: tensor([ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
        -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151],
       device='cuda:0')
build_the_model_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /23 with alignment adjustment
setting alpha for layer /12 start_node /23 with alignment adjustment
setting alpha for layer /22 start_node /23 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 15, 15]), torch.Size([1, 1, 32, 6, 6]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.42166305]], device='cuda:0') tensor([[inf]], device='cuda:0')
Keeping slopes for these layers: ['/23']
Keeping slopes for these layers: ['/23']
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
-----------------
# of unstable neurons: 491
-----------------

batch:  torch.Size([1, 16, 15, 15]) pre split depth:  7
batch:  torch.Size([1, 16, 15, 15]) post split depth:  7
splitting decisions: 
split level 0: [2, 44] 
split level 1: [2, 52] 
split level 2: [2, 93] 
split level 3: [2, 40] 
split level 4: [2, 82] 
split level 5: [2, 13] 
split level 6: [2, 94] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 128 / 128 = 1.0
pruning-in-iteration extra time: 0.00010657310485839844
Tensors transferred: pre=1.1846M lA=0.5923M alpha=0.1211M beta=0.0009M
This batch time : update_bounds func: 0.0229	 prepare: 0.0095	 bound: 0.0082	 transfer: 0.0021	 finalize: 0.0029
Accumulated time: update_bounds func: 6.8217	 prepare: 0.5219	 bound: 5.8822	 transfer: 0.1162	 finalize: 0.1613
batch bounding time:  0.022894859313964844
length of domains: 0
Total time: 0.0885	 pickout: 0.0009	 decision: 0.0475	 get_bound: 0.0389	 add_domain: 0.0012
Accumulated time:	 pickout: 0.0009	 decision: 0.0475	 get_bound: 0.0389	 add_domain: 0.0012
No domains left, verification finished!
128 domains visited
Cumulative time: 0.09412312507629395


Properties batch 5, size 1
Remaining timeout: 99.70642256736755
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0.  0.  0. -1.  1.  0.  0.  0.]]]
thresholds: [0] ######
Initial alpha-CROWN verified for spec index [0] with bound 2.55125093460083.

Properties batch 6, size 1
Remaining timeout: 99.66108226776123
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0.  0.  0.  0.  1. -1.  0.  0.]]]
thresholds: [0] ######
Initial alpha-CROWN verified for spec index [0] with bound 1.0538666248321533.

Properties batch 7, size 1
Remaining timeout: 99.62148547172546
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0.  0.  0.  0.  1.  0. -1.  0.]]]
thresholds: [0] ######
Remaining spec index [0] with bounds tensor([[-0.35705924]], device='cuda:0') need to verify.
Model prediction is: tensor([ 0.82103616, -3.53809929,  2.38996983,  1.33221626,  1.94704866,
        -1.39923120,  3.72536421, -0.69937664,  0.96274459, -3.59047151],
       device='cuda:0')
build_the_model_with_refined_bounds batch [0/1]
setting alpha for layer /input.4 start_node /23 with alignment adjustment
setting alpha for layer /12 start_node /23 with alignment adjustment<frozen importlib._bootstrap>:219: RuntimeWarning: numpy.ufunc size changed, may indicate binary incompatibility. Expected 216 from C header, got 232 from PyObject
/home/zhouxingshi/miniconda3/envs/zshi/lib/python3.8/site-packages/onnx/mapping.py:27: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  int(TensorProto.STRING): np.dtype(np.object)
/home/zhouxingshi/gputest/CROWN-GENERAL_release/complete_verifier/utils.py:573: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  eps_temp = torch.tensor(eps_temp / std).reshape(1, -1, 1, 1)
/home/zhouxingshi/gputest/CROWN-GENERAL_release/complete_verifier/batch_branch_and_bound.py:319: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(arguments.Config["bab"]["decision_thresh"] + 1e-7), np.inf

setting alpha for layer /22 start_node /23 with alignment adjustment
all slope initialized
directly get lb and ub from refined bounds
lA shapes: [torch.Size([1, 1, 16, 15, 15]), torch.Size([1, 1, 32, 6, 6]), torch.Size([1, 1, 100])]
c shape: torch.Size([1, 1, 10])
alpha-CROWN with fixed intermediate bounds: tensor([[-0.35705924]], device='cuda:0') tensor([[inf]], device='cuda:0')
Keeping slopes for these layers: ['/23']
Keeping slopes for these layers: ['/23']
layer 0 size torch.Size([3600]) unstable 333
layer 1 size torch.Size([1152]) unstable 123
layer 2 size torch.Size([100]) unstable 35
-----------------
# of unstable neurons: 491
-----------------

batch:  torch.Size([1, 16, 15, 15]) pre split depth:  7
batch:  torch.Size([1, 16, 15, 15]) post split depth:  7
splitting decisions: 
split level 0: [2, 52] 
split level 1: [2, 44] 
split level 2: [2, 40] 
split level 3: [2, 18] 
split level 4: [2, 56] 
split level 5: [2, 3] 
split level 6: [2, 99] 
(128, 3, 32, 32) torch.Size([128, 1, 10]) torch.Size([128, 1])

all verified at 0th iter
pruning_in_iteration open status: False
ratio of positive domain = 128 / 128 = 1.0
pruning-in-iteration extra time: 0.0001163482666015625
Tensors transferred: pre=1.1846M lA=0.5923M alpha=0.1211M beta=0.0009M
This batch time : update_bounds func: 0.0231	 prepare: 0.0095	 bound: 0.0085	 transfer: 0.0021	 finalize: 0.0028
Accumulated time: update_bounds func: 6.8448	 prepare: 0.5314	 bound: 5.8907	 transfer: 0.1183	 finalize: 0.1641
batch bounding time:  0.02312779426574707
length of domains: 0
Total time: 0.0863	 pickout: 0.0009	 decision: 0.0451	 get_bound: 0.0392	 add_domain: 0.0012
Accumulated time:	 pickout: 0.0009	 decision: 0.0451	 get_bound: 0.0392	 add_domain: 0.0012
No domains left, verification finished!
128 domains visited
Cumulative time: 0.09211015701293945


Properties batch 8, size 1
Remaining timeout: 99.41478204727173
##### Instance 0 first 10 spec matrices: [[[ 0.  0.  0.  0.  0.  0.  1.  0.  0. -1.]]]
thresholds: [0] ######
Initial alpha-CROWN verified for spec index [0] with bound 4.051467418670654.
Result: safe in 20.6325 seconds
############# Summary #############
Final verified acc: 100.0% (total 1 examples)
Problem instances count: 1 , total verified (safe/unsat): 1 , total falsified (unsafe/sat): 0 , timeout: 0
mean time (total 1): 20.63231077627273, max time: 20.632517099380493
safe (total 1): [0]

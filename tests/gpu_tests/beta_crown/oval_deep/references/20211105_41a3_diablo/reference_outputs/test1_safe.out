Experiments at Wed Apr 13 17:52:22 2022 on diablo.cs.ucla.edu
Sequential(
  (0): Conv2d(3, 8, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (3): ReLU()
  (4): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (5): ReLU()
  (6): Conv2d(8, 8, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (7): ReLU()
  (8): Flatten()
  (9): Linear(in_features=512, out_features=100, bias=True)
  (10): ReLU()
  (11): Linear(in_features=100, out_features=10, bias=True)
)
No epsilon defined!
Files already downloaded and verified
Overwrite epsilon that saved in .pkl file, they should be after normalized!
Task length: 1
saving results to Verified_ret_[cifar_model_deep]_start=3_end=4_iter=20_b=1024_int-beta=False_timeout=36_branching=fsb-min-1_lra-init=0.1_lra=0.01_lrb=0.05_PGD=skip.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  1  correct label  1 logits tensor([ 0.5793,  2.1212, -1.1504, -0.5506, -1.1408, -0.5623, -1.2757, -0.0688,
         1.6838,  0.3643], device='cuda:0', grad_fn=<SelectBackward>)
##### [0:3] Tested against 7 ######
Model prediction is: tensor([[ 0.5793,  2.1212, -1.1504, -0.5506, -1.1408, -0.5623, -1.2757, -0.0688,
          1.6838,  0.3643]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-1.1405]], device='cuda:0') None
best_l after optimization: 0.719064474105835 with beta sum per layer: []
optimal alpha/beta time: 11.11493730545044
initial alpha-CROWN bounds: tensor([[-0.7191]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.719064474105835
layer 0 size torch.Size([2048]) unstable 205
layer 1 size torch.Size([2048]) unstable 271
layer 2 size torch.Size([2048]) unstable 246
layer 3 size torch.Size([512]) unstable 90
layer 4 size torch.Size([100]) unstable 43
# of unstable neurons: 855
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 93]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.7526540756225586 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.7342150807380676]
optimal alpha/beta time: 0.8167352676391602
This batch time : update_bounds func: 0.8204	 prepare: 0.0021	 bound: 0.8171	 transfer: 0.0007	 finalize: 0.0004
Accumulated time: update_bounds func: 0.8204	 prepare: 0.0021	 bound: 0.8171	 transfer: 0.0007	 finalize: 0.0004
batch bounding time:  0.8205549716949463
Current worst splitting domains [lb, ub] (depth):
[-0.63811, 98.280937] (1), [-0.11454, 98.280937] (1), 
length of domains: 2
Total time: 0.8592	 pickout: 0.0012	 decision: 0.0372	 get_bound: 0.8206	 add_domain: 0.0001
Current lb:-0.6381139755249023
2 neurons visited
0 diving domains visited
Cumulative time: 13.158751010894775

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 98], [4, 98]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.8311643600463867 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 2.0419909954071045]
optimal alpha/beta time: 0.37357091903686523
This batch time : update_bounds func: 0.3777	 prepare: 0.0024	 bound: 0.3739	 transfer: 0.0008	 finalize: 0.0005
Accumulated time: update_bounds func: 1.1981	 prepare: 0.0045	 bound: 1.1910	 transfer: 0.0008	 finalize: 0.0009
batch bounding time:  0.37789106369018555
Current worst splitting domains [lb, ub] (depth):
[-0.51162, 98.280937] (2), [-0.43140, 98.280937] (2), 
length of domains: 2
Total time: 0.4171	 pickout: 0.0012	 decision: 0.0378	 get_bound: 0.3779	 add_domain: 0.0001
Current lb:-0.5116164684295654
6 neurons visited
0 diving domains visited
Cumulative time: 13.576018571853638

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 12], [4, 12]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.5860247611999512 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 1.673421859741211]
optimal alpha/beta time: 0.3731043338775635
This batch time : update_bounds func: 0.3772	 prepare: 0.0024	 bound: 0.3734	 transfer: 0.0008	 finalize: 0.0005
Accumulated time: update_bounds func: 1.5752	 prepare: 0.0069	 bound: 1.5644	 transfer: 0.0008	 finalize: 0.0014
batch bounding time:  0.37734246253967285
Current worst splitting domains [lb, ub] (depth):
[-0.46313, 98.280937] (3), [-0.38850, 98.280937] (3), 
length of domains: 2
Total time: 0.4163	 pickout: 0.0012	 decision: 0.0376	 get_bound: 0.3774	 add_domain: 0.0001
Current lb:-0.4631340503692627
10 neurons visited
0 diving domains visited
Cumulative time: 13.992489576339722

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 40], [4, 40]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.0057282447814941 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 1.75711989402771]
optimal alpha/beta time: 0.3728640079498291
This batch time : update_bounds func: 0.3769	 prepare: 0.0024	 bound: 0.3732	 transfer: 0.0008	 finalize: 0.0005
Accumulated time: update_bounds func: 1.9522	 prepare: 0.0093	 bound: 1.9375	 transfer: 0.0008	 finalize: 0.0020
batch bounding time:  0.3771209716796875
Current worst splitting domains [lb, ub] (depth):
[-0.35896, 98.280937] (4), [-0.28420, 98.280937] (4), [-0.21656, 98.280937] (4), [-0.14600, 98.280937] (4), 
length of domains: 4
Total time: 0.4160	 pickout: 0.0012	 decision: 0.0374	 get_bound: 0.3771	 add_domain: 0.0002
Current lb:-0.3589627742767334
14 neurons visited
0 diving domains visited
Cumulative time: 14.408628702163696

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 41], [4, 41], [4, 41], [4, 41]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 0.799575686454773 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 4.691596031188965]
optimal alpha/beta time: 0.3788766860961914
This batch time : update_bounds func: 0.3840	 prepare: 0.0029	 bound: 0.3792	 transfer: 0.0009	 finalize: 0.0010
Accumulated time: update_bounds func: 2.3362	 prepare: 0.0122	 bound: 2.3167	 transfer: 0.0009	 finalize: 0.0029
batch bounding time:  0.3842155933380127
Current worst splitting domains [lb, ub] (depth):
[-0.26298, 98.280937] (5), [-0.18945, 98.280937] (5), [-0.16780, 98.280937] (5), [-0.11349, 98.280937] (5), [-0.04580, 98.280937] (5), [-0.04257, 98.280937] (5), [-0.02410, 98.280937] (5), 
length of domains: 7
Total time: 0.4252	 pickout: 0.0016	 decision: 0.0391	 get_bound: 0.3842	 add_domain: 0.0003
Current lb:-0.26297760009765625
22 neurons visited
0 diving domains visited
Cumulative time: 14.83401346206665

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 8], [4, 8], [4, 8], [4, 8], [4, 8], [4, 8], [4, 8]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: -0.018042802810668945 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 9.10364055633545]
optimal alpha/beta time: 0.38073158264160156
This batch time : update_bounds func: 0.3877	 prepare: 0.0037	 bound: 0.3810	 transfer: 0.0013	 finalize: 0.0016
Accumulated time: update_bounds func: 2.7239	 prepare: 0.0159	 bound: 2.6977	 transfer: 0.0013	 finalize: 0.0046
batch bounding time:  0.38791322708129883
Current worst splitting domains [lb, ub] (depth):
[-0.19118, 98.280937] (6), [-0.11641, 98.280937] (6), [-0.08981, 98.280937] (6), [-0.04121, 98.280937] (6), [-0.02848, 98.280937] (6), [-0.00822, 98.280937] (6), 
length of domains: 6
Total time: 0.4319	 pickout: 0.0022	 decision: 0.0415	 get_bound: 0.3879	 add_domain: 0.0003
Current lb:-0.1911754608154297
36 neurons visited
0 diving domains visited
Cumulative time: 15.266229391098022

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 22], [4, 22], [4, 22], [4, 22], [4, 22], [4, 22]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -0.18852651119232178 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 5.2468671798706055]
optimal alpha/beta time: 0.3826107978820801
This batch time : update_bounds func: 0.3888	 prepare: 0.0034	 bound: 0.3829	 transfer: 0.0010	 finalize: 0.0014
Accumulated time: update_bounds func: 3.1128	 prepare: 0.0193	 bound: 3.0806	 transfer: 0.0010	 finalize: 0.0060
batch bounding time:  0.38913846015930176
Current worst splitting domains [lb, ub] (depth):
[-0.11310, 98.280937] (7), [-0.07780, 98.280937] (7), [-0.04159, 98.280937] (7), [-0.01027, 98.280937] (7), [-0.00518, 98.280937] (7), 
length of domains: 5
Total time: 0.4324	 pickout: 0.0020	 decision: 0.0407	 get_bound: 0.3892	 add_domain: 0.0004
Current lb:-0.11309504508972168
48 neurons visited
0 diving domains visited
Cumulative time: 15.698949337005615

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 77], [4, 77], [4, 77], [4, 77], [4, 77]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -0.2520718574523926 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 2.403435230255127]
optimal alpha/beta time: 0.3810248374938965
This batch time : update_bounds func: 0.3867	 prepare: 0.0032	 bound: 0.3813	 transfer: 0.0009	 finalize: 0.0012
Accumulated time: update_bounds func: 3.4994	 prepare: 0.0224	 bound: 3.4620	 transfer: 0.0009	 finalize: 0.0073
batch bounding time:  0.3868710994720459
Current worst splitting domains [lb, ub] (depth):
[-0.05383, 98.280937] (8), [-0.01608, 98.280937] (8), [-0.01072, 98.280937] (8), 
length of domains: 3
Total time: 0.4293	 pickout: 0.0020	 decision: 0.0402	 get_bound: 0.3869	 add_domain: 0.0002
Current lb:-0.05382895469665527
58 neurons visited
0 diving domains visited
Cumulative time: 16.128448963165283

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 20], [4, 20], [4, 20]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.28432750701904297 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.5346267223358154]
optimal alpha/beta time: 0.3720893859863281
This batch time : update_bounds func: 0.3767	 prepare: 0.0027	 bound: 0.3724	 transfer: 0.0008	 finalize: 0.0008
Accumulated time: update_bounds func: 3.8761	 prepare: 0.0251	 bound: 3.8344	 transfer: 0.0008	 finalize: 0.0080
batch bounding time:  0.3768587112426758
Current worst splitting domains [lb, ub] (depth):
[-0.00559, 98.280937] (9), 
length of domains: 1
Total time: 0.4167	 pickout: 0.0014	 decision: 0.0383	 get_bound: 0.3769	 add_domain: 0.0001
Current lb:-0.005591630935668945
64 neurons visited
0 diving domains visited
Cumulative time: 16.54534649848938

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 51]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.07801532745361328 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.0]
optimal alpha/beta time: 0.012974023818969727
This batch time : update_bounds func: 0.0164	 prepare: 0.0022	 bound: 0.0132	 transfer: 0.0007	 finalize: 0.0003
Accumulated time: update_bounds func: 3.8926	 prepare: 0.0273	 bound: 3.8476	 transfer: 0.0007	 finalize: 0.0084
batch bounding time:  0.016483783721923828
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0539	 pickout: 0.0010	 decision: 0.0364	 get_bound: 0.0165	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 16.599387645721436

Image 3 pidx 7 verify end, final lower bound 999, upper bound 98.28093719482422, time: 16.695302486419678
3 999
[[  3.         999.          66.          16.69530249   0.
    7.          98.28093719          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 16.695302486419678

Experiments at Wed Nov  3 15:39:34 2021 on CCI-2CPKMH3
Sequential(
  (0): Conv2d(3, 8, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (3): ReLU()
  (4): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (5): ReLU()
  (6): Conv2d(8, 8, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (7): ReLU()
  (8): Flatten()
  (9): Linear(in_features=512, out_features=100, bias=True)
  (10): ReLU()
  (11): Linear(in_features=100, out_features=10, bias=True)
)
No epsilon defined!
Files already downloaded and verified
Overwrite epsilon that saved in .pkl file, they should be after normalized!
Task length: 1
saving results to Verified_ret_[cifar_model_deep]_start=3_end=4_iter=20_b=1024_int-beta=False_timeout=12_branching=fsb-min-1_lra-init=0.1_lra=0.01_lrb=0.05_PGD=skip.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 3 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  1  correct label  1 logits tensor([ 0.5793,  2.1212, -1.1504, -0.5506, -1.1408, -0.5623, -1.2757, -0.0688,
         1.6838,  0.3643], device='cuda:0', grad_fn=<SelectBackward>)
##### [0:3] Tested against 7 ######
Model prediction is: tensor([[ 0.5793,  2.1212, -1.1504, -0.5506, -1.1408, -0.5623, -1.2757, -0.0688,
          1.6838,  0.3643]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-1.1405]], device='cuda:0') None
best_l after optimization: 0.7190649509429932 with beta sum per layer: []
optimal alpha/beta time: 5.3246307373046875
initial alpha-CROWN bounds: tensor([[-0.7191]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.7190649509429932
layer 0 size torch.Size([2048]) unstable 205
layer 1 size torch.Size([2048]) unstable 271
layer 2 size torch.Size([2048]) unstable 246
layer 3 size torch.Size([512]) unstable 90
layer 4 size torch.Size([100]) unstable 43
# of unstable neurons: 855
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 93]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.7526600360870361 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.7342150211334229]
optimal alpha/beta time: 0.3887290954589844
This batch time : update_bounds func: 0.3902	 prepare: 0.0008	 bound: 0.3889	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 0.3902	 prepare: 0.0008	 bound: 0.3889	 transfer: 0.0003	 finalize: 0.0002
batch bounding time:  0.3903031349182129
Current worst splitting domains [lb, ub] (depth):
[-0.63812, 98.280937] (1), [-0.11454, 98.280937] (1), 
length of domains: 2
Total time: 0.4075	 pickout: 0.0005	 decision: 0.0167	 get_bound: 0.3903	 add_domain: 0.0001
Current lb:-0.6381161212921143
2 neurons visited
0 diving domains visited
Cumulative time: 6.25556755065918

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 98], [4, 98]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.8311707973480225 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 2.0419912338256836]
optimal alpha/beta time: 0.17934894561767578
This batch time : update_bounds func: 0.1811	 prepare: 0.0009	 bound: 0.1795	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.5713	 prepare: 0.0018	 bound: 0.5684	 transfer: 0.0004	 finalize: 0.0004
batch bounding time:  0.1811063289642334
Current worst splitting domains [lb, ub] (depth):
[-0.51162, 98.280937] (2), [-0.43140, 98.280937] (2), 
length of domains: 2
Total time: 0.1986	 pickout: 0.0005	 decision: 0.0169	 get_bound: 0.1811	 add_domain: 0.0001
Current lb:-0.5116159915924072
6 neurons visited
0 diving domains visited
Cumulative time: 6.454231023788452

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 12], [4, 12]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.5860285758972168 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 1.6734308004379272]
optimal alpha/beta time: 0.18045663833618164
This batch time : update_bounds func: 0.1821	 prepare: 0.0009	 bound: 0.1806	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.7534	 prepare: 0.0027	 bound: 0.7489	 transfer: 0.0004	 finalize: 0.0006
batch bounding time:  0.18217039108276367
Current worst splitting domains [lb, ub] (depth):
[-0.46313, 98.280937] (3), [-0.38850, 98.280937] (3), 
length of domains: 2
Total time: 0.1993	 pickout: 0.0005	 decision: 0.0165	 get_bound: 0.1822	 add_domain: 0.0001
Current lb:-0.4631335735321045
10 neurons visited
0 diving domains visited
Cumulative time: 6.653578758239746

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 40], [4, 40]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.0057404041290283 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 1.7571420669555664]
optimal alpha/beta time: 0.1802523136138916
This batch time : update_bounds func: 0.1819	 prepare: 0.0009	 bound: 0.1804	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.9353	 prepare: 0.0036	 bound: 0.9293	 transfer: 0.0004	 finalize: 0.0008
batch bounding time:  0.18194937705993652
Current worst splitting domains [lb, ub] (depth):
[-0.35896, 98.280937] (4), [-0.28420, 98.280937] (4), [-0.21657, 98.280937] (4), [-0.14601, 98.280937] (4), 
length of domains: 4
Total time: 0.2021	 pickout: 0.0005	 decision: 0.0196	 get_bound: 0.1820	 add_domain: 0.0001
Current lb:-0.3589634895324707
14 neurons visited
0 diving domains visited
Cumulative time: 6.855757713317871

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 41], [4, 41], [4, 41], [4, 41]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 0.7996417284011841 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 4.693371772766113]
optimal alpha/beta time: 0.18292832374572754
This batch time : update_bounds func: 0.1849	 prepare: 0.0011	 bound: 0.1831	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.1203	 prepare: 0.0047	 bound: 1.1124	 transfer: 0.0004	 finalize: 0.0012
batch bounding time:  0.1849989891052246
Current worst splitting domains [lb, ub] (depth):
[-0.26298, 98.280937] (5), [-0.18945, 98.280937] (5), [-0.16780, 98.280937] (5), [-0.11349, 98.280937] (5), [-0.04580, 98.280937] (5), [-0.04262, 98.280937] (5), [-0.02410, 98.280937] (5), 
length of domains: 7
Total time: 0.2033	 pickout: 0.0007	 decision: 0.0174	 get_bound: 0.1850	 add_domain: 0.0001
Current lb:-0.26297760009765625
22 neurons visited
0 diving domains visited
Cumulative time: 7.059091091156006

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 8], [4, 8], [4, 8], [4, 8], [4, 8], [4, 8], [4, 8]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: -0.017967700958251953 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 9.106861114501953]
optimal alpha/beta time: 0.18843460083007812
This batch time : update_bounds func: 0.1912	 prepare: 0.0014	 bound: 0.1886	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 1.3114	 prepare: 0.0061	 bound: 1.3009	 transfer: 0.0006	 finalize: 0.0018
batch bounding time:  0.1912074089050293
Current worst splitting domains [lb, ub] (depth):
[-0.19118, 98.280937] (6), [-0.11641, 98.280937] (6), [-0.08981, 98.280937] (6), [-0.04121, 98.280937] (6), [-0.02849, 98.280937] (6), [-0.00822, 98.280937] (6), 
length of domains: 6
Total time: 0.2108	 pickout: 0.0009	 decision: 0.0185	 get_bound: 0.1912	 add_domain: 0.0001
Current lb:-0.1911778450012207
36 neurons visited
0 diving domains visited
Cumulative time: 7.269989013671875

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 22], [4, 22], [4, 22], [4, 22], [4, 22], [4, 22]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -0.18848443031311035 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 5.248377799987793]
optimal alpha/beta time: 0.1830301284790039
This batch time : update_bounds func: 0.1855	 prepare: 0.0013	 bound: 0.1832	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 1.4970	 prepare: 0.0074	 bound: 1.4841	 transfer: 0.0005	 finalize: 0.0023
batch bounding time:  0.18569660186767578
Current worst splitting domains [lb, ub] (depth):
[-0.11311, 98.280937] (7), [-0.07782, 98.280937] (7), [-0.04159, 98.280937] (7), [-0.01027, 98.280937] (7), [-0.00523, 98.280937] (7), 
length of domains: 5
Total time: 0.2049	 pickout: 0.0008	 decision: 0.0183	 get_bound: 0.1857	 add_domain: 0.0001
Current lb:-0.11311125755310059
48 neurons visited
0 diving domains visited
Cumulative time: 7.4749915599823

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 77], [4, 77], [4, 77], [4, 77], [4, 77]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -0.2520270347595215 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 2.410029888153076]
optimal alpha/beta time: 0.18174195289611816
This batch time : update_bounds func: 0.1841	 prepare: 0.0012	 bound: 0.1819	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 1.6810	 prepare: 0.0086	 bound: 1.6660	 transfer: 0.0005	 finalize: 0.0028
batch bounding time:  0.18414855003356934
Current worst splitting domains [lb, ub] (depth):
[-0.05387, 98.280937] (8), [-0.01609, 98.280937] (8), [-0.01074, 98.280937] (8), 
length of domains: 3
Total time: 0.2059	 pickout: 0.0008	 decision: 0.0209	 get_bound: 0.1842	 add_domain: 0.0001
Current lb:-0.05387425422668457
58 neurons visited
0 diving domains visited
Cumulative time: 7.680979251861572

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 20], [4, 20], [4, 20]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.2842949628829956 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.5342373847961426]
optimal alpha/beta time: 0.17881250381469727
This batch time : update_bounds func: 0.1807	 prepare: 0.0010	 bound: 0.1790	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.8618	 prepare: 0.0096	 bound: 1.8449	 transfer: 0.0004	 finalize: 0.0031
batch bounding time:  0.1807565689086914
Current worst splitting domains [lb, ub] (depth):
[-0.00559, 98.280937] (9), 
length of domains: 1
Total time: 0.1985	 pickout: 0.0006	 decision: 0.0170	 get_bound: 0.1808	 add_domain: 0.0000
Current lb:-0.0055887699127197266
64 neurons visited
0 diving domains visited
Cumulative time: 7.879515171051025

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[4, 51]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.0780189037322998 with beta sum per layer: [0.0, 0.0, 0.0, 0.0, 0.0]
optimal alpha/beta time: 0.005981922149658203
This batch time : update_bounds func: 0.0074	 prepare: 0.0008	 bound: 0.0061	 transfer: 0.0003	 finalize: 0.0001
Accumulated time: update_bounds func: 1.8692	 prepare: 0.0105	 bound: 1.8510	 transfer: 0.0003	 finalize: 0.0032
batch bounding time:  0.007417440414428711
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0240	 pickout: 0.0004	 decision: 0.0162	 get_bound: 0.0074	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 7.903584003448486

Image 3 pidx 7 verify end, final lower bound 999, upper bound 98.28093719482422, time: 7.942425489425659
3 999
[[  3.         999.          66.           7.94242549   0.
    7.          98.28093719          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 7.942425489425659

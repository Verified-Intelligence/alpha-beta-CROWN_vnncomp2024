Experiments at Wed Apr 13 17:37:46 2022 on diablo.cs.ucla.edu
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=800, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Sampled data loaded. Data already preprocessed!
Shape: torch.Size([1000, 1, 28, 28]) torch.Size([1000]) torch.Size([1000])
X range: tensor(2.8215) tensor(-0.4242) tensor(-0.0274)
Note runnerup label is empty here!
############################
epsilon after preprocession: tensor([[[[0.3895]]]]), data_max = tensor([[[[2.8215]]]]), data_min = tensor([[[[-0.4242]]]])
Task length: 1
saving results to Verified_ret_[mnist_conv_small]_start=113_end=114_iter=20_b=2048_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 113 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  9  correct label  9 logits tensor([-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
         1.4478, 13.2568], device='cuda:0', grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 9, Tested against: ['all'] ######
pgd prediction: tensor([-3.1159, -4.0030, -0.6726,  2.6987, -0.2683, -2.8590, -8.9765,  6.7044,
         1.6377,  8.7923], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([11.9082, 12.7953,  9.4649,  6.0936,  9.0606, 11.6512, 17.7687,  2.0879,
         7.1546,     inf], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[ 3.5425,  0.6511, -2.1750, -2.4561, -3.0957,  2.7296,  5.7511, -6.5224,
         -2.1588]], device='cuda:0') None
best_l after optimization: -4.015042304992676 with beta sum per layer: []
optimal alpha/beta time: 5.7478063106536865
initial alpha-CROWN bounds: tensor([[ 4.1918,  1.6687, -1.2693, -1.7332, -2.2137,  3.5305,  6.5222, -5.3492,
         -1.3328]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:113] Tested against 7 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 5.348904609680176 with beta sum per layer: []
optimal alpha/beta time: 1.4537644386291504
alpha-CROWN with fixed intermediate bounds: tensor([[-5.3489]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-5.348904609680176
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 1]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 7.7329630851745605 with beta sum per layer: [0.0, 0.0, 0.6193286776542664]
optimal alpha/beta time: 0.6790924072265625
This batch time : update_bounds func: 0.6819	 prepare: 0.0016	 bound: 0.6793	 transfer: 0.0006	 finalize: 0.0003
Accumulated time: update_bounds func: 0.6819	 prepare: 0.0016	 bound: 0.6793	 transfer: 0.0006	 finalize: 0.0003
batch bounding time:  0.6820425987243652
Current worst splitting domains [lb, ub] (depth):
[-4.96543, 93.651093] (1), [-2.76753, 93.651093] (1), 
length of domains: 2
Total time: 0.7039	 pickout: 0.0009	 decision: 0.0207	 get_bound: 0.6821	 add_domain: 0.0002
Current lb:-4.965432643890381
2 neurons visited
0 diving domains visited
Cumulative time: 2.5886871814727783

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 86], [2, 86]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 10.227804183959961 with beta sum per layer: [0.0, 0.0, 2.3092470169067383]
optimal alpha/beta time: 0.25295543670654297
This batch time : update_bounds func: 0.2560	 prepare: 0.0018	 bound: 0.2532	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 0.9379	 prepare: 0.0034	 bound: 0.9325	 transfer: 0.0006	 finalize: 0.0007
batch bounding time:  0.25616002082824707
Current worst splitting domains [lb, ub] (depth):
[-4.10657, 93.651093] (2), [-3.87611, 93.651093] (2), [-2.18753, 93.651093] (2), [-0.05759, 93.651093] (2), 
length of domains: 4
Total time: 0.2780	 pickout: 0.0010	 decision: 0.0206	 get_bound: 0.2562	 add_domain: 0.0002
Current lb:-4.106566429138184
6 neurons visited
0 diving domains visited
Cumulative time: 2.866760492324829

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 63], [2, 63], [2, 63], [2, 63]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 12.912393569946289 with beta sum per layer: [0.0, 0.0, 5.677765846252441]
optimal alpha/beta time: 0.25834059715270996
This batch time : update_bounds func: 0.2622	 prepare: 0.0021	 bound: 0.2586	 transfer: 0.0007	 finalize: 0.0008
Accumulated time: update_bounds func: 1.2002	 prepare: 0.0056	 bound: 1.1911	 transfer: 0.0007	 finalize: 0.0015
batch bounding time:  0.26236629486083984
Current worst splitting domains [lb, ub] (depth):
[-3.62254, 93.651093] (3), [-3.33277, 93.651093] (3), [-2.86947, 93.651093] (3), [-2.83548, 93.651093] (3), [-1.78607, 93.651093] (3), 
length of domains: 5
Total time: 0.2842	 pickout: 0.0011	 decision: 0.0204	 get_bound: 0.2624	 add_domain: 0.0002
Current lb:-3.622541904449463
14 neurons visited
0 diving domains visited
Cumulative time: 3.1510822772979736

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89], [2, 7], [2, 89], [2, 36], [2, 89]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 19.412948608398438 with beta sum per layer: [0.0, 0.0, 3.295711040496826]
optimal alpha/beta time: 0.25450754165649414
This batch time : update_bounds func: 0.2586	 prepare: 0.0023	 bound: 0.2548	 transfer: 0.0007	 finalize: 0.0007
Accumulated time: update_bounds func: 1.4587	 prepare: 0.0079	 bound: 1.4459	 transfer: 0.0007	 finalize: 0.0022
batch bounding time:  0.258709192276001
Current worst splitting domains [lb, ub] (depth):
[-3.05536, 93.651093] (4), [-2.71787, 93.651093] (4), [-2.63116, 93.651093] (4), [-2.54795, 93.651093] (4), [-2.27155, 93.651093] (4), [-2.02703, 93.651093] (4), [-1.90685, 93.651093] (4), [-1.27945, 93.651093] (4), [-0.51728, 93.651093] (4), [-0.45845, 93.651093] (4), 
length of domains: 10
Total time: 0.2810	 pickout: 0.0013	 decision: 0.0206	 get_bound: 0.2587	 add_domain: 0.0004
Current lb:-3.05535888671875
24 neurons visited
0 diving domains visited
Cumulative time: 3.4322447776794434

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7], [2, 89], [2, 7], [2, 7], [2, 89], [2, 7], [2, 36], [2, 7], [2, 7], [2, 7]]
single_node_split: True
regular batch size: 2*10, diving batch size 1*0
best_l after optimization: 22.387706756591797 with beta sum per layer: [0.0, 0.0, 8.097757339477539]
optimal alpha/beta time: 0.25461244583129883
This batch time : update_bounds func: 0.2604	 prepare: 0.0031	 bound: 0.2548	 transfer: 0.0010	 finalize: 0.0014
Accumulated time: update_bounds func: 1.7192	 prepare: 0.0110	 bound: 1.7007	 transfer: 0.0010	 finalize: 0.0036
batch bounding time:  0.26058363914489746
Current worst splitting domains [lb, ub] (depth):
[-2.47497, 93.651093] (5), [-2.08071, 93.651093] (5), [-2.00460, 93.651093] (5), [-1.91148, 93.651093] (5), [-1.90005, 93.651093] (5), [-1.76009, 93.651093] (5), [-1.72559, 93.651093] (5), [-1.68017, 93.651093] (5), [-1.57456, 93.651093] (5), [-1.43652, 93.651093] (5), [-1.33321, 93.651093] (5), [-1.32473, 93.651093] (5), [-1.18338, 93.651093] (5), [-0.56814, 93.651093] (5), [-0.42883, 93.651093] (5), 
length of domains: 15
Total time: 0.2852	 pickout: 0.0019	 decision: 0.0220	 get_bound: 0.2607	 add_domain: 0.0006
Current lb:-2.474968433380127
44 neurons visited
0 diving domains visited
Cumulative time: 3.7176308631896973

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 36], [2, 36], [2, 36], [2, 36], [2, 89], [2, 89], [2, 36], [2, 7], [2, 36], [2, 36]]
single_node_split: True
regular batch size: 2*15, diving batch size 1*0
best_l after optimization: 17.108898162841797 with beta sum per layer: [0.0, 0.0, 14.863811492919922]
optimal alpha/beta time: 0.2587697505950928
This batch time : update_bounds func: 0.2662	 prepare: 0.0040	 bound: 0.2590	 transfer: 0.0012	 finalize: 0.0019
Accumulated time: update_bounds func: 1.9854	 prepare: 0.0150	 bound: 1.9597	 transfer: 0.0012	 finalize: 0.0055
batch bounding time:  0.26638221740722656
Current worst splitting domains [lb, ub] (depth):
[-2.28195, 93.651093] (6), [-1.89181, 93.651093] (6), [-1.74068, 93.651093] (6), [-1.72993, 93.651093] (6), [-1.56263, 93.651093] (6), [-1.33595, 93.651093] (6), [-1.24410, 93.651093] (6), [-1.12871, 93.651093] (6), [-1.08554, 93.651093] (6), [-1.05795, 93.651093] (6), [-0.98239, 93.651093] (6), [-0.96026, 93.651093] (6), [-0.93327, 93.651093] (6), [-0.91020, 93.651093] (6), [-0.81176, 93.651093] (6), [-0.77000, 93.651093] (6), [-0.19654, 93.651093] (6), [-0.18331, 93.651093] (6), [-0.02645, 93.651093] (6), [-0.00115, 93.651093] (6), 
length of domains: 20
Total time: 0.2926	 pickout: 0.0026	 decision: 0.0228	 get_bound: 0.2664	 add_domain: 0.0008
Current lb:-2.2819485664367676
74 neurons visited
0 diving domains visited
Cumulative time: 4.010541915893555

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: 15.251218795776367 with beta sum per layer: [0.0, 0.0, 20.954004287719727]
optimal alpha/beta time: 0.25658607482910156
This batch time : update_bounds func: 0.2655	 prepare: 0.0048	 bound: 0.2568	 transfer: 0.0013	 finalize: 0.0025
Accumulated time: update_bounds func: 2.2509	 prepare: 0.0198	 bound: 2.2166	 transfer: 0.0013	 finalize: 0.0080
batch bounding time:  0.2656433582305908
Current worst splitting domains [lb, ub] (depth):
[-2.06373, 93.651093] (7), [-1.59861, 93.651093] (7), [-1.44554, 93.651093] (7), [-1.42118, 93.651093] (7), [-1.25965, 93.651093] (7), [-1.01970, 93.651093] (7), [-0.90333, 93.651093] (7), [-0.82089, 93.651093] (7), [-0.80755, 93.651093] (7), [-0.79153, 93.651093] (7), [-0.72171, 93.651093] (7), [-0.69183, 93.651093] (7), [-0.67053, 93.651093] (7), [-0.62168, 93.651093] (7), [-0.57370, 93.651093] (7), [-0.56928, 93.651093] (7), [-0.51606, 93.651093] (7), [-0.51150, 93.651093] (7), [-0.49214, 93.651093] (7), [-0.42001, 93.651093] (7), 
length of domains: 25
Total time: 0.2939	 pickout: 0.0032	 decision: 0.0238	 get_bound: 0.2657	 add_domain: 0.0012
Current lb:-2.063727378845215
114 neurons visited
0 diving domains visited
Cumulative time: 4.304783344268799

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 96], [1, 586], [1, 233], [2, 17], [1, 233], [1, 233], [2, 96], [2, 96], [1, 233]]
single_node_split: True
regular batch size: 2*25, diving batch size 1*0
best_l after optimization: 15.100005149841309 with beta sum per layer: [0.0, 0.2592463493347168, 23.69988250732422]
optimal alpha/beta time: 0.26187705993652344
This batch time : update_bounds func: 0.2729	 prepare: 0.0059	 bound: 0.2621	 transfer: 0.0015	 finalize: 0.0033
Accumulated time: update_bounds func: 2.5239	 prepare: 0.0257	 bound: 2.4787	 transfer: 0.0015	 finalize: 0.0114
batch bounding time:  0.2731006145477295
Current worst splitting domains [lb, ub] (depth):
[-1.78946, 93.651093] (8), [-1.30266, 93.651093] (8), [-1.30020, 93.651093] (8), [-1.21335, 93.651093] (8), [-1.08514, 93.651093] (8), [-1.00019, 93.651093] (8), [-0.95115, 93.651093] (8), [-0.83432, 93.651093] (8), [-0.75136, 93.651093] (8), [-0.70672, 93.651093] (8), [-0.69088, 93.651093] (8), [-0.56507, 93.651093] (8), [-0.55239, 93.651093] (8), [-0.45774, 93.651093] (8), [-0.41955, 93.651093] (8), [-0.37723, 93.651093] (8), [-0.34869, 93.651093] (8), [-0.32982, 93.651093] (8), [-0.31374, 93.651093] (8), [-0.31235, 93.651093] (8), 
length of domains: 37
Total time: 0.3021	 pickout: 0.0038	 decision: 0.0235	 get_bound: 0.2732	 add_domain: 0.0017
Current lb:-1.789461612701416
164 neurons visited
0 diving domains visited
Cumulative time: 4.607288360595703

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 586], [1, 586], [1, 586], [2, 17], [2, 65], [1, 586], [2, 17], [1, 233], [1, 586], [1, 586]]
single_node_split: True
regular batch size: 2*37, diving batch size 1*0
best_l after optimization: 0.3148946762084961 with beta sum per layer: [0.0, 0.5574202537536621, 36.079891204833984]
optimal alpha/beta time: 0.26447105407714844
This batch time : update_bounds func: 0.2796	 prepare: 0.0082	 bound: 0.2647	 transfer: 0.0021	 finalize: 0.0044
Accumulated time: update_bounds func: 2.8035	 prepare: 0.0339	 bound: 2.7434	 transfer: 0.0021	 finalize: 0.0158
batch bounding time:  0.27982401847839355
Current worst splitting domains [lb, ub] (depth):
[-1.46432, 93.651093] (9), [-1.24226, 93.651093] (9), [-0.90101, 93.651093] (9), [-0.85721, 93.651093] (9), [-0.84461, 93.651093] (9), [-0.81585, 93.651093] (9), [-0.79558, 93.651093] (9), [-0.78557, 93.651093] (9), [-0.67573, 93.651093] (9), [-0.60812, 93.651093] (9), [-0.52045, 93.651093] (9), [-0.51096, 93.651093] (9), [-0.45515, 93.651093] (9), [-0.42259, 93.651093] (9), [-0.40001, 93.651093] (9), [-0.30724, 93.651093] (9), [-0.29299, 93.651093] (9), [-0.27510, 93.651093] (9), [-0.23525, 93.651093] (9), [-0.22968, 93.651093] (9), 
length of domains: 31
Total time: 0.3117	 pickout: 0.0054	 decision: 0.0250	 get_bound: 0.2799	 add_domain: 0.0015
Current lb:-1.4643235206604004
238 neurons visited
0 diving domains visited
Cumulative time: 4.919662237167358

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17], [2, 17], [2, 96], [2, 65], [2, 17], [1, 586], [2, 65], [2, 17], [2, 65], [1, 586]]
single_node_split: True
regular batch size: 2*31, diving batch size 1*0
best_l after optimization: -1.630417823791504 with beta sum per layer: [0.0, 0.33101752400398254, 25.502639770507812]
optimal alpha/beta time: 0.26096439361572266
This batch time : update_bounds func: 0.2741	 prepare: 0.0073	 bound: 0.2612	 transfer: 0.0015	 finalize: 0.0038
Accumulated time: update_bounds func: 3.0776	 prepare: 0.0413	 bound: 3.0047	 transfer: 0.0015	 finalize: 0.0196
batch bounding time:  0.27422547340393066
Current worst splitting domains [lb, ub] (depth):
[-1.03770, 93.651093] (10), [-0.93460, 93.651093] (10), [-0.81253, 93.651093] (10), [-0.72213, 93.651093] (10), [-0.69377, 93.651093] (10), [-0.62679, 93.651093] (10), [-0.52077, 93.651093] (10), [-0.47955, 93.651093] (10), [-0.45085, 93.651093] (10), [-0.40961, 93.651093] (10), [-0.39414, 93.651093] (10), [-0.38851, 93.651093] (10), [-0.33686, 93.651093] (10), [-0.32590, 93.651093] (10), [-0.32321, 93.651093] (10), [-0.27223, 93.651093] (10), [-0.25143, 93.651093] (10), [-0.24464, 93.651093] (10), [-0.23446, 93.651093] (10), [-0.10865, 93.651093] (10), 
length of domains: 24
Total time: 0.3042	 pickout: 0.0047	 decision: 0.0240	 get_bound: 0.2743	 add_domain: 0.0012
Current lb:-1.0377039909362793
300 neurons visited
0 diving domains visited
Cumulative time: 5.2244439125061035

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 65], [2, 65], [2, 65], [2, 65], [2, 17], [2, 17], [2, 17], [1, 586], [1, 593], [2, 17]]
single_node_split: True
regular batch size: 2*24, diving batch size 1*0
best_l after optimization: -3.179750442504883 with beta sum per layer: [0.0, 0.22962535917758942, 17.59427261352539]
optimal alpha/beta time: 0.2602050304412842
This batch time : update_bounds func: 0.2711	 prepare: 0.0062	 bound: 0.2605	 transfer: 0.0014	 finalize: 0.0029
Accumulated time: update_bounds func: 3.3486	 prepare: 0.0475	 bound: 3.2651	 transfer: 0.0014	 finalize: 0.0225
batch bounding time:  0.27121663093566895
Current worst splitting domains [lb, ub] (depth):
[-0.88191, 93.651093] (11), [-0.76438, 93.651093] (11), [-0.65672, 93.651093] (11), [-0.55111, 93.651093] (11), [-0.35257, 93.651093] (11), [-0.31733, 93.651093] (11), [-0.24630, 93.651093] (11), [-0.17514, 93.651093] (11), [-0.14016, 93.651093] (11), [-0.08639, 93.651093] (11), [-0.08440, 93.651093] (11), [-0.07225, 93.651093] (11), [-0.05269, 93.651093] (11), [-0.05125, 93.651093] (11), [-0.03046, 93.651093] (11), [-0.02539, 93.651093] (11), [-0.00916, 93.651093] (11), 
length of domains: 17
Total time: 0.3000	 pickout: 0.0038	 decision: 0.0239	 get_bound: 0.2713	 add_domain: 0.0009
Current lb:-0.8819108009338379
348 neurons visited
0 diving domains visited
Cumulative time: 5.524859666824341

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 593], [1, 141], [1, 593], [1, 141], [2, 65], [2, 65], [1, 593], [1, 593], [2, 65], [1, 593]]
single_node_split: True
regular batch size: 2*17, diving batch size 1*0
best_l after optimization: -2.4602770805358887 with beta sum per layer: [0.0, 0.2945441007614136, 11.244009971618652]
optimal alpha/beta time: 0.2626826763153076
This batch time : update_bounds func: 0.2710	 prepare: 0.0048	 bound: 0.2629	 transfer: 0.0010	 finalize: 0.0021
Accumulated time: update_bounds func: 3.6196	 prepare: 0.0523	 bound: 3.5281	 transfer: 0.0010	 finalize: 0.0246
batch bounding time:  0.27114439010620117
Current worst splitting domains [lb, ub] (depth):
[-0.83171, 93.651093] (12), [-0.60592, 93.651093] (12), [-0.37368, 93.651093] (12), [-0.34316, 93.651093] (12), [-0.32377, 93.651093] (12), [-0.22979, 93.651093] (12), [-0.18321, 93.651093] (12), [-0.15250, 93.651093] (12), [-0.13586, 93.651093] (12), [-0.10141, 93.651093] (12), [-0.09287, 93.651093] (12), [-0.09082, 93.651093] (12), 
length of domains: 12
Total time: 0.2972	 pickout: 0.0029	 decision: 0.0224	 get_bound: 0.2712	 add_domain: 0.0007
Current lb:-0.8317108154296875
382 neurons visited
0 diving domains visited
Cumulative time: 5.8224077224731445

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 141], [1, 141], [1, 593], [1, 593], [1, 141], [1, 593], [1, 141], [1, 233], [1, 141], [1, 141]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: -0.6040139198303223 with beta sum per layer: [0.0, 0.766660213470459, 4.125085830688477]
optimal alpha/beta time: 0.259232759475708
This batch time : update_bounds func: 0.2658	 prepare: 0.0038	 bound: 0.2595	 transfer: 0.0009	 finalize: 0.0016
Accumulated time: update_bounds func: 3.8855	 prepare: 0.0561	 bound: 3.7875	 transfer: 0.0009	 finalize: 0.0262
batch bounding time:  0.2659718990325928
Current worst splitting domains [lb, ub] (depth):
[-0.47243, 93.651093] (13), [-0.40116, 93.651093] (13), [-0.31446, 93.651093] (13), [-0.30200, 93.651093] (13), [-0.29355, 93.651093] (13), [-0.16589, 93.651093] (13), [-0.10867, 93.651093] (13), [-0.04454, 93.651093] (13), 
length of domains: 8
Total time: 0.2903	 pickout: 0.0022	 decision: 0.0215	 get_bound: 0.2660	 add_domain: 0.0005
Current lb:-0.4724297523498535
406 neurons visited
0 diving domains visited
Cumulative time: 6.112983703613281

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 632], [1, 632], [1, 632], [1, 636], [1, 632], [2, 50], [1, 632], [2, 50]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -1.1551437377929688 with beta sum per layer: [0.0, 0.6955176591873169, 2.1524510383605957]
optimal alpha/beta time: 0.2584996223449707
This batch time : update_bounds func: 0.2640	 prepare: 0.0032	 bound: 0.2588	 transfer: 0.0008	 finalize: 0.0012
Accumulated time: update_bounds func: 4.1494	 prepare: 0.0593	 bound: 4.0463	 transfer: 0.0008	 finalize: 0.0274
batch bounding time:  0.26408934593200684
Current worst splitting domains [lb, ub] (depth):
[-0.16966, 93.651093] (14), [-0.15326, 93.651093] (14), [-0.08243, 93.651093] (14), [-0.07234, 93.651093] (14), [-0.00144, 93.651093] (14), 
length of domains: 5
Total time: 0.2871	 pickout: 0.0017	 decision: 0.0209	 get_bound: 0.2641	 add_domain: 0.0004
Current lb:-0.16965723037719727
422 neurons visited
0 diving domains visited
Cumulative time: 6.400313138961792

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 181], [2, 47], [2, 47], [2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -2.8320727348327637 with beta sum per layer: [0.0, 0.22328633069992065, 0.8272242546081543]
optimal alpha/beta time: 0.23034024238586426
This batch time : update_bounds func: 0.2347	 prepare: 0.0026	 bound: 0.2306	 transfer: 0.0007	 finalize: 0.0008
Accumulated time: update_bounds func: 4.3841	 prepare: 0.0619	 bound: 4.2769	 transfer: 0.0007	 finalize: 0.0281
batch bounding time:  0.2348465919494629
Current worst splitting domains [lb, ub] (depth):
[-0.08369, 93.651093] (15), 
length of domains: 1
Total time: 0.2570	 pickout: 0.0013	 decision: 0.0207	 get_bound: 0.2349	 add_domain: 0.0001
Current lb:-0.08368730545043945
432 neurons visited
0 diving domains visited
Cumulative time: 6.657475471496582

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 632]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5065693855285645 with beta sum per layer: [0.0, 0.0, 0.8573231101036072]
optimal alpha/beta time: 0.009153127670288086
This batch time : update_bounds func: 0.0119	 prepare: 0.0017	 bound: 0.0094	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 4.3960	 prepare: 0.0637	 bound: 4.2863	 transfer: 0.0005	 finalize: 0.0284
batch bounding time:  0.011958837509155273
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0326	 pickout: 0.0008	 decision: 0.0199	 get_bound: 0.0120	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 6.690171003341675

Image 113 pidx 7 verify end, final lower bound 999, upper bound 93.65109252929688, time: 6.751601696014404
113 999
##### [0:113] Tested against 3 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.73215913772583 with beta sum per layer: []
optimal alpha/beta time: 0.963104248046875
alpha-CROWN with fixed intermediate bounds: tensor([[-1.7322]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.73215913772583
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 1]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.04257917404174805 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.24894213676452637
This batch time : update_bounds func: 0.2516	 prepare: 0.0016	 bound: 0.2492	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 4.6476	 prepare: 0.0652	 bound: 4.5355	 transfer: 0.0005	 finalize: 0.0287
batch bounding time:  0.25176382064819336
Current worst splitting domains [lb, ub] (depth):
[-1.44242, 97.267838] (1), 
length of domains: 1
Total time: 0.2725	 pickout: 0.0008	 decision: 0.0199	 get_bound: 0.2518	 add_domain: 0.0001
Current lb:-1.442415714263916
2 neurons visited
0 diving domains visited
Cumulative time: 1.25046968460083

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.0514616966247559 with beta sum per layer: [0.0, 0.0, 0.336653470993042]
optimal alpha/beta time: 0.2508375644683838
This batch time : update_bounds func: 0.2535	 prepare: 0.0016	 bound: 0.2511	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 4.9012	 prepare: 0.0669	 bound: 4.7865	 transfer: 0.0005	 finalize: 0.0289
batch bounding time:  0.2536642551422119
Current worst splitting domains [lb, ub] (depth):
[-0.91395, 97.267838] (2), [-0.13751, 97.267838] (2), 
length of domains: 2
Total time: 0.2744	 pickout: 0.0007	 decision: 0.0199	 get_bound: 0.2537	 add_domain: 0.0001
Current lb:-0.9139513969421387
4 neurons visited
0 diving domains visited
Cumulative time: 1.524932861328125

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 10]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.2977452278137207 with beta sum per layer: [0.0, 0.0, 0.7321597337722778]
optimal alpha/beta time: 0.25530195236206055
This batch time : update_bounds func: 0.2585	 prepare: 0.0018	 bound: 0.2556	 transfer: 0.0007	 finalize: 0.0004
Accumulated time: update_bounds func: 5.1596	 prepare: 0.0687	 bound: 5.0421	 transfer: 0.0007	 finalize: 0.0293
batch bounding time:  0.258652925491333
Current worst splitting domains [lb, ub] (depth):
[-0.49326, 97.267838] (3), 
length of domains: 1
Total time: 0.2797	 pickout: 0.0009	 decision: 0.0201	 get_bound: 0.2587	 add_domain: 0.0001
Current lb:-0.49326181411743164
8 neurons visited
0 diving domains visited
Cumulative time: 1.8047606945037842

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 10]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.047080039978027344 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.25132322311401367
This batch time : update_bounds func: 0.2541	 prepare: 0.0016	 bound: 0.2516	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.4137	 prepare: 0.0703	 bound: 5.2936	 transfer: 0.0005	 finalize: 0.0296
batch bounding time:  0.25418806076049805
Current worst splitting domains [lb, ub] (depth):
[-0.22462, 97.267838] (4), 
length of domains: 1
Total time: 0.2749	 pickout: 0.0008	 decision: 0.0199	 get_bound: 0.2542	 add_domain: 0.0001
Current lb:-0.22461605072021484
10 neurons visited
0 diving domains visited
Cumulative time: 2.0798330307006836

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 36]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.4549870491027832 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.25100135803222656
This batch time : update_bounds func: 0.2537	 prepare: 0.0016	 bound: 0.2512	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.6674	 prepare: 0.0720	 bound: 5.5449	 transfer: 0.0005	 finalize: 0.0298
batch bounding time:  0.2538261413574219
Current worst splitting domains [lb, ub] (depth):
[-0.01063, 97.267838] (5), 
length of domains: 1
Total time: 0.2745	 pickout: 0.0007	 decision: 0.0198	 get_bound: 0.2538	 add_domain: 0.0001
Current lb:-0.010628700256347656
12 neurons visited
0 diving domains visited
Cumulative time: 2.3543689250946045

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.0189638137817383 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.009096145629882812
This batch time : update_bounds func: 0.0117	 prepare: 0.0016	 bound: 0.0093	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.6791	 prepare: 0.0736	 bound: 5.5542	 transfer: 0.0005	 finalize: 0.0301
batch bounding time:  0.011778831481933594
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0324	 pickout: 0.0007	 decision: 0.0199	 get_bound: 0.0118	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.3868658542633057

Image 113 pidx 3 verify end, final lower bound 999, upper bound 97.26783752441406, time: 2.447653293609619
113 999
##### [0:113] Tested against 8 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.331721305847168 with beta sum per layer: []
optimal alpha/beta time: 1.0372231006622314
alpha-CROWN with fixed intermediate bounds: tensor([[-1.3317]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.331721305847168
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 58]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9886684417724609 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.25125885009765625
This batch time : update_bounds func: 0.2539	 prepare: 0.0016	 bound: 0.2515	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.9330	 prepare: 0.0752	 bound: 5.8057	 transfer: 0.0005	 finalize: 0.0304
batch bounding time:  0.25402045249938965
Current worst splitting domains [lb, ub] (depth):
[-1.07317, 97.668282] (1), 
length of domains: 1
Total time: 0.2750	 pickout: 0.0008	 decision: 0.0200	 get_bound: 0.2540	 add_domain: 0.0001
Current lb:-1.073166847229004
2 neurons visited
0 diving domains visited
Cumulative time: 1.3270487785339355

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 65]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.6419267654418945 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2552361488342285
This batch time : update_bounds func: 0.2580	 prepare: 0.0017	 bound: 0.2555	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.1910	 prepare: 0.0769	 bound: 6.0611	 transfer: 0.0005	 finalize: 0.0306
batch bounding time:  0.2580852508544922
Current worst splitting domains [lb, ub] (depth):
[-0.75621, 97.668282] (2), 
length of domains: 1
Total time: 0.2788	 pickout: 0.0007	 decision: 0.0199	 get_bound: 0.2581	 add_domain: 0.0001
Current lb:-0.7562141418457031
4 neurons visited
0 diving domains visited
Cumulative time: 1.6059379577636719

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.10809564590454102 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2510831356048584
This batch time : update_bounds func: 0.2538	 prepare: 0.0017	 bound: 0.2513	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.4448	 prepare: 0.0786	 bound: 6.3125	 transfer: 0.0005	 finalize: 0.0309
batch bounding time:  0.25403308868408203
Current worst splitting domains [lb, ub] (depth):
[-0.09988, 97.668282] (3), 
length of domains: 1
Total time: 0.2748	 pickout: 0.0008	 decision: 0.0199	 get_bound: 0.2540	 add_domain: 0.0001
Current lb:-0.0998835563659668
6 neurons visited
0 diving domains visited
Cumulative time: 1.880821704864502

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 50]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.9895176887512207 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.009103536605834961
This batch time : update_bounds func: 0.0118	 prepare: 0.0017	 bound: 0.0093	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.4565	 prepare: 0.0802	 bound: 6.3218	 transfer: 0.0005	 finalize: 0.0311
batch bounding time:  0.011796236038208008
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0324	 pickout: 0.0007	 decision: 0.0198	 get_bound: 0.0118	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.9133059978485107

Image 113 pidx 8 verify end, final lower bound 999, upper bound 97.66828155517578, time: 1.9734878540039062
113 999
##### [0:113] Tested against 4 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.212517738342285 with beta sum per layer: []
optimal alpha/beta time: 1.0342912673950195
alpha-CROWN with fixed intermediate bounds: tensor([[-2.2125]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.212517738342285
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.5149450302124023 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2507922649383545
This batch time : update_bounds func: 0.2534	 prepare: 0.0016	 bound: 0.2510	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.7100	 prepare: 0.0818	 bound: 6.5728	 transfer: 0.0005	 finalize: 0.0314
batch bounding time:  0.25356078147888184
Current worst splitting domains [lb, ub] (depth):
[-1.69296, 96.787483] (1), 
length of domains: 1
Total time: 0.2743	 pickout: 0.0007	 decision: 0.0199	 get_bound: 0.2536	 add_domain: 0.0001
Current lb:-1.692962646484375
2 neurons visited
0 diving domains visited
Cumulative time: 1.3231358528137207

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9455318450927734 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2510361671447754
This batch time : update_bounds func: 0.2537	 prepare: 0.0016	 bound: 0.2513	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.9637	 prepare: 0.0835	 bound: 6.8241	 transfer: 0.0005	 finalize: 0.0317
batch bounding time:  0.25386953353881836
Current worst splitting domains [lb, ub] (depth):
[-1.13734, 96.787483] (2), 
length of domains: 1
Total time: 0.2745	 pickout: 0.0007	 decision: 0.0198	 get_bound: 0.2539	 add_domain: 0.0001
Current lb:-1.1373367309570312
4 neurons visited
0 diving domains visited
Cumulative time: 1.5977251529693604

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 233]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9943342208862305 with beta sum per layer: [0.0, 0.06430651247501373, 0.0]
optimal alpha/beta time: 0.2547907829284668
This batch time : update_bounds func: 0.2576	 prepare: 0.0017	 bound: 0.2550	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 7.2213	 prepare: 0.0852	 bound: 7.0791	 transfer: 0.0005	 finalize: 0.0319
batch bounding time:  0.2577047348022461
Current worst splitting domains [lb, ub] (depth):
[-0.65281, 96.787483] (3), [-0.34153, 96.787483] (3), 
length of domains: 2
Total time: 0.2783	 pickout: 0.0007	 decision: 0.0197	 get_bound: 0.2577	 add_domain: 0.0001
Current lb:-0.6528053283691406
6 neurons visited
0 diving domains visited
Cumulative time: 1.8761169910430908

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 586], [1, 586]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.1850738525390625 with beta sum per layer: [0.0, 0.1323668658733368, 0.0]
optimal alpha/beta time: 0.2580389976501465
This batch time : update_bounds func: 0.2612	 prepare: 0.0019	 bound: 0.2583	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 7.4825	 prepare: 0.0871	 bound: 7.3374	 transfer: 0.0006	 finalize: 0.0323
batch bounding time:  0.26137709617614746
Current worst splitting domains [lb, ub] (depth):
[-0.43651, 96.787483] (4), [-0.12199, 96.787483] (4), 
length of domains: 2
Total time: 0.2823	 pickout: 0.0009	 decision: 0.0199	 get_bound: 0.2614	 add_domain: 0.0001
Current lb:-0.4365091323852539
10 neurons visited
0 diving domains visited
Cumulative time: 2.158540964126587

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 33], [2, 33]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.8862895965576172 with beta sum per layer: [0.0, 0.1361207216978073, 0.0]
optimal alpha/beta time: 0.2582824230194092
This batch time : update_bounds func: 0.2615	 prepare: 0.0019	 bound: 0.2585	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 7.7440	 prepare: 0.0890	 bound: 7.5960	 transfer: 0.0006	 finalize: 0.0327
batch bounding time:  0.26161623001098633
Current worst splitting domains [lb, ub] (depth):
[-0.15323, 96.787483] (5), 
length of domains: 1
Total time: 0.2826	 pickout: 0.0009	 decision: 0.0200	 get_bound: 0.2616	 add_domain: 0.0001
Current lb:-0.1532268524169922
14 neurons visited
0 diving domains visited
Cumulative time: 2.4412593841552734

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 232]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.6589832305908203 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.009152412414550781
This batch time : update_bounds func: 0.0119	 prepare: 0.0017	 bound: 0.0094	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 7.7559	 prepare: 0.0907	 bound: 7.6053	 transfer: 0.0005	 finalize: 0.0329
batch bounding time:  0.011948108673095703
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0325	 pickout: 0.0007	 decision: 0.0198	 get_bound: 0.0120	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.4738738536834717

Image 113 pidx 4 verify end, final lower bound 999, upper bound 96.78748321533203, time: 2.5342447757720947
113 999
##### [0:113] Tested against 2 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized./home/zhouxingshi/gputest/CROWN-GENERAL_41a3/complete_verifier/utils.py:391: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  eps_temp = torch.tensor(eps_temp / std).reshape(1, -1, 1, 1)

setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.267594337463379 with beta sum per layer: []
optimal alpha/beta time: 1.0072660446166992
alpha-CROWN with fixed intermediate bounds: tensor([[-1.2676]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.267594337463379
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.5161352157592773 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.25277185440063477
This batch time : update_bounds func: 0.2554	 prepare: 0.0016	 bound: 0.2530	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 8.0113	 prepare: 0.0923	 bound: 7.8584	 transfer: 0.0005	 finalize: 0.0332
batch bounding time:  0.25554442405700684
Current worst splitting domains [lb, ub] (depth):
[-0.66652, 97.732407] (1), 
length of domains: 1
Total time: 0.2762	 pickout: 0.0008	 decision: 0.0198	 get_bound: 0.2556	 add_domain: 0.0001
Current lb:-0.6665153503417969
2 neurons visited
0 diving domains visited
Cumulative time: 1.2980849742889404

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.6300067901611328 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.009093284606933594
This batch time : update_bounds func: 0.0117	 prepare: 0.0017	 bound: 0.0093	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 8.0231	 prepare: 0.0940	 bound: 7.8677	 transfer: 0.0005	 finalize: 0.0335
batch bounding time:  0.011781930923461914
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0324	 pickout: 0.0007	 decision: 0.0199	 get_bound: 0.0118	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.330571174621582

Image 113 pidx 2 verify end, final lower bound 999, upper bound 97.73240661621094, time: 1.3903782367706299
113 999
##### [0:113] Tested against 5 ######
Initial alpha-CROWN verified for label 5 with bound 3.530515670776367
Image 113 pidx 5 verify end, final lower bound 3.530515670776367, upper bound inf, time: 0.0005307197570800781
113 3.530515670776367
##### [0:113] Tested against 0 ######
Initial alpha-CROWN verified for label 0 with bound 4.191804885864258
Image 113 pidx 0 verify end, final lower bound 4.191804885864258, upper bound inf, time: 0.0005047321319580078
113 4.191804885864258
##### [0:113] Tested against 1 ######
Initial alpha-CROWN verified for label 1 with bound 1.6687278747558594
Image 113 pidx 1 verify end, final lower bound 1.6687278747558594, upper bound inf, time: 0.0004818439483642578
113 1.6687278747558594
##### [0:113] Tested against 6 ######
Initial alpha-CROWN verified for label 6 with bound 6.522150039672852
Image 113 pidx 6 verify end, final lower bound 6.522150039672852, upper bound inf, time: 0.0004942417144775391
113 6.522150039672852
##### [0:113] Tested against 9 ######
correct label, skip!
[[113.           0.           0.           0.93054295   0.
   -3.                  inf          inf]
 [113.           0.           0.           6.509794     0.
   -1.                  inf          inf]
 [113.         999.         434.           6.7516017    0.
    7.          93.65109253   2.08792782]
 [113.         999.          14.           2.44765329   0.
    3.          97.26783752   6.09357357]
 [113.         999.           8.           1.97348785   0.
    8.          97.66828156   7.1545639 ]
 [113.         999.          16.           2.53424478   0.
    4.          96.78748322   9.06057453]
 [113.         999.           4.           1.39037824   0.
    2.          97.73240662   9.46487522]
 [113.           3.53051567   0.           0.00053072   0.
    5.                  inf  11.65124416]
 [113.           4.19180489   0.           0.00050473   0.
    0.                  inf  11.90815926]
 [113.           1.66872787   0.           0.00048184   0.
    1.                  inf  12.79525471]
 [113.           6.52215004   0.           0.00049424   0.
    6.                  inf  17.76874352]
 [113.           0.           0.           0.           0.
    9.                  inf          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 21.609171390533447

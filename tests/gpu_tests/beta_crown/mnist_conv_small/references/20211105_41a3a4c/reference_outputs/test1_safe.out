Experiments at Thu Nov  4 22:55:28 2021 on huan-Super-Server
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=800, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Sampled data loaded. Data already preprocessed!
Shape: torch.Size([1000, 1, 28, 28]) torch.Size([1000]) torch.Size([1000])
X range: tensor(2.8215) tensor(-0.4242) tensor(-0.0274)
Note runnerup label is empty here!
############################
epsilon after preprocession: tensor([[[[0.3895]]]]), data_max = tensor([[[[2.8215]]]]), data_min = tensor([[[[-0.4242]]]])
Task length: 1
saving results to Verified_ret_[mnist_conv_small]_start=113_end=114_iter=20_b=2048_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 113 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  9  correct label  9 logits tensor([-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
         1.4478, 13.2568], device='cuda:0', grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 9, Tested against: ['all'] ######
pgd prediction: tensor([-3.1159, -4.0030, -0.6726,  2.6987, -0.2683, -2.8590, -8.9765,  6.7044,
         1.6377,  8.7923], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([11.9082, 12.7953,  9.4649,  6.0936,  9.0606, 11.6512, 17.7687,  2.0879,
         7.1546,     inf], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[ 3.5425,  0.6511, -2.1750, -2.4561, -3.0957,  2.7296,  5.7511, -6.5224,
         -2.1588]], device='cuda:0') None
best_l after optimization: -4.015040397644043 with beta sum per layer: []
optimal alpha/beta time: 12.738924503326416
initial alpha-CROWN bounds: tensor([[ 4.1918,  1.6687, -1.2693, -1.7332, -2.2137,  3.5305,  6.5221, -5.3492,
         -1.3328]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:113] Tested against 7 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 5.348903656005859 with beta sum per layer: []
optimal alpha/beta time: 1.2257130146026611
alpha-CROWN with fixed intermediate bounds: tensor([[-5.3489]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-5.348903656005859
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 1]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 7.73296594619751 with beta sum per layer: [0.0, 0.0, 0.6193286776542664]
optimal alpha/beta time: 0.5594162940979004
This batch time : update_bounds func: 0.5623	 prepare: 0.0020	 bound: 0.5596	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.5623	 prepare: 0.0020	 bound: 0.5596	 transfer: 0.0004	 finalize: 0.0002
batch bounding time:  0.5623772144317627
Current worst splitting domains [lb, ub] (depth):
[-4.96543, 93.651093] (1), [-2.76753, 93.651093] (1), 
length of domains: 2
Total time: 0.6373	 pickout: 0.0493	 decision: 0.0254	 get_bound: 0.5624	 add_domain: 0.0002
Current lb:-4.965432643890381
2 neurons visited
0 diving domains visited
Cumulative time: 2.246267557144165

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 86], [2, 86]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 10.227805137634277 with beta sum per layer: [0.0, 0.0, 2.3092470169067383]
optimal alpha/beta time: 0.20170044898986816
This batch time : update_bounds func: 0.2038	 prepare: 0.0012	 bound: 0.2019	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.7660	 prepare: 0.0031	 bound: 0.7615	 transfer: 0.0004	 finalize: 0.0005
batch bounding time:  0.2039179801940918
Current worst splitting domains [lb, ub] (depth):
[-4.10657, 93.651093] (2), [-3.87611, 93.651093] (2), [-2.18753, 93.651093] (2), [-0.05759, 93.651093] (2), 
length of domains: 4
Total time: 0.2223	 pickout: 0.0030	 decision: 0.0152	 get_bound: 0.2039	 add_domain: 0.0001
Current lb:-4.1065673828125
6 neurons visited
0 diving domains visited
Cumulative time: 2.4686102867126465

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 63], [2, 63], [2, 63], [2, 63]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 12.912389755249023 with beta sum per layer: [0.0, 0.0, 5.677765846252441]
optimal alpha/beta time: 0.20632314682006836
This batch time : update_bounds func: 0.2093	 prepare: 0.0015	 bound: 0.2065	 transfer: 0.0007	 finalize: 0.0006
Accumulated time: update_bounds func: 0.9754	 prepare: 0.0046	 bound: 0.9680	 transfer: 0.0007	 finalize: 0.0011
batch bounding time:  0.2095201015472412
Current worst splitting domains [lb, ub] (depth):
[-3.62254, 93.651093] (3), [-3.33277, 93.651093] (3), [-2.86947, 93.651093] (3), [-2.83548, 93.651093] (3), [-1.78607, 93.651093] (3), 
length of domains: 5
Total time: 0.2257	 pickout: 0.0008	 decision: 0.0151	 get_bound: 0.2095	 add_domain: 0.0002
Current lb:-3.622541904449463
14 neurons visited
0 diving domains visited
Cumulative time: 2.69446063041687

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89], [2, 7], [2, 89], [2, 36], [2, 89]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 19.412948608398438 with beta sum per layer: [0.0, 0.0, 3.2957115173339844]
optimal alpha/beta time: 0.1926889419555664
This batch time : update_bounds func: 0.1956	 prepare: 0.0015	 bound: 0.1929	 transfer: 0.0007	 finalize: 0.0005
Accumulated time: update_bounds func: 1.1710	 prepare: 0.0061	 bound: 1.1609	 transfer: 0.0007	 finalize: 0.0017
batch bounding time:  0.19570255279541016
Current worst splitting domains [lb, ub] (depth):
[-3.05536, 93.651093] (4), [-2.71787, 93.651093] (4), [-2.63116, 93.651093] (4), [-2.54795, 93.651093] (4), [-2.27155, 93.651093] (4), [-2.02703, 93.651093] (4), [-1.90685, 93.651093] (4), [-1.27945, 93.651093] (4), [-0.51728, 93.651093] (4), [-0.45845, 93.651093] (4), 
length of domains: 10
Total time: 0.2124	 pickout: 0.0010	 decision: 0.0153	 get_bound: 0.1957	 add_domain: 0.0004
Current lb:-3.05535888671875
24 neurons visited
0 diving domains visited
Cumulative time: 2.906951904296875

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7], [2, 89], [2, 7], [2, 7], [2, 89], [2, 7], [2, 36], [2, 7], [2, 7], [2, 7]]
single_node_split: True
regular batch size: 2*10, diving batch size 1*0
best_l after optimization: 22.387710571289062 with beta sum per layer: [0.0, 0.0, 8.097757339477539]
optimal alpha/beta time: 0.18585467338562012
This batch time : update_bounds func: 0.1901	 prepare: 0.0021	 bound: 0.1860	 transfer: 0.0010	 finalize: 0.0010
Accumulated time: update_bounds func: 1.3611	 prepare: 0.0082	 bound: 1.3469	 transfer: 0.0010	 finalize: 0.0026
batch bounding time:  0.1902174949645996
Current worst splitting domains [lb, ub] (depth):
[-2.47497, 93.651093] (5), [-2.08071, 93.651093] (5), [-2.00460, 93.651093] (5), [-1.91148, 93.651093] (5), [-1.90005, 93.651093] (5), [-1.76009, 93.651093] (5), [-1.72559, 93.651093] (5), [-1.68017, 93.651093] (5), [-1.57456, 93.651093] (5), [-1.43652, 93.651093] (5), [-1.33321, 93.651093] (5), [-1.32473, 93.651093] (5), [-1.18338, 93.651093] (5), [-0.56814, 93.651093] (5), [-0.42883, 93.651093] (5), 
length of domains: 15
Total time: 0.2090	 pickout: 0.0015	 decision: 0.0166	 get_bound: 0.1903	 add_domain: 0.0005
Current lb:-2.4749693870544434
44 neurons visited
0 diving domains visited
Cumulative time: 3.116131067276001

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 36], [2, 36], [2, 36], [2, 36], [2, 89], [2, 89], [2, 36], [2, 7], [2, 36], [2, 36]]
single_node_split: True
regular batch size: 2*15, diving batch size 1*0
best_l after optimization: 17.108903884887695 with beta sum per layer: [0.0, 0.0, 14.863809585571289]
optimal alpha/beta time: 0.1873326301574707
This batch time : update_bounds func: 0.1930	 prepare: 0.0027	 bound: 0.1875	 transfer: 0.0014	 finalize: 0.0014
Accumulated time: update_bounds func: 1.5541	 prepare: 0.0108	 bound: 1.5344	 transfer: 0.0014	 finalize: 0.0040
batch bounding time:  0.193098783493042
Current worst splitting domains [lb, ub] (depth):
[-2.28195, 93.651093] (6), [-1.89181, 93.651093] (6), [-1.74068, 93.651093] (6), [-1.72993, 93.651093] (6), [-1.56263, 93.651093] (6), [-1.33595, 93.651093] (6), [-1.24410, 93.651093] (6), [-1.12871, 93.651093] (6), [-1.08554, 93.651093] (6), [-1.05795, 93.651093] (6), [-0.98239, 93.651093] (6), [-0.96026, 93.651093] (6), [-0.93327, 93.651093] (6), [-0.91020, 93.651093] (6), [-0.81176, 93.651093] (6), [-0.76999, 93.651093] (6), [-0.19654, 93.651093] (6), [-0.18331, 93.651093] (6), [-0.02645, 93.651093] (6), [-0.00115, 93.651093] (6), 
length of domains: 20
Total time: 0.2187	 pickout: 0.0021	 decision: 0.0228	 get_bound: 0.1931	 add_domain: 0.0006
Current lb:-2.281949043273926
74 neurons visited
0 diving domains visited
Cumulative time: 3.3350114822387695

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58], [2, 58]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: 15.251220703125 with beta sum per layer: [0.0, 0.0, 20.954002380371094]
optimal alpha/beta time: 0.18744683265686035
This batch time : update_bounds func: 0.1941	 prepare: 0.0031	 bound: 0.1876	 transfer: 0.0016	 finalize: 0.0018
Accumulated time: update_bounds func: 1.7482	 prepare: 0.0139	 bound: 1.7220	 transfer: 0.0016	 finalize: 0.0058
batch bounding time:  0.19421124458312988
Current worst splitting domains [lb, ub] (depth):
[-2.06373, 93.651093] (7), [-1.59861, 93.651093] (7), [-1.44555, 93.651093] (7), [-1.42118, 93.651093] (7), [-1.25965, 93.651093] (7), [-1.01970, 93.651093] (7), [-0.90333, 93.651093] (7), [-0.82089, 93.651093] (7), [-0.80755, 93.651093] (7), [-0.79153, 93.651093] (7), [-0.72171, 93.651093] (7), [-0.69183, 93.651093] (7), [-0.67053, 93.651093] (7), [-0.62168, 93.651093] (7), [-0.57370, 93.651093] (7), [-0.56928, 93.651093] (7), [-0.51606, 93.651093] (7), [-0.51150, 93.651093] (7), [-0.49214, 93.651093] (7), [-0.42002, 93.651093] (7), 
length of domains: 25
Total time: 0.2149	 pickout: 0.0025	 decision: 0.0173	 get_bound: 0.1943	 add_domain: 0.0008
Current lb:-2.0637264251708984
114 neurons visited
0 diving domains visited
Cumulative time: 3.5502424240112305

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 96], [1, 586], [1, 233], [2, 17], [1, 233], [1, 233], [2, 96], [2, 96], [1, 233]]
single_node_split: True
regular batch size: 2*25, diving batch size 1*0
best_l after optimization: 15.100004196166992 with beta sum per layer: [0.0, 0.2592463493347168, 23.69987678527832]
optimal alpha/beta time: 0.1926565170288086
This batch time : update_bounds func: 0.2013	 prepare: 0.0039	 bound: 0.1928	 transfer: 0.0019	 finalize: 0.0025
Accumulated time: update_bounds func: 1.9495	 prepare: 0.0179	 bound: 1.9149	 transfer: 0.0019	 finalize: 0.0083
batch bounding time:  0.20137596130371094
Current worst splitting domains [lb, ub] (depth):
[-1.78946, 93.651093] (8), [-1.30266, 93.651093] (8), [-1.30020, 93.651093] (8), [-1.21334, 93.651093] (8), [-1.08514, 93.651093] (8), [-1.00019, 93.651093] (8), [-0.95115, 93.651093] (8), [-0.83432, 93.651093] (8), [-0.75136, 93.651093] (8), [-0.70673, 93.651093] (8), [-0.69088, 93.651093] (8), [-0.56507, 93.651093] (8), [-0.55239, 93.651093] (8), [-0.45774, 93.651093] (8), [-0.41955, 93.651093] (8), [-0.37723, 93.651093] (8), [-0.34869, 93.651093] (8), [-0.32982, 93.651093] (8), [-0.31374, 93.651093] (8), [-0.31236, 93.651093] (8), 
length of domains: 37
Total time: 0.2229	 pickout: 0.0032	 decision: 0.0171	 get_bound: 0.2014	 add_domain: 0.0012
Current lb:-1.7894620895385742
164 neurons visited
0 diving domains visited
Cumulative time: 3.7734968662261963

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 586], [1, 586], [1, 586], [2, 17], [2, 65], [1, 586], [2, 17], [1, 233], [1, 586], [1, 586]]
single_node_split: True
regular batch size: 2*37, diving batch size 1*0
best_l after optimization: 0.3148765563964844 with beta sum per layer: [0.0, 0.5574202537536621, 36.07987594604492]
optimal alpha/beta time: 0.1926436424255371
This batch time : update_bounds func: 0.2042	 prepare: 0.0054	 bound: 0.1928	 transfer: 0.0027	 finalize: 0.0032
Accumulated time: update_bounds func: 2.1537	 prepare: 0.0232	 bound: 2.1077	 transfer: 0.0027	 finalize: 0.0115
batch bounding time:  0.2043778896331787
Current worst splitting domains [lb, ub] (depth):
[-1.46432, 93.651093] (9), [-1.24226, 93.651093] (9), [-0.90101, 93.651093] (9), [-0.85721, 93.651093] (9), [-0.84461, 93.651093] (9), [-0.81585, 93.651093] (9), [-0.79558, 93.651093] (9), [-0.78557, 93.651093] (9), [-0.67573, 93.651093] (9), [-0.60812, 93.651093] (9), [-0.52045, 93.651093] (9), [-0.51096, 93.651093] (9), [-0.45515, 93.651093] (9), [-0.42258, 93.651093] (9), [-0.40001, 93.651093] (9), [-0.30724, 93.651093] (9), [-0.29299, 93.651093] (9), [-0.27510, 93.651093] (9), [-0.23525, 93.651093] (9), [-0.22968, 93.651093] (9), 
length of domains: 31
Total time: 0.2289	 pickout: 0.0045	 decision: 0.0187	 get_bound: 0.2045	 add_domain: 0.0011
Current lb:-1.464322566986084
238 neurons visited
0 diving domains visited
Cumulative time: 4.003217458724976

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17], [2, 17], [2, 96], [2, 65], [2, 17], [1, 586], [2, 65], [2, 17], [2, 65], [1, 586]]
single_node_split: True
regular batch size: 2*31, diving batch size 1*0
best_l after optimization: -1.6304206848144531 with beta sum per layer: [0.0, 0.3310164511203766, 25.502613067626953]
optimal alpha/beta time: 0.1894822120666504
This batch time : update_bounds func: 0.1993	 prepare: 0.0048	 bound: 0.1897	 transfer: 0.0018	 finalize: 0.0029
Accumulated time: update_bounds func: 2.3530	 prepare: 0.0280	 bound: 2.2974	 transfer: 0.0018	 finalize: 0.0144
batch bounding time:  0.19939661026000977
Current worst splitting domains [lb, ub] (depth):
[-1.03770, 93.651093] (10), [-0.93460, 93.651093] (10), [-0.81253, 93.651093] (10), [-0.72213, 93.651093] (10), [-0.69377, 93.651093] (10), [-0.62679, 93.651093] (10), [-0.52077, 93.651093] (10), [-0.47955, 93.651093] (10), [-0.45085, 93.651093] (10), [-0.40961, 93.651093] (10), [-0.39415, 93.651093] (10), [-0.38850, 93.651093] (10), [-0.33686, 93.651093] (10), [-0.32590, 93.651093] (10), [-0.32321, 93.651093] (10), [-0.27223, 93.651093] (10), [-0.25143, 93.651093] (10), [-0.24464, 93.651093] (10), [-0.23446, 93.651093] (10), [-0.10865, 93.651093] (10), 
length of domains: 24
Total time: 0.2220	 pickout: 0.0039	 decision: 0.0178	 get_bound: 0.1995	 add_domain: 0.0009
Current lb:-1.037703037261963
300 neurons visited
0 diving domains visited
Cumulative time: 4.225789308547974

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 65], [2, 65], [2, 65], [2, 65], [2, 17], [2, 17], [2, 17], [1, 586], [1, 593], [2, 17]]
single_node_split: True
regular batch size: 2*24, diving batch size 1*0
best_l after optimization: -3.179762363433838 with beta sum per layer: [0.0, 0.2296231985092163, 17.594242095947266]
optimal alpha/beta time: 0.1915898323059082
This batch time : update_bounds func: 0.1993	 prepare: 0.0041	 bound: 0.1918	 transfer: 0.0011	 finalize: 0.0022
Accumulated time: update_bounds func: 2.5523	 prepare: 0.0321	 bound: 2.4891	 transfer: 0.0011	 finalize: 0.0166
batch bounding time:  0.1994645595550537
Current worst splitting domains [lb, ub] (depth):
[-0.88191, 93.651093] (11), [-0.76438, 93.651093] (11), [-0.65672, 93.651093] (11), [-0.55111, 93.651093] (11), [-0.35257, 93.651093] (11), [-0.31732, 93.651093] (11), [-0.24630, 93.651093] (11), [-0.17514, 93.651093] (11), [-0.14016, 93.651093] (11), [-0.08639, 93.651093] (11), [-0.08440, 93.651093] (11), [-0.07224, 93.651093] (11), [-0.05268, 93.651093] (11), [-0.05125, 93.651093] (11), [-0.03046, 93.651093] (11), [-0.02539, 93.651093] (11), [-0.00916, 93.651093] (11), 
length of domains: 17
Total time: 0.2208	 pickout: 0.0030	 decision: 0.0175	 get_bound: 0.1995	 add_domain: 0.0007
Current lb:-0.8819093704223633
348 neurons visited
0 diving domains visited
Cumulative time: 4.447106838226318

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 593], [1, 141], [1, 593], [1, 141], [2, 65], [2, 65], [1, 593], [1, 593], [2, 65], [1, 593]]
single_node_split: True
regular batch size: 2*17, diving batch size 1*0
best_l after optimization: -2.4602866172790527 with beta sum per layer: [0.0, 0.2945441007614136, 11.243989944458008]
optimal alpha/beta time: 0.1898791790008545
This batch time : update_bounds func: 0.1958	 prepare: 0.0031	 bound: 0.1901	 transfer: 0.0009	 finalize: 0.0017
Accumulated time: update_bounds func: 2.7481	 prepare: 0.0352	 bound: 2.6792	 transfer: 0.0009	 finalize: 0.0183
batch bounding time:  0.19594669342041016
Current worst splitting domains [lb, ub] (depth):
[-0.83171, 93.651093] (12), [-0.60592, 93.651093] (12), [-0.37368, 93.651093] (12), [-0.34316, 93.651093] (12), [-0.32377, 93.651093] (12), [-0.22979, 93.651093] (12), [-0.18321, 93.651093] (12), [-0.15250, 93.651093] (12), [-0.13586, 93.651093] (12), [-0.10141, 93.651093] (12), [-0.09287, 93.651093] (12), [-0.09082, 93.651093] (12), 
length of domains: 12
Total time: 0.2153	 pickout: 0.0025	 decision: 0.0163	 get_bound: 0.1960	 add_domain: 0.0005
Current lb:-0.8317108154296875
382 neurons visited
0 diving domains visited
Cumulative time: 4.662768363952637

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 141], [1, 141], [1, 593], [1, 593], [1, 141], [1, 593], [1, 141], [1, 233], [1, 141], [1, 141]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: -0.6040053367614746 with beta sum per layer: [0.0, 0.766660213470459, 4.125075817108154]
optimal alpha/beta time: 0.21099591255187988
This batch time : update_bounds func: 0.2169	 prepare: 0.0033	 bound: 0.2112	 transfer: 0.0011	 finalize: 0.0013
Accumulated time: update_bounds func: 2.9650	 prepare: 0.0385	 bound: 2.8904	 transfer: 0.0011	 finalize: 0.0196
batch bounding time:  0.21708440780639648
Current worst splitting domains [lb, ub] (depth):
[-0.47243, 93.651093] (13), [-0.40116, 93.651093] (13), [-0.31446, 93.651093] (13), [-0.30200, 93.651093] (13), [-0.29356, 93.651093] (13), [-0.16589, 93.651093] (13), [-0.10867, 93.651093] (13), [-0.04454, 93.651093] (13), 
length of domains: 8
Total time: 0.2379	 pickout: 0.0019	 decision: 0.0185	 get_bound: 0.2171	 add_domain: 0.0004
Current lb:-0.4724297523498535
406 neurons visited
0 diving domains visited
Cumulative time: 4.9009928703308105

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 632], [1, 632], [1, 632], [1, 636], [1, 632], [2, 50], [1, 632], [2, 50]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -1.1551485061645508 with beta sum per layer: [0.0, 0.6955176591873169, 2.152453899383545]
optimal alpha/beta time: 0.20885229110717773
This batch time : update_bounds func: 0.2132	 prepare: 0.0021	 bound: 0.2091	 transfer: 0.0010	 finalize: 0.0010
Accumulated time: update_bounds func: 3.1782	 prepare: 0.0406	 bound: 3.0995	 transfer: 0.0010	 finalize: 0.0206
batch bounding time:  0.2133791446685791
Current worst splitting domains [lb, ub] (depth):
[-0.16966, 93.651093] (14), [-0.15326, 93.651093] (14), [-0.08243, 93.651093] (14), [-0.07234, 93.651093] (14), [-0.00144, 93.651093] (14), 
length of domains: 5
Total time: 0.2311	 pickout: 0.0014	 decision: 0.0160	 get_bound: 0.2134	 add_domain: 0.0003
Current lb:-0.16965723037719727
422 neurons visited
0 diving domains visited
Cumulative time: 5.13240122795105

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 181], [2, 47], [2, 47], [2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -2.832075595855713 with beta sum per layer: [0.0, 0.22328633069992065, 0.8272247910499573]
optimal alpha/beta time: 0.18550705909729004
This batch time : update_bounds func: 0.1887	 prepare: 0.0017	 bound: 0.1857	 transfer: 0.0007	 finalize: 0.0005
Accumulated time: update_bounds func: 3.3670	 prepare: 0.0423	 bound: 3.2852	 transfer: 0.0007	 finalize: 0.0211
batch bounding time:  0.18888497352600098
Current worst splitting domains [lb, ub] (depth):
[-0.08369, 93.651093] (15), 
length of domains: 1
Total time: 0.2064	 pickout: 0.0012	 decision: 0.0163	 get_bound: 0.1889	 add_domain: 0.0001
Current lb:-0.08368730545043945
432 neurons visited
0 diving domains visited
Cumulative time: 5.338990211486816

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 632]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5065674781799316 with beta sum per layer: [0.0, 0.0, 0.8573238253593445]
optimal alpha/beta time: 0.006639719009399414
This batch time : update_bounds func: 0.0085	 prepare: 0.0011	 bound: 0.0068	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 3.3755	 prepare: 0.0434	 bound: 3.2920	 transfer: 0.0004	 finalize: 0.0213
batch bounding time:  0.008515119552612305
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0238	 pickout: 0.0006	 decision: 0.0147	 get_bound: 0.0085	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 5.362915277481079

Image 113 pidx 7 verify end, final lower bound 999, upper bound 93.65109252929688, time: 5.409479141235352
113 999
##### [0:113] Tested against 3 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.7321596145629883 with beta sum per layer: []
optimal alpha/beta time: 0.7835328578948975
alpha-CROWN with fixed intermediate bounds: tensor([[-1.7322]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.7321596145629883
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 1]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.042432308197021484 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.19642925262451172
This batch time : update_bounds func: 0.1982	 prepare: 0.0011	 bound: 0.1966	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 3.5737	 prepare: 0.0445	 bound: 3.4886	 transfer: 0.0004	 finalize: 0.0215
batch bounding time:  0.19837522506713867
Current worst splitting domains [lb, ub] (depth):
[-1.44239, 97.267838] (1), 
length of domains: 1
Total time: 0.2145	 pickout: 0.0006	 decision: 0.0154	 get_bound: 0.1984	 add_domain: 0.0001
Current lb:-1.4423894882202148
2 neurons visited
0 diving domains visited
Cumulative time: 1.0092923641204834

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.0512762069702148 with beta sum per layer: [0.0, 0.0, 0.33660417795181274]
optimal alpha/beta time: 0.19669723510742188
This batch time : update_bounds func: 0.1986	 prepare: 0.0011	 bound: 0.1969	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 3.7723	 prepare: 0.0456	 bound: 3.6854	 transfer: 0.0004	 finalize: 0.0217
batch bounding time:  0.19862627983093262
Current worst splitting domains [lb, ub] (depth):
[-0.91382, 97.267838] (2), [-0.13746, 97.267838] (2), 
length of domains: 2
Total time: 0.2156	 pickout: 0.0006	 decision: 0.0162	 get_bound: 0.1986	 add_domain: 0.0001
Current lb:-0.9138164520263672
4 neurons visited
0 diving domains visited
Cumulative time: 1.2249009609222412

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 10]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.301419734954834 with beta sum per layer: [0.0, 0.0, 0.719226062297821]
optimal alpha/beta time: 0.19660711288452148
This batch time : update_bounds func: 0.1987	 prepare: 0.0012	 bound: 0.1968	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 3.9710	 prepare: 0.0468	 bound: 3.8822	 transfer: 0.0004	 finalize: 0.0220
batch bounding time:  0.19879770278930664
Current worst splitting domains [lb, ub] (depth):
[-0.49305, 97.267838] (3), 
length of domains: 1
Total time: 0.2151	 pickout: 0.0006	 decision: 0.0156	 get_bound: 0.1988	 add_domain: 0.0001
Current lb:-0.4930539131164551
8 neurons visited
0 diving domains visited
Cumulative time: 1.4400651454925537

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 10]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.04742765426635742 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1971118450164795
This batch time : update_bounds func: 0.1989	 prepare: 0.0011	 bound: 0.1973	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 4.1699	 prepare: 0.0479	 bound: 4.0795	 transfer: 0.0004	 finalize: 0.0221
batch bounding time:  0.1990044116973877
Current worst splitting domains [lb, ub] (depth):
[-0.22438, 97.267838] (4), 
length of domains: 1
Total time: 0.2149	 pickout: 0.0006	 decision: 0.0153	 get_bound: 0.1990	 add_domain: 0.0001
Current lb:-0.2243814468383789
10 neurons visited
0 diving domains visited
Cumulative time: 1.655022382736206

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 36]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.45538949966430664 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.18957257270812988
This batch time : update_bounds func: 0.1913	 prepare: 0.0010	 bound: 0.1897	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.3613	 prepare: 0.0490	 bound: 4.2692	 transfer: 0.0003	 finalize: 0.0223
batch bounding time:  0.1913926601409912
Current worst splitting domains [lb, ub] (depth):
[-0.01042, 97.267838] (5), 
length of domains: 1
Total time: 0.2066	 pickout: 0.0006	 decision: 0.0146	 get_bound: 0.1914	 add_domain: 0.0001
Current lb:-0.010419845581054688
12 neurons visited
0 diving domains visited
Cumulative time: 1.8616552352905273

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.0194511413574219 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006543874740600586
This batch time : update_bounds func: 0.0083	 prepare: 0.0010	 bound: 0.0067	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.3695	 prepare: 0.0500	 bound: 4.2759	 transfer: 0.0003	 finalize: 0.0225
batch bounding time:  0.008283615112304688
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0253	 pickout: 0.0005	 decision: 0.0165	 get_bound: 0.0083	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.887014627456665

Image 113 pidx 3 verify end, final lower bound 999, upper bound 97.26783752441406, time: 1.9321808815002441
113 999
##### [0:113] Tested against 8 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.3317203521728516 with beta sum per layer: []
optimal alpha/beta time: 0.7909336090087891
alpha-CROWN with fixed intermediate bounds: tensor([[-1.3317]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.3317203521728516
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 58]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9886674880981445 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1969892978668213
This batch time : update_bounds func: 0.1988	 prepare: 0.0011	 bound: 0.1972	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 4.5683	 prepare: 0.0510	 bound: 4.4731	 transfer: 0.0004	 finalize: 0.0227
batch bounding time:  0.19887804985046387
Current worst splitting domains [lb, ub] (depth):
[-1.07317, 97.668282] (1), 
length of domains: 1
Total time: 0.2147	 pickout: 0.0006	 decision: 0.0152	 get_bound: 0.1989	 add_domain: 0.0001
Current lb:-1.073166847229004
2 neurons visited
0 diving domains visited
Cumulative time: 1.0229010581970215

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 65]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.6419239044189453 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.19560742378234863
This batch time : update_bounds func: 0.1974	 prepare: 0.0011	 bound: 0.1958	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 4.7658	 prepare: 0.0521	 bound: 4.6688	 transfer: 0.0004	 finalize: 0.0229
batch bounding time:  0.19751596450805664
Current worst splitting domains [lb, ub] (depth):
[-0.75621, 97.668282] (2), 
length of domains: 1
Total time: 0.2136	 pickout: 0.0006	 decision: 0.0155	 get_bound: 0.1975	 add_domain: 0.0001
Current lb:-0.7562122344970703
4 neurons visited
0 diving domains visited
Cumulative time: 1.2365591526031494

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.10809564590454102 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.19325876235961914
This batch time : update_bounds func: 0.1951	 prepare: 0.0011	 bound: 0.1934	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 4.9609	 prepare: 0.0532	 bound: 4.8623	 transfer: 0.0004	 finalize: 0.0230
batch bounding time:  0.1953568458557129
Current worst splitting domains [lb, ub] (depth):
[-0.09988, 97.668282] (3), 
length of domains: 1
Total time: 0.2113	 pickout: 0.0006	 decision: 0.0152	 get_bound: 0.1954	 add_domain: 0.0001
Current lb:-0.099884033203125
6 neurons visited
0 diving domains visited
Cumulative time: 1.447929859161377

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 50]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.9895186424255371 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.0064961910247802734
This batch time : update_bounds func: 0.0082	 prepare: 0.0010	 bound: 0.0066	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.9691	 prepare: 0.0543	 bound: 4.8689	 transfer: 0.0003	 finalize: 0.0232
batch bounding time:  0.008278131484985352
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0239	 pickout: 0.0007	 decision: 0.0149	 get_bound: 0.0083	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.4719345569610596

Image 113 pidx 8 verify end, final lower bound 999, upper bound 97.66828155517578, time: 1.5145580768585205
113 999
##### [0:113] Tested against 4 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.2125186920166016 with beta sum per layer: []
optimal alpha/beta time: 0.8415579795837402
alpha-CROWN with fixed intermediate bounds: tensor([[-2.2125]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.2125186920166016
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.5149431228637695 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.20810818672180176
This batch time : update_bounds func: 0.2100	 prepare: 0.0011	 bound: 0.2083	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 5.1791	 prepare: 0.0554	 bound: 5.0772	 transfer: 0.0004	 finalize: 0.0234
batch bounding time:  0.21012091636657715
Current worst splitting domains [lb, ub] (depth):
[-1.69296, 96.787483] (1), 
length of domains: 1
Total time: 0.2266	 pickout: 0.0007	 decision: 0.0158	 get_bound: 0.2101	 add_domain: 0.0001
Current lb:-1.6929607391357422
2 neurons visited
0 diving domains visited
Cumulative time: 1.0802741050720215

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 7]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9455318450927734 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.20592856407165527
This batch time : update_bounds func: 0.2077	 prepare: 0.0010	 bound: 0.2061	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 5.3869	 prepare: 0.0564	 bound: 5.2833	 transfer: 0.0004	 finalize: 0.0236
batch bounding time:  0.20786070823669434
Current worst splitting domains [lb, ub] (depth):
[-1.13734, 96.787483] (2), 
length of domains: 1
Total time: 0.2233	 pickout: 0.0005	 decision: 0.0148	 get_bound: 0.2079	 add_domain: 0.0001
Current lb:-1.1373367309570312
4 neurons visited
0 diving domains visited
Cumulative time: 1.3036220073699951

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 233]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.9943380355834961 with beta sum per layer: [0.0, 0.06430651247501373, 0.0]
optimal alpha/beta time: 0.21762609481811523
This batch time : update_bounds func: 0.2196	 prepare: 0.0012	 bound: 0.2178	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 5.6064	 prepare: 0.0576	 bound: 5.5011	 transfer: 0.0004	 finalize: 0.0238
batch bounding time:  0.2196974754333496
Current worst splitting domains [lb, ub] (depth):
[-0.65281, 96.787483] (3), [-0.34153, 96.787483] (3), 
length of domains: 2
Total time: 0.2353	 pickout: 0.0005	 decision: 0.0149	 get_bound: 0.2197	 add_domain: 0.0001
Current lb:-0.6528072357177734
6 neurons visited
0 diving domains visited
Cumulative time: 1.5389611721038818

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 586], [1, 586]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.1850719451904297 with beta sum per layer: [0.0, 0.1323668658733368, 0.0]
optimal alpha/beta time: 0.22272968292236328
This batch time : update_bounds func: 0.2251	 prepare: 0.0013	 bound: 0.2229	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.8315	 prepare: 0.0589	 bound: 5.7240	 transfer: 0.0005	 finalize: 0.0241
batch bounding time:  0.22521185874938965
Current worst splitting domains [lb, ub] (depth):
[-0.43651, 96.787483] (4), [-0.12199, 96.787483] (4), 
length of domains: 2
Total time: 0.2414	 pickout: 0.0006	 decision: 0.0154	 get_bound: 0.2252	 add_domain: 0.0001
Current lb:-0.4365091323852539
10 neurons visited
0 diving domains visited
Cumulative time: 1.780433177947998

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 33], [2, 33]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.8862895965576172 with beta sum per layer: [0.0, 0.1361207216978073, 0.0]
optimal alpha/beta time: 0.21674180030822754
This batch time : update_bounds func: 0.2189	 prepare: 0.0012	 bound: 0.2170	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 6.0504	 prepare: 0.0601	 bound: 5.9410	 transfer: 0.0004	 finalize: 0.0244
batch bounding time:  0.21905803680419922
Current worst splitting domains [lb, ub] (depth):
[-0.15323, 96.787483] (5), 
length of domains: 1
Total time: 0.2345	 pickout: 0.0007	 decision: 0.0147	 get_bound: 0.2191	 add_domain: 0.0001
Current lb:-0.1532268524169922
14 neurons visited
0 diving domains visited
Cumulative time: 2.0149779319763184

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 232]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.6589818000793457 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006598949432373047
This batch time : update_bounds func: 0.0085	 prepare: 0.0011	 bound: 0.0068	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 6.0589	 prepare: 0.0612	 bound: 5.9478	 transfer: 0.0004	 finalize: 0.0245
batch bounding time:  0.008484363555908203
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0236	 pickout: 0.0005	 decision: 0.0145	 get_bound: 0.0085	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.0386154651641846

Image 113 pidx 4 verify end, final lower bound 999, upper bound 96.78748321533203, time: 2.083197593688965
113 999
##### [0:113] Tested against 2 ######
Model prediction is: tensor([[-4.1227, -5.8338, -1.1651,  2.5555,  1.7880, -3.6164, -8.9669,  4.6731,
          1.4478, 13.2568]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized./home/shiqi/CROWN-GENERAL/complete_verifier/utils.py:391: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  eps_temp = torch.tensor(eps_temp / std).reshape(1, -1, 1, 1)

setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 13, 13]) != torch.Size([2, 9, 1, 16, 13, 13]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 5, 5]) != torch.Size([2, 9, 1, 32, 5, 5]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 13, 13])
1 /11 torch.Size([1, 32, 5, 5])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.2675952911376953 with beta sum per layer: []
optimal alpha/beta time: 0.8754556179046631
alpha-CROWN with fixed intermediate bounds: tensor([[-1.2676]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.2675952911376953
layer 0 size torch.Size([2704]) unstable 942
layer 1 size torch.Size([800]) unstable 146
layer 2 size torch.Size([100]) unstable 33
# of unstable neurons: 1121
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 17]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.5161352157592773 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.21606659889221191
This batch time : update_bounds func: 0.2179	 prepare: 0.0011	 bound: 0.2162	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 6.2768	 prepare: 0.0623	 bound: 6.1640	 transfer: 0.0004	 finalize: 0.0247
batch bounding time:  0.2180323600769043
Current worst splitting domains [lb, ub] (depth):
[-0.66652, 97.732407] (1), 
length of domains: 1
Total time: 0.2340	 pickout: 0.0006	 decision: 0.0153	 get_bound: 0.2180	 add_domain: 0.0001
Current lb:-0.6665153503417969
2 neurons visited
0 diving domains visited
Cumulative time: 1.1208693981170654

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 89]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.6300048828125 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006858348846435547
This batch time : update_bounds func: 0.0087	 prepare: 0.0011	 bound: 0.0070	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 6.2855	 prepare: 0.0634	 bound: 6.1710	 transfer: 0.0003	 finalize: 0.0249
batch bounding time:  0.008704662322998047
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0246	 pickout: 0.0005	 decision: 0.0153	 get_bound: 0.0087	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.1455578804016113

Image 113 pidx 2 verify end, final lower bound 999, upper bound 97.73240661621094, time: 1.1880097389221191
113 999
##### [0:113] Tested against 5 ######
Initial alpha-CROWN verified for label 5 with bound 3.5305137634277344
Image 113 pidx 5 verify end, final lower bound 3.5305137634277344, upper bound inf, time: 0.00032782554626464844
113 3.5305137634277344
##### [0:113] Tested against 0 ######
Initial alpha-CROWN verified for label 0 with bound 4.191802024841309
Image 113 pidx 0 verify end, final lower bound 4.191802024841309, upper bound inf, time: 0.00031828880310058594
113 4.191802024841309
##### [0:113] Tested against 1 ######
Initial alpha-CROWN verified for label 1 with bound 1.6687288284301758
Image 113 pidx 1 verify end, final lower bound 1.6687288284301758, upper bound inf, time: 0.0003695487976074219
113 1.6687288284301758
##### [0:113] Tested against 6 ######
Initial alpha-CROWN verified for label 6 with bound 6.522149085998535
Image 113 pidx 6 verify end, final lower bound 6.522149085998535, upper bound inf, time: 0.0003426074981689453
113 6.522149085998535
##### [0:113] Tested against 9 ######
correct label, skip!
[[113.           0.           0.           1.87425399   0.
   -3.                  inf          inf]
 [113.           0.           0.          13.6939013    0.
   -1.                  inf          inf]
 [113.         999.         434.           5.40947914   0.
    7.          93.65109253   2.08792782]
 [113.         999.          14.           1.93218088   0.
    3.          97.26783752   6.09357357]
 [113.         999.           8.           1.51455808   0.
    8.          97.66828156   7.1545639 ]
 [113.         999.          16.           2.08319759   0.
    4.          96.78748322   9.06057453]
 [113.         999.           4.           1.18800974   0.
    2.          97.73240662   9.46487522]
 [113.           3.53051376   0.           0.00032783   0.
    5.                  inf  11.65124416]
 [113.           4.19180202   0.           0.00031829   0.
    0.                  inf  11.90815926]
 [113.           1.66872883   0.           0.00036955   0.
    1.                  inf  12.79525471]
 [113.           6.52214909   0.           0.00034261   0.
    6.                  inf  17.76874352]
 [113.           0.           0.           0.           0.
    9.                  inf          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 25.82268500328064

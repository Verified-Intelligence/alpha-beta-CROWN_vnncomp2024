Experiments at Sun Oct 31 20:04:34 2021 on huan-Naples-server
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.1340)
############################
epsilon after preprocession: 0.30000001192092896, data_max = tensor([[[[1.]]]]), data_min = tensor([[[[0.]]]])
Task length: 1
saving results to Verified_ret_[mnist_cnn_4layer]_start=69_end=70_iter=20_b=1024_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 69 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  7  correct label  7 logits tensor([ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
          5.7896,  -0.5153,   2.6719], device='cuda:0',
       grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 7, Tested against: ['all'] ######
pgd prediction: tensor([ -3.6400,  -5.8007,  -4.6005,  -2.2296,  -0.6381,  -3.7662, -10.0016,
          2.9392,   0.1814,   2.3079], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
attack margin tensor([ 6.5792,  8.7399,  7.5398,  5.1688,  3.5773,  6.7055, 12.9409,     inf,
         2.7578,  0.6314], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-1.3933, -1.4213, -0.7456, -1.7482, -3.3693, -3.1006, -1.6072, -4.8603,
         -3.6773]], device='cuda:0') None
best_l after optimization: -7.236372470855713 with beta sum per layer: []
optimal alpha/beta time: 4.3427653312683105
initial alpha-CROWN bounds: tensor([[ 1.1496,  2.7642,  2.1769,  0.3948, -0.0447,  0.2932,  3.9428, -1.8664,
         -1.5741]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:69] Tested against 9 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.5716962814331055 with beta sum per layer: []
optimal alpha/beta time: 1.0891664028167725
alpha-CROWN with fixed intermediate bounds: tensor([[-1.5717]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.5716962814331055
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 2.0565543174743652 with beta sum per layer: [0.0, 0.0, 0.28172534704208374]
optimal alpha/beta time: 0.5248956680297852
This batch time : update_bounds func: 0.5267	 prepare: 0.0010	 bound: 0.5251	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.5267	 prepare: 0.0010	 bound: 0.5251	 transfer: 0.0004	 finalize: 0.0002
batch bounding time:  0.5267846584320068
Current worst splitting domains [lb, ub] (depth):
[-1.40547, 97.428307] (1), [-0.65109, 97.428307] (1), 
length of domains: 2
Total time: 0.5415	 pickout: 0.0006	 decision: 0.0140	 get_bound: 0.5268	 add_domain: 0.0001
Current lb:-1.4054661989212036
2 neurons visited
0 diving domains visited
Cumulative time: 1.9864368438720703

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 2.5164995193481445 with beta sum per layer: [0.0, 0.0, 1.1600483655929565]
optimal alpha/beta time: 0.17709636688232422
This batch time : update_bounds func: 0.1791	 prepare: 0.0011	 bound: 0.1773	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.7058	 prepare: 0.0022	 bound: 0.7023	 transfer: 0.0004	 finalize: 0.0005
batch bounding time:  0.17923998832702637
Current worst splitting domains [lb, ub] (depth):
[-1.31700, 97.428307] (2), [-0.67129, 97.428307] (2), [-0.45999, 97.428307] (2), [-0.06821, 97.428307] (2), 
length of domains: 4
Total time: 0.1939	 pickout: 0.0006	 decision: 0.0139	 get_bound: 0.1793	 add_domain: 0.0001
Current lb:-1.3170031309127808
6 neurons visited
0 diving domains visited
Cumulative time: 2.180438280105591

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 56], [2, 56], [2, 56], [2, 56]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 2.710672378540039 with beta sum per layer: [0.0, 0.0, 3.091413974761963]
optimal alpha/beta time: 0.17942237854003906
This batch time : update_bounds func: 0.1822	 prepare: 0.0014	 bound: 0.1796	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 0.8880	 prepare: 0.0036	 bound: 0.8819	 transfer: 0.0005	 finalize: 0.0012
batch bounding time:  0.1822826862335205
Current worst splitting domains [lb, ub] (depth):
[-1.17354, 97.428307] (3), [-0.95828, 97.428307] (3), [-0.44531, 97.428307] (3), [-0.32506, 97.428307] (3), [-0.23134, 97.428307] (3), 
length of domains: 5
Total time: 0.1974	 pickout: 0.0008	 decision: 0.0141	 get_bound: 0.1823	 add_domain: 0.0002
Current lb:-1.1735366582870483
14 neurons visited
0 diving domains visited
Cumulative time: 2.3779380321502686

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 96], [2, 85], [2, 85], [2, 85]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 3.047969341278076 with beta sum per layer: [0.0, 0.0, 4.352038383483887]
optimal alpha/beta time: 0.18156886100769043
This batch time : update_bounds func: 0.1845	 prepare: 0.0015	 bound: 0.1817	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 1.0725	 prepare: 0.0051	 bound: 1.0636	 transfer: 0.0005	 finalize: 0.0018
batch bounding time:  0.184586763381958
Current worst splitting domains [lb, ub] (depth):
[-1.09427, 97.428307] (4), [-0.86764, 97.428307] (4), [-0.74036, 97.428307] (4), [-0.29255, 97.428307] (4), [-0.28396, 97.428307] (4), [-0.14996, 97.428307] (4), [-0.09012, 97.428307] (4), 
length of domains: 7
Total time: 0.2002	 pickout: 0.0009	 decision: 0.0145	 get_bound: 0.1846	 add_domain: 0.0003
Current lb:-1.0942656993865967
24 neurons visited
0 diving domains visited
Cumulative time: 2.578328847885132

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [2, 85], [2, 96], [2, 33], [2, 96]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 3.8356263637542725 with beta sum per layer: [0.0, 0.0, 5.386987209320068]
optimal alpha/beta time: 0.17957544326782227
This batch time : update_bounds func: 0.1831	 prepare: 0.0018	 bound: 0.1797	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 1.2556	 prepare: 0.0068	 bound: 1.2434	 transfer: 0.0006	 finalize: 0.0027
batch bounding time:  0.18321585655212402
Current worst splitting domains [lb, ub] (depth):
[-0.91368, 97.428307] (5), [-0.85111, 97.428307] (5), [-0.69815, 97.428307] (5), [-0.53701, 97.428307] (5), [-0.49623, 97.428307] (5), [-0.32880, 97.428307] (5), [-0.15933, 97.428307] (5), [-0.06028, 97.428307] (5), [-0.03470, 97.428307] (5), 
length of domains: 9
Total time: 0.2003	 pickout: 0.0011	 decision: 0.0155	 get_bound: 0.1832	 add_domain: 0.0004
Current lb:-0.9136841297149658
38 neurons visited
0 diving domains visited
Cumulative time: 2.7787728309631348

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33]]
single_node_split: True
regular batch size: 2*9, diving batch size 1*0
best_l after optimization: 4.191136360168457 with beta sum per layer: [0.0, 0.0, 7.707520008087158]
optimal alpha/beta time: 0.18147969245910645
This batch time : update_bounds func: 0.1856	 prepare: 0.0020	 bound: 0.1816	 transfer: 0.0007	 finalize: 0.0011
Accumulated time: update_bounds func: 1.4411	 prepare: 0.0089	 bound: 1.4250	 transfer: 0.0007	 finalize: 0.0039
batch bounding time:  0.18569612503051758
Current worst splitting domains [lb, ub] (depth):
[-0.76740, 97.428307] (6), [-0.70282, 97.428307] (6), [-0.68241, 97.428307] (6), [-0.62261, 97.428307] (6), [-0.58214, 97.428307] (6), [-0.34095, 97.428307] (6), [-0.33280, 97.428307] (6), [-0.30777, 97.428307] (6), [-0.21940, 97.428307] (6), [-0.12674, 97.428307] (6), [-0.07855, 97.428307] (6), [-0.02949, 97.428307] (6), [-0.00393, 97.428307] (6), 
length of domains: 13
Total time: 0.2033	 pickout: 0.0013	 decision: 0.0158	 get_bound: 0.1857	 add_domain: 0.0005
Current lb:-0.767396092414856
56 neurons visited
0 diving domains visited
Cumulative time: 2.982286214828491

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 603], [1, 16], [1, 72], [1, 72], [1, 603], [1, 603], [1, 72], [1, 603], [1, 603], [1, 603]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: 6.4816412925720215 with beta sum per layer: [0.0, 0.4394066333770752, 10.202406883239746]
optimal alpha/beta time: 0.18096137046813965
This batch time : update_bounds func: 0.1861	 prepare: 0.0025	 bound: 0.1811	 transfer: 0.0009	 finalize: 0.0015
Accumulated time: update_bounds func: 1.6273	 prepare: 0.0114	 bound: 1.6061	 transfer: 0.0009	 finalize: 0.0054
batch bounding time:  0.18624281883239746
Current worst splitting domains [lb, ub] (depth):
[-0.71400, 97.428307] (7), [-0.64642, 97.428307] (7), [-0.62699, 97.428307] (7), [-0.57620, 97.428307] (7), [-0.55027, 97.428307] (7), [-0.52869, 97.428307] (7), [-0.50351, 97.428307] (7), [-0.49288, 97.428307] (7), [-0.48987, 97.428307] (7), [-0.42445, 97.428307] (7), [-0.27634, 97.428307] (7), [-0.23776, 97.428307] (7), [-0.21061, 97.428307] (7), [-0.18493, 97.428307] (7), [-0.15509, 97.428307] (7), [-0.14515, 97.428307] (7), [-0.14051, 97.428307] (7), [-0.04498, 97.428307] (7), [-0.01117, 97.428307] (7), 
length of domains: 19
Total time: 0.2129	 pickout: 0.0017	 decision: 0.0242	 get_bound: 0.1863	 add_domain: 0.0007
Current lb:-0.7139954566955566
82 neurons visited
0 diving domains visited
Cumulative time: 3.1954166889190674

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 16], [1, 72], [1, 16], [1, 16], [1, 16], [1, 16], [1, 16], [1, 72], [1, 16], [1, 16]]
single_node_split: True
regular batch size: 2*19, diving batch size 1*0
best_l after optimization: 8.962986946105957 with beta sum per layer: [0.0, 4.543068885803223, 10.497247695922852]
optimal alpha/beta time: 0.18448877334594727
This batch time : update_bounds func: 0.1914	 prepare: 0.0035	 bound: 0.1847	 transfer: 0.0010	 finalize: 0.0021
Accumulated time: update_bounds func: 1.8187	 prepare: 0.0150	 bound: 1.7908	 transfer: 0.0010	 finalize: 0.0075
batch bounding time:  0.19154715538024902
Current worst splitting domains [lb, ub] (depth):
[-0.66191, 97.428307] (8), [-0.56958, 97.428307] (8), [-0.53605, 97.428307] (8), [-0.52872, 97.428307] (8), [-0.50506, 97.428307] (8), [-0.50320, 97.428307] (8), [-0.47819, 97.428307] (8), [-0.47730, 97.428307] (8), [-0.45399, 97.428307] (8), [-0.44976, 97.428307] (8), [-0.43374, 97.428307] (8), [-0.36990, 97.428307] (8), [-0.36762, 97.428307] (8), [-0.36345, 97.428307] (8), [-0.31734, 97.428307] (8), [-0.30988, 97.428307] (8), [-0.30395, 97.428307] (8), [-0.29915, 97.428307] (8), [-0.27455, 97.428307] (8), [-0.25174, 97.428307] (8), 
length of domains: 29
Total time: 0.2118	 pickout: 0.0023	 decision: 0.0167	 get_bound: 0.1916	 add_domain: 0.0013
Current lb:-0.6619149446487427
120 neurons visited
0 diving domains visited
Cumulative time: 3.4076039791107178

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 72], [1, 72], [1, 603], [1, 603], [1, 603], [1, 603], [1, 72], [1, 72], [2, 8], [1, 72]]
single_node_split: True
regular batch size: 2*29, diving batch size 1*0
best_l after optimization: 11.397089004516602 with beta sum per layer: [0.0, 7.4482622146606445, 10.66647720336914]
optimal alpha/beta time: 0.18079471588134766
This batch time : update_bounds func: 0.1909	 prepare: 0.0050	 bound: 0.1810	 transfer: 0.0016	 finalize: 0.0031
Accumulated time: update_bounds func: 2.0096	 prepare: 0.0200	 bound: 1.9718	 transfer: 0.0016	 finalize: 0.0106
batch bounding time:  0.1910240650177002
Current worst splitting domains [lb, ub] (depth):
[-0.55893, 97.428307] (9), [-0.53373, 97.428307] (9), [-0.48279, 97.428307] (9), [-0.47995, 97.428307] (9), [-0.46512, 97.428307] (9), [-0.45060, 97.428307] (9), [-0.44983, 97.428307] (9), [-0.43992, 97.428307] (9), [-0.39559, 97.428307] (9), [-0.39245, 97.428307] (9), [-0.39055, 97.428307] (9), [-0.37822, 97.428307] (9), [-0.37796, 97.428307] (9), [-0.37138, 97.428307] (9), [-0.36430, 97.428307] (9), [-0.36166, 97.428307] (9), [-0.35881, 97.428307] (9), [-0.34537, 97.428307] (9), [-0.29967, 97.428307] (9), [-0.28707, 97.428307] (9), 
length of domains: 44
Total time: 0.2137	 pickout: 0.0032	 decision: 0.0174	 get_bound: 0.1911	 add_domain: 0.0020
Current lb:-0.558925986289978
178 neurons visited
0 diving domains visited
Cumulative time: 3.6217477321624756

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 81]]
single_node_split: True
regular batch size: 2*44, diving batch size 1*0
best_l after optimization: 11.001947402954102 with beta sum per layer: [0.0, 12.352341651916504, 16.817913055419922]
optimal alpha/beta time: 0.1849527359008789
This batch time : update_bounds func: 0.1996	 prepare: 0.0071	 bound: 0.1851	 transfer: 0.0025	 finalize: 0.0047
Accumulated time: update_bounds func: 2.2092	 prepare: 0.0271	 bound: 2.1569	 transfer: 0.0025	 finalize: 0.0153
batch bounding time:  0.19979381561279297
Current worst splitting domains [lb, ub] (depth):
[-0.49980, 97.428307] (10), [-0.47140, 97.428307] (10), [-0.42281, 97.428307] (10), [-0.41838, 97.428307] (10), [-0.40855, 97.428307] (10), [-0.39426, 97.428307] (10), [-0.38304, 97.428307] (10), [-0.37966, 97.428307] (10), [-0.33904, 97.428307] (10), [-0.33199, 97.428307] (10), [-0.33033, 97.428307] (10), [-0.32449, 97.428307] (10), [-0.32051, 97.428307] (10), [-0.31623, 97.428307] (10), [-0.31469, 97.428307] (10), [-0.30825, 97.428307] (10), [-0.30460, 97.428307] (10), [-0.29482, 97.428307] (10), [-0.28207, 97.428307] (10), [-0.28177, 97.428307] (10), 
length of domains: 65
Total time: 0.2283	 pickout: 0.0047	 decision: 0.0207	 get_bound: 0.1999	 add_domain: 0.0030
Current lb:-0.4998018741607666
266 neurons visited
0 diving domains visited
Cumulative time: 3.8508152961730957

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 275], [1, 275], [2, 81], [2, 81], [1, 275], [2, 81], [2, 81], [1, 275], [1, 603], [2, 81]]
single_node_split: True
regular batch size: 2*65, diving batch size 1*0
best_l after optimization: 5.507574081420898 with beta sum per layer: [0.0, 17.8231258392334, 29.920717239379883]
optimal alpha/beta time: 0.1867682933807373
This batch time : update_bounds func: 0.2076	 prepare: 0.0099	 bound: 0.1870	 transfer: 0.0037	 finalize: 0.0068
Accumulated time: update_bounds func: 2.4168	 prepare: 0.0370	 bound: 2.3439	 transfer: 0.0037	 finalize: 0.0221
batch bounding time:  0.20781183242797852
Current worst splitting domains [lb, ub] (depth):
[-0.45597, 97.428307] (11), [-0.42706, 97.428307] (11), [-0.37598, 97.428307] (11), [-0.37056, 97.428307] (11), [-0.36408, 97.428307] (11), [-0.36207, 97.428307] (11), [-0.34560, 97.428307] (11), [-0.34469, 97.428307] (11), [-0.33599, 97.428307] (11), [-0.32913, 97.428307] (11), [-0.28903, 97.428307] (11), [-0.28490, 97.428307] (11), [-0.28083, 97.428307] (11), [-0.27238, 97.428307] (11), [-0.27007, 97.428307] (11), [-0.26221, 97.428307] (11), [-0.25975, 97.428307] (11), [-0.25628, 97.428307] (11), [-0.25078, 97.428307] (11), [-0.24888, 97.428307] (11), 
length of domains: 67
Total time: 0.2408	 pickout: 0.0067	 decision: 0.0229	 get_bound: 0.2081	 add_domain: 0.0032
Current lb:-0.45597219467163086
396 neurons visited
0 diving domains visited
Cumulative time: 4.092803001403809

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 81], [1, 613], [2, 81], [1, 613], [1, 613], [2, 81], [2, 81], [1, 613]]
single_node_split: True
regular batch size: 2*67, diving batch size 1*0
best_l after optimization: 7.376646041870117 with beta sum per layer: [0.0, 17.881038665771484, 18.679346084594727]
optimal alpha/beta time: 0.18649888038635254
This batch time : update_bounds func: 0.2069	 prepare: 0.0102	 bound: 0.1867	 transfer: 0.0028	 finalize: 0.0070
Accumulated time: update_bounds func: 2.6237	 prepare: 0.0472	 bound: 2.5306	 transfer: 0.0028	 finalize: 0.0291
batch bounding time:  0.2071526050567627
Current worst splitting domains [lb, ub] (depth):
[-0.40330, 97.428307] (12), [-0.37403, 97.428307] (12), [-0.32117, 97.428307] (12), [-0.31073, 97.428307] (12), [-0.28848, 97.428307] (12), [-0.28780, 97.428307] (12), [-0.28123, 97.428307] (12), [-0.27898, 97.428307] (12), [-0.26279, 97.428307] (12), [-0.26235, 97.428307] (12), [-0.26103, 97.428307] (12), [-0.24600, 97.428307] (12), [-0.24328, 97.428307] (12), [-0.23535, 97.428307] (12), [-0.23201, 97.428307] (12), [-0.21777, 97.428307] (12), [-0.20121, 97.428307] (12), [-0.19616, 97.428307] (12), [-0.19439, 97.428307] (12), [-0.19308, 97.428307] (12), 
length of domains: 72
Total time: 0.2404	 pickout: 0.0069	 decision: 0.0224	 get_bound: 0.2074	 add_domain: 0.0037
Current lb:-0.40330469608306885
530 neurons visited
0 diving domains visited
Cumulative time: 4.334353446960449

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 38], [1, 613], [1, 613], [1, 38], [1, 275], [1, 38], [1, 275], [1, 275], [1, 275]]
single_node_split: True
regular batch size: 2*72, diving batch size 1*0
best_l after optimization: 9.12973403930664 with beta sum per layer: [0.0, 13.852376937866211, 13.46272087097168]
optimal alpha/beta time: 0.1879127025604248
This batch time : update_bounds func: 0.2090	 prepare: 0.0107	 bound: 0.1881	 transfer: 0.0025	 finalize: 0.0074
Accumulated time: update_bounds func: 2.8327	 prepare: 0.0579	 bound: 2.7187	 transfer: 0.0025	 finalize: 0.0365
batch bounding time:  0.20919370651245117
Current worst splitting domains [lb, ub] (depth):
[-0.33243, 97.428307] (13), [-0.32563, 97.428307] (13), [-0.29981, 97.428307] (13), [-0.27271, 97.428307] (13), [-0.24891, 97.428307] (13), [-0.24384, 97.428307] (13), [-0.24360, 97.428307] (13), [-0.24064, 97.428307] (13), [-0.23233, 97.428307] (13), [-0.23122, 97.428307] (13), [-0.22572, 97.428307] (13), [-0.22282, 97.428307] (13), [-0.22144, 97.428307] (13), [-0.21829, 97.428307] (13), [-0.20894, 97.428307] (13), [-0.20788, 97.428307] (13), [-0.20742, 97.428307] (13), [-0.20672, 97.428307] (13), [-0.19923, 97.428307] (13), [-0.18080, 97.428307] (13), 
length of domains: 95
Total time: 0.2451	 pickout: 0.0074	 decision: 0.0233	 get_bound: 0.2094	 add_domain: 0.0050
Current lb:-0.3324347734451294
674 neurons visited
0 diving domains visited
Cumulative time: 4.58061146736145

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 416], [1, 38], [1, 416], [1, 416], [2, 79], [1, 38], [1, 163], [1, 416], [1, 38], [1, 416]]
single_node_split: True
regular batch size: 2*95, diving batch size 1*0
best_l after optimization: 6.560596466064453 with beta sum per layer: [0.0, 20.851043701171875, 13.279626846313477]
optimal alpha/beta time: 0.2049722671508789
This batch time : update_bounds func: 0.2333	 prepare: 0.0141	 bound: 0.2052	 transfer: 0.0037	 finalize: 0.0100
Accumulated time: update_bounds func: 3.0660	 prepare: 0.0720	 bound: 2.9238	 transfer: 0.0037	 finalize: 0.0466
batch bounding time:  0.23361849784851074
Current worst splitting domains [lb, ub] (depth):
[-0.30441, 97.428307] (14), [-0.28288, 97.428307] (14), [-0.26966, 97.428307] (14), [-0.24807, 97.428307] (14), [-0.22814, 97.428307] (14), [-0.21375, 97.428307] (14), [-0.21284, 97.428307] (14), [-0.21078, 97.428307] (14), [-0.20250, 97.428307] (14), [-0.19356, 97.428307] (14), [-0.19094, 97.428307] (14), [-0.18818, 97.428307] (14), [-0.18720, 97.428307] (14), [-0.18503, 97.428307] (14), [-0.18327, 97.428307] (14), [-0.18264, 97.428307] (14), [-0.18140, 97.428307] (14), [-0.17802, 97.428307] (14), [-0.17721, 97.428307] (14), [-0.17648, 97.428307] (14), 
length of domains: 104
Total time: 0.2805	 pickout: 0.0098	 decision: 0.0309	 get_bound: 0.2339	 add_domain: 0.0059
Current lb:-0.3044147491455078
864 neurons visited
0 diving domains visited
Cumulative time: 4.862665176391602

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 269], [1, 269], [1, 38], [1, 269], [1, 269], [2, 41], [1, 163], [1, 269], [1, 269], [2, 41]]
single_node_split: True
regular batch size: 2*104, diving batch size 1*0
best_l after optimization: 3.396320343017578 with beta sum per layer: [0.0, 19.269702911376953, 12.087688446044922]
optimal alpha/beta time: 0.20558476448059082
This batch time : update_bounds func: 0.2365	 prepare: 0.0154	 bound: 0.2058	 transfer: 0.0033	 finalize: 0.0117
Accumulated time: update_bounds func: 3.3025	 prepare: 0.0873	 bound: 3.1296	 transfer: 0.0033	 finalize: 0.0582
batch bounding time:  0.23674726486206055
Current worst splitting domains [lb, ub] (depth):
[-0.27447, 97.428307] (15), [-0.24514, 97.428307] (15), [-0.22667, 97.428307] (15), [-0.21436, 97.428307] (15), [-0.18651, 97.428307] (15), [-0.18624, 97.428307] (15), [-0.18261, 97.428307] (15), [-0.17600, 97.428307] (15), [-0.17398, 97.428307] (15), [-0.16806, 97.428307] (15), [-0.16599, 97.428307] (15), [-0.16546, 97.428307] (15), [-0.15284, 97.428307] (15), [-0.15205, 97.428307] (15), [-0.15196, 97.428307] (15), [-0.14793, 97.428307] (15), [-0.14700, 97.428307] (15), [-0.14352, 97.428307] (15), [-0.14211, 97.428307] (15), [-0.14010, 97.428307] (15), 
length of domains: 100
Total time: 0.2890	 pickout: 0.0107	 decision: 0.0348	 get_bound: 0.2371	 add_domain: 0.0064
Current lb:-0.2744748592376709
1072 neurons visited
0 diving domains visited
Cumulative time: 5.153505563735962

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 416], [1, 269], [1, 613], [1, 269], [1, 416], [1, 613], [1, 613], [1, 613], [2, 79]]
single_node_split: True
regular batch size: 2*100, diving batch size 1*0
best_l after optimization: 1.1424275636672974 with beta sum per layer: [0.0, 17.074687957763672, 7.7649335861206055]
optimal alpha/beta time: 0.20441865921020508
This batch time : update_bounds func: 0.2328	 prepare: 0.0149	 bound: 0.2046	 transfer: 0.0024	 finalize: 0.0106
Accumulated time: update_bounds func: 3.5353	 prepare: 0.1022	 bound: 3.3342	 transfer: 0.0024	 finalize: 0.0688
batch bounding time:  0.23310470581054688
Current worst splitting domains [lb, ub] (depth):
[-0.20617, 97.428307] (16), [-0.19339, 97.428307] (16), [-0.19007, 97.428307] (16), [-0.18058, 97.428307] (16), [-0.16201, 97.428307] (16), [-0.15625, 97.428307] (16), [-0.15121, 97.428307] (16), [-0.15016, 97.428307] (16), [-0.13918, 97.428307] (16), [-0.13084, 97.428307] (16), [-0.12564, 97.428307] (16), [-0.11756, 97.428307] (16), [-0.11616, 97.428307] (16), [-0.11146, 97.428307] (16), [-0.11126, 97.428307] (16), [-0.11044, 97.428307] (16), [-0.10918, 97.428307] (16), [-0.10830, 97.428307] (16), [-0.10369, 97.428307] (16), [-0.09895, 97.428307] (16), 
length of domains: 93
Total time: 0.2790	 pickout: 0.0104	 decision: 0.0296	 get_bound: 0.2334	 add_domain: 0.0056
Current lb:-0.20617049932479858
1272 neurons visited
0 diving domains visited
Cumulative time: 5.434137582778931

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79], [1, 38], [2, 79], [2, 79], [1, 710], [2, 79], [1, 422]]
single_node_split: True
regular batch size: 2*93, diving batch size 1*0
best_l after optimization: -5.571506500244141 with beta sum per layer: [0.0, 13.521875381469727, 4.581933975219727]
optimal alpha/beta time: 0.2032182216644287
This batch time : update_bounds func: 0.2301	 prepare: 0.0144	 bound: 0.2034	 transfer: 0.0022	 finalize: 0.0097
Accumulated time: update_bounds func: 3.7654	 prepare: 0.1166	 bound: 3.5376	 transfer: 0.0022	 finalize: 0.0785
batch bounding time:  0.23033714294433594
Current worst splitting domains [lb, ub] (depth):
[-0.16894, 97.428307] (17), [-0.15568, 97.428307] (17), [-0.14961, 97.428307] (17), [-0.13697, 97.428307] (17), [-0.12696, 97.428307] (17), [-0.12332, 97.428307] (17), [-0.11520, 97.428307] (17), [-0.10325, 97.428307] (17), [-0.10208, 97.428307] (17), [-0.09938, 97.428307] (17), [-0.08613, 97.428307] (17), [-0.08574, 97.428307] (17), [-0.08364, 97.428307] (17), [-0.07900, 97.428307] (17), [-0.07760, 97.428307] (17), [-0.07490, 97.428307] (17), [-0.07446, 97.428307] (17), [-0.07400, 97.428307] (17), [-0.07259, 97.428307] (17), [-0.06854, 97.428307] (17), 
length of domains: 69
Total time: 0.2736	 pickout: 0.0097	 decision: 0.0289	 get_bound: 0.2306	 add_domain: 0.0044
Current lb:-0.1689380407333374
1458 neurons visited
0 diving domains visited
Cumulative time: 5.709436416625977

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 710], [1, 710], [1, 163], [1, 163], [2, 41], [1, 710], [1, 163], [1, 710], [1, 163], [1, 710]]
single_node_split: True
regular batch size: 2*69, diving batch size 1*0
best_l after optimization: -3.1036806106567383 with beta sum per layer: [0.0, 8.129753112792969, 2.5626447200775146]
optimal alpha/beta time: 0.19020843505859375
This batch time : update_bounds func: 0.2109	 prepare: 0.0109	 bound: 0.1904	 transfer: 0.0018	 finalize: 0.0075
Accumulated time: update_bounds func: 3.9763	 prepare: 0.1275	 bound: 3.7280	 transfer: 0.0018	 finalize: 0.0860
batch bounding time:  0.21107816696166992
Current worst splitting domains [lb, ub] (depth):
[-0.14163, 97.428307] (18), [-0.13029, 97.428307] (18), [-0.12259, 97.428307] (18), [-0.11165, 97.428307] (18), [-0.09866, 97.428307] (18), [-0.08793, 97.428307] (18), [-0.07975, 97.428307] (18), [-0.07828, 97.428307] (18), [-0.07517, 97.428307] (18), [-0.06427, 97.428307] (18), [-0.05898, 97.428307] (18), [-0.05883, 97.428307] (18), [-0.05826, 97.428307] (18), [-0.05445, 97.428307] (18), [-0.05307, 97.428307] (18), [-0.04914, 97.428307] (18), [-0.04779, 97.428307] (18), [-0.04747, 97.428307] (18), [-0.04643, 97.428307] (18), [-0.04426, 97.428307] (18), 
length of domains: 46
Total time: 0.2796	 pickout: 0.0073	 decision: 0.0579	 get_bound: 0.2113	 add_domain: 0.0031
Current lb:-0.14162921905517578
1596 neurons visited
0 diving domains visited
Cumulative time: 5.9902729988098145

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 163], [1, 163], [1, 710], [1, 710], [2, 41], [1, 710], [1, 38], [1, 710], [2, 41], [2, 41]]
single_node_split: True
regular batch size: 2*46, diving batch size 1*0
best_l after optimization: -2.6738593578338623 with beta sum per layer: [0.0, 4.461662292480469, 1.2652149200439453]
optimal alpha/beta time: 0.1869182586669922
This batch time : update_bounds func: 0.2014	 prepare: 0.0076	 bound: 0.1871	 transfer: 0.0014	 finalize: 0.0050
Accumulated time: update_bounds func: 4.1777	 prepare: 0.1351	 bound: 3.9151	 transfer: 0.0014	 finalize: 0.0910
batch bounding time:  0.20155620574951172
Current worst splitting domains [lb, ub] (depth):
[-0.11548, 97.428307] (19), [-0.10598, 97.428307] (19), [-0.09661, 97.428307] (19), [-0.08943, 97.428307] (19), [-0.06240, 97.428307] (19), [-0.05429, 97.428307] (19), [-0.05190, 97.428307] (19), [-0.05187, 97.428307] (19), [-0.04258, 97.428307] (19), [-0.02988, 97.428307] (19), [-0.02713, 97.428307] (19), [-0.02137, 97.428307] (19), [-0.02091, 97.428307] (19), [-0.01912, 97.428307] (19), [-0.01796, 97.428307] (19), [-0.01721, 97.428307] (19), [-0.01719, 97.428307] (19), [-0.01460, 97.428307] (19), [-0.01427, 97.428307] (19), [-0.01191, 97.428307] (19), 
length of domains: 29
Total time: 0.2297	 pickout: 0.0050	 decision: 0.0211	 get_bound: 0.2017	 add_domain: 0.0020
Current lb:-0.11548006534576416
1688 neurons visited
0 diving domains visited
Cumulative time: 6.2236738204956055

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 723], [1, 723], [1, 723], [1, 723], [2, 41], [2, 41], [1, 571], [0, 2455], [0, 2455], [1, 710]]
single_node_split: True
regular batch size: 2*29, diving batch size 1*0
best_l after optimization: -1.554213523864746 with beta sum per layer: [0.0, 2.5191586017608643, 0.2845522165298462]
optimal alpha/beta time: 0.18289709091186523
This batch time : update_bounds func: 0.1932	 prepare: 0.0053	 bound: 0.1831	 transfer: 0.0015	 finalize: 0.0032
Accumulated time: update_bounds func: 4.3709	 prepare: 0.1404	 bound: 4.0982	 transfer: 0.0015	 finalize: 0.0942
batch bounding time:  0.19335007667541504
Current worst splitting domains [lb, ub] (depth):
[-0.08646, 97.428307] (20), [-0.07827, 97.428307] (20), [-0.07041, 97.428307] (20), [-0.06410, 97.428307] (20), [-0.05143, 97.428307] (20), [-0.04167, 97.428307] (20), [-0.03591, 97.428307] (20), [-0.02658, 97.428307] (20), [-0.02176, 97.428307] (20), [-0.01788, 97.428307] (20), [-0.01711, 97.428307] (20), [-0.01543, 97.428307] (20), [-0.01400, 97.428307] (20), [-0.01302, 97.428307] (20), [-0.01064, 97.428307] (20), [-0.00843, 97.428307] (20), [-0.00430, 97.428307] (20), [-0.00266, 97.428307] (20), [-0.00112, 97.428307] (20), 
length of domains: 19
Total time: 0.2166	 pickout: 0.0040	 decision: 0.0177	 get_bound: 0.1934	 add_domain: 0.0014
Current lb:-0.0864570140838623
1746 neurons visited
0 diving domains visited
Cumulative time: 6.440865993499756

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 422], [0, 2455], [0, 2455], [0, 2455], [1, 702], [1, 702], [1, 558], [1, 422], [0, 2455], [1, 558]]
single_node_split: True
regular batch size: 2*19, diving batch size 1*0
best_l after optimization: -1.0141316652297974 with beta sum per layer: [0.0, 0.5671062469482422, 0.23327021300792694]
optimal alpha/beta time: 0.1861889362335205
This batch time : update_bounds func: 0.1936	 prepare: 0.0038	 bound: 0.1864	 transfer: 0.0010	 finalize: 0.0023
Accumulated time: update_bounds func: 4.5644	 prepare: 0.1443	 bound: 4.2846	 transfer: 0.0010	 finalize: 0.0965
batch bounding time:  0.19371414184570312
Current worst splitting domains [lb, ub] (depth):
[-0.07818, 97.428307] (21), [-0.07023, 97.428307] (21), [-0.06318, 97.428307] (21), [-0.02395, 97.428307] (21), [-0.01868, 97.428307] (21), [-0.01839, 97.428307] (21), [-0.01684, 97.428307] (21), [-0.01534, 97.428307] (21), [-0.00923, 97.428307] (21), [-0.00779, 97.428307] (21), [-0.00677, 97.428307] (21), [-0.00460, 97.428307] (21), [-0.00421, 97.428307] (21), 
length of domains: 13
Total time: 0.2130	 pickout: 0.0024	 decision: 0.0158	 get_bound: 0.1938	 add_domain: 0.0010
Current lb:-0.0781790018081665
1784 neurons visited
0 diving domains visited
Cumulative time: 6.654353380203247

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [1, 422], [2, 41], [1, 422], [1, 422], [1, 422], [1, 919], [1, 723], [2, 41], [1, 723]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: -0.6903040409088135 with beta sum per layer: [0.0, 0.3985752761363983, 0.21642164885997772]
optimal alpha/beta time: 0.18327021598815918
This batch time : update_bounds func: 0.1888	 prepare: 0.0030	 bound: 0.1835	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 4.7533	 prepare: 0.1473	 bound: 4.4680	 transfer: 0.0007	 finalize: 0.0980
batch bounding time:  0.18894314765930176
Current worst splitting domains [lb, ub] (depth):
[-0.03174, 97.428307] (22), [-0.01693, 97.428307] (22), 
length of domains: 2
Total time: 0.2064	 pickout: 0.0019	 decision: 0.0153	 get_bound: 0.1890	 add_domain: 0.0003
Current lb:-0.031737685203552246
1810 neurons visited
0 diving domains visited
Cumulative time: 6.861084222793579

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 422], [1, 422]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.09930562973022461 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.00642848014831543
This batch time : update_bounds func: 0.0086	 prepare: 0.0013	 bound: 0.0066	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 4.7618	 prepare: 0.1486	 bound: 4.4746	 transfer: 0.0004	 finalize: 0.0983
batch bounding time:  0.008593082427978516
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0232	 pickout: 0.0006	 decision: 0.0140	 get_bound: 0.0086	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 6.884415864944458

Image 69 pidx 9 verify end, final lower bound 999, upper bound 97.42830657958984, time: 6.930627107620239
69 999
##### [0:69] Tested against 8 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.8632228374481201 with beta sum per layer: []
optimal alpha/beta time: 0.739173412322998
alpha-CROWN with fixed intermediate bounds: tensor([[-1.8632]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.8632228374481201
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.6729023456573486 with beta sum per layer: [0.0, 0.0, 0.6076859831809998]
optimal alpha/beta time: 0.1739661693572998
This batch time : update_bounds func: 0.1757	 prepare: 0.0010	 bound: 0.1741	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.9375	 prepare: 0.1495	 bound: 4.6487	 transfer: 0.0003	 finalize: 0.0985
batch bounding time:  0.17575955390930176
Current worst splitting domains [lb, ub] (depth):
[-1.68294, 97.136780] (1), 
length of domains: 1
Total time: 0.1899	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.1758	 add_domain: 0.0001
Current lb:-1.6829428672790527
2 neurons visited
0 diving domains visited
Cumulative time: 0.9405078887939453

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.9005606174468994 with beta sum per layer: [0.0, 0.0, 0.6258449554443359]
optimal alpha/beta time: 0.1742098331451416
This batch time : update_bounds func: 0.1760	 prepare: 0.0010	 bound: 0.1744	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 5.1134	 prepare: 0.1505	 bound: 4.8231	 transfer: 0.0003	 finalize: 0.0987
batch bounding time:  0.1760568618774414
Current worst splitting domains [lb, ub] (depth):
[-1.44428, 97.136780] (2), [-0.45628, 97.136780] (2), 
length of domains: 2
Total time: 0.1901	 pickout: 0.0005	 decision: 0.0135	 get_bound: 0.1761	 add_domain: 0.0001
Current lb:-1.4442827701568604
4 neurons visited
0 diving domains visited
Cumulative time: 1.1307179927825928

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.6136839389801025 with beta sum per layer: [0.0, 0.0, 1.6785131692886353]
optimal alpha/beta time: 0.17650365829467773
This batch time : update_bounds func: 0.1785	 prepare: 0.0011	 bound: 0.1767	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 5.2919	 prepare: 0.1517	 bound: 4.9998	 transfer: 0.0004	 finalize: 0.0991
batch bounding time:  0.1786034107208252
Current worst splitting domains [lb, ub] (depth):
[-1.33818, 97.136780] (3), [-0.26351, 97.136780] (3), 
length of domains: 2
Total time: 0.1930	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1786	 add_domain: 0.0001
Current lb:-1.3381807804107666
8 neurons visited
0 diving domains visited
Cumulative time: 1.3238232135772705

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 81]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.2162996530532837 with beta sum per layer: [0.0, 0.0, 1.2855643033981323]
optimal alpha/beta time: 0.1747450828552246
This batch time : update_bounds func: 0.1768	 prepare: 0.0011	 bound: 0.1749	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 5.4687	 prepare: 0.1528	 bound: 5.1747	 transfer: 0.0004	 finalize: 0.0994
batch bounding time:  0.17686104774475098
Current worst splitting domains [lb, ub] (depth):
[-0.94859, 97.136780] (4), [-0.62145, 97.136780] (4), [-0.13264, 97.136780] (4), 
length of domains: 3
Total time: 0.1914	 pickout: 0.0006	 decision: 0.0138	 get_bound: 0.1769	 add_domain: 0.0001
Current lb:-0.9485864639282227
12 neurons visited
0 diving domains visited
Cumulative time: 1.5152561664581299

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 85]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.14693760871887207 with beta sum per layer: [0.0, 0.0, 1.7069298028945923]
optimal alpha/beta time: 0.1778428554534912
This batch time : update_bounds func: 0.1801	 prepare: 0.0013	 bound: 0.1780	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 5.6488	 prepare: 0.1541	 bound: 5.3527	 transfer: 0.0004	 finalize: 0.0998
batch bounding time:  0.18023228645324707
Current worst splitting domains [lb, ub] (depth):
[-0.84148, 97.136780] (5), [-0.52047, 97.136780] (5), 
length of domains: 2
Total time: 0.1952	 pickout: 0.0007	 decision: 0.0141	 get_bound: 0.1802	 add_domain: 0.0001
Current lb:-0.8414840698242188
18 neurons visited
0 diving domains visited
Cumulative time: 1.7105231285095215

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.4078644514083862 with beta sum per layer: [0.0, 0.0, 0.2592868208885193]
optimal alpha/beta time: 0.17487263679504395
This batch time : update_bounds func: 0.1768	 prepare: 0.0011	 bound: 0.1750	 transfer: 0.0003	 finalize: 0.0003
Accumulated time: update_bounds func: 5.8257	 prepare: 0.1552	 bound: 5.5277	 transfer: 0.0003	 finalize: 0.1001
batch bounding time:  0.17694497108459473
Current worst splitting domains [lb, ub] (depth):
[-0.55990, 97.136780] (6), [-0.46103, 97.136780] (6), [-0.23762, 97.136780] (6), [-0.14932, 97.136780] (6), 
length of domains: 4
Total time: 0.1917	 pickout: 0.0006	 decision: 0.0140	 get_bound: 0.1770	 add_domain: 0.0002
Current lb:-0.55989670753479
22 neurons visited
0 diving domains visited
Cumulative time: 1.9023168087005615

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 571], [1, 571], [1, 613], [1, 927]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 1.674790382385254 with beta sum per layer: [0.0, 0.30390164256095886, 0.5467721223831177]
optimal alpha/beta time: 0.18007612228393555
This batch time : update_bounds func: 0.1828	 prepare: 0.0014	 bound: 0.1802	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 6.0085	 prepare: 0.1566	 bound: 5.7080	 transfer: 0.0005	 finalize: 0.1007
batch bounding time:  0.18291711807250977
Current worst splitting domains [lb, ub] (depth):
[-0.49545, 97.136780] (7), [-0.40047, 97.136780] (7), [-0.28899, 97.136780] (7), [-0.18369, 97.136780] (7), [-0.11208, 97.136780] (7), [-0.11063, 97.136780] (7), [-0.08808, 97.136780] (7), 
length of domains: 7
Total time: 0.1982	 pickout: 0.0008	 decision: 0.0142	 get_bound: 0.1829	 add_domain: 0.0003
Current lb:-0.49544763565063477
30 neurons visited
0 diving domains visited
Cumulative time: 2.10064959526062

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 603], [1, 613], [1, 603], [1, 416], [1, 416], [1, 603]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 1.6704423427581787 with beta sum per layer: [0.0, 0.6288982629776001, 1.0427696704864502]
optimal alpha/beta time: 0.17816519737243652
This batch time : update_bounds func: 0.1817	 prepare: 0.0019	 bound: 0.1783	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 6.1902	 prepare: 0.1585	 bound: 5.8863	 transfer: 0.0006	 finalize: 0.1016
batch bounding time:  0.18184328079223633
Current worst splitting domains [lb, ub] (depth):
[-0.37201, 97.136780] (8), [-0.36117, 97.136780] (8), [-0.32682, 97.136780] (8), [-0.23014, 97.136780] (8), [-0.16231, 97.136780] (8), [-0.14809, 97.136780] (8), [-0.10655, 97.136780] (8), [-0.03166, 97.136780] (8), [-0.02734, 97.136780] (8), [-0.01368, 97.136780] (8), [-0.00682, 97.136780] (8), 
length of domains: 11
Total time: 0.1986	 pickout: 0.0011	 decision: 0.0151	 get_bound: 0.1819	 add_domain: 0.0006
Current lb:-0.3720059394836426
44 neurons visited
0 diving domains visited
Cumulative time: 2.2994844913482666

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 72], [1, 72], [1, 908], [1, 908], [1, 72], [1, 72], [1, 908], [1, 908], [1, 908], [1, 908]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 0.9428423643112183 with beta sum per layer: [0.0, 1.4995427131652832, 1.5320308208465576]
optimal alpha/beta time: 0.17953824996948242
This batch time : update_bounds func: 0.1842	 prepare: 0.0025	 bound: 0.1797	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 6.3744	 prepare: 0.1610	 bound: 6.0660	 transfer: 0.0006	 finalize: 0.1029
batch bounding time:  0.18434810638427734
Current worst splitting domains [lb, ub] (depth):
[-0.27661, 97.136780] (9), [-0.25381, 97.136780] (9), [-0.24971, 97.136780] (9), [-0.23428, 97.136780] (9), [-0.23207, 97.136780] (9), [-0.16612, 97.136780] (9), [-0.11581, 97.136780] (9), [-0.05325, 97.136780] (9), [-0.04917, 97.136780] (9), [-0.03019, 97.136780] (9), [-0.02709, 97.136780] (9), [-0.01123, 97.136780] (9), [-0.00395, 97.136780] (9), [-0.00273, 97.136780] (9), 
length of domains: 14
Total time: 0.2070	 pickout: 0.0015	 decision: 0.0204	 get_bound: 0.1844	 add_domain: 0.0007
Current lb:-0.2766082286834717
66 neurons visited
0 diving domains visited
Cumulative time: 2.5067055225372314

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 927], [1, 908], [1, 908], [1, 908], [1, 908], [1, 927], [1, 613], [1, 927], [1, 908], [1, 908]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: 0.07089424133300781 with beta sum per layer: [0.0, 2.645153284072876, 1.2805424928665161]
optimal alpha/beta time: 0.18052339553833008
This batch time : update_bounds func: 0.1859	 prepare: 0.0029	 bound: 0.1807	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 6.5604	 prepare: 0.1639	 bound: 6.2467	 transfer: 0.0007	 finalize: 0.1045
batch bounding time:  0.1860501766204834
Current worst splitting domains [lb, ub] (depth):
[-0.21956, 97.136780] (10), [-0.21610, 97.136780] (10), [-0.19620, 97.136780] (10), [-0.18468, 97.136780] (10), [-0.16549, 97.136780] (10), [-0.10963, 97.136780] (10), [-0.07403, 97.136780] (10), [-0.03160, 97.136780] (10), [-0.02245, 97.136780] (10), [-0.01497, 97.136780] (10), [-0.01026, 97.136780] (10), [-0.00306, 97.136780] (10), 
length of domains: 12
Total time: 0.2045	 pickout: 0.0018	 decision: 0.0160	 get_bound: 0.1861	 add_domain: 0.0006
Current lb:-0.21956396102905273
94 neurons visited
0 diving domains visited
Cumulative time: 2.7115118503570557

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: -1.6868224143981934 with beta sum per layer: [0.0, 1.314136266708374, 0.7453787922859192]
optimal alpha/beta time: 0.17934513092041016
This batch time : update_bounds func: 0.1843	 prepare: 0.0026	 bound: 0.1795	 transfer: 0.0006	 finalize: 0.0015
Accumulated time: update_bounds func: 6.7446	 prepare: 0.1665	 bound: 6.4263	 transfer: 0.0006	 finalize: 0.1060
batch bounding time:  0.18440032005310059
Current worst splitting domains [lb, ub] (depth):
[-0.14957, 97.136780] (11), [-0.14922, 97.136780] (11), [-0.13076, 97.136780] (11), [-0.11573, 97.136780] (11), [-0.09845, 97.136780] (11), [-0.03818, 97.136780] (11), 
length of domains: 6
Total time: 0.2016	 pickout: 0.0016	 decision: 0.0152	 get_bound: 0.1844	 add_domain: 0.0003
Current lb:-0.14956951141357422
118 neurons visited
0 diving domains visited
Cumulative time: 2.9133903980255127

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -3.2007601261138916 with beta sum per layer: [0.0, 0.06143775209784508, 0.4482293128967285]
optimal alpha/beta time: 0.17644476890563965
This batch time : update_bounds func: 0.1796	 prepare: 0.0018	 bound: 0.1766	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 6.9243	 prepare: 0.1682	 bound: 6.6029	 transfer: 0.0005	 finalize: 0.1067
batch bounding time:  0.1797468662261963
Current worst splitting domains [lb, ub] (depth):
[-0.10212, 97.136780] (12), [-0.10175, 97.136780] (12), [-0.08693, 97.136780] (12), [-0.07022, 97.136780] (12), [-0.05564, 97.136780] (12), 
length of domains: 5
Total time: 0.1957	 pickout: 0.0010	 decision: 0.0145	 get_bound: 0.1798	 add_domain: 0.0003
Current lb:-0.10212135314941406
130 neurons visited
0 diving domains visited
Cumulative time: 3.109208106994629

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 603], [1, 16], [1, 603], [1, 16], [1, 16]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -0.0924220085144043 with beta sum per layer: [0.0, 0.0, 0.23381030559539795]
optimal alpha/beta time: 0.17896056175231934
This batch time : update_bounds func: 0.1821	 prepare: 0.0016	 bound: 0.1791	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 7.1063	 prepare: 0.1699	 bound: 6.7820	 transfer: 0.0005	 finalize: 0.1075
batch bounding time:  0.18218398094177246
Current worst splitting domains [lb, ub] (depth):
[-0.05824, 97.136780] (13), [-0.02889, 97.136780] (13), [-0.02657, 97.136780] (13), [-0.01949, 97.136780] (13), [-0.01257, 97.136780] (13), 
length of domains: 5
Total time: 0.1977	 pickout: 0.0009	 decision: 0.0143	 get_bound: 0.1822	 add_domain: 0.0003
Current lb:-0.058237552642822266
140 neurons visited
0 diving domains visited
Cumulative time: 3.3070619106292725

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 16], [1, 603], [1, 16], [1, 603]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.6859387159347534 with beta sum per layer: [0.0, 0.0, 0.23770968616008759]
optimal alpha/beta time: 0.0064237117767333984
This batch time : update_bounds func: 0.0093	 prepare: 0.0016	 bound: 0.0066	 transfer: 0.0004	 finalize: 0.0006
Accumulated time: update_bounds func: 7.1156	 prepare: 0.1715	 bound: 6.7886	 transfer: 0.0004	 finalize: 0.1081
batch bounding time:  0.009367227554321289
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0247	 pickout: 0.0009	 decision: 0.0144	 get_bound: 0.0094	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.33193302154541

Image 69 pidx 8 verify end, final lower bound 999, upper bound 97.13677978515625, time: 3.3779780864715576
69 999
##### [0:69] Tested against 4 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.04000520706176758 with beta sum per layer: []
optimal alpha/beta time: 0.7301943302154541
alpha-CROWN with fixed intermediate bounds: tensor([[-0.0400]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.04000520706176758
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.0525994300842285 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.0063097476959228516
This batch time : update_bounds func: 0.0080	 prepare: 0.0010	 bound: 0.0064	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 7.1236	 prepare: 0.1725	 bound: 6.7950	 transfer: 0.0003	 finalize: 0.1083
batch bounding time:  0.007986068725585938
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0222	 pickout: 0.0005	 decision: 0.0137	 get_bound: 0.0080	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 0.7637419700622559

Image 69 pidx 4 verify end, final lower bound 999, upper bound 98.95999145507812, time: 0.8092327117919922
69 999
##### [0:69] Tested against 3 ######
Initial alpha-CROWN verified for label 3 with bound 0.3947587013244629
Image 69 pidx 3 verify end, final lower bound 0.3947587013244629, upper bound inf, time: 0.0004868507385253906
69 0.3947587013244629
##### [0:69] Tested against 0 ######
Initial alpha-CROWN verified for label 0 with bound 1.1495933532714844
Image 69 pidx 0 verify end, final lower bound 1.1495933532714844, upper bound inf, time: 0.0004591941833496094
69 1.1495933532714844
##### [0:69] Tested against 5 ######
Initial alpha-CROWN verified for label 5 with bound 0.29323911666870117
Image 69 pidx 5 verify end, final lower bound 0.29323911666870117, upper bound inf, time: 0.00046062469482421875
69 0.29323911666870117
##### [0:69] Tested against 2 ######
Initial alpha-CROWN verified for label 2 with bound 2.1768908500671387
Image 69 pidx 2 verify end, final lower bound 2.1768908500671387, upper bound inf, time: 0.0004589557647705078
69 2.1768908500671387
##### [0:69] Tested against 1 ######
Initial alpha-CROWN verified for label 1 with bound 2.7642059326171875
Image 69 pidx 1 verify end, final lower bound 2.7642059326171875, upper bound inf, time: 0.0004589557647705078
69 2.7642059326171875
##### [0:69] Tested against 6 ######
Initial alpha-CROWN verified for label 6 with bound 3.942837715148926
Image 69 pidx 6 verify end, final lower bound 3.942837715148926, upper bound inf, time: 0.0004596710205078125
69 3.942837715148926
##### [0:69] Tested against 7 ######
correct label, skip!
[[  69.            0.            0.            0.72318649    0.
    -3.                   inf           inf]
 [  69.            0.            0.            4.9797883     0.
    -1.                   inf           inf]
 [  69.          999.         1814.            6.93062711    0.
     9.           97.42830658    0.63135242]
 [  69.          999.          150.            3.37797809    0.
     8.           97.13677979    2.75780511]
 [  69.          999.            2.            0.80923271    0.
     4.           98.95999146    3.57731557]
 [  69.            0.3947587     0.            0.00048685    0.
     3.                   inf    5.16880417]
 [  69.            1.14959335    0.            0.00045919    0.
     0.                   inf    6.57923317]
 [  69.            0.29323912    0.            0.00046062    0.
     5.                   inf    6.70548916]
 [  69.            2.17689085    0.            0.00045896    0.
     2.                   inf    7.53978586]
 [  69.            2.76420593    0.            0.00045896    0.
     1.                   inf    8.73991013]
 [  69.            3.94283772    0.            0.00045967    0.
     6.                   inf   12.94085312]
 [  69.            0.            0.            0.            0.
     7.                   inf           inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 16.10041046142578

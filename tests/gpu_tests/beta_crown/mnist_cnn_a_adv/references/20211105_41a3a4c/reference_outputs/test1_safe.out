Experiments at Sun Oct 31 20:03:58 2021 on huan-Naples-server
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.1340)
############################
epsilon after preprocession: 0.30000001192092896, data_max = tensor([[[[1.]]]]), data_min = tensor([[[[0.]]]])
Task length: 1
saving results to Verified_ret_[mnist_cnn_4layer]_start=2_end=3_iter=20_b=1024_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  9  correct label  9 logits tensor([-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
        -1.0512,  3.9617], device='cuda:0', grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 9, Tested against: ['all'] ######
pgd prediction: tensor([-5.2919, -6.1735, -3.9591, -3.1813,  2.2672, -2.9024, -3.6765, -1.5912,
        -2.1644,  3.0396], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([8.3315, 9.2131, 6.9987, 6.2209, 0.7724, 5.9420, 6.7161, 4.6308, 5.2040,
           inf], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-4.1401, -3.4078, -5.1113, -5.2829, -1.5644, -6.7596, -6.7052, -4.9598,
         -4.3621]], device='cuda:0') None
best_l after optimization: 21.559368133544922 with beta sum per layer: []
optimal alpha/beta time: 4.350764751434326
initial alpha-CROWN bounds: tensor([[-1.6260, -0.6047, -2.5602, -2.6631, -0.8632, -3.7282, -3.4870, -3.4827,
         -2.5442]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:2] Tested against 4 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.8620109558105469 with beta sum per layer: []
optimal alpha/beta time: 1.0994412899017334
alpha-CROWN with fixed intermediate bounds: tensor([[-0.8620]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.8620109558105469
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.23690354824066162 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.5213913917541504
This batch time : update_bounds func: 0.5232	 prepare: 0.0010	 bound: 0.5216	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.5232	 prepare: 0.0010	 bound: 0.5216	 transfer: 0.0004	 finalize: 0.0002
batch bounding time:  0.5232961177825928
Current worst splitting domains [lb, ub] (depth):
[-0.72521, 98.137985] (1), 
length of domains: 1
Total time: 0.5382	 pickout: 0.0006	 decision: 0.0142	 get_bound: 0.5233	 add_domain: 0.0001
Current lb:-0.725212812423706
2 neurons visited
0 diving domains visited
Cumulative time: 2.0100457668304443

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1046]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.8591850996017456 with beta sum per layer: [0.0, 0.27736642956733704, 0.0]
optimal alpha/beta time: 0.17821884155273438
This batch time : update_bounds func: 0.1800	 prepare: 0.0011	 bound: 0.1784	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 0.7032	 prepare: 0.0021	 bound: 0.7000	 transfer: 0.0003	 finalize: 0.0004
batch bounding time:  0.18015813827514648
Current worst splitting domains [lb, ub] (depth):
[-0.67223, 98.137985] (2), [-0.18696, 98.137985] (2), 
length of domains: 2
Total time: 0.1955	 pickout: 0.0005	 decision: 0.0147	 get_bound: 0.1802	 add_domain: 0.0001
Current lb:-0.6722264289855957
4 neurons visited
0 diving domains visited
Cumulative time: 2.2055764198303223

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 45]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.26248836517333984 with beta sum per layer: [0.0, 0.5026439428329468, 0.3157651126384735]
optimal alpha/beta time: 0.18164825439453125
This batch time : update_bounds func: 0.1838	 prepare: 0.0012	 bound: 0.1818	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.8870	 prepare: 0.0033	 bound: 0.8818	 transfer: 0.0004	 finalize: 0.0007
batch bounding time:  0.18386459350585938
Current worst splitting domains [lb, ub] (depth):
[-0.60964, 98.137985] (3), [-0.09604, 98.137985] (3), 
length of domains: 2
Total time: 0.1984	 pickout: 0.0006	 decision: 0.0138	 get_bound: 0.1839	 add_domain: 0.0001
Current lb:-0.6096396446228027
8 neurons visited
0 diving domains visited
Cumulative time: 2.404061794281006

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11], [2, 11]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.013065695762634277 with beta sum per layer: [0.0, 0.4505549669265747, 0.0]
optimal alpha/beta time: 0.17975878715515137
This batch time : update_bounds func: 0.1819	 prepare: 0.0012	 bound: 0.1799	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.0688	 prepare: 0.0045	 bound: 1.0617	 transfer: 0.0004	 finalize: 0.0011
batch bounding time:  0.18198561668395996
Current worst splitting domains [lb, ub] (depth):
[-0.29358, 98.137985] (4), [-0.19210, 98.137985] (4), 
length of domains: 2
Total time: 0.1966	 pickout: 0.0006	 decision: 0.0139	 get_bound: 0.1820	 add_domain: 0.0001
Current lb:-0.29357922077178955
12 neurons visited
0 diving domains visited
Cumulative time: 2.6007485389709473

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 556], [1, 556]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.07184374332427979 with beta sum per layer: [0.0, 0.39705339074134827, 0.0]
optimal alpha/beta time: 0.18087100982666016
This batch time : update_bounds func: 0.1830	 prepare: 0.0012	 bound: 0.1810	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.2518	 prepare: 0.0057	 bound: 1.2428	 transfer: 0.0004	 finalize: 0.0014
batch bounding time:  0.18306469917297363
Current worst splitting domains [lb, ub] (depth):
[-0.12343, 98.137985] (5), [-0.08221, 98.137985] (5), 
length of domains: 2
Total time: 0.1975	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1831	 add_domain: 0.0001
Current lb:-0.12342607975006104
16 neurons visited
0 diving domains visited
Cumulative time: 2.7983815670013428

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 648], [1, 606]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.0828213095664978 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17939376831054688
This batch time : update_bounds func: 0.1815	 prepare: 0.0012	 bound: 0.1796	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.4333	 prepare: 0.0069	 bound: 1.4224	 transfer: 0.0004	 finalize: 0.0017
batch bounding time:  0.18157505989074707
Current worst splitting domains [lb, ub] (depth):
[-0.09113, 98.137985] (6), 
length of domains: 1
Total time: 0.1960	 pickout: 0.0006	 decision: 0.0138	 get_bound: 0.1816	 add_domain: 0.0001
Current lb:-0.09112942218780518
20 neurons visited
0 diving domains visited
Cumulative time: 2.9945240020751953

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 655]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.0013145208358764648 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.16932439804077148
This batch time : update_bounds func: 0.1711	 prepare: 0.0011	 bound: 0.1695	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 1.6044	 prepare: 0.0079	 bound: 1.5919	 transfer: 0.0003	 finalize: 0.0019
batch bounding time:  0.1712338924407959
Current worst splitting domains [lb, ub] (depth):
[-0.02458, 98.137985] (7), 
length of domains: 1
Total time: 0.1856	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.1712	 add_domain: 0.0001
Current lb:-0.02458012104034424
22 neurons visited
0 diving domains visited
Cumulative time: 3.180201292037964

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 606]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.1849064826965332 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.0063323974609375
This batch time : update_bounds func: 0.0081	 prepare: 0.0010	 bound: 0.0065	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 1.6125	 prepare: 0.0090	 bound: 1.5983	 transfer: 0.0003	 finalize: 0.0021
batch bounding time:  0.008087396621704102
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0222	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.0081	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.202510118484497

Image 2 pidx 4 verify end, final lower bound 999, upper bound 98.13798522949219, time: 3.2486681938171387
2 999
##### [0:2] Tested against 7 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.4809141159057617 with beta sum per layer: []
optimal alpha/beta time: 0.7212164402008057
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4809]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.4809141159057617
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.714257717132568 with beta sum per layer: [0.0, 0.0, 0.011077119037508965]
optimal alpha/beta time: 0.17532920837402344
This batch time : update_bounds func: 0.1770	 prepare: 0.0010	 bound: 0.1755	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 1.7895	 prepare: 0.0099	 bound: 1.7738	 transfer: 0.0003	 finalize: 0.0023
batch bounding time:  0.17713618278503418
Current worst splitting domains [lb, ub] (depth):
[-2.74438, 95.519089] (1), [-1.96988, 95.519089] (1), 
length of domains: 2
Total time: 0.1913	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.1771	 add_domain: 0.0001
Current lb:-2.744375705718994
2 neurons visited
0 diving domains visited
Cumulative time: 0.9239118099212646

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 4.416428565979004 with beta sum per layer: [0.0, 0.0, 1.4439550638198853]
optimal alpha/beta time: 0.17761445045471191
This batch time : update_bounds func: 0.1796	 prepare: 0.0011	 bound: 0.1778	 transfer: 0.0003	 finalize: 0.0003
Accumulated time: update_bounds func: 1.9691	 prepare: 0.0111	 bound: 1.9516	 transfer: 0.0003	 finalize: 0.0026
batch bounding time:  0.1797034740447998
Current worst splitting domains [lb, ub] (depth):
[-2.55913, 95.519089] (2), [-1.84384, 95.519089] (2), [-0.49298, 95.519089] (2), 
length of domains: 3
Total time: 0.1941	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1797	 add_domain: 0.0001
Current lb:-2.5591297149658203
6 neurons visited
0 diving domains visited
Cumulative time: 1.1181087493896484

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1052], [1, 415], [2, 67]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 5.756150722503662 with beta sum per layer: [0.0, 0.20624564588069916, 1.5949262380599976]
optimal alpha/beta time: 0.18143391609191895
This batch time : update_bounds func: 0.1838	 prepare: 0.0014	 bound: 0.1816	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 2.1529	 prepare: 0.0124	 bound: 2.1332	 transfer: 0.0004	 finalize: 0.0030
batch bounding time:  0.18395423889160156
Current worst splitting domains [lb, ub] (depth):
[-2.25794, 95.519089] (3), [-1.93883, 95.519089] (3), [-1.36109, 95.519089] (3), [-1.02175, 95.519089] (3), 
length of domains: 4
Total time: 0.1988	 pickout: 0.0007	 decision: 0.0140	 get_bound: 0.1840	 add_domain: 0.0001
Current lb:-2.2579407691955566
12 neurons visited
0 diving domains visited
Cumulative time: 1.3170020580291748

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11], [2, 11], [2, 67], [2, 11]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 8.41788101196289 with beta sum per layer: [0.0, 0.32431408762931824, 2.224269390106201]
optimal alpha/beta time: 0.1817786693572998
This batch time : update_bounds func: 0.1846	 prepare: 0.0015	 bound: 0.1820	 transfer: 0.0004	 finalize: 0.0007
Accumulated time: update_bounds func: 2.3375	 prepare: 0.0139	 bound: 2.3151	 transfer: 0.0004	 finalize: 0.0037
batch bounding time:  0.18466448783874512
Current worst splitting domains [lb, ub] (depth):
[-2.07651, 95.519089] (4), [-1.73761, 95.519089] (4), [-1.34456, 95.519089] (4), [-1.03998, 95.519089] (4), [-0.83853, 95.519089] (4), [-0.74538, 95.519089] (4), [-0.64283, 95.519089] (4), 
length of domains: 7
Total time: 0.2002	 pickout: 0.0008	 decision: 0.0145	 get_bound: 0.1847	 add_domain: 0.0003
Current lb:-2.076507568359375
20 neurons visited
0 diving domains visited
Cumulative time: 1.5173249244689941

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 11], [2, 11]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 8.730934143066406 with beta sum per layer: [0.0, 0.9315176010131836, 3.8852572441101074]
optimal alpha/beta time: 0.18347907066345215
This batch time : update_bounds func: 0.1869	 prepare: 0.0019	 bound: 0.1837	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 2.5244	 prepare: 0.0158	 bound: 2.4988	 transfer: 0.0005	 finalize: 0.0045
batch bounding time:  0.1870129108428955
Current worst splitting domains [lb, ub] (depth):
[-1.57572, 95.519089] (5), [-1.48241, 95.519089] (5), [-1.14142, 95.519089] (5), [-1.14021, 95.519089] (5), [-0.99411, 95.519089] (5), [-0.67474, 95.519089] (5), [-0.57802, 95.519089] (5), [-0.45405, 95.519089] (5), [-0.43516, 95.519089] (5), [-0.25643, 95.519089] (5), [-0.23010, 95.519089] (5), 
length of domains: 11
Total time: 0.2039	 pickout: 0.0011	 decision: 0.0153	 get_bound: 0.1870	 add_domain: 0.0005
Current lb:-1.5757246017456055
34 neurons visited
0 diving domains visited
Cumulative time: 1.7214055061340332

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 415], [1, 415], [1, 415], [1, 415], [2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 38]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 4.28702974319458 with beta sum per layer: [0.0, 4.818828582763672, 6.99674654006958]
optimal alpha/beta time: 0.18324589729309082
This batch time : update_bounds func: 0.1879	 prepare: 0.0025	 bound: 0.1834	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 2.7123	 prepare: 0.0183	 bound: 2.6822	 transfer: 0.0006	 finalize: 0.0058
batch bounding time:  0.18803048133850098
Current worst splitting domains [lb, ub] (depth):
[-1.25019, 95.519089] (6), [-1.19854, 95.519089] (6), [-0.93461, 95.519089] (6), [-0.79432, 95.519089] (6), [-0.76397, 95.519089] (6), [-0.49329, 95.519089] (6), [-0.44243, 95.519089] (6), [-0.28529, 95.519089] (6), [-0.12737, 95.519089] (6), [-0.09165, 95.519089] (6), [-0.04752, 95.519089] (6), 
length of domains: 11
Total time: 0.2063	 pickout: 0.0015	 decision: 0.0163	 get_bound: 0.1881	 add_domain: 0.0004
Current lb:-1.2501897811889648
56 neurons visited
0 diving domains visited
Cumulative time: 1.9279844760894775

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [1, 618], [2, 38], [1, 618], [1, 1052]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 3.7697954177856445 with beta sum per layer: [0.0, 6.457534313201904, 2.9101686477661133]
optimal alpha/beta time: 0.18230795860290527
This batch time : update_bounds func: 0.1870	 prepare: 0.0025	 bound: 0.1825	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 2.8993	 prepare: 0.0208	 bound: 2.8647	 transfer: 0.0006	 finalize: 0.0072
batch bounding time:  0.1871027946472168
Current worst splitting domains [lb, ub] (depth):
[-0.83063, 95.519089] (7), [-0.77885, 95.519089] (7), [-0.76197, 95.519089] (7), [-0.62440, 95.519089] (7), [-0.53200, 95.519089] (7), [-0.44198, 95.519089] (7), [-0.37944, 95.519089] (7), [-0.31335, 95.519089] (7), [-0.26780, 95.519089] (7), [-0.18388, 95.519089] (7), [-0.16786, 95.519089] (7), 
length of domains: 11
Total time: 0.2042	 pickout: 0.0015	 decision: 0.0151	 get_bound: 0.1871	 add_domain: 0.0005
Current lb:-0.8306283950805664
78 neurons visited
0 diving domains visited
Cumulative time: 2.132443904876709

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 661], [1, 618], [1, 661], [1, 618], [1, 618], [1, 618], [1, 618], [1, 661], [1, 618], [1, 618]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 3.2319509983062744 with beta sum per layer: [0.0, 5.7191033363342285, 1.1301968097686768]
optimal alpha/beta time: 0.18219923973083496
This batch time : update_bounds func: 0.1867	 prepare: 0.0024	 bound: 0.1824	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 3.0860	 prepare: 0.0232	 bound: 3.0471	 transfer: 0.0006	 finalize: 0.0085
batch bounding time:  0.18683934211730957
Current worst splitting domains [lb, ub] (depth):
[-0.72771, 95.519089] (8), [-0.57454, 95.519089] (8), [-0.50482, 95.519089] (8), [-0.37926, 95.519089] (8), [-0.36779, 95.519089] (8), [-0.29699, 95.519089] (8), [-0.24696, 95.519089] (8), [-0.17777, 95.519089] (8), [-0.16504, 95.519089] (8), [-0.15542, 95.519089] (8), [-0.13779, 95.519089] (8), [-0.09084, 95.519089] (8), [-0.03962, 95.519089] (8), [-0.02546, 95.519089] (8), 
length of domains: 14
Total time: 0.2038	 pickout: 0.0015	 decision: 0.0149	 get_bound: 0.1869	 add_domain: 0.0006
Current lb:-0.7277121543884277
100 neurons visited
0 diving domains visited
Cumulative time: 2.3365373611450195

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 618], [1, 618], [1, 1059], [1, 618], [1, 661], [1, 612], [1, 661], [1, 618], [1, 1059], [1, 618]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: 0.14435577392578125 with beta sum per layer: [0.0, 6.955244541168213, 0.24527588486671448]
optimal alpha/beta time: 0.1830601692199707
This batch time : update_bounds func: 0.1884	 prepare: 0.0028	 bound: 0.1832	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 3.2744	 prepare: 0.0259	 bound: 3.2303	 transfer: 0.0007	 finalize: 0.0101
batch bounding time:  0.18851041793823242
Current worst splitting domains [lb, ub] (depth):
[-0.45004, 95.519089] (9), [-0.31542, 95.519089] (9), [-0.31302, 95.519089] (9), [-0.26608, 95.519089] (9), [-0.21093, 95.519089] (9), [-0.21044, 95.519089] (9), [-0.16563, 95.519089] (9), [-0.14108, 95.519089] (9), [-0.10435, 95.519089] (9), [-0.05770, 95.519089] (9), 
length of domains: 10
Total time: 0.2069	 pickout: 0.0018	 decision: 0.0161	 get_bound: 0.1886	 add_domain: 0.0005
Current lb:-0.4500398635864258
128 neurons visited
0 diving domains visited
Cumulative time: 2.54376482963562

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 612], [1, 612], [1, 612], [1, 612], [1, 1059], [1, 905], [1, 612], [1, 612], [1, 612], [1, 612]]
single_node_split: True
regular batch size: 2*10, diving batch size 1*0
best_l after optimization: 0.3786134719848633 with beta sum per layer: [0.0, 2.2767834663391113, 0.06980957835912704]
optimal alpha/beta time: 0.18232297897338867
This batch time : update_bounds func: 0.1866	 prepare: 0.0023	 bound: 0.1825	 transfer: 0.0006	 finalize: 0.0012
Accumulated time: update_bounds func: 3.4610	 prepare: 0.0282	 bound: 3.4128	 transfer: 0.0006	 finalize: 0.0113
batch bounding time:  0.18673419952392578
Current worst splitting domains [lb, ub] (depth):
[-0.37250, 95.519089] (10), [-0.21633, 95.519089] (10), [-0.18723, 95.519089] (10), [-0.18514, 95.519089] (10), [-0.08282, 95.519089] (10), [-0.05502, 95.519089] (10), [-0.04645, 95.519089] (10), [-0.04276, 95.519089] (10), 
length of domains: 8
Total time: 0.2036	 pickout: 0.0014	 decision: 0.0151	 get_bound: 0.1868	 add_domain: 0.0004
Current lb:-0.37250447273254395
148 neurons visited
0 diving domains visited
Cumulative time: 2.7476441860198975

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47], [2, 47], [2, 47], [2, 47], [1, 73], [2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -1.1543550491333008 with beta sum per layer: [0.0, 1.128379464149475, 0.34264057874679565]
optimal alpha/beta time: 0.18208694458007812
This batch time : update_bounds func: 0.1861	 prepare: 0.0021	 bound: 0.1823	 transfer: 0.0005	 finalize: 0.0011
Accumulated time: update_bounds func: 3.6471	 prepare: 0.0303	 bound: 3.5951	 transfer: 0.0005	 finalize: 0.0124
batch bounding time:  0.1861886978149414
Current worst splitting domains [lb, ub] (depth):
[-0.24931, 95.519089] (11), [-0.08441, 95.519089] (11), [-0.07646, 95.519089] (11), [-0.06541, 95.519089] (11), 
length of domains: 4
Total time: 0.2026	 pickout: 0.0012	 decision: 0.0150	 get_bound: 0.1862	 add_domain: 0.0002
Current lb:-0.24930787086486816
164 neurons visited
0 diving domains visited
Cumulative time: 2.9504995346069336

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 46], [2, 46], [1, 661], [1, 73]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: -2.100809097290039 with beta sum per layer: [0.0, 0.1541672646999359, 0.0]
optimal alpha/beta time: 0.1779003143310547
This batch time : update_bounds func: 0.1806	 prepare: 0.0016	 bound: 0.1781	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 3.8277	 prepare: 0.0319	 bound: 3.7732	 transfer: 0.0004	 finalize: 0.0130
batch bounding time:  0.1808018684387207
Current worst splitting domains [lb, ub] (depth):
[-0.17847, 95.519089] (12), [-0.00962, 95.519089] (12), 
length of domains: 2
Total time: 0.1960	 pickout: 0.0008	 decision: 0.0143	 get_bound: 0.1808	 add_domain: 0.0001
Current lb:-0.17846941947937012
172 neurons visited
0 diving domains visited
Cumulative time: 3.1466739177703857

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1059], [1, 1059]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5893268585205078 with beta sum per layer: [0.0, 0.18783751130104065, 0.0]
optimal alpha/beta time: 0.006342649459838867
This batch time : update_bounds func: 0.0083	 prepare: 0.0012	 bound: 0.0065	 transfer: 0.0003	 finalize: 0.0003
Accumulated time: update_bounds func: 3.8360	 prepare: 0.0331	 bound: 3.7797	 transfer: 0.0003	 finalize: 0.0133
batch bounding time:  0.008372068405151367
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0227	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.0084	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.169466018676758

Image 2 pidx 7 verify end, final lower bound 999, upper bound 95.51908874511719, time: 3.214371681213379
2 999
##### [0:2] Tested against 8 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.5426106452941895 with beta sum per layer: []
optimal alpha/beta time: 0.7236967086791992
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5426]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.5426106452941895
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 3.737206220626831 with beta sum per layer: [0.0, 0.0, 0.3803931474685669]
optimal alpha/beta time: 0.17728590965270996
This batch time : update_bounds func: 0.1790	 prepare: 0.0010	 bound: 0.1774	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.0151	 prepare: 0.0340	 bound: 3.9572	 transfer: 0.0003	 finalize: 0.0135
batch bounding time:  0.17911195755004883
Current worst splitting domains [lb, ub] (depth):
[-2.39366, 96.457390] (1), [-1.34354, 96.457390] (1), 
length of domains: 2
Total time: 0.1935	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.1791	 add_domain: 0.0001
Current lb:-2.3936617374420166
2 neurons visited
0 diving domains visited
Cumulative time: 0.9285411834716797

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 3.8356761932373047 with beta sum per layer: [0.0, 0.0, 2.1701698303222656]
optimal alpha/beta time: 0.17769789695739746
This batch time : update_bounds func: 0.1797	 prepare: 0.0012	 bound: 0.1779	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 4.1948	 prepare: 0.0352	 bound: 4.1350	 transfer: 0.0004	 finalize: 0.0138
batch bounding time:  0.1798417568206787
Current worst splitting domains [lb, ub] (depth):
[-2.23222, 96.457390] (2), [-1.02259, 96.457390] (2), [-0.96615, 96.457390] (2), 
length of domains: 3
Total time: 0.1943	 pickout: 0.0006	 decision: 0.0138	 get_bound: 0.1799	 add_domain: 0.0001
Current lb:-2.2322206497192383
6 neurons visited
0 diving domains visited
Cumulative time: 1.1229760646820068

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38], [2, 38]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 4.408107757568359 with beta sum per layer: [0.0, 0.0, 2.5837743282318115]
optimal alpha/beta time: 0.1784205436706543
This batch time : update_bounds func: 0.1807	 prepare: 0.0013	 bound: 0.1786	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 4.3755	 prepare: 0.0365	 bound: 4.3137	 transfer: 0.0004	 finalize: 0.0142
batch bounding time:  0.18081903457641602
Current worst splitting domains [lb, ub] (depth):
[-2.04247, 96.457390] (3), [-1.31751, 96.457390] (3), [-0.42425, 96.457390] (3), [-0.26308, 96.457390] (3), [-0.23010, 96.457390] (3), [-0.13071, 96.457390] (3), 
length of domains: 6
Total time: 0.1976	 pickout: 0.0024	 decision: 0.0141	 get_bound: 0.1808	 add_domain: 0.0002
Current lb:-2.0424716472625732
12 neurons visited
0 diving domains visited
Cumulative time: 1.320646047592163

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 67], [2, 67], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 1.723290205001831 with beta sum per layer: [0.0, 0.0, 5.71687126159668]
optimal alpha/beta time: 0.18281960487365723
This batch time : update_bounds func: 0.1860	 prepare: 0.0016	 bound: 0.1830	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 4.5615	 prepare: 0.0381	 bound: 4.4966	 transfer: 0.0006	 finalize: 0.0150
batch bounding time:  0.18618297576904297
Current worst splitting domains [lb, ub] (depth):
[-1.74235, 96.457390] (4), [-0.97610, 96.457390] (4), [-0.87835, 96.457390] (4), [-0.46094, 96.457390] (4), 
length of domains: 4
Total time: 0.2032	 pickout: 0.0010	 decision: 0.0159	 get_bound: 0.1862	 add_domain: 0.0002
Current lb:-1.7423454523086548
24 neurons visited
0 diving domains visited
Cumulative time: 1.5240774154663086

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22], [2, 85], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 3.156740188598633 with beta sum per layer: [0.0, 0.0, 2.7087626457214355]
optimal alpha/beta time: 0.17837071418762207
This batch time : update_bounds func: 0.1810	 prepare: 0.0014	 bound: 0.1785	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 4.7425	 prepare: 0.0395	 bound: 4.6752	 transfer: 0.0005	 finalize: 0.0155
batch bounding time:  0.1811230182647705
Current worst splitting domains [lb, ub] (depth):
[-1.56915, 96.457390] (5), [-0.79756, 96.457390] (5), [-0.78211, 96.457390] (5), [-0.48722, 96.457390] (5), [-0.24889, 96.457390] (5), 
length of domains: 5
Total time: 0.1966	 pickout: 0.0008	 decision: 0.0144	 get_bound: 0.1811	 add_domain: 0.0002
Current lb:-1.5691536664962769
32 neurons visited
0 diving domains visited
Cumulative time: 1.720764398574829

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 415], [2, 85]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 2.598435640335083 with beta sum per layer: [0.0, 0.0, 3.3432579040527344]
optimal alpha/beta time: 0.18423175811767578
This batch time : update_bounds func: 0.1874	 prepare: 0.0016	 bound: 0.1844	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 4.9300	 prepare: 0.0411	 bound: 4.8596	 transfer: 0.0006	 finalize: 0.0163
batch bounding time:  0.18754816055297852
Current worst splitting domains [lb, ub] (depth):
[-1.20940, 96.457390] (6), [-0.90395, 96.457390] (6), [-0.35519, 96.457390] (6), [-0.33144, 96.457390] (6), [-0.17044, 96.457390] (6), [-0.13148, 96.457390] (6), 
length of domains: 6
Total time: 0.2033	 pickout: 0.0009	 decision: 0.0145	 get_bound: 0.1876	 add_domain: 0.0003
Current lb:-1.2094042301177979
42 neurons visited
0 diving domains visited
Cumulative time: 1.9242305755615234

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [1, 430], [1, 430], [1, 430], [2, 22], [1, 430]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 2.4344253540039062 with beta sum per layer: [0.0, 0.12450024485588074, 3.4312005043029785]
optimal alpha/beta time: 0.18515563011169434
This batch time : update_bounds func: 0.1884	 prepare: 0.0018	 bound: 0.1853	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 5.1183	 prepare: 0.0429	 bound: 5.0449	 transfer: 0.0005	 finalize: 0.0170
batch bounding time:  0.1884937286376953
Current worst splitting domains [lb, ub] (depth):
[-1.11726, 96.457390] (7), [-0.80174, 96.457390] (7), [-0.74327, 96.457390] (7), [-0.34582, 96.457390] (7), [-0.21381, 96.457390] (7), [-0.11078, 96.457390] (7), [-0.02712, 96.457390] (7), 
length of domains: 7
Total time: 0.2046	 pickout: 0.0010	 decision: 0.0148	 get_bound: 0.1885	 add_domain: 0.0003
Current lb:-1.1172559261322021
54 neurons visited
0 diving domains visited
Cumulative time: 2.129056930541992

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 2.7591261863708496 with beta sum per layer: [0.0, 0.1401570588350296, 3.365684747695923]
optimal alpha/beta time: 0.18128681182861328
This batch time : update_bounds func: 0.1850	 prepare: 0.0019	 bound: 0.1815	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 5.3033	 prepare: 0.0447	 bound: 5.2264	 transfer: 0.0006	 finalize: 0.0180
batch bounding time:  0.18510961532592773
Current worst splitting domains [lb, ub] (depth):
[-0.91498, 96.457390] (8), [-0.73483, 96.457390] (8), [-0.59827, 96.457390] (8), [-0.50913, 96.457390] (8), [-0.41553, 96.457390] (8), [-0.36727, 96.457390] (8), [-0.09763, 96.457390] (8), [-0.04524, 96.457390] (8), 
length of domains: 8
Total time: 0.2017	 pickout: 0.0011	 decision: 0.0151	 get_bound: 0.1851	 add_domain: 0.0004
Current lb:-0.9149752855300903
68 neurons visited
0 diving domains visited
Cumulative time: 2.3309547901153564

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [2, 81]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 3.5765066146850586 with beta sum per layer: [0.0, 0.39203864336013794, 2.0440852642059326]
optimal alpha/beta time: 0.1804811954498291
This batch time : update_bounds func: 0.1845	 prepare: 0.0021	 bound: 0.1807	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 5.4879	 prepare: 0.0469	 bound: 5.4070	 transfer: 0.0006	 finalize: 0.0190
batch bounding time:  0.18463754653930664
Current worst splitting domains [lb, ub] (depth):
[-0.74239, 96.457390] (9), [-0.64780, 96.457390] (9), [-0.51429, 96.457390] (9), [-0.45031, 96.457390] (9), [-0.41623, 96.457390] (9), [-0.32261, 96.457390] (9), [-0.30128, 96.457390] (9), [-0.22292, 96.457390] (9), [-0.18901, 96.457390] (9), [-0.12929, 96.457390] (9), [-0.11961, 96.457390] (9), [-0.06668, 96.457390] (9), 
length of domains: 12
Total time: 0.2050	 pickout: 0.0012	 decision: 0.0186	 get_bound: 0.1847	 add_domain: 0.0005
Current lb:-0.7423899173736572
84 neurons visited
0 diving domains visited
Cumulative time: 2.536123037338257

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 268], [1, 268], [2, 81], [1, 415], [1, 268], [1, 268], [2, 81], [2, 81], [2, 81], [1, 415]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: 3.398897171020508 with beta sum per layer: [0.0, 1.3319753408432007, 2.8774161338806152]
optimal alpha/beta time: 0.18542194366455078
This batch time : update_bounds func: 0.1906	 prepare: 0.0026	 bound: 0.1856	 transfer: 0.0008	 finalize: 0.0015
Accumulated time: update_bounds func: 5.6785	 prepare: 0.0495	 bound: 5.5927	 transfer: 0.0008	 finalize: 0.0205
batch bounding time:  0.1907360553741455
Current worst splitting domains [lb, ub] (depth):
[-0.67330, 96.457390] (10), [-0.59014, 96.457390] (10), [-0.49283, 96.457390] (10), [-0.35881, 96.457390] (10), [-0.35701, 96.457390] (10), [-0.33855, 96.457390] (10), [-0.33733, 96.457390] (10), [-0.25534, 96.457390] (10), [-0.22326, 96.457390] (10), [-0.15878, 96.457390] (10), [-0.13570, 96.457390] (10), [-0.07143, 96.457390] (10), [-0.05441, 96.457390] (10), [-0.02846, 96.457390] (10), [-0.01319, 96.457390] (10), [-0.01274, 96.457390] (10), 
length of domains: 16
Total time: 0.2093	 pickout: 0.0016	 decision: 0.0161	 get_bound: 0.1908	 add_domain: 0.0008
Current lb:-0.6733026504516602
108 neurons visited
0 diving domains visited
Cumulative time: 2.745654821395874

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 81], [2, 81], [2, 81], [1, 415], [2, 81], [2, 81], [1, 1207], [2, 81]]
single_node_split: True
regular batch size: 2*16, diving batch size 1*0
best_l after optimization: 1.9238979816436768 with beta sum per layer: [0.0, 1.710247278213501, 3.620213747024536]
optimal alpha/beta time: 0.18329811096191406
This batch time : update_bounds func: 0.1895	 prepare: 0.0032	 bound: 0.1835	 transfer: 0.0010	 finalize: 0.0018
Accumulated time: update_bounds func: 5.8680	 prepare: 0.0527	 bound: 5.7762	 transfer: 0.0010	 finalize: 0.0224
batch bounding time:  0.18965387344360352
Current worst splitting domains [lb, ub] (depth):
[-0.52050, 96.457390] (11), [-0.42606, 96.457390] (11), [-0.39416, 96.457390] (11), [-0.34595, 96.457390] (11), [-0.34253, 96.457390] (11), [-0.23229, 96.457390] (11), [-0.21074, 96.457390] (11), [-0.19618, 96.457390] (11), [-0.16640, 96.457390] (11), [-0.16430, 96.457390] (11), [-0.10250, 96.457390] (11), [-0.09545, 96.457390] (11), [-0.08690, 96.457390] (11), [-0.08334, 96.457390] (11), [-0.07654, 96.457390] (11), [-0.07633, 96.457390] (11), [-0.05150, 96.457390] (11), [-0.02512, 96.457390] (11), [-0.00484, 96.457390] (11), 
length of domains: 19
Total time: 0.2092	 pickout: 0.0020	 decision: 0.0165	 get_bound: 0.1897	 add_domain: 0.0009
Current lb:-0.5204994678497314
140 neurons visited
0 diving domains visited
Cumulative time: 2.955127239227295

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 415], [1, 415], [1, 1198], [1, 1198], [1, 415], [1, 1207], [1, 1198], [1, 415], [1, 415], [1, 1207]]
single_node_split: True
regular batch size: 2*19, diving batch size 1*0
best_l after optimization: 1.1047966480255127 with beta sum per layer: [0.0, 2.5137550830841064, 4.316843509674072]
optimal alpha/beta time: 0.18401384353637695
This batch time : update_bounds func: 0.1910	 prepare: 0.0035	 bound: 0.1842	 transfer: 0.0011	 finalize: 0.0021
Accumulated time: update_bounds func: 6.0589	 prepare: 0.0561	 bound: 5.9603	 transfer: 0.0011	 finalize: 0.0245
batch bounding time:  0.19110751152038574
Current worst splitting domains [lb, ub] (depth):
[-0.43354, 96.457390] (12), [-0.36101, 96.457390] (12), [-0.31568, 96.457390] (12), [-0.29157, 96.457390] (12), [-0.23872, 96.457390] (12), [-0.11784, 96.457390] (12), [-0.11712, 96.457390] (12), [-0.10377, 96.457390] (12), [-0.09636, 96.457390] (12), [-0.07789, 96.457390] (12), [-0.07535, 96.457390] (12), [-0.07331, 96.457390] (12), [-0.06789, 96.457390] (12), [-0.05233, 96.457390] (12), [-0.04648, 96.457390] (12), [-0.03773, 96.457390] (12), [-0.02492, 96.457390] (12), [-0.01374, 96.457390] (12), [-0.00315, 96.457390] (12), [-0.00102, 96.457390] (12), 
length of domains: 20
Total time: 0.2120	 pickout: 0.0023	 decision: 0.0172	 get_bound: 0.1912	 add_domain: 0.0013
Current lb:-0.43353796005249023
178 neurons visited
0 diving domains visited
Cumulative time: 3.1674885749816895

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1198], [1, 1198], [1, 415], [1, 415], [1, 1198], [1, 1198], [1, 415], [1, 1059], [1, 1198], [1, 415]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: -0.776572585105896 with beta sum per layer: [0.0, 4.81226921081543, 3.7433433532714844]
optimal alpha/beta time: 0.1855325698852539
This batch time : update_bounds func: 0.1924	 prepare: 0.0036	 bound: 0.1857	 transfer: 0.0008	 finalize: 0.0022
Accumulated time: update_bounds func: 6.2514	 prepare: 0.0597	 bound: 6.1461	 transfer: 0.0008	 finalize: 0.0267
batch bounding time:  0.1925671100616455
Current worst splitting domains [lb, ub] (depth):
[-0.37309, 96.457390] (13), [-0.31803, 96.457390] (13), [-0.26302, 96.457390] (13), [-0.24606, 96.457390] (13), [-0.18010, 96.457390] (13), [-0.13271, 96.457390] (13), [-0.07482, 96.457390] (13), [-0.06503, 96.457390] (13), [-0.05077, 96.457390] (13), [-0.01236, 96.457390] (13), [-0.00790, 96.457390] (13), [-0.00595, 96.457390] (13), [-0.00442, 96.457390] (13), [-0.00098, 96.457390] (13), 
length of domains: 14
Total time: 0.2142	 pickout: 0.0023	 decision: 0.0184	 get_bound: 0.1926	 add_domain: 0.0009
Current lb:-0.3730916976928711
218 neurons visited
0 diving domains visited
Cumulative time: 3.3821487426757812

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [1, 618], [1, 618], [2, 79], [2, 79], [2, 79], [2, 79], [1, 618], [2, 79]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: -0.3398280143737793 with beta sum per layer: [0.0, 3.859985589981079, 1.7993719577789307]
optimal alpha/beta time: 0.18317198753356934
This batch time : update_bounds func: 0.1887	 prepare: 0.0029	 bound: 0.1833	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 6.4400	 prepare: 0.0627	 bound: 6.3294	 transfer: 0.0007	 finalize: 0.0283
batch bounding time:  0.18880963325500488
Current worst splitting domains [lb, ub] (depth):
[-0.25969, 96.457390] (14), [-0.20666, 96.457390] (14), [-0.19600, 96.457390] (14), [-0.17311, 96.457390] (14), [-0.17257, 96.457390] (14), [-0.11305, 96.457390] (14), [-0.06166, 96.457390] (14), [-0.02055, 96.457390] (14), 
length of domains: 8
Total time: 0.2064	 pickout: 0.0018	 decision: 0.0152	 get_bound: 0.1889	 add_domain: 0.0005
Current lb:-0.2596921920776367
246 neurons visited
0 diving domains visited
Cumulative time: 3.588866949081421

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1059], [1, 1059], [1, 914], [1, 905], [1, 914], [1, 1207], [1, 1059], [1, 1059]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 0.28804993629455566 with beta sum per layer: [0.0, 0.776581883430481, 0.8046364784240723]
optimal alpha/beta time: 0.18015837669372559
This batch time : update_bounds func: 0.1839	 prepare: 0.0020	 bound: 0.1803	 transfer: 0.0005	 finalize: 0.0011
Accumulated time: update_bounds func: 6.6240	 prepare: 0.0647	 bound: 6.5097	 transfer: 0.0005	 finalize: 0.0294
batch bounding time:  0.18406343460083008
Current worst splitting domains [lb, ub] (depth):
[-0.20872, 96.457390] (15), [-0.15485, 96.457390] (15), [-0.14313, 96.457390] (15), [-0.11867, 96.457390] (15), [-0.10955, 96.457390] (15), [-0.02490, 96.457390] (15), [-0.01527, 96.457390] (15), [-0.00887, 96.457390] (15), 
length of domains: 8
Total time: 0.2006	 pickout: 0.0012	 decision: 0.0148	 get_bound: 0.1841	 add_domain: 0.0005
Current lb:-0.20871829986572266
262 neurons visited
0 diving domains visited
Cumulative time: 3.7896780967712402

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1207], [1, 1207], [2, 79], [2, 79], [1, 1207], [1, 277], [1, 1207], [1, 1207]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -0.08579754829406738 with beta sum per layer: [0.0, 0.5400069355964661, 1.0300328731536865]
optimal alpha/beta time: 0.18114852905273438
This batch time : update_bounds func: 0.1851	 prepare: 0.0021	 bound: 0.1813	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 6.8091	 prepare: 0.0668	 bound: 6.6911	 transfer: 0.0006	 finalize: 0.0304
batch bounding time:  0.18520188331604004
Current worst splitting domains [lb, ub] (depth):
[-0.14849, 96.457390] (16), [-0.09353, 96.457390] (16), [-0.05124, 96.457390] (16), [-0.03681, 96.457390] (16), [-0.02737, 96.457390] (16), [-0.01225, 96.457390] (16), 
length of domains: 6
Total time: 0.2016	 pickout: 0.0012	 decision: 0.0147	 get_bound: 0.1852	 add_domain: 0.0004
Current lb:-0.14848828315734863
278 neurons visited
0 diving domains visited
Cumulative time: 3.9914772510528564

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 914], [1, 914], [1, 914], [1, 1059], [1, 1059], [1, 1207]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -0.5795552730560303 with beta sum per layer: [0.0, 0.0, 0.6909571886062622]
optimal alpha/beta time: 0.17930817604064941
This batch time : update_bounds func: 0.1825	 prepare: 0.0018	 bound: 0.1795	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 6.9916	 prepare: 0.0685	 bound: 6.8705	 transfer: 0.0005	 finalize: 0.0311
batch bounding time:  0.1826333999633789
Current worst splitting domains [lb, ub] (depth):
[-0.09189, 96.457390] (17), [-0.03776, 96.457390] (17), 
length of domains: 2
Total time: 0.1984	 pickout: 0.0010	 decision: 0.0146	 get_bound: 0.1827	 add_domain: 0.0002
Current lb:-0.09189438819885254
290 neurons visited
0 diving domains visited
Cumulative time: 4.190067529678345

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 618], [1, 618]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.15506529808044434 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17514538764953613
This batch time : update_bounds func: 0.1772	 prepare: 0.0012	 bound: 0.1753	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 7.1688	 prepare: 0.0697	 bound: 7.0459	 transfer: 0.0004	 finalize: 0.0314
batch bounding time:  0.17734718322753906
Current worst splitting domains [lb, ub] (depth):
[-0.02689, 96.457390] (18), 
length of domains: 1
Total time: 0.1919	 pickout: 0.0006	 decision: 0.0139	 get_bound: 0.1774	 add_domain: 0.0001
Current lb:-0.02688765525817871
294 neurons visited
0 diving domains visited
Cumulative time: 4.382094860076904

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 277]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.11295139789581299 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.0063436031341552734
This batch time : update_bounds func: 0.0081	 prepare: 0.0011	 bound: 0.0065	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 7.1769	 prepare: 0.0708	 bound: 7.0523	 transfer: 0.0003	 finalize: 0.0316
batch bounding time:  0.008108377456665039
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0224	 pickout: 0.0005	 decision: 0.0137	 get_bound: 0.0081	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 4.404511451721191

Image 2 pidx 8 verify end, final lower bound 999, upper bound 96.45738983154297, time: 4.448483467102051
2 999
##### [0:2] Tested against 5 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.725130796432495 with beta sum per layer: []
optimal alpha/beta time: 0.7435333728790283
alpha-CROWN with fixed intermediate bounds: tensor([[-3.7251]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.725130796432495
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 5.703380107879639 with beta sum per layer: [0.0, 0.0, 0.04906998947262764]
optimal alpha/beta time: 0.1743764877319336
This batch time : update_bounds func: 0.1761	 prepare: 0.0010	 bound: 0.1745	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 7.3530	 prepare: 0.0718	 bound: 7.2269	 transfer: 0.0003	 finalize: 0.0318
batch bounding time:  0.17621302604675293
Current worst splitting domains [lb, ub] (depth):
[-3.41188, 95.274872] (1), [-2.29150, 95.274872] (1), 
length of domains: 2
Total time: 0.1906	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.1762	 add_domain: 0.0001
Current lb:-3.4118783473968506
2 neurons visited
0 diving domains visited
Cumulative time: 0.9455888271331787

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 6.5392231941223145 with beta sum per layer: [0.0, 0.0, 1.545568585395813]
optimal alpha/beta time: 0.17800021171569824
This batch time : update_bounds func: 0.1800	 prepare: 0.0011	 bound: 0.1782	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 7.5330	 prepare: 0.0729	 bound: 7.4050	 transfer: 0.0004	 finalize: 0.0322
batch bounding time:  0.18011832237243652
Current worst splitting domains [lb, ub] (depth):
[-3.24963, 95.274872] (2), [-2.02914, 95.274872] (2), [-0.94873, 95.274872] (2), [-0.31172, 95.274872] (2), 
length of domains: 4
Total time: 0.1946	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1801	 add_domain: 0.0001
Current lb:-3.2496280670166016
6 neurons visited
0 diving domains visited
Cumulative time: 1.1402344703674316

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 7.326846599578857 with beta sum per layer: [0.0, 0.0, 3.9446306228637695]
optimal alpha/beta time: 0.17877793312072754
This batch time : update_bounds func: 0.1813	 prepare: 0.0014	 bound: 0.1789	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 7.7143	 prepare: 0.0743	 bound: 7.5840	 transfer: 0.0004	 finalize: 0.0327
batch bounding time:  0.18139123916625977
Current worst splitting domains [lb, ub] (depth):
[-2.89167, 95.274872] (3), [-2.04747, 95.274872] (3), [-1.62279, 95.274872] (3), [-0.86059, 95.274872] (3), [-0.35981, 95.274872] (3), [-0.05669, 95.274872] (3), 
length of domains: 6
Total time: 0.1965	 pickout: 0.0008	 decision: 0.0142	 get_bound: 0.1814	 add_domain: 0.0002
Current lb:-2.891669750213623
14 neurons visited
0 diving domains visited
Cumulative time: 1.3368773460388184

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1194], [2, 81], [1, 1194], [2, 85], [1, 1194], [2, 81]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 10.018987655639648 with beta sum per layer: [0.0, 0.0, 5.599748611450195]
optimal alpha/beta time: 0.1831531524658203
This batch time : update_bounds func: 0.1864	 prepare: 0.0018	 bound: 0.1833	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 7.9007	 prepare: 0.0761	 bound: 7.7673	 transfer: 0.0005	 finalize: 0.0334
batch bounding time:  0.18653035163879395
Current worst splitting domains [lb, ub] (depth):
[-2.49349, 95.274872] (4), [-2.27000, 95.274872] (4), [-1.61232, 95.274872] (4), [-1.50897, 95.274872] (4), [-1.18176, 95.274872] (4), [-1.10225, 95.274872] (4), [-0.58049, 95.274872] (4), [-0.10012, 95.274872] (4), 
length of domains: 8
Total time: 0.2037	 pickout: 0.0010	 decision: 0.0159	 get_bound: 0.1866	 add_domain: 0.0003
Current lb:-2.493485927581787
26 neurons visited
0 diving domains visited
Cumulative time: 1.540759563446045

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [1, 1194], [1, 1194], [2, 81], [2, 85], [2, 81], [2, 81]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 14.572271347045898 with beta sum per layer: [0.0, 0.0, 5.057389259338379]
optimal alpha/beta time: 0.18242740631103516
This batch time : update_bounds func: 0.1863	 prepare: 0.0021	 bound: 0.1826	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 8.0870	 prepare: 0.0781	 bound: 7.9499	 transfer: 0.0005	 finalize: 0.0345
batch bounding time:  0.186415433883667
Current worst splitting domains [lb, ub] (depth):
[-2.11500, 95.274872] (5), [-1.90517, 95.274872] (5), [-1.89016, 95.274872] (5), [-1.68772, 95.274872] (5), [-1.36256, 95.274872] (5), [-1.24776, 95.274872] (5), [-1.24191, 95.274872] (5), [-1.08858, 95.274872] (5), [-0.83245, 95.274872] (5), [-0.69433, 95.274872] (5), [-0.60935, 95.274872] (5), [-0.29064, 95.274872] (5), [-0.17368, 95.274872] (5), [-0.02118, 95.274872] (5), 
length of domains: 14
Total time: 0.2034	 pickout: 0.0012	 decision: 0.0153	 get_bound: 0.1864	 add_domain: 0.0005
Current lb:-2.1150035858154297
42 neurons visited
0 diving domains visited
Cumulative time: 1.744309663772583

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [1, 430], [2, 85], [2, 81], [2, 85]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: 18.76456069946289 with beta sum per layer: [0.0, 0.5060217976570129, 9.529644012451172]
optimal alpha/beta time: 0.18358349800109863
This batch time : update_bounds func: 0.1890	 prepare: 0.0029	 bound: 0.1838	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 8.2760	 prepare: 0.0810	 bound: 8.1337	 transfer: 0.0007	 finalize: 0.0361
batch bounding time:  0.18918418884277344
Current worst splitting domains [lb, ub] (depth):
[-1.87082, 95.274872] (6), [-1.66023, 95.274872] (6), [-1.64487, 95.274872] (6), [-1.52482, 95.274872] (6), [-1.44412, 95.274872] (6), [-1.36939, 95.274872] (6), [-1.27769, 95.274872] (6), [-1.19701, 95.274872] (6), [-1.12925, 95.274872] (6), [-1.06822, 95.274872] (6), [-1.06384, 95.274872] (6), [-0.84908, 95.274872] (6), [-0.70587, 95.274872] (6), [-0.61172, 95.274872] (6), [-0.58317, 95.274872] (6), [-0.41138, 95.274872] (6), [-0.40628, 95.274872] (6), [-0.35735, 95.274872] (6), [-0.33149, 95.274872] (6), [-0.30828, 95.274872] (6), 
length of domains: 20
Total time: 0.2092	 pickout: 0.0017	 decision: 0.0175	 get_bound: 0.1892	 add_domain: 0.0007
Current lb:-1.8708200454711914
70 neurons visited
0 diving domains visited
Cumulative time: 1.9537882804870605

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [1, 410], [1, 410], [1, 430], [1, 410], [1, 430], [1, 430], [2, 85], [1, 430], [2, 85]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: 22.951725006103516 with beta sum per layer: [0.0, 1.352079153060913, 13.609589576721191]
optimal alpha/beta time: 0.18394231796264648
This batch time : update_bounds func: 0.1910	 prepare: 0.0037	 bound: 0.1841	 transfer: 0.0008	 finalize: 0.0022
Accumulated time: update_bounds func: 8.4670	 prepare: 0.0848	 bound: 8.3178	 transfer: 0.0008	 finalize: 0.0383
batch bounding time:  0.19114899635314941
Current worst splitting domains [lb, ub] (depth):
[-1.74957, 95.274872] (7), [-1.42726, 95.274872] (7), [-1.29226, 95.274872] (7), [-1.24683, 95.274872] (7), [-1.24578, 95.274872] (7), [-1.24045, 95.274872] (7), [-1.19261, 95.274872] (7), [-1.18111, 95.274872] (7), [-1.05121, 95.274872] (7), [-1.02967, 95.274872] (7), [-0.98094, 95.274872] (7), [-0.97487, 95.274872] (7), [-0.93522, 95.274872] (7), [-0.90061, 95.274872] (7), [-0.83674, 95.274872] (7), [-0.82872, 95.274872] (7), [-0.82394, 95.274872] (7), [-0.67620, 95.274872] (7), [-0.63759, 95.274872] (7), [-0.56018, 95.274872] (7), 
length of domains: 30
Total time: 0.2131	 pickout: 0.0023	 decision: 0.0184	 get_bound: 0.1912	 add_domain: 0.0012
Current lb:-1.7495722770690918
110 neurons visited
0 diving domains visited
Cumulative time: 2.167292594909668

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 410], [1, 410], [2, 41], [1, 430], [1, 430], [2, 41], [1, 430], [2, 41], [1, 430], [2, 41]]
single_node_split: True
regular batch size: 2*30, diving batch size 1*0
best_l after optimization: 25.313488006591797 with beta sum per layer: [0.0, 2.459548234939575, 19.18340301513672]
optimal alpha/beta time: 0.18428468704223633
This batch time : update_bounds func: 0.1945	 prepare: 0.0051	 bound: 0.1845	 transfer: 0.0015	 finalize: 0.0033
Accumulated time: update_bounds func: 8.6615	 prepare: 0.0898	 bound: 8.5023	 transfer: 0.0015	 finalize: 0.0416
batch bounding time:  0.1946420669555664
Current worst splitting domains [lb, ub] (depth):
[-1.37132, 95.274872] (8), [-1.32976, 95.274872] (8), [-1.12597, 95.274872] (8), [-1.12458, 95.274872] (8), [-1.05642, 95.274872] (8), [-1.02118, 95.274872] (8), [-0.98191, 95.274872] (8), [-0.95458, 95.274872] (8), [-0.93844, 95.274872] (8), [-0.92401, 95.274872] (8), [-0.86370, 95.274872] (8), [-0.83904, 95.274872] (8), [-0.81368, 95.274872] (8), [-0.79928, 95.274872] (8), [-0.78878, 95.274872] (8), [-0.77648, 95.274872] (8), [-0.77526, 95.274872] (8), [-0.70691, 95.274872] (8), [-0.67859, 95.274872] (8), [-0.67194, 95.274872] (8), 
length of domains: 46
Total time: 0.2175	 pickout: 0.0033	 decision: 0.0176	 get_bound: 0.1947	 add_domain: 0.0019
Current lb:-1.371324062347412
170 neurons visited
0 diving domains visited
Cumulative time: 2.385340452194214

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 67], [2, 41], [2, 41], [2, 41], [2, 41], [2, 67], [2, 67], [1, 410]]
single_node_split: True
regular batch size: 2*46, diving batch size 1*0
best_l after optimization: 15.010265350341797 with beta sum per layer: [0.0, 4.726397514343262, 29.60711669921875]
optimal alpha/beta time: 0.1865231990814209
This batch time : update_bounds func: 0.2017	 prepare: 0.0072	 bound: 0.1867	 transfer: 0.0028	 finalize: 0.0049
Accumulated time: update_bounds func: 8.8633	 prepare: 0.0970	 bound: 8.6890	 transfer: 0.0028	 finalize: 0.0465
batch bounding time:  0.2019181251525879
Current worst splitting domains [lb, ub] (depth):
[-1.05741, 95.274872] (9), [-1.04084, 95.274872] (9), [-0.99658, 95.274872] (9), [-0.92033, 95.274872] (9), [-0.85938, 95.274872] (9), [-0.83981, 95.274872] (9), [-0.83184, 95.274872] (9), [-0.80599, 95.274872] (9), [-0.75783, 95.274872] (9), [-0.72371, 95.274872] (9), [-0.68204, 95.274872] (9), [-0.67093, 95.274872] (9), [-0.65126, 95.274872] (9), [-0.65057, 95.274872] (9), [-0.62642, 95.274872] (9), [-0.61856, 95.274872] (9), [-0.59481, 95.274872] (9), [-0.59170, 95.274872] (9), [-0.57566, 95.274872] (9), [-0.51853, 95.274872] (9), 
length of domains: 52
Total time: 0.2303	 pickout: 0.0048	 decision: 0.0212	 get_bound: 0.2021	 add_domain: 0.0022
Current lb:-1.0574126243591309
262 neurons visited
0 diving domains visited
Cumulative time: 2.6164565086364746

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 47], [2, 67], [2, 67], [2, 67], [2, 47], [2, 41], [2, 67], [2, 41]]
single_node_split: True
regular batch size: 2*52, diving batch size 1*0
best_l after optimization: 2.691572904586792 with beta sum per layer: [0.0, 3.1394500732421875, 27.372196197509766]
optimal alpha/beta time: 0.18487310409545898
This batch time : update_bounds func: 0.2012	 prepare: 0.0079	 bound: 0.1851	 transfer: 0.0026	 finalize: 0.0055
Accumulated time: update_bounds func: 9.0645	 prepare: 0.1049	 bound: 8.8740	 transfer: 0.0026	 finalize: 0.0520
batch bounding time:  0.2013838291168213
Current worst splitting domains [lb, ub] (depth):
[-0.89235, 95.274872] (10), [-0.88086, 95.274872] (10), [-0.86685, 95.274872] (10), [-0.70238, 95.274872] (10), [-0.69816, 95.274872] (10), [-0.67429, 95.274872] (10), [-0.62145, 95.274872] (10), [-0.58815, 95.274872] (10), [-0.54621, 95.274872] (10), [-0.53631, 95.274872] (10), [-0.51633, 95.274872] (10), [-0.48388, 95.274872] (10), [-0.48379, 95.274872] (10), [-0.47035, 95.274872] (10), [-0.46511, 95.274872] (10), [-0.41991, 95.274872] (10), [-0.40532, 95.274872] (10), [-0.38963, 95.274872] (10), [-0.36155, 95.274872] (10), [-0.34131, 95.274872] (10), 
length of domains: 45
Total time: 0.2313	 pickout: 0.0054	 decision: 0.0223	 get_bound: 0.2015	 add_domain: 0.0021
Current lb:-0.8923540115356445
366 neurons visited
0 diving domains visited
Cumulative time: 2.848649263381958

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47], [2, 45], [2, 47], [2, 45], [2, 47], [2, 47], [2, 47], [2, 45], [2, 45]]
single_node_split: True
regular batch size: 2*45, diving batch size 1*0
best_l after optimization: -3.4094648361206055 with beta sum per layer: [0.0, 2.577601909637451, 19.400175094604492]
optimal alpha/beta time: 0.18549394607543945
This batch time : update_bounds func: 0.1993	 prepare: 0.0070	 bound: 0.1857	 transfer: 0.0014	 finalize: 0.0051
Accumulated time: update_bounds func: 9.2638	 prepare: 0.1119	 bound: 9.0597	 transfer: 0.0014	 finalize: 0.0571
batch bounding time:  0.1994783878326416
Current worst splitting domains [lb, ub] (depth):
[-0.76791, 95.274872] (11), [-0.76606, 95.274872] (11), [-0.75248, 95.274872] (11), [-0.59990, 95.274872] (11), [-0.57051, 95.274872] (11), [-0.55138, 95.274872] (11), [-0.48639, 95.274872] (11), [-0.45687, 95.274872] (11), [-0.45521, 95.274872] (11), [-0.44450, 95.274872] (11), [-0.39809, 95.274872] (11), [-0.35829, 95.274872] (11), [-0.33724, 95.274872] (11), [-0.32218, 95.274872] (11), [-0.29651, 95.274872] (11), [-0.28316, 95.274872] (11), [-0.20151, 95.274872] (11), [-0.20037, 95.274872] (11), [-0.19879, 95.274872] (11), [-0.18509, 95.274872] (11), 
length of domains: 37
Total time: 0.2267	 pickout: 0.0047	 decision: 0.0206	 get_bound: 0.1996	 add_domain: 0.0018
Current lb:-0.7679109573364258
456 neurons visited
0 diving domains visited
Cumulative time: 3.07616925239563

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 41], [2, 45], [1, 430], [2, 45], [2, 45], [2, 78], [1, 410], [2, 45], [1, 410]]
single_node_split: True
regular batch size: 2*37, diving batch size 1*0
best_l after optimization: -10.05514144897461 with beta sum per layer: [0.0, 2.215244770050049, 11.044779777526855]
optimal alpha/beta time: 0.18678545951843262
This batch time : update_bounds func: 0.1983	 prepare: 0.0059	 bound: 0.1870	 transfer: 0.0012	 finalize: 0.0041
Accumulated time: update_bounds func: 9.4621	 prepare: 0.1178	 bound: 9.2467	 transfer: 0.0012	 finalize: 0.0612
batch bounding time:  0.19850969314575195
Current worst splitting domains [lb, ub] (depth):
[-0.66186, 95.274872] (12), [-0.63818, 95.274872] (12), [-0.50003, 95.274872] (12), [-0.47685, 95.274872] (12), [-0.45077, 95.274872] (12), [-0.43993, 95.274872] (12), [-0.34643, 95.274872] (12), [-0.34009, 95.274872] (12), [-0.31043, 95.274872] (12), [-0.25402, 95.274872] (12), [-0.25026, 95.274872] (12), [-0.21875, 95.274872] (12), [-0.20185, 95.274872] (12), [-0.19413, 95.274872] (12), [-0.15916, 95.274872] (12), [-0.14540, 95.274872] (12), [-0.11760, 95.274872] (12), [-0.11732, 95.274872] (12), [-0.10818, 95.274872] (12), [-0.10446, 95.274872] (12), 
length of domains: 34
Total time: 0.2310	 pickout: 0.0039	 decision: 0.0267	 get_bound: 0.1986	 add_domain: 0.0017
Current lb:-0.661860466003418
530 neurons visited
0 diving domains visited
Cumulative time: 3.3079116344451904

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 45]]
single_node_split: True
regular batch size: 2*34, diving batch size 1*0
best_l after optimization: -5.341867923736572 with beta sum per layer: [0.0, 1.5156956911087036, 9.133524894714355]
optimal alpha/beta time: 0.18459677696228027
This batch time : update_bounds func: 0.1955	 prepare: 0.0055	 bound: 0.1849	 transfer: 0.0011	 finalize: 0.0038
Accumulated time: update_bounds func: 9.6576	 prepare: 0.1233	 bound: 9.4315	 transfer: 0.0011	 finalize: 0.0650
batch bounding time:  0.1956338882446289
Current worst splitting domains [lb, ub] (depth):
[-0.44028, 95.274872] (13), [-0.41660, 95.274872] (13), [-0.39637, 95.274872] (13), [-0.37038, 95.274872] (13), [-0.30761, 95.274872] (13), [-0.28117, 95.274872] (13), [-0.23854, 95.274872] (13), [-0.23027, 95.274872] (13), [-0.21657, 95.274872] (13), [-0.18349, 95.274872] (13), [-0.18077, 95.274872] (13), [-0.13687, 95.274872] (13), [-0.12839, 95.274872] (13), [-0.12221, 95.274872] (13), [-0.11810, 95.274872] (13), [-0.11598, 95.274872] (13), [-0.08558, 95.274872] (13), [-0.06552, 95.274872] (13), [-0.01304, 95.274872] (13), [-0.00597, 95.274872] (13), 
length of domains: 20
Total time: 0.2184	 pickout: 0.0037	 decision: 0.0179	 get_bound: 0.1957	 add_domain: 0.0011
Current lb:-0.440279483795166
598 neurons visited
0 diving domains visited
Cumulative time: 3.5270333290100098

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 414]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: 0.4013209342956543 with beta sum per layer: [0.0, 0.08932393789291382, 2.503727436065674]
optimal alpha/beta time: 0.18204140663146973
This batch time : update_bounds func: 0.1890	 prepare: 0.0036	 bound: 0.1822	 transfer: 0.0008	 finalize: 0.0022
Accumulated time: update_bounds func: 9.8466	 prepare: 0.1269	 bound: 9.6138	 transfer: 0.0008	 finalize: 0.0672
batch bounding time:  0.18911075592041016
Current worst splitting domains [lb, ub] (depth):
[-0.29092, 95.274872] (14), [-0.26831, 95.274872] (14), [-0.25522, 95.274872] (14), [-0.24015, 95.274872] (14), [-0.23714, 95.274872] (14), [-0.22561, 95.274872] (14), [-0.14733, 95.274872] (14), [-0.12456, 95.274872] (14), [-0.11355, 95.274872] (14), [-0.08219, 95.274872] (14), [-0.07374, 95.274872] (14), [-0.06807, 95.274872] (14), [-0.06199, 95.274872] (14), [-0.05323, 95.274872] (14), [-0.02468, 95.274872] (14), [-0.01995, 95.274872] (14), [-0.01982, 95.274872] (14), [-0.01701, 95.274872] (14), 
length of domains: 18
Total time: 0.2084	 pickout: 0.0023	 decision: 0.0158	 get_bound: 0.1892	 add_domain: 0.0011
Current lb:-0.2909245491027832
638 neurons visited
0 diving domains visited
Cumulative time: 3.735872268676758

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 1207], [1, 269], [1, 1195], [1, 1195]]
single_node_split: True
regular batch size: 2*18, diving batch size 1*0
best_l after optimization: -2.3609859943389893 with beta sum per layer: [0.0, 0.22960928082466125, 1.5341943502426147]
optimal alpha/beta time: 0.18521666526794434
This batch time : update_bounds func: 0.1921	 prepare: 0.0033	 bound: 0.1854	 transfer: 0.0011	 finalize: 0.0021
Accumulated time: update_bounds func: 10.0387	 prepare: 0.1303	 bound: 9.7992	 transfer: 0.0011	 finalize: 0.0693
batch bounding time:  0.19226670265197754
Current worst splitting domains [lb, ub] (depth):
[-0.10006, 95.274872] (15), [-0.09979, 95.274872] (15), [-0.09133, 95.274872] (15), [-0.08110, 95.274872] (15), [-0.07657, 95.274872] (15), [-0.07613, 95.274872] (15), [-0.06935, 95.274872] (15), [-0.06082, 95.274872] (15), [-0.06080, 95.274872] (15), [-0.05431, 95.274872] (15), [-0.05103, 95.274872] (15), [-0.04988, 95.274872] (15), [-0.04379, 95.274872] (15), [-0.04061, 95.274872] (15), [-0.04046, 95.274872] (15), [-0.03552, 95.274872] (15), [-0.02752, 95.274872] (15), [-0.01813, 95.274872] (15), 
length of domains: 18
Total time: 0.2112	 pickout: 0.0021	 decision: 0.0157	 get_bound: 0.1923	 add_domain: 0.0011
Current lb:-0.10006141662597656
674 neurons visited
0 diving domains visited
Cumulative time: 3.947557210922241

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 269], [1, 1195], [1, 1195], [1, 1195], [1, 1195]]
single_node_split: True
regular batch size: 2*18, diving batch size 1*0
best_l after optimization: -7.054049968719482 with beta sum per layer: [0.0, 0.15470927953720093, 0.7236959934234619]
optimal alpha/beta time: 0.1799156665802002
This batch time : update_bounds func: 0.1867	 prepare: 0.0034	 bound: 0.1801	 transfer: 0.0011	 finalize: 0.0020
Accumulated time: update_bounds func: 10.2253	 prepare: 0.1337	 bound: 9.9793	 transfer: 0.0011	 finalize: 0.0714
batch bounding time:  0.18680691719055176
Current worst splitting domains [lb, ub] (depth):
[-0.07227, 95.274872] (16), [-0.06967, 95.274872] (16), [-0.05719, 95.274872] (16), [-0.05348, 95.274872] (16), [-0.05058, 95.274872] (16), [-0.03493, 95.274872] (16), [-0.03277, 95.274872] (16), [-0.03069, 95.274872] (16), [-0.02420, 95.274872] (16), [-0.02397, 95.274872] (16), [-0.01388, 95.274872] (16), [-0.00796, 95.274872] (16), [-0.00630, 95.274872] (16), 
length of domains: 13
Total time: 0.2055	 pickout: 0.0022	 decision: 0.0156	 get_bound: 0.1869	 add_domain: 0.0008
Current lb:-0.07226943969726562
710 neurons visited
0 diving domains visited
Cumulative time: 4.153483867645264

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 711], [1, 711], [1, 269], [2, 22], [2, 22], [2, 22], [1, 269], [1, 269], [1, 711], [1, 711]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0

all verified at 3th iter
best_l after optimization: -2.5707530975341797 with beta sum per layer: [0.0, 0.12146508693695068, 0.20296655595302582]
optimal alpha/beta time: 0.03239607810974121
This batch time : update_bounds func: 0.0377	 prepare: 0.0028	 bound: 0.0326	 transfer: 0.0007	 finalize: 0.0015
Accumulated time: update_bounds func: 10.2630	 prepare: 0.1365	 bound: 10.0118	 transfer: 0.0007	 finalize: 0.0729
batch bounding time:  0.03778576850891113
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0548	 pickout: 0.0017	 decision: 0.0152	 get_bound: 0.0378	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 4.208605051040649

Image 2 pidx 5 verify end, final lower bound 999, upper bound 95.27487182617188, time: 4.253225326538086
2 999
##### [0:2] Tested against 3 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.6607589721679688 with beta sum per layer: []
optimal alpha/beta time: 0.7137086391448975
alpha-CROWN with fixed intermediate bounds: tensor([[-2.6608]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.6607589721679688
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 3.0408833026885986 with beta sum per layer: [0.0, 0.0, 0.7081987857818604]
optimal alpha/beta time: 0.17846417427062988
This batch time : update_bounds func: 0.1802	 prepare: 0.0010	 bound: 0.1786	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 10.4432	 prepare: 0.1375	 bound: 10.1905	 transfer: 0.0004	 finalize: 0.0731
batch bounding time:  0.18036317825317383
Current worst splitting domains [lb, ub] (depth):
[-2.48005, 96.339241] (1), [-0.56083, 96.339241] (1), 
length of domains: 2
Total time: 0.1948	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.1804	 add_domain: 0.0001
Current lb:-2.480048418045044
2 neurons visited
0 diving domains visited
Cumulative time: 0.91994309425354

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 3.750208854675293 with beta sum per layer: [0.0, 0.0, 1.9492260217666626]
optimal alpha/beta time: 0.17719078063964844
This batch time : update_bounds func: 0.1792	 prepare: 0.0011	 bound: 0.1774	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 10.6224	 prepare: 0.1386	 bound: 10.3678	 transfer: 0.0004	 finalize: 0.0734
batch bounding time:  0.17933893203735352
Current worst splitting domains [lb, ub] (depth):
[-2.19189, 96.339241] (2), [-1.54901, 96.339241] (2), [-0.04558, 96.339241] (2), 
length of domains: 3
Total time: 0.1939	 pickout: 0.0006	 decision: 0.0138	 get_bound: 0.1794	 add_domain: 0.0001
Current lb:-2.1918938159942627
6 neurons visited
0 diving domains visited
Cumulative time: 1.1139042377471924

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 4.343398094177246 with beta sum per layer: [0.0, 0.0, 2.911686658859253]
optimal alpha/beta time: 0.17733454704284668
This batch time : update_bounds func: 0.1797	 prepare: 0.0013	 bound: 0.1775	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 10.8021	 prepare: 0.1398	 bound: 10.5453	 transfer: 0.0004	 finalize: 0.0738
batch bounding time:  0.1797633171081543
Current worst splitting domains [lb, ub] (depth):
[-1.88223, 96.339241] (3), [-1.29165, 96.339241] (3), [-1.19105, 96.339241] (3), [-0.78831, 96.339241] (3), 
length of domains: 4
Total time: 0.1943	 pickout: 0.0007	 decision: 0.0137	 get_bound: 0.1798	 add_domain: 0.0001
Current lb:-1.8822274208068848
12 neurons visited
0 diving domains visited
Cumulative time: 1.308323621749878

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 78], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 4.684326171875 with beta sum per layer: [0.0, 0.0, 3.7494702339172363]
optimal alpha/beta time: 0.17816543579101562
This batch time : update_bounds func: 0.1808	 prepare: 0.0014	 bound: 0.1783	 transfer: 0.0004	 finalize: 0.0006
Accumulated time: update_bounds func: 10.9829	 prepare: 0.1412	 bound: 10.7236	 transfer: 0.0004	 finalize: 0.0745
batch bounding time:  0.18094158172607422
Current worst splitting domains [lb, ub] (depth):
[-1.71020, 96.339241] (4), [-0.99501, 96.339241] (4), [-0.82066, 96.339241] (4), [-0.62866, 96.339241] (4), [-0.58996, 96.339241] (4), [-0.40836, 96.339241] (4), 
length of domains: 6
Total time: 0.1962	 pickout: 0.0008	 decision: 0.0143	 get_bound: 0.1810	 add_domain: 0.0002
Current lb:-1.7102019786834717
20 neurons visited
0 diving domains visited
Cumulative time: 1.5046343803405762

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78], [2, 78], [2, 22], [2, 41], [2, 78], [2, 78]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 4.1229424476623535 with beta sum per layer: [0.0, 0.0, 4.944109916687012]
optimal alpha/beta time: 0.17886018753051758
This batch time : update_bounds func: 0.1819	 prepare: 0.0016	 bound: 0.1790	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 11.1649	 prepare: 0.1428	 bound: 10.9026	 transfer: 0.0005	 finalize: 0.0752
batch bounding time:  0.18204641342163086
Current worst splitting domains [lb, ub] (depth):
[-1.30430, 96.339241] (5), [-1.13189, 96.339241] (5), [-0.65331, 96.339241] (5), [-0.63792, 96.339241] (5), [-0.23897, 96.339241] (5), [-0.22903, 96.339241] (5), [-0.17073, 96.339241] (5), [-0.10036, 96.339241] (5), 
length of domains: 8
Total time: 0.2003	 pickout: 0.0009	 decision: 0.0170	 get_bound: 0.1821	 add_domain: 0.0003
Current lb:-1.3042969703674316
32 neurons visited
0 diving domains visited
Cumulative time: 1.705110788345337

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [1, 905], [2, 41], [2, 41], [1, 415]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 1.8391451835632324 with beta sum per layer: [0.0, 0.0, 5.826794624328613]
optimal alpha/beta time: 0.18132758140563965
This batch time : update_bounds func: 0.1851	 prepare: 0.0020	 bound: 0.1815	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 11.3500	 prepare: 0.1448	 bound: 11.0841	 transfer: 0.0006	 finalize: 0.0762
batch bounding time:  0.1852412223815918
Current worst splitting domains [lb, ub] (depth):
[-0.97980, 96.339241] (6), [-0.80045, 96.339241] (6), [-0.78465, 96.339241] (6), [-0.60750, 96.339241] (6), [-0.31072, 96.339241] (6), [-0.25670, 96.339241] (6), [-0.14739, 96.339241] (6), [-0.08358, 96.339241] (6), 
length of domains: 8
Total time: 0.2018	 pickout: 0.0011	 decision: 0.0151	 get_bound: 0.1853	 add_domain: 0.0003
Current lb:-0.9798026084899902
48 neurons visited
0 diving domains visited
Cumulative time: 1.9071078300476074

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [2, 85], [1, 414], [2, 85], [2, 85], [1, 905], [1, 415], [2, 85]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 2.199939012527466 with beta sum per layer: [0.0, 0.13309650123119354, 3.939154624938965]
optimal alpha/beta time: 0.18357300758361816
This batch time : update_bounds func: 0.1874	 prepare: 0.0020	 bound: 0.1837	 transfer: 0.0006	 finalize: 0.0011
Accumulated time: update_bounds func: 11.5374	 prepare: 0.1468	 bound: 11.2679	 transfer: 0.0006	 finalize: 0.0773
batch bounding time:  0.18758082389831543
Current worst splitting domains [lb, ub] (depth):
[-0.85198, 96.339241] (7), [-0.55116, 96.339241] (7), [-0.53891, 96.339241] (7), [-0.51054, 96.339241] (7), [-0.43137, 96.339241] (7), [-0.33235, 96.339241] (7), [-0.26440, 96.339241] (7), [-0.07476, 96.339241] (7), [-0.07405, 96.339241] (7), 
length of domains: 9
Total time: 0.2038	 pickout: 0.0011	 decision: 0.0147	 get_bound: 0.1876	 add_domain: 0.0004
Current lb:-0.8519761562347412
64 neurons visited
0 diving domains visited
Cumulative time: 2.1111342906951904

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [1, 430], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [2, 45], [1, 430]]
single_node_split: True
regular batch size: 2*9, diving batch size 1*0
best_l after optimization: 1.0952966213226318 with beta sum per layer: [0.0, 0.20096972584724426, 2.431885242462158]
optimal alpha/beta time: 0.18226170539855957
This batch time : update_bounds func: 0.1864	 prepare: 0.0022	 bound: 0.1824	 transfer: 0.0006	 finalize: 0.0011
Accumulated time: update_bounds func: 11.7239	 prepare: 0.1490	 bound: 11.4503	 transfer: 0.0006	 finalize: 0.0784
batch bounding time:  0.18654990196228027
Current worst splitting domains [lb, ub] (depth):
[-0.63427, 96.339241] (8), [-0.42547, 96.339241] (8), [-0.36022, 96.339241] (8), [-0.29497, 96.339241] (8), [-0.28846, 96.339241] (8), [-0.21000, 96.339241] (8), [-0.18566, 96.339241] (8), [-0.13574, 96.339241] (8), [-0.07488, 96.339241] (8), [-0.05072, 96.339241] (8), [-0.00646, 96.339241] (8), 
length of domains: 11
Total time: 0.2040	 pickout: 0.0013	 decision: 0.0156	 get_bound: 0.1866	 add_domain: 0.0005
Current lb:-0.6342740058898926
82 neurons visited
0 diving domains visited
Cumulative time: 2.3153159618377686

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 45], [2, 79], [2, 45], [1, 430], [1, 430], [2, 45], [2, 45], [1, 430], [2, 45]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: -4.2213592529296875 with beta sum per layer: [0.0, 0.3628444969654083, 2.0205276012420654]
optimal alpha/beta time: 0.181549072265625
This batch time : update_bounds func: 0.1863	 prepare: 0.0025	 bound: 0.1817	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 11.9101	 prepare: 0.1515	 bound: 11.6321	 transfer: 0.0006	 finalize: 0.0797
batch bounding time:  0.18640542030334473
Current worst splitting domains [lb, ub] (depth):
[-0.51863, 96.339241] (9), [-0.29033, 96.339241] (9), [-0.19712, 96.339241] (9), [-0.16670, 96.339241] (9), [-0.11869, 96.339241] (9), [-0.08260, 96.339241] (9), [-0.04052, 96.339241] (9), 
length of domains: 7
Total time: 0.2037	 pickout: 0.0015	 decision: 0.0155	 get_bound: 0.1864	 add_domain: 0.0003
Current lb:-0.518625020980835
104 neurons visited
0 diving domains visited
Cumulative time: 2.519320011138916

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 45], [2, 79], [2, 45], [2, 45], [2, 79]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: -2.7804763317108154 with beta sum per layer: [0.0, 0.249538391828537, 1.2484468221664429]
optimal alpha/beta time: 0.18081355094909668
This batch time : update_bounds func: 0.1844	 prepare: 0.0019	 bound: 0.1810	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 12.0945	 prepare: 0.1534	 bound: 11.8130	 transfer: 0.0006	 finalize: 0.0806
batch bounding time:  0.18448996543884277
Current worst splitting domains [lb, ub] (depth):
[-0.29358, 96.339241] (10), [-0.13644, 96.339241] (10), [-0.08021, 96.339241] (10), [-0.07022, 96.339241] (10), 
length of domains: 4
Total time: 0.2005	 pickout: 0.0011	 decision: 0.0147	 get_bound: 0.1845	 add_domain: 0.0002
Current lb:-0.2935755252838135
118 neurons visited
0 diving domains visited
Cumulative time: 2.720038890838623

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 75], [2, 75], [2, 75], [2, 79]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: -1.070890188217163 with beta sum per layer: [0.0, 0.0, 0.3679281175136566]
optimal alpha/beta time: 0.16836071014404297
This batch time : update_bounds func: 0.1710	 prepare: 0.0015	 bound: 0.1685	 transfer: 0.0004	 finalize: 0.0006
Accumulated time: update_bounds func: 12.2655	 prepare: 0.1549	 bound: 11.9816	 transfer: 0.0004	 finalize: 0.0811
batch bounding time:  0.17113804817199707
Current worst splitting domains [lb, ub] (depth):
[-0.19079, 96.339241] (11), [-0.01983, 96.339241] (11), 
length of domains: 2
Total time: 0.1865	 pickout: 0.0008	 decision: 0.0144	 get_bound: 0.1712	 add_domain: 0.0001
Current lb:-0.19078826904296875
126 neurons visited
0 diving domains visited
Cumulative time: 2.906658411026001

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5], [1, 414]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -1.0919201374053955 with beta sum per layer: [0.0, 0.0, 0.14713053405284882]
optimal alpha/beta time: 0.17258620262145996
This batch time : update_bounds func: 0.1748	 prepare: 0.0013	 bound: 0.1728	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 12.4403	 prepare: 0.1562	 bound: 12.1544	 transfer: 0.0004	 finalize: 0.0814
batch bounding time:  0.17487454414367676
Current worst splitting domains [lb, ub] (depth):
[-0.09490, 96.339241] (12), 
length of domains: 1
Total time: 0.1893	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1749	 add_domain: 0.0001
Current lb:-0.09490036964416504
130 neurons visited
0 diving domains visited
Cumulative time: 3.09607195854187

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.3537437915802002 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006308794021606445
This batch time : update_bounds func: 0.0081	 prepare: 0.0011	 bound: 0.0064	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 12.4484	 prepare: 0.1572	 bound: 12.1608	 transfer: 0.0003	 finalize: 0.0816
batch bounding time:  0.008079767227172852
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0221	 pickout: 0.0005	 decision: 0.0135	 get_bound: 0.0081	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.118246078491211

Image 2 pidx 3 verify end, final lower bound 999, upper bound 96.33924102783203, time: 3.1625735759735107
2 999
##### [0:2] Tested against 6 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.481377124786377 with beta sum per layer: []
optimal alpha/beta time: 0.7229058742523193
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4814]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.481377124786377
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 2.9235992431640625 with beta sum per layer: [0.0, 0.0, 0.6712828278541565]
optimal alpha/beta time: 0.17617011070251465
This batch time : update_bounds func: 0.1779	 prepare: 0.0010	 bound: 0.1763	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 12.6263	 prepare: 0.1582	 bound: 12.3371	 transfer: 0.0003	 finalize: 0.0818
batch bounding time:  0.1779952049255371
Current worst splitting domains [lb, ub] (depth):
[-3.30013, 95.518623] (1), 
length of domains: 1
Total time: 0.1922	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.1780	 add_domain: 0.0001
Current lb:-3.300130844116211
2 neurons visited
0 diving domains visited
Cumulative time: 0.9264740943908691

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.676318645477295 with beta sum per layer: [0.0, 0.0, 0.03140841796994209]
optimal alpha/beta time: 0.17545032501220703
This batch time : update_bounds func: 0.1772	 prepare: 0.0010	 bound: 0.1756	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 12.8034	 prepare: 0.1592	 bound: 12.5127	 transfer: 0.0003	 finalize: 0.0820
batch bounding time:  0.17728567123413086
Current worst splitting domains [lb, ub] (depth):
[-2.57562, 95.518623] (2), [-2.10070, 95.518623] (2), 
length of domains: 2
Total time: 0.1913	 pickout: 0.0005	 decision: 0.0134	 get_bound: 0.1773	 add_domain: 0.0001
Current lb:-2.57562255859375
4 neurons visited
0 diving domains visited
Cumulative time: 1.1178717613220215

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 410], [2, 41]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 6.948789596557617 with beta sum per layer: [0.0, 0.08676125854253769, 0.1693054437637329]
optimal alpha/beta time: 0.17957353591918945
This batch time : update_bounds func: 0.1817	 prepare: 0.0012	 bound: 0.1797	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 12.9851	 prepare: 0.1604	 bound: 12.6925	 transfer: 0.0004	 finalize: 0.0823
batch bounding time:  0.18181443214416504
Current worst splitting domains [lb, ub] (depth):
[-1.98187, 95.518623] (3), [-1.87674, 95.518623] (3), [-1.73853, 95.518623] (3), [-1.35165, 95.518623] (3), 
length of domains: 4
Total time: 0.1963	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1819	 add_domain: 0.0001
Current lb:-1.9818696975708008
8 neurons visited
0 diving domains visited
Cumulative time: 1.3142707347869873

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 41], [2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 6.918606758117676 with beta sum per layer: [0.0, 0.15142256021499634, 2.278390884399414]
optimal alpha/beta time: 0.18230557441711426
This batch time : update_bounds func: 0.1851	 prepare: 0.0015	 bound: 0.1825	 transfer: 0.0004	 finalize: 0.0007
Accumulated time: update_bounds func: 13.1702	 prepare: 0.1619	 bound: 12.8750	 transfer: 0.0004	 finalize: 0.0830
batch bounding time:  0.1852114200592041
Current worst splitting domains [lb, ub] (depth):
[-1.79300, 95.518623] (4), [-1.48627, 95.518623] (4), [-1.44989, 95.518623] (4), [-1.22109, 95.518623] (4), [-1.08643, 95.518623] (4), [-0.10329, 95.518623] (4), 
length of domains: 6
Total time: 0.2006	 pickout: 0.0008	 decision: 0.0144	 get_bound: 0.1852	 add_domain: 0.0002
Current lb:-1.7930021286010742
16 neurons visited
0 diving domains visited
Cumulative time: 1.5149908065795898

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 67], [2, 83], [2, 67], [2, 83], [2, 38]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 4.654836654663086 with beta sum per layer: [0.0, 0.7857211828231812, 4.193129539489746]
optimal alpha/beta time: 0.18271565437316895
This batch time : update_bounds func: 0.1859	 prepare: 0.0017	 bound: 0.1829	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 13.3561	 prepare: 0.1636	 bound: 13.0579	 transfer: 0.0005	 finalize: 0.0838
batch bounding time:  0.18599152565002441
Current worst splitting domains [lb, ub] (depth):
[-1.36360, 95.518623] (5), [-1.24453, 95.518623] (5), [-1.20941, 95.518623] (5), [-1.16302, 95.518623] (5), [-0.94992, 95.518623] (5), [-0.87626, 95.518623] (5), 
length of domains: 6
Total time: 0.2023	 pickout: 0.0010	 decision: 0.0151	 get_bound: 0.1860	 add_domain: 0.0002
Current lb:-1.363595962524414
28 neurons visited
0 diving domains visited
Cumulative time: 1.7174854278564453

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [1, 410], [2, 83], [2, 67], [2, 83], [2, 38]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 4.228528022766113 with beta sum per layer: [0.0, 0.16168923676013947, 2.406604766845703]
optimal alpha/beta time: 0.18210911750793457
This batch time : update_bounds func: 0.1855	 prepare: 0.0018	 bound: 0.1823	 transfer: 0.0005	 finalize: 0.0009
Accumulated time: update_bounds func: 13.5416	 prepare: 0.1654	 bound: 13.2402	 transfer: 0.0005	 finalize: 0.0846
batch bounding time:  0.18559598922729492
Current worst splitting domains [lb, ub] (depth):
[-1.09622, 95.518623] (6), [-1.02074, 95.518623] (6), [-0.91464, 95.518623] (6), [-0.74842, 95.518623] (6), [-0.74557, 95.518623] (6), [-0.65768, 95.518623] (6), [-0.47052, 95.518623] (6), [-0.09732, 95.518623] (6), 
length of domains: 8
Total time: 0.2014	 pickout: 0.0010	 decision: 0.0145	 get_bound: 0.1856	 add_domain: 0.0003
Current lb:-1.0962166786193848
40 neurons visited
0 diving domains visited
Cumulative time: 1.9190728664398193

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [1, 1194], [2, 38], [2, 38], [2, 38], [2, 38], [2, 75], [1, 410]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 3.6310031414031982 with beta sum per layer: [0.0, 0.2730655372142792, 3.3482728004455566]
optimal alpha/beta time: 0.18192601203918457
This batch time : update_bounds func: 0.1858	 prepare: 0.0021	 bound: 0.1821	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 13.7274	 prepare: 0.1675	 bound: 13.4223	 transfer: 0.0005	 finalize: 0.0857
batch bounding time:  0.18594074249267578
Current worst splitting domains [lb, ub] (depth):
[-0.68945, 95.518623] (7), [-0.53566, 95.518623] (7), [-0.47532, 95.518623] (7), [-0.45797, 95.518623] (7), [-0.37739, 95.518623] (7), [-0.34782, 95.518623] (7), [-0.33252, 95.518623] (7), [-0.29305, 95.518623] (7), [-0.23526, 95.518623] (7), [-0.19643, 95.518623] (7), [-0.12224, 95.518623] (7), [-0.05284, 95.518623] (7), [-0.00699, 95.518623] (7), 
length of domains: 13
Total time: 0.2030	 pickout: 0.0012	 decision: 0.0153	 get_bound: 0.1860	 add_domain: 0.0005
Current lb:-0.6894450187683105
56 neurons visited
0 diving domains visited
Cumulative time: 2.122220277786255

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1194], [2, 38], [1, 1194], [2, 38], [1, 1194], [1, 1194], [2, 85], [1, 410], [1, 1194], [2, 85]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: -2.8165123462677 with beta sum per layer: [0.0, 0.5730530023574829, 3.9683096408843994]
optimal alpha/beta time: 0.18135452270507812
This batch time : update_bounds func: 0.1866	 prepare: 0.0028	 bound: 0.1815	 transfer: 0.0007	 finalize: 0.0015
Accumulated time: update_bounds func: 13.9140	 prepare: 0.1703	 bound: 13.6038	 transfer: 0.0007	 finalize: 0.0872
batch bounding time:  0.18668556213378906
Current worst splitting domains [lb, ub] (depth):
[-0.16141, 95.518623] (8), [-0.15922, 95.518623] (8), [-0.11424, 95.518623] (8), [-0.08141, 95.518623] (8), [-0.03755, 95.518623] (8), 
length of domains: 5
Total time: 0.2049	 pickout: 0.0017	 decision: 0.0163	 get_bound: 0.1867	 add_domain: 0.0003
Current lb:-0.16141128540039062
82 neurons visited
0 diving domains visited
Cumulative time: 2.3274331092834473

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 1194], [1, 655]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -2.184006690979004 with beta sum per layer: [0.0, 0.053843904286623, 0.0]
optimal alpha/beta time: 0.00639796257019043
This batch time : update_bounds func: 0.0094	 prepare: 0.0017	 bound: 0.0065	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 13.9234	 prepare: 0.1720	 bound: 13.6103	 transfer: 0.0005	 finalize: 0.0878
batch bounding time:  0.009435653686523438
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0248	 pickout: 0.0009	 decision: 0.0144	 get_bound: 0.0095	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.3523366451263428

Image 2 pidx 6 verify end, final lower bound 999, upper bound 95.51862335205078, time: 2.3979036808013916
2 999
##### [0:2] Tested against 2 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.555879592895508 with beta sum per layer: []
optimal alpha/beta time: 0.714184045791626
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5559]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.555879592895508
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 905]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.056882858276367 with beta sum per layer: [0.0, 0.1352522224187851, 0.0]
optimal alpha/beta time: 0.16866827011108398
This batch time : update_bounds func: 0.1704	 prepare: 0.0010	 bound: 0.1688	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 14.0938	 prepare: 0.1730	 bound: 13.7792	 transfer: 0.0003	 finalize: 0.0880
batch bounding time:  0.17050409317016602
Current worst splitting domains [lb, ub] (depth):
[-2.34690, 96.444122] (1), [-1.70998, 96.444122] (1), 
length of domains: 2
Total time: 0.1847	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.1705	 add_domain: 0.0001
Current lb:-2.3469038009643555
2 neurons visited
0 diving domains visited
Cumulative time: 0.9102895259857178

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 5.166163444519043 with beta sum per layer: [0.0, 0.3394465744495392, 0.0]
optimal alpha/beta time: 0.18000054359436035
This batch time : update_bounds func: 0.1821	 prepare: 0.0012	 bound: 0.1802	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 14.2758	 prepare: 0.1741	 bound: 13.9593	 transfer: 0.0004	 finalize: 0.0883
batch bounding time:  0.1821763515472412
Current worst splitting domains [lb, ub] (depth):
[-1.68238, 96.444122] (2), [-1.64262, 96.444122] (2), [-1.01623, 96.444122] (2), [-0.82493, 96.444122] (2), 
length of domains: 4
Total time: 0.1965	 pickout: 0.0006	 decision: 0.0136	 get_bound: 0.1822	 add_domain: 0.0001
Current lb:-1.6823840141296387
6 neurons visited
0 diving domains visited
Cumulative time: 1.106903076171875

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 2.063100814819336 with beta sum per layer: [0.0, 0.5665745735168457, 1.083620309829712]
optimal alpha/beta time: 0.18041372299194336
This batch time : update_bounds func: 0.1830	 prepare: 0.0015	 bound: 0.1806	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 14.4588	 prepare: 0.1756	 bound: 14.1399	 transfer: 0.0004	 finalize: 0.0889
batch bounding time:  0.18312358856201172
Current worst splitting domains [lb, ub] (depth):
[-1.50308, 96.444122] (3), [-1.49605, 96.444122] (3), [-0.82284, 96.444122] (3), [-0.62571, 96.444122] (3), 
length of domains: 4
Total time: 0.1982	 pickout: 0.0008	 decision: 0.0141	 get_bound: 0.1831	 add_domain: 0.0002
Current lb:-1.5030827522277832
14 neurons visited
0 diving domains visited
Cumulative time: 1.3052103519439697

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 38]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 4.354034423828125 with beta sum per layer: [0.0, 0.728395402431488, 0.36646026372909546]
optimal alpha/beta time: 0.18172955513000488
This batch time : update_bounds func: 0.1845	 prepare: 0.0015	 bound: 0.1819	 transfer: 0.0004	 finalize: 0.0007
Accumulated time: update_bounds func: 14.6433	 prepare: 0.1770	 bound: 14.3218	 transfer: 0.0004	 finalize: 0.0895
batch bounding time:  0.18462777137756348
Current worst splitting domains [lb, ub] (depth):
[-1.30347, 96.444122] (4), [-0.86204, 96.444122] (4), [-0.85421, 96.444122] (4), [-0.69919, 96.444122] (4), [-0.61801, 96.444122] (4), [-0.02656, 96.444122] (4), [-0.00521, 96.444122] (4), 
length of domains: 7
Total time: 0.1996	 pickout: 0.0008	 decision: 0.0139	 get_bound: 0.1846	 add_domain: 0.0003
Current lb:-1.3034706115722656
22 neurons visited
0 diving domains visited
Cumulative time: 1.5049536228179932

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 41], [2, 38], [2, 47], [2, 38]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 1.1719727516174316 with beta sum per layer: [0.0, 1.0228890180587769, 1.2947885990142822]
optimal alpha/beta time: 0.18240976333618164
This batch time : update_bounds func: 0.1858	 prepare: 0.0019	 bound: 0.1826	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 14.8292	 prepare: 0.1789	 bound: 14.5044	 transfer: 0.0005	 finalize: 0.0904
batch bounding time:  0.18595385551452637
Current worst splitting domains [lb, ub] (depth):
[-0.84666, 96.444122] (5), [-0.64275, 96.444122] (5), [-0.60246, 96.444122] (5), [-0.59482, 96.444122] (5), [-0.27489, 96.444122] (5), [-0.07531, 96.444122] (5), 
length of domains: 6
Total time: 0.2025	 pickout: 0.0011	 decision: 0.0151	 get_bound: 0.1860	 add_domain: 0.0002
Current lb:-0.846656084060669
36 neurons visited
0 diving domains visited
Cumulative time: 1.707606554031372

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [1, 415], [2, 41], [2, 41], [2, 38], [2, 41]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 0.1640007495880127 with beta sum per layer: [0.0, 0.7040285468101501, 1.3067525625228882]
optimal alpha/beta time: 0.18216538429260254
This batch time : update_bounds func: 0.1856	 prepare: 0.0018	 bound: 0.1823	 transfer: 0.0005	 finalize: 0.0009
Accumulated time: update_bounds func: 15.0148	 prepare: 0.1807	 bound: 14.6867	 transfer: 0.0005	 finalize: 0.0912
batch bounding time:  0.1856822967529297
Current worst splitting domains [lb, ub] (depth):
[-0.67412, 96.444122] (6), [-0.30596, 96.444122] (6), [-0.15054, 96.444122] (6), [-0.13743, 96.444122] (6), [-0.01767, 96.444122] (6), [-0.01263, 96.444122] (6), 
length of domains: 6
Total time: 0.2014	 pickout: 0.0010	 decision: 0.0145	 get_bound: 0.1857	 add_domain: 0.0002
Current lb:-0.6741185188293457
48 neurons visited
0 diving domains visited
Cumulative time: 1.9091911315917969

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 11], [2, 83], [2, 11], [2, 83]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -1.6099591255187988 with beta sum per layer: [0.0, 0.0, 0.11948507279157639]
optimal alpha/beta time: 0.1820383071899414
This batch time : update_bounds func: 0.1852	 prepare: 0.0018	 bound: 0.1822	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 15.2000	 prepare: 0.1825	 bound: 14.8689	 transfer: 0.0005	 finalize: 0.0920
batch bounding time:  0.18532705307006836
Current worst splitting domains [lb, ub] (depth):
[-0.21766, 96.444122] (7), [-0.12262, 96.444122] (7), [-0.03916, 96.444122] (7), 
length of domains: 3
Total time: 0.2010	 pickout: 0.0010	 decision: 0.0145	 get_bound: 0.1854	 add_domain: 0.0001
Current lb:-0.21766209602355957
60 neurons visited
0 diving domains visited
Cumulative time: 2.110353946685791

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 75], [2, 11], [2, 83]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.91288161277771 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17318248748779297
This batch time : update_bounds func: 0.1755	 prepare: 0.0013	 bound: 0.1734	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 15.3755	 prepare: 0.1838	 bound: 15.0423	 transfer: 0.0004	 finalize: 0.0924
batch bounding time:  0.17565226554870605
Current worst splitting domains [lb, ub] (depth):
[-0.09109, 96.444122] (8), 
length of domains: 1
Total time: 0.1903	 pickout: 0.0007	 decision: 0.0139	 get_bound: 0.1757	 add_domain: 0.0001
Current lb:-0.09109139442443848
66 neurons visited
0 diving domains visited
Cumulative time: 2.3008294105529785

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.36207032203674316 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.0063288211822509766
This batch time : update_bounds func: 0.0081	 prepare: 0.0011	 bound: 0.0065	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 15.3836	 prepare: 0.1849	 bound: 15.0488	 transfer: 0.0003	 finalize: 0.0926
batch bounding time:  0.008132696151733398
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0221	 pickout: 0.0005	 decision: 0.0135	 get_bound: 0.0081	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.3230085372924805

Image 2 pidx 2 verify end, final lower bound 999, upper bound 96.44412231445312, time: 2.3683652877807617
2 999
##### [0:2] Tested against 0 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.6235947608947754 with beta sum per layer: []
optimal alpha/beta time: 0.7307262420654297
alpha-CROWN with fixed intermediate bounds: tensor([[-1.6236]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.6235947608947754
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.4113972187042236 with beta sum per layer: [0.0, 0.0, 0.7153044939041138]
optimal alpha/beta time: 0.1753702163696289
This batch time : update_bounds func: 0.1771	 prepare: 0.0010	 bound: 0.1755	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 15.5606	 prepare: 0.1859	 bound: 15.2243	 transfer: 0.0003	 finalize: 0.0928
batch bounding time:  0.17717528343200684
Current worst splitting domains [lb, ub] (depth):
[-1.39178, 97.376404] (1), [-0.01962, 97.376404] (1), 
length of domains: 2
Total time: 0.1915	 pickout: 0.0005	 decision: 0.0137	 get_bound: 0.1772	 add_domain: 0.0001
Current lb:-1.3917818069458008
2 neurons visited
0 diving domains visited
Cumulative time: 0.9335033893585205

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [1, 563]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.23020052909851074 with beta sum per layer: [0.0, 0.0, 1.905006766319275]
optimal alpha/beta time: 0.17989611625671387
This batch time : update_bounds func: 0.1820	 prepare: 0.0012	 bound: 0.1801	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 15.7427	 prepare: 0.1871	 bound: 15.4044	 transfer: 0.0004	 finalize: 0.0931
batch bounding time:  0.18213844299316406
Current worst splitting domains [lb, ub] (depth):
[-1.23395, 97.376404] (2), 
length of domains: 1
Total time: 0.1965	 pickout: 0.0006	 decision: 0.0137	 get_bound: 0.1822	 add_domain: 0.0001
Current lb:-1.2339539527893066
6 neurons visited
0 diving domains visited
Cumulative time: 1.1300666332244873

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 563]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.475968360900879 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1755051612854004
This batch time : update_bounds func: 0.1773	 prepare: 0.0010	 bound: 0.1757	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 15.9200	 prepare: 0.1881	 bound: 15.5801	 transfer: 0.0004	 finalize: 0.0933
batch bounding time:  0.17741060256958008
Current worst splitting domains [lb, ub] (depth):
[-0.90507, 97.376404] (3), [-0.57089, 97.376404] (3), 
length of domains: 2
Total time: 0.1914	 pickout: 0.0005	 decision: 0.0134	 get_bound: 0.1774	 add_domain: 0.0001
Current lb:-0.9050745964050293
8 neurons visited
0 diving domains visited
Cumulative time: 1.3215539455413818

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.7324116230010986 with beta sum per layer: [0.0, 0.0, 0.43343526124954224]
optimal alpha/beta time: 0.17940092086791992
This batch time : update_bounds func: 0.1815	 prepare: 0.0012	 bound: 0.1796	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 16.1015	 prepare: 0.1893	 bound: 15.7596	 transfer: 0.0004	 finalize: 0.0936
batch bounding time:  0.18159914016723633
Current worst splitting domains [lb, ub] (depth):
[-0.60233, 97.376404] (4), [-0.28482, 97.376404] (4), 
length of domains: 2
Total time: 0.1959	 pickout: 0.0006	 decision: 0.0136	 get_bound: 0.1816	 add_domain: 0.0001
Current lb:-0.6023321151733398
12 neurons visited
0 diving domains visited
Cumulative time: 1.5175468921661377

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.12257957458496094 with beta sum per layer: [0.0, 0.0, 0.25697505474090576]
optimal alpha/beta time: 0.18116402626037598
This batch time : update_bounds func: 0.1842	 prepare: 0.0021	 bound: 0.1813	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 16.2857	 prepare: 0.1914	 bound: 15.9410	 transfer: 0.0004	 finalize: 0.0939
batch bounding time:  0.18429923057556152
Current worst splitting domains [lb, ub] (depth):
[-0.19499, 97.376404] (5), 
length of domains: 1
Total time: 0.1985	 pickout: 0.0006	 decision: 0.0136	 get_bound: 0.1843	 add_domain: 0.0001
Current lb:-0.19498777389526367
16 neurons visited
0 diving domains visited
Cumulative time: 1.7161753177642822

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 612]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.28413867950439453 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17347168922424316
This batch time : update_bounds func: 0.1753	 prepare: 0.0011	 bound: 0.1736	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 16.4610	 prepare: 0.1925	 bound: 16.1146	 transfer: 0.0004	 finalize: 0.0941
batch bounding time:  0.1753990650177002
Current worst splitting domains [lb, ub] (depth):
[-0.01140, 97.376404] (6), 
length of domains: 1
Total time: 0.1898	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.1754	 add_domain: 0.0001
Current lb:-0.011400222778320312
18 neurons visited
0 diving domains visited
Cumulative time: 1.9060356616973877

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5039639472961426 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006430625915527344
This batch time : update_bounds func: 0.0082	 prepare: 0.0011	 bound: 0.0066	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 16.4691	 prepare: 0.1936	 bound: 16.1212	 transfer: 0.0003	 finalize: 0.0943
batch bounding time:  0.008196353912353516
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0223	 pickout: 0.0005	 decision: 0.0136	 get_bound: 0.0082	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.9284296035766602

Image 2 pidx 0 verify end, final lower bound 999, upper bound 97.37640380859375, time: 1.9735431671142578
2 999
##### [0:2] Tested against 1 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.6013956069946289 with beta sum per layer: []
optimal alpha/beta time: 0.7303831577301025
alpha-CROWN with fixed intermediate bounds: tensor([[-0.6014]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.6013956069946289
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.3626675605773926 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1636354923248291
This batch time : update_bounds func: 0.1654	 prepare: 0.0010	 bound: 0.1638	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 16.6345	 prepare: 0.1946	 bound: 16.2850	 transfer: 0.0003	 finalize: 0.0945
batch bounding time:  0.16547203063964844
Current worst splitting domains [lb, ub] (depth):
[-0.05071, 98.398605] (1), 
length of domains: 1
Total time: 0.1797	 pickout: 0.0005	 decision: 0.0137	 get_bound: 0.1655	 add_domain: 0.0001
Current lb:-0.05071067810058594
2 neurons visited
0 diving domains visited
Cumulative time: 0.9215450286865234

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.8762502670288086 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.00638127326965332
This batch time : update_bounds func: 0.0081	 prepare: 0.0010	 bound: 0.0065	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 16.6426	 prepare: 0.1956	 bound: 16.2915	 transfer: 0.0003	 finalize: 0.0947
batch bounding time:  0.008102655410766602
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0224	 pickout: 0.0005	 decision: 0.0138	 get_bound: 0.0081	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 0.9440090656280518

Image 2 pidx 1 verify end, final lower bound 999, upper bound 98.39860534667969, time: 0.9893743991851807
2 999
##### [0:2] Tested against 9 ######
correct label, skip!
[[  2.           0.           0.           0.74152446   0.
   -3.                  inf          inf]
 [  2.           0.           0.           4.98097801   0.
   -1.                  inf          inf]
 [  2.         999.          24.           3.24866819   0.
    4.          98.13798523   0.77242827]
 [  2.         999.         176.           3.21437168   0.
    7.          95.51908875   4.63081026]
 [  2.         999.         296.           4.44848347   0.
    8.          96.45738983   5.20398712]
 [  2.         999.         736.           4.25322533   0.
    5.          95.27487183   5.94195986]
 [  2.         999.         132.           3.16257358   0.
    3.          96.33924103   6.22093773]
 [  2.         999.          92.           2.39790368   0.
    6.          95.51862335   6.71611691]
 [  2.         999.          68.           2.36836529   0.
    2.          96.44412231   6.99869823]
 [  2.         999.          20.           1.97354317   0.
    0.          97.37640381   8.33151913]
 [  2.         999.           4.           0.9893744    0.
    1.          98.39860535   9.21309662]
 [  2.           0.           0.           0.           0.
    9.                  inf          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 31.037486791610718

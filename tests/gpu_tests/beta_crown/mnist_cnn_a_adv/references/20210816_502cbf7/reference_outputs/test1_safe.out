Experiments at Sun Oct 31 19:31:24 2021 on huan-Naples-server
Namespace(batch_size=600, beta_warmup=True, branching_candidates=3, branching_method='kfsb', branching_reduceop='max', complete_verifier='bab', conv_mode='patches', crown=False, data='MNIST_SDP', decision_thresh=0, deterministic=False, device='cuda', double_fp=False, end=3, epsilon=None, incomplete=True, init_iteration=100, intermediate_refinement_layers=[-1], iteration=20, load='sdp_models/mnist_0.3_cnn_a_adv.model', loss_reduction_func='sum', lp_test=None, lr_alpha=0.01, lr_beta=0.05, lr_decay=0.98, lr_init_alpha=0.1, lr_intermediate_beta=0.05, max_refinement_domains=1000, max_subproblems_list=200000, mip_multi_proc=None, mip_perneuron_refine_timeout=15, mip_refine_timeout=0.8, mip_threads=1, mode='verified-acc', model='mnist_cnn_4layer', no_beta=False, no_joint_opt=False, no_warm=False, norm=inf, opt_bias=False, opt_coeffs=False, opt_intermediate_beta=False, optimizer='adam', pgd_order='before', record_lb=False, refinement_batch_size=-1, seed=100, share_slopes=False, solve_slope=True, start=2, timeout=120.0)
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
complete verification for verified accuracy, set decision_thresh to be 0
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.1340)
############################
epsilon after preprocession: 0.30000001192092896, data_max = tensor([[[[1.]]]]), data_min = tensor([[[[0.]]]])
saving results to Verified_ret_[mnist_cnn_4layer]_start=2_end=3_iter=20_b=600_int-beta=False_timeout=120.0_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  9  correct label  9 logits tensor([-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
        -1.0512,  3.9617], grad_fn=<SelectBackward>)
##### PGD attack: True label: 9, Tested against: all others ######
pgd prediction: tensor([-5.3261, -6.1751, -3.9652, -3.1862,  2.2856, -2.9095, -3.6913, -1.5793,
        -2.1711,  3.0557], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([8.3818, 9.2308, 7.0209, 6.2418, 0.7701, 5.9652, 6.7470, 4.6350, 5.2268,
           inf], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
best_l after optimization: 21.579713821411133 with beta sum per layer: []
optimal alpha/beta time: 4.706868648529053
initial alpha-CROWN bounds: tensor([[-1.6287, -0.6077, -2.5624, -2.6650, -0.8637, -3.7308, -3.4895, -3.4854,
         -2.5466]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:2] Tested against 0 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.628525733947754 with beta sum per layer: []
optimal alpha/beta time: 0.9499950408935547
alpha-CROWN with fixed intermediate bounds: tensor([[-1.6285]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.628525733947754
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 83]]
single_node_split: True
best_l after optimization: 1.4279093742370605 with beta sum per layer: [0.0, 0.0, 0.7125107645988464]
optimal alpha/beta time: 0.1782975196838379
This batch time : update_bounds func: 0.1800	 prepare: 0.0009	 bound: 0.1785	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.1800	 prepare: 0.0009	 bound: 0.1785	 transfer: 0.0004	 finalize: 0.0002
batch bounding time:  0.18002009391784668
Current worst domains: [-1.3970117568969727, -0.03089761734008789]
length of domains: 2
Total time: 0.1969	 pickout: 0.0007	 decision: 0.0161	 get_bound: 0.1800	 add_domain: 0.0001
Current lb:-1.3970117568969727
2 neurons visited

splitting decisions: [[2, 22], [1, 563]]
single_node_split: True
best_l after optimization: -0.19423484802246094 with beta sum per layer: [0.0, 0.0, 1.900757074356079]
optimal alpha/beta time: 0.18302226066589355
This batch time : update_bounds func: 0.1851	 prepare: 0.0012	 bound: 0.1832	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.3651	 prepare: 0.0021	 bound: 0.3616	 transfer: 0.0004	 finalize: 0.0005
batch bounding time:  0.18516206741333008
Current worst domains: [-1.238595962524414]
length of domains: 1
Total time: 0.2019	 pickout: 0.0006	 decision: 0.0161	 get_bound: 0.1852	 add_domain: 0.0001
Current lb:-1.238595962524414
6 neurons visited

splitting decisions: [[1, 563]]
single_node_split: True
best_l after optimization: 1.486426830291748 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17987513542175293
This batch time : update_bounds func: 0.1816	 prepare: 0.0010	 bound: 0.1800	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 0.5467	 prepare: 0.0031	 bound: 0.5416	 transfer: 0.0004	 finalize: 0.0007
batch bounding time:  0.18166279792785645
Current worst domains: [-0.9100255966186523, -0.5764012336730957]
length of domains: 2
Total time: 0.1978	 pickout: 0.0005	 decision: 0.0155	 get_bound: 0.1817	 add_domain: 0.0001
Current lb:-0.9100255966186523
8 neurons visited

splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
best_l after optimization: 0.7536351680755615 with beta sum per layer: [0.0, 0.0, 0.43294671177864075]
optimal alpha/beta time: 0.18294930458068848
This batch time : update_bounds func: 0.1850	 prepare: 0.0012	 bound: 0.1831	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.7318	 prepare: 0.0042	 bound: 0.7247	 transfer: 0.0004	 finalize: 0.0010
batch bounding time:  0.18503832817077637
Current worst domains: [-0.6071176528930664, -0.28952622413635254]
length of domains: 2
Total time: 0.2017	 pickout: 0.0006	 decision: 0.0159	 get_bound: 0.1851	 add_domain: 0.0001
Current lb:-0.6071176528930664
12 neurons visited

splitting decisions: [[2, 85], [2, 85]]
single_node_split: True
best_l after optimization: -0.12437701225280762 with beta sum per layer: [0.0, 0.0, 0.2677847743034363]
optimal alpha/beta time: 0.18451571464538574
This batch time : update_bounds func: 0.1866	 prepare: 0.0011	 bound: 0.1847	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 0.9183	 prepare: 0.0054	 bound: 0.9094	 transfer: 0.0004	 finalize: 0.0014
batch bounding time:  0.18660593032836914
Current worst domains: [-0.19893789291381836]
length of domains: 1
Total time: 0.2030	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.1866	 add_domain: 0.0001
Current lb:-0.19893789291381836
16 neurons visited

splitting decisions: [[1, 612]]
single_node_split: True
best_l after optimization: -0.27216053009033203 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17029166221618652
This batch time : update_bounds func: 0.1721	 prepare: 0.0010	 bound: 0.1704	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 1.0904	 prepare: 0.0064	 bound: 1.0798	 transfer: 0.0004	 finalize: 0.0016
batch bounding time:  0.17209529876708984
Current worst domains: [-0.017598628997802734]
length of domains: 1
Total time: 0.1885	 pickout: 0.0005	 decision: 0.0158	 get_bound: 0.1722	 add_domain: 0.0001
Current lb:-0.017598628997802734
18 neurons visited

splitting decisions: [[1, 430]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.4911074638366699 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.00678253173828125
This batch time : update_bounds func: 0.0084	 prepare: 0.0010	 bound: 0.0069	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 1.0988	 prepare: 0.0074	 bound: 1.0867	 transfer: 0.0003	 finalize: 0.0018
batch bounding time:  0.008446455001831055
Current worst domains: []
length of domains: 0
Total time: 0.0246	 pickout: 0.0005	 decision: 0.0156	 get_bound: 0.0085	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 0 verify end, Time cost: 2.5690436363220215
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0]]
##### [0:2] Tested against 1 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.6076498031616211 with beta sum per layer: []
optimal alpha/beta time: 0.7732887268066406
alpha-CROWN with fixed intermediate bounds: tensor([[-0.6076]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.6076498031616211
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 67]]
single_node_split: True
best_l after optimization: -0.3479499816894531 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1735379695892334
This batch time : update_bounds func: 0.1752	 prepare: 0.0009	 bound: 0.1737	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 1.2740	 prepare: 0.0083	 bound: 1.2603	 transfer: 0.0004	 finalize: 0.0020
batch bounding time:  0.17522144317626953
Current worst domains: [-0.056664466857910156]
length of domains: 1
Total time: 0.1915	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.1752	 add_domain: 0.0000
Current lb:-0.056664466857910156
2 neurons visited

splitting decisions: [[2, 47]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -1.8650903701782227 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.00669097900390625
This batch time : update_bounds func: 0.0082	 prepare: 0.0009	 bound: 0.0068	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 1.2823	 prepare: 0.0092	 bound: 1.2671	 transfer: 0.0003	 finalize: 0.0022
batch bounding time:  0.008267402648925781
Current worst domains: []
length of domains: 0
Total time: 0.0242	 pickout: 0.0005	 decision: 0.0155	 get_bound: 0.0083	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 1 verify end, Time cost: 1.045989990234375
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1]]
##### [0:2] Tested against 2 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.562056541442871 with beta sum per layer: []
optimal alpha/beta time: 0.7588298320770264
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5621]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.562056541442871
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[1, 905]]
single_node_split: True
best_l after optimization: 4.068979263305664 with beta sum per layer: [0.0, 0.13470472395420074, 0.0]
optimal alpha/beta time: 0.17544865608215332
This batch time : update_bounds func: 0.1771	 prepare: 0.0009	 bound: 0.1756	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 1.4594	 prepare: 0.0101	 bound: 1.4427	 transfer: 0.0004	 finalize: 0.0024
batch bounding time:  0.1771402359008789
Current worst domains: [-2.35284423828125, -1.716135025024414]
length of domains: 2
Total time: 0.1934	 pickout: 0.0005	 decision: 0.0156	 get_bound: 0.1772	 add_domain: 0.0001
Current lb:-2.35284423828125
2 neurons visited

splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
best_l after optimization: 5.189459323883057 with beta sum per layer: [0.0, 0.3384060859680176, 0.0]
optimal alpha/beta time: 0.18154430389404297
This batch time : update_bounds func: 0.1835	 prepare: 0.0011	 bound: 0.1817	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 1.6429	 prepare: 0.0112	 bound: 1.6244	 transfer: 0.0004	 finalize: 0.0027
batch bounding time:  0.18355727195739746
Current worst domains: [-1.690206527709961, -1.6470770835876465, -1.0214099884033203, -0.8307657241821289]
length of domains: 4
Total time: 0.2000	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.1836	 add_domain: 0.0001
Current lb:-1.690206527709961
6 neurons visited

splitting decisions: [[2, 22], [2, 22], [2, 22], [2, 22]]
single_node_split: True
best_l after optimization: 2.1175119876861572 with beta sum per layer: [0.0, 0.5652904510498047, 1.0829863548278809]
optimal alpha/beta time: 0.18360590934753418
This batch time : update_bounds func: 0.1862	 prepare: 0.0014	 bound: 0.1837	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 1.8291	 prepare: 0.0126	 bound: 1.8081	 transfer: 0.0005	 finalize: 0.0032
batch bounding time:  0.1862475872039795
Current worst domains: [-1.5113592147827148, -1.5023870468139648, -0.8283462524414062, -0.6320071220397949]
length of domains: 4
Total time: 0.2035	 pickout: 0.0008	 decision: 0.0163	 get_bound: 0.1863	 add_domain: 0.0001
Current lb:-1.5113592147827148
14 neurons visited

splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 38]]
single_node_split: True
best_l after optimization: 4.400443077087402 with beta sum per layer: [0.0, 0.7332167625427246, 0.3509063720703125]
optimal alpha/beta time: 0.183211088180542
This batch time : update_bounds func: 0.1859	 prepare: 0.0014	 bound: 0.1833	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 2.0150	 prepare: 0.0140	 bound: 1.9915	 transfer: 0.0005	 finalize: 0.0039
batch bounding time:  0.18593478202819824
Current worst domains: [-1.3087875843048096, -0.8685078620910645, -0.8626284599304199, -0.7041234970092773, -0.6240293979644775, -0.030426979064941406, -0.009378194808959961]
length of domains: 7
Total time: 0.2030	 pickout: 0.0008	 decision: 0.0160	 get_bound: 0.1860	 add_domain: 0.0002
Current lb:-1.3087875843048096
22 neurons visited

splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 41], [2, 38], [2, 47], [2, 38]]
single_node_split: True
best_l after optimization: 1.231015682220459 with beta sum per layer: [0.0, 1.0172538757324219, 1.2774815559387207]
optimal alpha/beta time: 0.18484711647033691
This batch time : update_bounds func: 0.1882	 prepare: 0.0018	 bound: 0.1850	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 2.2032	 prepare: 0.0158	 bound: 2.1765	 transfer: 0.0005	 finalize: 0.0047
batch bounding time:  0.1882939338684082
Current worst domains: [-0.8520016670227051, -0.6491260528564453, -0.6055247783660889, -0.602081298828125, -0.2804131507873535, -0.08066821098327637, -0.0021266937255859375]
length of domains: 7
Total time: 0.2069	 pickout: 0.0011	 decision: 0.0173	 get_bound: 0.1883	 add_domain: 0.0003
Current lb:-0.8520016670227051
36 neurons visited

splitting decisions: [[2, 83], [1, 415], [2, 41], [2, 41], [2, 38], [2, 41], [2, 41]]
single_node_split: True
best_l after optimization: -0.8858497142791748 with beta sum per layer: [0.0, 0.7294024229049683, 1.8616206645965576]
optimal alpha/beta time: 0.18694782257080078
This batch time : update_bounds func: 0.1906	 prepare: 0.0019	 bound: 0.1871	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 2.3938	 prepare: 0.0178	 bound: 2.3636	 transfer: 0.0005	 finalize: 0.0057
batch bounding time:  0.19063544273376465
Current worst domains: [-0.6790058612823486, -0.3124094009399414, -0.154296875, -0.14485645294189453, -0.023327350616455078, -0.020191192626953125]
length of domains: 6
Total time: 0.2087	 pickout: 0.0011	 decision: 0.0168	 get_bound: 0.1907	 add_domain: 0.0002
Current lb:-0.6790058612823486
50 neurons visited

splitting decisions: [[2, 41], [2, 41], [2, 11], [2, 83], [2, 83], [2, 83]]
single_node_split: True
best_l after optimization: -1.5651299953460693 with beta sum per layer: [0.0, 0.0, 0.10002076625823975]
optimal alpha/beta time: 0.1807112693786621
This batch time : update_bounds func: 0.1837	 prepare: 0.0017	 bound: 0.1808	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 2.5776	 prepare: 0.0195	 bound: 2.5444	 transfer: 0.0005	 finalize: 0.0064
batch bounding time:  0.18377304077148438
Current worst domains: [-0.22249484062194824, -0.12810897827148438, -0.041391849517822266]
length of domains: 3
Total time: 0.2020	 pickout: 0.0010	 decision: 0.0170	 get_bound: 0.1838	 add_domain: 0.0001
Current lb:-0.22249484062194824
62 neurons visited

splitting decisions: [[2, 75], [2, 11], [2, 83]]
single_node_split: True
best_l after optimization: -0.8855991363525391 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.1753556728363037
This batch time : update_bounds func: 0.1777	 prepare: 0.0013	 bound: 0.1755	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 2.7552	 prepare: 0.0208	 bound: 2.7199	 transfer: 0.0004	 finalize: 0.0068
batch bounding time:  0.17769217491149902
Current worst domains: [-0.0958409309387207]
length of domains: 1
Total time: 0.1945	 pickout: 0.0007	 decision: 0.0160	 get_bound: 0.1777	 add_domain: 0.0001
Current lb:-0.0958409309387207
68 neurons visited

splitting decisions: [[2, 11]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.3506932258605957 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006806135177612305
This batch time : update_bounds func: 0.0085	 prepare: 0.0011	 bound: 0.0069	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 2.7637	 prepare: 0.0218	 bound: 2.7268	 transfer: 0.0003	 finalize: 0.0070
batch bounding time:  0.008553504943847656
Current worst domains: []
length of domains: 0
Total time: 0.0271	 pickout: 0.0005	 decision: 0.0179	 get_bound: 0.0086	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 2 verify end, Time cost: 2.4551780223846436
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2]]
##### [0:2] Tested against 3 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.665693998336792 with beta sum per layer: []
optimal alpha/beta time: 0.756695032119751
alpha-CROWN with fixed intermediate bounds: tensor([[-2.6657]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.665693998336792
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 83]]
single_node_split: True
best_l after optimization: 3.0504860877990723 with beta sum per layer: [0.0, 0.0, 0.7077245712280273]
optimal alpha/beta time: 0.17589139938354492
This batch time : update_bounds func: 0.1775	 prepare: 0.0009	 bound: 0.1760	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 2.9412	 prepare: 0.0228	 bound: 2.9028	 transfer: 0.0003	 finalize: 0.0072
batch bounding time:  0.17749643325805664
Current worst domains: [-2.4868338108062744, -0.5636522769927979]
length of domains: 2
Total time: 0.1937	 pickout: 0.0005	 decision: 0.0156	 get_bound: 0.1775	 add_domain: 0.0001
Current lb:-2.4868338108062744
2 neurons visited

splitting decisions: [[2, 38], [2, 38]]
single_node_split: True
best_l after optimization: 3.769002676010132 with beta sum per layer: [0.0, 0.0, 1.9421749114990234]
optimal alpha/beta time: 0.1774885654449463
This batch time : update_bounds func: 0.1794	 prepare: 0.0011	 bound: 0.1776	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 3.1206	 prepare: 0.0238	 bound: 3.0804	 transfer: 0.0004	 finalize: 0.0075
batch bounding time:  0.17939209938049316
Current worst domains: [-2.1962099075317383, -1.5546951293945312, -0.04980659484863281]
length of domains: 3
Total time: 0.1958	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.1794	 add_domain: 0.0001
Current lb:-2.1962099075317383
6 neurons visited

splitting decisions: [[2, 67], [2, 67], [2, 67]]
single_node_split: True
best_l after optimization: 4.371270179748535 with beta sum per layer: [0.0, 0.0, 2.904106378555298]
optimal alpha/beta time: 0.17717742919921875
This batch time : update_bounds func: 0.1793	 prepare: 0.0012	 bound: 0.1773	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 3.2999	 prepare: 0.0250	 bound: 3.2577	 transfer: 0.0004	 finalize: 0.0079
batch bounding time:  0.17933273315429688
Current worst domains: [-1.886760950088501, -1.2988762855529785, -1.1972873210906982, -0.7947158813476562]
length of domains: 4
Total time: 0.1961	 pickout: 0.0007	 decision: 0.0159	 get_bound: 0.1794	 add_domain: 0.0001
Current lb:-1.886760950088501
12 neurons visited

splitting decisions: [[2, 22], [2, 78], [2, 22], [2, 22]]
single_node_split: True
best_l after optimization: 4.731164932250977 with beta sum per layer: [0.0, 0.0, 3.7786664962768555]
optimal alpha/beta time: 0.1786351203918457
This batch time : update_bounds func: 0.1811	 prepare: 0.0013	 bound: 0.1788	 transfer: 0.0004	 finalize: 0.0006
Accumulated time: update_bounds func: 3.4810	 prepare: 0.0264	 bound: 3.4365	 transfer: 0.0004	 finalize: 0.0085
batch bounding time:  0.18116331100463867
Current worst domains: [-1.7140436172485352, -1.000084638595581, -0.8265185356140137, -0.6329684257507324, -0.597923755645752, -0.41637325286865234]
length of domains: 6
Total time: 0.1984	 pickout: 0.0008	 decision: 0.0162	 get_bound: 0.1812	 add_domain: 0.0002
Current lb:-1.7140436172485352
20 neurons visited

splitting decisions: [[2, 78], [2, 78], [2, 22], [2, 41], [2, 78], [2, 78]]
single_node_split: True
best_l after optimization: 4.1762590408325195 with beta sum per layer: [0.0, 0.0, 4.993411064147949]
optimal alpha/beta time: 0.17895960807800293
This batch time : update_bounds func: 0.1818	 prepare: 0.0016	 bound: 0.1791	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 3.6628	 prepare: 0.0279	 bound: 3.6156	 transfer: 0.0005	 finalize: 0.0091
batch bounding time:  0.1818864345550537
Current worst domains: [-1.3087964057922363, -1.134511947631836, -0.6573126316070557, -0.6408863067626953, -0.2432689666748047, -0.23367977142333984, -0.1803112030029297, -0.10490751266479492]
length of domains: 8
Total time: 0.2002	 pickout: 0.0009	 decision: 0.0171	 get_bound: 0.1819	 add_domain: 0.0003
Current lb:-1.3087964057922363
32 neurons visited

splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [1, 905], [2, 41], [2, 41], [1, 415]]
single_node_split: True
best_l after optimization: 1.8991992473602295 with beta sum per layer: [0.0, 0.0, 5.786911964416504]
optimal alpha/beta time: 0.18082809448242188
This batch time : update_bounds func: 0.1845	 prepare: 0.0020	 bound: 0.1810	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 3.8473	 prepare: 0.0299	 bound: 3.7965	 transfer: 0.0005	 finalize: 0.0101
batch bounding time:  0.18449735641479492
Current worst domains: [-0.98248291015625, -0.8058552742004395, -0.7884302139282227, -0.6082718372344971, -0.3152627944946289, -0.26120853424072266, -0.15270233154296875, -0.08840799331665039]
length of domains: 8
Total time: 0.2042	 pickout: 0.0011	 decision: 0.0183	 get_bound: 0.1845	 add_domain: 0.0003
Current lb:-0.98248291015625
48 neurons visited

splitting decisions: [[1, 430], [2, 85], [1, 414], [2, 85], [2, 85], [1, 905], [1, 415], [2, 85]]
single_node_split: True
best_l after optimization: 2.2800710201263428 with beta sum per layer: [0.0, 0.12484291195869446, 3.9355521202087402]
optimal alpha/beta time: 0.1816387176513672
This batch time : update_bounds func: 0.1853	 prepare: 0.0020	 bound: 0.1818	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 4.0326	 prepare: 0.0319	 bound: 3.9783	 transfer: 0.0005	 finalize: 0.0111
batch bounding time:  0.1853315830230713
Current worst domains: [-0.856569766998291, -0.5570526123046875, -0.5436587333679199, -0.5152602195739746, -0.4366605281829834, -0.3361492156982422, -0.27050113677978516, -0.08192205429077148, -0.07915782928466797]
length of domains: 9
Total time: 0.2037	 pickout: 0.0011	 decision: 0.0168	 get_bound: 0.1854	 add_domain: 0.0003
Current lb:-0.856569766998291
64 neurons visited

splitting decisions: [[2, 85], [1, 430], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [1, 430], [2, 45]]
single_node_split: True
best_l after optimization: 1.1846628189086914 with beta sum per layer: [0.0, 0.20355692505836487, 2.399484157562256]
optimal alpha/beta time: 0.18099403381347656
This batch time : update_bounds func: 0.1849	 prepare: 0.0021	 bound: 0.1811	 transfer: 0.0005	 finalize: 0.0011
Accumulated time: update_bounds func: 4.2175	 prepare: 0.0340	 bound: 4.1594	 transfer: 0.0005	 finalize: 0.0121
batch bounding time:  0.18491816520690918
Current worst domains: [-0.638664960861206, -0.4287986755371094, -0.36571455001831055, -0.2989978790283203, -0.2901191711425781, -0.21329927444458008, -0.19776511192321777, -0.14347553253173828, -0.08142518997192383, -0.05274009704589844]
length of domains: 11
Total time: 0.2042	 pickout: 0.0012	 decision: 0.0176	 get_bound: 0.1850	 add_domain: 0.0004
Current lb:-0.638664960861206
82 neurons visited

splitting decisions: [[2, 45], [2, 45], [2, 79], [2, 45], [1, 430], [1, 430], [2, 45], [2, 45], [1, 430], [2, 45]]
single_node_split: True
best_l after optimization: -4.130954265594482 with beta sum per layer: [0.0, 0.37694692611694336, 1.9339582920074463]
optimal alpha/beta time: 0.1833798885345459
This batch time : update_bounds func: 0.1882	 prepare: 0.0025	 bound: 0.1835	 transfer: 0.0009	 finalize: 0.0013
Accumulated time: update_bounds func: 4.4057	 prepare: 0.0365	 bound: 4.3429	 transfer: 0.0009	 finalize: 0.0134
batch bounding time:  0.18828558921813965
Current worst domains: [-0.5231568813323975, -0.2944469451904297, -0.20322608947753906, -0.1712026596069336, -0.12182068824768066, -0.08809518814086914, -0.04839587211608887]
length of domains: 7
Total time: 0.2109	 pickout: 0.0015	 decision: 0.0208	 get_bound: 0.1883	 add_domain: 0.0003
Current lb:-0.5231568813323975
104 neurons visited

splitting decisions: [[2, 79], [2, 79], [2, 45], [2, 79], [2, 45], [2, 45], [2, 79]]
single_node_split: True
best_l after optimization: -2.7236831188201904 with beta sum per layer: [0.0, 0.16545416414737701, 1.1729748249053955]
optimal alpha/beta time: 0.1808021068572998
This batch time : update_bounds func: 0.1842	 prepare: 0.0019	 bound: 0.1809	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 4.5899	 prepare: 0.0383	 bound: 4.5238	 transfer: 0.0006	 finalize: 0.0142
batch bounding time:  0.18427014350891113
Current worst domains: [-0.2970094680786133, -0.14330792427062988, -0.08532524108886719, -0.07329583168029785, -0.001748800277709961]
length of domains: 5
Total time: 0.2026	 pickout: 0.0012	 decision: 0.0169	 get_bound: 0.1843	 add_domain: 0.0002
Current lb:-0.2970094680786133
118 neurons visited

splitting decisions: [[2, 75], [2, 75], [2, 75], [2, 79], [2, 79]]
single_node_split: True
best_l after optimization: -1.4891149997711182 with beta sum per layer: [0.0, 0.03090730309486389, 0.4578450620174408]
optimal alpha/beta time: 0.17898964881896973
This batch time : update_bounds func: 0.1819	 prepare: 0.0016	 bound: 0.1791	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 4.7718	 prepare: 0.0399	 bound: 4.7030	 transfer: 0.0005	 finalize: 0.0148
batch bounding time:  0.18190360069274902
Current worst domains: [-0.19484424591064453, -0.02812361717224121]
length of domains: 2
Total time: 0.1996	 pickout: 0.0009	 decision: 0.0166	 get_bound: 0.1819	 add_domain: 0.0001
Current lb:-0.19484424591064453
128 neurons visited

splitting decisions: [[2, 5], [1, 414]]
single_node_split: True
best_l after optimization: -1.069148063659668 with beta sum per layer: [0.0, 0.0, 0.1234317272901535]
optimal alpha/beta time: 0.1782526969909668
This batch time : update_bounds func: 0.1803	 prepare: 0.0012	 bound: 0.1784	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 4.9521	 prepare: 0.0411	 bound: 4.8814	 transfer: 0.0004	 finalize: 0.0151
batch bounding time:  0.18037033081054688
Current worst domains: [-0.09833836555480957]
length of domains: 1
Total time: 0.1972	 pickout: 0.0006	 decision: 0.0161	 get_bound: 0.1804	 add_domain: 0.0001
Current lb:-0.09833836555480957
132 neurons visited

splitting decisions: [[1, 414]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.34712815284729004 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.007638454437255859
This batch time : update_bounds func: 0.0093	 prepare: 0.0010	 bound: 0.0078	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 4.9614	 prepare: 0.0421	 bound: 4.8891	 transfer: 0.0003	 finalize: 0.0153
batch bounding time:  0.009328603744506836
Current worst domains: []
length of domains: 0
Total time: 0.0255	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.0093	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 3 verify end, Time cost: 3.2460899353027344
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3]]
##### [0:2] Tested against 4 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.8636870384216309 with beta sum per layer: []
optimal alpha/beta time: 0.7558441162109375
alpha-CROWN with fixed intermediate bounds: tensor([[-0.8637]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.8636870384216309
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 47]]
single_node_split: True
best_l after optimization: 0.239923357963562 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17436790466308594
This batch time : update_bounds func: 0.1760	 prepare: 0.0009	 bound: 0.1745	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 5.1374	 prepare: 0.0430	 bound: 5.0636	 transfer: 0.0003	 finalize: 0.0155
batch bounding time:  0.17599701881408691
Current worst domains: [-0.72701096534729]
length of domains: 1
Total time: 0.1923	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.1760	 add_domain: 0.0000
Current lb:-0.72701096534729
2 neurons visited

splitting decisions: [[1, 1046]]
single_node_split: True
best_l after optimization: 0.8624064922332764 with beta sum per layer: [0.0, 0.27702829241752625, 0.0]
optimal alpha/beta time: 0.17684674263000488
This batch time : update_bounds func: 0.1785	 prepare: 0.0010	 bound: 0.1770	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 5.3159	 prepare: 0.0440	 bound: 5.2405	 transfer: 0.0003	 finalize: 0.0157
batch bounding time:  0.17851948738098145
Current worst domains: [-0.6739952564239502, -0.18841123580932617]
length of domains: 2
Total time: 0.1945	 pickout: 0.0005	 decision: 0.0154	 get_bound: 0.1785	 add_domain: 0.0001
Current lb:-0.6739952564239502
4 neurons visited

splitting decisions: [[2, 45], [2, 45]]
single_node_split: True
best_l after optimization: 0.2695070505142212 with beta sum per layer: [0.0, 0.496901273727417, 0.31628501415252686]
optimal alpha/beta time: 0.17879700660705566
This batch time : update_bounds func: 0.1807	 prepare: 0.0011	 bound: 0.1789	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 5.4966	 prepare: 0.0451	 bound: 5.4195	 transfer: 0.0004	 finalize: 0.0160
batch bounding time:  0.18075108528137207
Current worst domains: [-0.6113557815551758, -0.09714198112487793]
length of domains: 2
Total time: 0.1971	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.1808	 add_domain: 0.0001
Current lb:-0.6113557815551758
8 neurons visited

splitting decisions: [[2, 11], [2, 11]]
single_node_split: True
best_l after optimization: -0.010522007942199707 with beta sum per layer: [0.0, 0.4397459924221039, 0.0]
optimal alpha/beta time: 0.17896223068237305
This batch time : update_bounds func: 0.1809	 prepare: 0.0011	 bound: 0.1791	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 5.6776	 prepare: 0.0463	 bound: 5.5986	 transfer: 0.0004	 finalize: 0.0163
batch bounding time:  0.18097591400146484
Current worst domains: [-0.2951967716217041, -0.1893693208694458]
length of domains: 2
Total time: 0.1989	 pickout: 0.0006	 decision: 0.0172	 get_bound: 0.1810	 add_domain: 0.0001
Current lb:-0.2951967716217041
12 neurons visited

splitting decisions: [[1, 556], [1, 556]]
single_node_split: True
best_l after optimization: 0.07444238662719727 with beta sum per layer: [0.0, 0.3975813090801239, 0.0]
optimal alpha/beta time: 0.17890095710754395
This batch time : update_bounds func: 0.1809	 prepare: 0.0011	 bound: 0.1790	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 5.8584	 prepare: 0.0474	 bound: 5.7776	 transfer: 0.0004	 finalize: 0.0166
batch bounding time:  0.18088412284851074
Current worst domains: [-0.12472057342529297, -0.07916116714477539]
length of domains: 2
Total time: 0.1976	 pickout: 0.0006	 decision: 0.0160	 get_bound: 0.1809	 add_domain: 0.0001
Current lb:-0.12472057342529297
16 neurons visited

splitting decisions: [[1, 648], [1, 606]]
single_node_split: True
best_l after optimization: -0.08212411403656006 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17750191688537598
This batch time : update_bounds func: 0.1794	 prepare: 0.0011	 bound: 0.1776	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 6.0379	 prepare: 0.0485	 bound: 5.9552	 transfer: 0.0004	 finalize: 0.0169
batch bounding time:  0.1794753074645996
Current worst domains: [-0.09217453002929688]
length of domains: 1
Total time: 0.1960	 pickout: 0.0006	 decision: 0.0158	 get_bound: 0.1795	 add_domain: 0.0001
Current lb:-0.09217453002929688
20 neurons visited

splitting decisions: [[1, 655]]
single_node_split: True
best_l after optimization: 0.0029882192611694336 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17525362968444824
This batch time : update_bounds func: 0.1770	 prepare: 0.0010	 bound: 0.1754	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 6.2148	 prepare: 0.0495	 bound: 6.1306	 transfer: 0.0004	 finalize: 0.0171
batch bounding time:  0.17698979377746582
Current worst domains: [-0.02551114559173584]
length of domains: 1
Total time: 0.1932	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.1770	 add_domain: 0.0001
Current lb:-0.02551114559173584
22 neurons visited

splitting decisions: [[1, 606]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.18338024616241455 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006787300109863281
This batch time : update_bounds func: 0.0084	 prepare: 0.0010	 bound: 0.0069	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 6.2233	 prepare: 0.0505	 bound: 6.1375	 transfer: 0.0003	 finalize: 0.0173
batch bounding time:  0.008442401885986328
Current worst domains: []
length of domains: 0
Total time: 0.0248	 pickout: 0.0005	 decision: 0.0158	 get_bound: 0.0085	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 4 verify end, Time cost: 2.207261323928833
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3], [2, 999, 24, 2.207261323928833, 0, 4]]
##### [0:2] Tested against 5 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.7302942276000977 with beta sum per layer: []
optimal alpha/beta time: 0.7664344310760498
alpha-CROWN with fixed intermediate bounds: tensor([[-3.7303]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.7302942276000977
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 38]]
single_node_split: True
best_l after optimization: 5.712050437927246 with beta sum per layer: [0.0, 0.0, 0.049584224820137024]
optimal alpha/beta time: 0.1729438304901123
This batch time : update_bounds func: 0.1745	 prepare: 0.0009	 bound: 0.1731	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 6.3978	 prepare: 0.0514	 bound: 6.3105	 transfer: 0.0003	 finalize: 0.0175
batch bounding time:  0.1745457649230957
Current worst domains: [-3.4167418479919434, -2.295308828353882]
length of domains: 2
Total time: 0.1908	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.1746	 add_domain: 0.0001
Current lb:-3.4167418479919434
2 neurons visited

splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
best_l after optimization: 6.564591884613037 with beta sum per layer: [0.0, 0.0, 1.5307434797286987]
optimal alpha/beta time: 0.17644119262695312
This batch time : update_bounds func: 0.1783	 prepare: 0.0011	 bound: 0.1766	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 6.5761	 prepare: 0.0525	 bound: 6.4871	 transfer: 0.0004	 finalize: 0.0177
batch bounding time:  0.1783764362335205
Current worst domains: [-3.2550106048583984, -2.0330049991607666, -0.9599330425262451, -0.31664347648620605]
length of domains: 4
Total time: 0.1949	 pickout: 0.0006	 decision: 0.0158	 get_bound: 0.1784	 add_domain: 0.0001
Current lb:-3.2550106048583984
6 neurons visited

splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79]]
single_node_split: True
best_l after optimization: 7.372901439666748 with beta sum per layer: [0.0, 0.0, 3.9420361518859863]
optimal alpha/beta time: 0.17817187309265137
This batch time : update_bounds func: 0.1806	 prepare: 0.0013	 bound: 0.1783	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 6.7567	 prepare: 0.0538	 bound: 6.6654	 transfer: 0.0005	 finalize: 0.0182
batch bounding time:  0.1806344985961914
Current worst domains: [-2.8965015411376953, -2.054683208465576, -1.6292164325714111, -0.8641800880432129, -0.3670213222503662, -0.06854772567749023]
length of domains: 6
Total time: 0.1979	 pickout: 0.0007	 decision: 0.0163	 get_bound: 0.1807	 add_domain: 0.0002
Current lb:-2.8965015411376953
14 neurons visited

splitting decisions: [[1, 1194], [2, 81], [1, 1194], [2, 85], [1, 1194], [2, 81]]
single_node_split: True
best_l after optimization: 10.092172622680664 with beta sum per layer: [0.0, 0.0, 5.548535346984863]
optimal alpha/beta time: 0.18127679824829102
This batch time : update_bounds func: 0.1844	 prepare: 0.0017	 bound: 0.1814	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 6.9411	 prepare: 0.0555	 bound: 6.8468	 transfer: 0.0005	 finalize: 0.0189
batch bounding time:  0.18441414833068848
Current worst domains: [-2.4978389739990234, -2.2736854553222656, -1.617401123046875, -1.5181350708007812, -1.1858930587768555, -1.1042299270629883, -0.5857267379760742, -0.10393905639648438]
length of domains: 8
Total time: 0.2208	 pickout: 0.0010	 decision: 0.0351	 get_bound: 0.1844	 add_domain: 0.0002
Current lb:-2.4978389739990234
26 neurons visited

splitting decisions: [[2, 81], [2, 81], [1, 1194], [1, 1194], [2, 81], [2, 85], [2, 81], [2, 81]]
single_node_split: True
best_l after optimization: 14.677183151245117 with beta sum per layer: [0.0, 0.0, 4.994365692138672]
optimal alpha/beta time: 0.18053150177001953
This batch time : update_bounds func: 0.1843	 prepare: 0.0020	 bound: 0.1807	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 7.1253	 prepare: 0.0575	 bound: 7.0274	 transfer: 0.0006	 finalize: 0.0199
batch bounding time:  0.18430447578430176
Current worst domains: [-2.1202392578125, -1.9106838703155518, -1.8966951370239258, -1.6928341388702393, -1.3662805557250977, -1.2570195198059082, -1.2470927238464355, -1.0961525440216064, -0.8375554084777832, -0.7007641792297363]
length of domains: 14
Total time: 0.3143	 pickout: 0.0011	 decision: 0.1284	 get_bound: 0.1843	 add_domain: 0.0004
Current lb:-2.1202392578125
42 neurons visited

splitting decisions: [[2, 85], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [1, 430], [2, 85], [2, 81], [2, 85]]
single_node_split: True
best_l after optimization: 18.7667236328125 with beta sum per layer: [0.0, 0.49219492077827454, 9.56138801574707]
optimal alpha/beta time: 0.18341541290283203
This batch time : update_bounds func: 0.1888	 prepare: 0.0029	 bound: 0.1835	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 7.3141	 prepare: 0.0604	 bound: 7.2110	 transfer: 0.0007	 finalize: 0.0215
batch bounding time:  0.18883419036865234
Current worst domains: [-1.876138687133789, -1.6650550365447998, -1.6476402282714844, -1.5292754173278809, -1.448915958404541, -1.3774433135986328, -1.281038761138916, -1.203880786895752, -1.138381004333496, -1.0766615867614746]
length of domains: 20
Total time: 0.5085	 pickout: 0.0017	 decision: 0.3173	 get_bound: 0.1889	 add_domain: 0.0006
Current lb:-1.876138687133789
70 neurons visited

splitting decisions: [[1, 430], [1, 410], [1, 410], [1, 430], [1, 410], [1, 430], [1, 430], [2, 85], [1, 430], [2, 85]]
single_node_split: True
best_l after optimization: 23.105819702148438 with beta sum per layer: [0.0, 1.2877039909362793, 14.000553131103516]
optimal alpha/beta time: 0.18430638313293457
This batch time : update_bounds func: 0.1913	 prepare: 0.0037	 bound: 0.1844	 transfer: 0.0009	 finalize: 0.0021
Accumulated time: update_bounds func: 7.5054	 prepare: 0.0641	 bound: 7.3954	 transfer: 0.0009	 finalize: 0.0236
batch bounding time:  0.19131231307983398
Current worst domains: [-1.755061149597168, -1.4328312873840332, -1.2961435317993164, -1.253091812133789, -1.2504072189331055, -1.2462425231933594, -1.1968088150024414, -1.1894960403442383, -1.0539166927337646, -1.0355725288391113]
length of domains: 30
Total time: 0.2137	 pickout: 0.0023	 decision: 0.0189	 get_bound: 0.1914	 add_domain: 0.0011
Current lb:-1.755061149597168
110 neurons visited

splitting decisions: [[1, 410], [1, 410], [2, 41], [1, 430], [1, 430], [2, 41], [1, 430], [2, 41], [1, 430], [2, 41]]
single_node_split: True
best_l after optimization: 25.651308059692383 with beta sum per layer: [0.0, 2.485783576965332, 19.132492065429688]
optimal alpha/beta time: 0.1829051971435547
This batch time : update_bounds func: 0.1928	 prepare: 0.0051	 bound: 0.1830	 transfer: 0.0014	 finalize: 0.0032
Accumulated time: update_bounds func: 7.6982	 prepare: 0.0692	 bound: 7.5785	 transfer: 0.0014	 finalize: 0.0268
batch bounding time:  0.19291377067565918
Current worst domains: [-1.3775720596313477, -1.3347177505493164, -1.132467269897461, -1.129676342010498, -1.060570240020752, -1.024491310119629, -0.9827947616577148, -0.9608473777770996, -0.9392721652984619, -0.931828498840332]
length of domains: 46
Total time: 0.2180	 pickout: 0.0032	 decision: 0.0200	 get_bound: 0.1930	 add_domain: 0.0017
Current lb:-1.3775720596313477
170 neurons visited

splitting decisions: [[2, 41], [2, 41], [2, 67], [2, 41], [2, 41], [2, 41], [2, 41], [2, 67], [2, 67], [1, 410]]
single_node_split: True
best_l after optimization: 15.582484245300293 with beta sum per layer: [0.0, 4.500017166137695, 29.402708053588867]
optimal alpha/beta time: 0.18401741981506348
This batch time : update_bounds func: 0.1999	 prepare: 0.0072	 bound: 0.1842	 transfer: 0.0036	 finalize: 0.0048
Accumulated time: update_bounds func: 7.8981	 prepare: 0.0764	 bound: 7.7626	 transfer: 0.0036	 finalize: 0.0315
batch bounding time:  0.19999289512634277
Current worst domains: [-1.0628609657287598, -1.0435914993286133, -1.0008840560913086, -0.925175666809082, -0.8634672164916992, -0.844684362411499, -0.8356409072875977, -0.8065681457519531, -0.7617337703704834, -0.7255849838256836]
length of domains: 52
Total time: 0.2301	 pickout: 0.0047	 decision: 0.0232	 get_bound: 0.2001	 add_domain: 0.0020
Current lb:-1.0628609657287598
262 neurons visited

splitting decisions: [[2, 67], [2, 67], [2, 47], [2, 67], [2, 67], [2, 67], [2, 47], [2, 41], [2, 67], [2, 41]]
single_node_split: True
best_l after optimization: 3.225992441177368 with beta sum per layer: [0.0, 3.1562695503234863, 27.466196060180664]
optimal alpha/beta time: 0.18361759185791016
This batch time : update_bounds func: 0.1999	 prepare: 0.0080	 bound: 0.1838	 transfer: 0.0026	 finalize: 0.0054
Accumulated time: update_bounds func: 8.0980	 prepare: 0.0844	 bound: 7.9464	 transfer: 0.0026	 finalize: 0.0369
batch bounding time:  0.19999194145202637
Current worst domains: [-0.8970394134521484, -0.8833589553833008, -0.8700828552246094, -0.7074003219604492, -0.7027177810668945, -0.6796643733978271, -0.6270432472229004, -0.5916922092437744, -0.5457067489624023, -0.5419235229492188]
length of domains: 44
Total time: 0.2331	 pickout: 0.0053	 decision: 0.0258	 get_bound: 0.2002	 add_domain: 0.0018
Current lb:-0.8970394134521484
366 neurons visited

splitting decisions: [[2, 47], [2, 47], [2, 45], [2, 47], [2, 45], [2, 47], [2, 47], [2, 47], [2, 45], [2, 45]]
single_node_split: True
best_l after optimization: -2.5073561668395996 with beta sum per layer: [0.0, 2.738689422607422, 18.972137451171875]
optimal alpha/beta time: 0.18345284461975098
This batch time : update_bounds func: 0.1966	 prepare: 0.0069	 bound: 0.1836	 transfer: 0.0014	 finalize: 0.0045
Accumulated time: update_bounds func: 8.2946	 prepare: 0.0913	 bound: 8.1300	 transfer: 0.0014	 finalize: 0.0414
batch bounding time:  0.19675469398498535
Current worst domains: [-0.7731056213378906, -0.7703566551208496, -0.7555770874023438, -0.605095386505127, -0.5765891075134277, -0.5573368072509766, -0.4877490997314453, -0.458590030670166, -0.45813679695129395, -0.4487285614013672]
length of domains: 37
Total time: 0.2262	 pickout: 0.0046	 decision: 0.0227	 get_bound: 0.1969	 add_domain: 0.0020
Current lb:-0.7731056213378906
454 neurons visited

splitting decisions: [[2, 45], [2, 41], [2, 45], [1, 430], [2, 45], [2, 45], [2, 78], [1, 410], [2, 45], [1, 410]]
single_node_split: True
best_l after optimization: -10.993342399597168 with beta sum per layer: [0.0, 2.27823543548584, 11.278999328613281]
optimal alpha/beta time: 0.18282675743103027
This batch time : update_bounds func: 0.1940	 prepare: 0.0060	 bound: 0.1830	 transfer: 0.0012	 finalize: 0.0038
Accumulated time: update_bounds func: 8.4887	 prepare: 0.0972	 bound: 8.3129	 transfer: 0.0012	 finalize: 0.0452
batch bounding time:  0.1941211223602295
Current worst domains: [-0.666724681854248, -0.6424732208251953, -0.5031661987304688, -0.4816126823425293, -0.45559263229370117, -0.44384765625, -0.3494844436645508, -0.34182119369506836, -0.3144371509552002, -0.25919055938720703]
length of domains: 33
Total time: 0.2219	 pickout: 0.0039	 decision: 0.0221	 get_bound: 0.1942	 add_domain: 0.0016
Current lb:-0.666724681854248
528 neurons visited

splitting decisions: [[2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 45]]
single_node_split: True
best_l after optimization: -3.095240354537964 with beta sum per layer: [0.0, 1.502736210823059, 8.885220527648926]
optimal alpha/beta time: 0.18348455429077148
This batch time : update_bounds func: 0.1936	 prepare: 0.0054	 bound: 0.1836	 transfer: 0.0011	 finalize: 0.0034
Accumulated time: update_bounds func: 8.6823	 prepare: 0.1026	 bound: 8.4965	 transfer: 0.0011	 finalize: 0.0485
batch bounding time:  0.19371795654296875
Current worst domains: [-0.44388771057128906, -0.42063140869140625, -0.40106773376464844, -0.37413549423217773, -0.31147050857543945, -0.2831597328186035, -0.24183034896850586, -0.23564910888671875, -0.22118425369262695, -0.1880779266357422]
length of domains: 20
Total time: 0.2185	 pickout: 0.0035	 decision: 0.0198	 get_bound: 0.1938	 add_domain: 0.0013
Current lb:-0.44388771057128906
594 neurons visited

splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 414]]
single_node_split: True
best_l after optimization: 0.5185787677764893 with beta sum per layer: [0.0, 0.37507322430610657, 2.57468318939209]
optimal alpha/beta time: 0.1807410717010498
This batch time : update_bounds func: 0.1874	 prepare: 0.0036	 bound: 0.1809	 transfer: 0.0008	 finalize: 0.0021
Accumulated time: update_bounds func: 8.8697	 prepare: 0.1062	 bound: 8.6774	 transfer: 0.0008	 finalize: 0.0506
batch bounding time:  0.18748998641967773
Current worst domains: [-0.29473876953125, -0.27173280715942383, -0.2588205337524414, -0.24354267120361328, -0.2411808967590332, -0.22974300384521484, -0.14891576766967773, -0.12874174118041992, -0.11647367477416992, -0.08663272857666016]
length of domains: 18
Total time: 0.2087	 pickout: 0.0023	 decision: 0.0179	 get_bound: 0.1876	 add_domain: 0.0010
Current lb:-0.29473876953125
634 neurons visited

splitting decisions: [[1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 1207], [1, 269], [1, 1195], [1, 1195]]
single_node_split: True
best_l after optimization: -2.5036113262176514 with beta sum per layer: [0.0, 0.28751981258392334, 1.4897778034210205]
optimal alpha/beta time: 0.1812300682067871
This batch time : update_bounds func: 0.1875	 prepare: 0.0033	 bound: 0.1814	 transfer: 0.0008	 finalize: 0.0019
Accumulated time: update_bounds func: 9.0572	 prepare: 0.1095	 bound: 8.8588	 transfer: 0.0008	 finalize: 0.0525
batch bounding time:  0.18750572204589844
Current worst domains: [-0.10552597045898438, -0.10505056381225586, -0.09516763687133789, -0.08483028411865234, -0.08078622817993164, -0.0771646499633789, -0.07323217391967773, -0.06573772430419922, -0.06472492218017578, -0.05839872360229492]
length of domains: 18
Total time: 0.2083	 pickout: 0.0021	 decision: 0.0177	 get_bound: 0.1876	 add_domain: 0.0010
Current lb:-0.10552597045898438
670 neurons visited

splitting decisions: [[1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 269], [1, 1195], [1, 1195], [1, 1195], [1, 1195]]
single_node_split: True
best_l after optimization: -6.9260640144348145 with beta sum per layer: [0.0, 0.14403964579105377, 0.7091302871704102]
optimal alpha/beta time: 0.1800673007965088
This batch time : update_bounds func: 0.1864	 prepare: 0.0033	 bound: 0.1802	 transfer: 0.0008	 finalize: 0.0020
Accumulated time: update_bounds func: 9.2436	 prepare: 0.1128	 bound: 9.0390	 transfer: 0.0008	 finalize: 0.0545
batch bounding time:  0.18643927574157715
Current worst domains: [-0.07704305648803711, -0.07503318786621094, -0.061491966247558594, -0.05653047561645508, -0.054627418518066406, -0.03722858428955078, -0.03487730026245117, -0.03397035598754883, -0.028398513793945312, -0.02790689468383789]
length of domains: 14
Total time: 0.2069	 pickout: 0.0021	 decision: 0.0175	 get_bound: 0.1865	 add_domain: 0.0008
Current lb:-0.07704305648803711
706 neurons visited

splitting decisions: [[1, 269], [1, 711], [1, 269], [2, 22], [2, 22], [1, 269], [2, 22], [1, 269], [1, 711], [1, 711]]
single_node_split: True
best_l after optimization: -2.8395280838012695 with beta sum per layer: [0.0, 0.18201586604118347, 0.34765738248825073]
optimal alpha/beta time: 0.1789398193359375
This batch time : update_bounds func: 0.1842	 prepare: 0.0029	 bound: 0.1791	 transfer: 0.0007	 finalize: 0.0016
Accumulated time: update_bounds func: 9.4278	 prepare: 0.1157	 bound: 9.2180	 transfer: 0.0007	 finalize: 0.0560
batch bounding time:  0.18427014350891113
Current worst domains: [-0.014527320861816406]
length of domains: 1
Total time: 0.2035	 pickout: 0.0017	 decision: 0.0173	 get_bound: 0.1843	 add_domain: 0.0001
Current lb:-0.014527320861816406
734 neurons visited

splitting decisions: [[2, 22]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.3373446464538574 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006740093231201172
This batch time : update_bounds func: 0.0084	 prepare: 0.0010	 bound: 0.0068	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 9.4362	 prepare: 0.1167	 bound: 9.2249	 transfer: 0.0003	 finalize: 0.0562
batch bounding time:  0.008388996124267578
Current worst domains: []
length of domains: 0
Total time: 0.0246	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.0084	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 5 verify end, Time cost: 4.868577718734741
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3], [2, 999, 24, 2.207261323928833, 0, 4], [2, 999, 736, 4.868577718734741, 0, 5]]
##### [0:2] Tested against 6 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.4885940551757812 with beta sum per layer: []
optimal alpha/beta time: 0.7522842884063721
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4886]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.4885940551757812
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 47]]
single_node_split: True
best_l after optimization: 2.9386534690856934 with beta sum per layer: [0.0, 0.0, 0.6712738871574402]
optimal alpha/beta time: 0.1817786693572998
This batch time : update_bounds func: 0.1834	 prepare: 0.0009	 bound: 0.1819	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 9.6196	 prepare: 0.1176	 bound: 9.4068	 transfer: 0.0004	 finalize: 0.0564
batch bounding time:  0.18342280387878418
Current worst domains: [-3.3073339462280273]
length of domains: 1
Total time: 0.1997	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.1834	 add_domain: 0.0000
Current lb:-3.3073339462280273
2 neurons visited

splitting decisions: [[2, 79]]
single_node_split: True
best_l after optimization: 4.688787460327148 with beta sum per layer: [0.0, 0.0, 0.04782325401902199]
optimal alpha/beta time: 0.17612123489379883
This batch time : update_bounds func: 0.1778	 prepare: 0.0009	 bound: 0.1762	 transfer: 0.0004	 finalize: 0.0002
Accumulated time: update_bounds func: 9.7973	 prepare: 0.1186	 bound: 9.5830	 transfer: 0.0004	 finalize: 0.0566
batch bounding time:  0.17779755592346191
Current worst domains: [-2.5805978775024414, -2.108189582824707]
length of domains: 2
Total time: 0.1938	 pickout: 0.0005	 decision: 0.0154	 get_bound: 0.1778	 add_domain: 0.0001
Current lb:-2.5805978775024414
4 neurons visited

splitting decisions: [[1, 410], [2, 41]]
single_node_split: True
best_l after optimization: 6.974831581115723 with beta sum per layer: [0.0, 0.08541861176490784, 0.16679039597511292]
optimal alpha/beta time: 0.17951416969299316
This batch time : update_bounds func: 0.1816	 prepare: 0.0012	 bound: 0.1796	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 9.9789	 prepare: 0.1198	 bound: 9.7626	 transfer: 0.0004	 finalize: 0.0569
batch bounding time:  0.1815946102142334
Current worst domains: [-1.9871068000793457, -1.8785920143127441, -1.7503318786621094, -1.3588008880615234]
length of domains: 4
Total time: 0.1983	 pickout: 0.0006	 decision: 0.0160	 get_bound: 0.1816	 add_domain: 0.0001
Current lb:-1.9871068000793457
8 neurons visited

splitting decisions: [[2, 41], [2, 41], [2, 67], [2, 67]]
single_node_split: True
best_l after optimization: 8.184200286865234 with beta sum per layer: [0.0, 0.11580304056406021, 1.601362943649292]
optimal alpha/beta time: 0.17973971366882324
This batch time : update_bounds func: 0.1824	 prepare: 0.0014	 bound: 0.1799	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 10.1613	 prepare: 0.1212	 bound: 9.9425	 transfer: 0.0005	 finalize: 0.0575
batch bounding time:  0.18243050575256348
Current worst domains: [-1.561849594116211, -1.489518642425537, -1.4577655792236328, -1.351546287536621, -1.2272272109985352, -1.0942955017089844, -0.11064624786376953]
length of domains: 7
Total time: 0.1999	 pickout: 0.0008	 decision: 0.0164	 get_bound: 0.1825	 add_domain: 0.0002
Current lb:-1.561849594116211
16 neurons visited

splitting decisions: [[2, 67], [2, 67], [2, 83], [2, 67], [2, 67], [2, 83], [2, 38]]
single_node_split: True
best_l after optimization: 4.177971363067627 with beta sum per layer: [0.0, 0.7375955581665039, 5.559446334838867]
optimal alpha/beta time: 0.1833782196044922
This batch time : update_bounds func: 0.1868	 prepare: 0.0018	 bound: 0.1835	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 10.3481	 prepare: 0.1230	 bound: 10.1260	 transfer: 0.0006	 finalize: 0.0583
batch bounding time:  0.18680167198181152
Current worst domains: [-1.2881946563720703, -1.2528958320617676, -1.2133383750915527, -1.0945310592651367, -0.9510946273803711, -0.8842489719390869]
length of domains: 6
Total time: 0.2055	 pickout: 0.0011	 decision: 0.0173	 get_bound: 0.1868	 add_domain: 0.0002
Current lb:-1.2881946563720703
30 neurons visited

splitting decisions: [[2, 83], [1, 410], [2, 83], [2, 83], [2, 83], [2, 38]]
single_node_split: True
best_l after optimization: 3.3962008953094482 with beta sum per layer: [0.0, 0.19702908396720886, 2.839215040206909]
optimal alpha/beta time: 0.1814103126525879
This batch time : update_bounds func: 0.1847	 prepare: 0.0017	 bound: 0.1815	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 10.5328	 prepare: 0.1247	 bound: 10.3075	 transfer: 0.0006	 finalize: 0.0591
batch bounding time:  0.1847372055053711
Current worst domains: [-1.0983867645263672, -1.0267844200134277, -0.8968744277954102, -0.7580490112304688, -0.747861385345459, -0.6631388664245605, -0.47600603103637695, -0.10737204551696777]
length of domains: 8
Total time: 0.2027	 pickout: 0.0010	 decision: 0.0167	 get_bound: 0.1848	 add_domain: 0.0003
Current lb:-1.0983867645263672
42 neurons visited

splitting decisions: [[2, 38], [1, 1194], [2, 38], [2, 38], [2, 38], [2, 38], [2, 75], [1, 410]]
single_node_split: True
best_l after optimization: 3.6336617469787598 with beta sum per layer: [0.0, 0.2274368703365326, 3.5263752937316895]
optimal alpha/beta time: 0.18051886558532715
This batch time : update_bounds func: 0.1843	 prepare: 0.0020	 bound: 0.1806	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 10.7171	 prepare: 0.1267	 bound: 10.4882	 transfer: 0.0006	 finalize: 0.0601
batch bounding time:  0.1843574047088623
Current worst domains: [-0.6943197250366211, -0.5401334762573242, -0.4689326286315918, -0.46448278427124023, -0.3745536804199219, -0.352569580078125, -0.33954858779907227, -0.30022478103637695, -0.2425670623779297, -0.15779542922973633]
length of domains: 13
Total time: 0.2034	 pickout: 0.0011	 decision: 0.0174	 get_bound: 0.1844	 add_domain: 0.0005
Current lb:-0.6943197250366211
58 neurons visited

splitting decisions: [[1, 1194], [2, 38], [1, 1194], [2, 38], [1, 1194], [1, 1194], [2, 85], [1, 410], [1, 1194], [2, 85]]
single_node_split: True
best_l after optimization: -2.8771955966949463 with beta sum per layer: [0.0, 0.47876274585723877, 4.494473934173584]
optimal alpha/beta time: 0.18196654319763184
This batch time : update_bounds func: 0.1872	 prepare: 0.0027	 bound: 0.1821	 transfer: 0.0008	 finalize: 0.0015
Accumulated time: update_bounds func: 10.9043	 prepare: 0.1295	 bound: 10.6703	 transfer: 0.0008	 finalize: 0.0616
batch bounding time:  0.18725061416625977
Current worst domains: [-0.17461681365966797, -0.16605186462402344, -0.11949634552001953, -0.0875859260559082, -0.04389047622680664]
length of domains: 5
Total time: 0.2073	 pickout: 0.0016	 decision: 0.0181	 get_bound: 0.1873	 add_domain: 0.0002
Current lb:-0.17461681365966797
84 neurons visited

splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 1194], [1, 655]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -2.115579605102539 with beta sum per layer: [0.0, 0.04777798801660538, 0.0]
optimal alpha/beta time: 0.0068738460540771484
This batch time : update_bounds func: 0.0097	 prepare: 0.0016	 bound: 0.0070	 transfer: 0.0005	 finalize: 0.0006
Accumulated time: update_bounds func: 10.9140	 prepare: 0.1311	 bound: 10.6773	 transfer: 0.0005	 finalize: 0.0621
batch bounding time:  0.009779214859008789
Current worst domains: []
length of domains: 0
Total time: 0.0273	 pickout: 0.0009	 decision: 0.0166	 get_bound: 0.0098	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 6 verify end, Time cost: 2.4485983848571777
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3], [2, 999, 24, 2.207261323928833, 0, 4], [2, 999, 736, 4.868577718734741, 0, 5], [2, 999, 94, 2.4485983848571777, 0, 6]]
##### [0:2] Tested against 7 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.4850707054138184 with beta sum per layer: []
optimal alpha/beta time: 0.7372527122497559
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4851]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.4850707054138184
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 78]]
single_node_split: True
best_l after optimization: 4.718533515930176 with beta sum per layer: [0.0, 0.0, 0.01449527870863676]
optimal alpha/beta time: 0.17261385917663574
This batch time : update_bounds func: 0.1742	 prepare: 0.0009	 bound: 0.1727	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 11.0883	 prepare: 0.1320	 bound: 10.8500	 transfer: 0.0003	 finalize: 0.0623
batch bounding time:  0.17423772811889648
Current worst domains: [-2.7472968101501465, -1.9712369441986084]
length of domains: 2
Total time: 0.1905	 pickout: 0.0005	 decision: 0.0156	 get_bound: 0.1743	 add_domain: 0.0001
Current lb:-2.7472968101501465
2 neurons visited

splitting decisions: [[2, 22], [2, 22]]
single_node_split: True
best_l after optimization: 4.444899559020996 with beta sum per layer: [0.0, 0.0, 1.4475773572921753]
optimal alpha/beta time: 0.17475223541259766
This batch time : update_bounds func: 0.1766	 prepare: 0.0011	 bound: 0.1749	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 11.2649	 prepare: 0.1331	 bound: 11.0249	 transfer: 0.0004	 finalize: 0.0626
batch bounding time:  0.17664051055908203
Current worst domains: [-2.5621085166931152, -1.848005771636963, -0.4991888999938965]
length of domains: 3
Total time: 0.1931	 pickout: 0.0006	 decision: 0.0158	 get_bound: 0.1767	 add_domain: 0.0001
Current lb:-2.5621085166931152
6 neurons visited

splitting decisions: [[1, 1052], [1, 415], [2, 67]]
single_node_split: True
best_l after optimization: 5.778067111968994 with beta sum per layer: [0.0, 0.24320322275161743, 1.597489356994629]
optimal alpha/beta time: 0.17808270454406738
This batch time : update_bounds func: 0.1803	 prepare: 0.0013	 bound: 0.1782	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 11.4452	 prepare: 0.1344	 bound: 11.2031	 transfer: 0.0004	 finalize: 0.0630
batch bounding time:  0.18036127090454102
Current worst domains: [-2.2610511779785156, -1.9422626495361328, -1.3628971576690674, -1.0258355140686035]
length of domains: 4
Total time: 0.1970	 pickout: 0.0007	 decision: 0.0158	 get_bound: 0.1804	 add_domain: 0.0001
Current lb:-2.2610511779785156
12 neurons visited

splitting decisions: [[2, 11], [2, 11], [2, 67], [2, 11]]
single_node_split: True
best_l after optimization: 8.440457344055176 with beta sum per layer: [0.0, 0.3266069293022156, 2.2137508392333984]
optimal alpha/beta time: 0.17811322212219238
This batch time : update_bounds func: 0.1807	 prepare: 0.0014	 bound: 0.1782	 transfer: 0.0004	 finalize: 0.0006
Accumulated time: update_bounds func: 11.6259	 prepare: 0.1358	 bound: 11.3813	 transfer: 0.0004	 finalize: 0.0636
batch bounding time:  0.18070292472839355
Current worst domains: [-2.0800833702087402, -1.7413268089294434, -1.3488168716430664, -1.0450382232666016, -0.8388481140136719, -0.7492926120758057, -0.6453659534454346]
length of domains: 7
Total time: 0.1979	 pickout: 0.0008	 decision: 0.0162	 get_bound: 0.1807	 add_domain: 0.0002
Current lb:-2.0800833702087402
20 neurons visited

splitting decisions: [[2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 11], [2, 11]]
single_node_split: True
best_l after optimization: 8.777700424194336 with beta sum per layer: [0.0, 0.9472807049751282, 3.8853626251220703]
optimal alpha/beta time: 0.17995429039001465
This batch time : update_bounds func: 0.1832	 prepare: 0.0018	 bound: 0.1801	 transfer: 0.0005	 finalize: 0.0008
Accumulated time: update_bounds func: 11.8091	 prepare: 0.1376	 bound: 11.5614	 transfer: 0.0005	 finalize: 0.0644
batch bounding time:  0.18323111534118652
Current worst domains: [-1.5797476768493652, -1.485016107559204, -1.144474983215332, -1.1438665390014648, -0.9978084564208984, -0.6786642074584961, -0.5818881988525391, -0.4588747024536133, -0.43839406967163086, -0.25835752487182617]
length of domains: 11
Total time: 0.2018	 pickout: 0.0011	 decision: 0.0171	 get_bound: 0.1833	 add_domain: 0.0003
Current lb:-1.5797476768493652
34 neurons visited

splitting decisions: [[1, 415], [1, 415], [1, 415], [1, 415], [2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 38]]
single_node_split: True
best_l after optimization: 4.370949745178223 with beta sum per layer: [0.0, 4.824619293212891, 7.113204002380371]
optimal alpha/beta time: 0.17926645278930664
This batch time : update_bounds func: 0.1838	 prepare: 0.0025	 bound: 0.1794	 transfer: 0.0006	 finalize: 0.0012
Accumulated time: update_bounds func: 11.9928	 prepare: 0.1400	 bound: 11.7408	 transfer: 0.0006	 finalize: 0.0656
batch bounding time:  0.18381619453430176
Current worst domains: [-1.2524166107177734, -1.202115535736084, -0.9372434616088867, -0.7965888977050781, -0.7658071517944336, -0.4985237121582031, -0.44602489471435547, -0.29250431060791016, -0.13013696670532227, -0.09262466430664062]
length of domains: 11
Total time: 0.2039	 pickout: 0.0015	 decision: 0.0182	 get_bound: 0.1839	 add_domain: 0.0004
Current lb:-1.2524166107177734
56 neurons visited

splitting decisions: [[2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [1, 618], [2, 38], [1, 618], [1, 1052]]
single_node_split: True
best_l after optimization: 3.8391659259796143 with beta sum per layer: [0.0, 6.46074104309082, 2.9240942001342773]
optimal alpha/beta time: 0.18066644668579102
This batch time : update_bounds func: 0.1851	 prepare: 0.0024	 bound: 0.1808	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 12.1780	 prepare: 0.1425	 bound: 11.9216	 transfer: 0.0006	 finalize: 0.0668
batch bounding time:  0.1851816177368164
Current worst domains: [-0.8334946632385254, -0.7814414501190186, -0.7654809951782227, -0.6275529861450195, -0.5344409942626953, -0.4421200752258301, -0.38199281692504883, -0.31752490997314453, -0.2701692581176758, -0.1861896514892578]
length of domains: 12
Total time: 0.2044	 pickout: 0.0014	 decision: 0.0173	 get_bound: 0.1852	 add_domain: 0.0004
Current lb:-0.8334946632385254
78 neurons visited

splitting decisions: [[1, 661], [1, 618], [1, 661], [1, 618], [1, 618], [1, 618], [1, 618], [1, 661], [1, 618], [1, 618]]
single_node_split: True
best_l after optimization: 2.6817100048065186 with beta sum per layer: [0.0, 7.452971935272217, 1.3664101362228394]
optimal alpha/beta time: 0.17902565002441406
This batch time : update_bounds func: 0.1836	 prepare: 0.0025	 bound: 0.1791	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 12.3616	 prepare: 0.1450	 bound: 12.1007	 transfer: 0.0006	 finalize: 0.0682
batch bounding time:  0.1836836338043213
Current worst domains: [-0.7303848266601562, -0.5784659385681152, -0.506371021270752, -0.38149476051330566, -0.3704209327697754, -0.29901885986328125, -0.24949407577514648, -0.18193387985229492, -0.1671905517578125, -0.16190528869628906]
length of domains: 14
Total time: 0.2036	 pickout: 0.0016	 decision: 0.0178	 get_bound: 0.1837	 add_domain: 0.0005
Current lb:-0.7303848266601562
102 neurons visited

splitting decisions: [[1, 618], [1, 618], [1, 1059], [1, 618], [1, 661], [1, 612], [1, 661], [1, 618], [1, 1059], [1, 618]]
single_node_split: True
best_l after optimization: 0.24330520629882812 with beta sum per layer: [0.0, 7.05282735824585, 0.21440379321575165]
optimal alpha/beta time: 0.1799623966217041
This batch time : update_bounds func: 0.1851	 prepare: 0.0028	 bound: 0.1801	 transfer: 0.0007	 finalize: 0.0015
Accumulated time: update_bounds func: 12.5467	 prepare: 0.1478	 bound: 12.2808	 transfer: 0.0007	 finalize: 0.0697
batch bounding time:  0.1851511001586914
Current worst domains: [-0.4525904655456543, -0.3168168067932129, -0.3146390914916992, -0.2684791088104248, -0.21230268478393555, -0.21219253540039062, -0.16864871978759766, -0.14331865310668945, -0.102752685546875, -0.058264732360839844]
length of domains: 10
Total time: 0.2053	 pickout: 0.0017	 decision: 0.0179	 get_bound: 0.1852	 add_domain: 0.0005
Current lb:-0.4525904655456543
130 neurons visited

splitting decisions: [[1, 612], [1, 612], [1, 612], [1, 612], [1, 1059], [1, 905], [1, 612], [1, 612], [1, 612], [1, 612]]
single_node_split: True
best_l after optimization: 0.38832545280456543 with beta sum per layer: [0.0, 2.248638391494751, 0.0638575330376625]
optimal alpha/beta time: 0.1797475814819336
This batch time : update_bounds func: 0.1839	 prepare: 0.0022	 bound: 0.1799	 transfer: 0.0006	 finalize: 0.0011
Accumulated time: update_bounds func: 12.7306	 prepare: 0.1500	 bound: 12.4607	 transfer: 0.0006	 finalize: 0.0708
batch bounding time:  0.18392491340637207
Current worst domains: [-0.3747587203979492, -0.21799421310424805, -0.1908583641052246, -0.18700718879699707, -0.08692264556884766, -0.05956315994262695, -0.048798561096191406, -0.044686317443847656]
length of domains: 8
Total time: 0.2027	 pickout: 0.0014	 decision: 0.0170	 get_bound: 0.1840	 add_domain: 0.0004
Current lb:-0.3747587203979492
150 neurons visited

splitting decisions: [[2, 47], [2, 47], [2, 47], [2, 47], [2, 47], [1, 73], [2, 47], [2, 47]]
single_node_split: True
best_l after optimization: -1.104520559310913 with beta sum per layer: [0.0, 1.1420929431915283, 0.33057984709739685]
optimal alpha/beta time: 0.17896223068237305
This batch time : update_bounds func: 0.1827	 prepare: 0.0020	 bound: 0.1791	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 12.9133	 prepare: 0.1520	 bound: 12.6397	 transfer: 0.0005	 finalize: 0.0718
batch bounding time:  0.1827545166015625
Current worst domains: [-0.25200390815734863, -0.08780527114868164, -0.07850289344787598, -0.06896686553955078]
length of domains: 4
Total time: 0.2010	 pickout: 0.0012	 decision: 0.0168	 get_bound: 0.1828	 add_domain: 0.0002
Current lb:-0.25200390815734863
166 neurons visited

splitting decisions: [[2, 46], [2, 46], [1, 661], [1, 73]]
single_node_split: True
best_l after optimization: -2.086322069168091 with beta sum per layer: [0.0, 0.1722327172756195, 0.0]
optimal alpha/beta time: 0.17679619789123535
This batch time : update_bounds func: 0.1794	 prepare: 0.0015	 bound: 0.1769	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 13.0927	 prepare: 0.1535	 bound: 12.8167	 transfer: 0.0004	 finalize: 0.0723
batch bounding time:  0.17942070960998535
Current worst domains: [-0.18090057373046875, -0.009733200073242188]
length of domains: 2
Total time: 0.1966	 pickout: 0.0008	 decision: 0.0163	 get_bound: 0.1794	 add_domain: 0.0001
Current lb:-0.18090057373046875
174 neurons visited

splitting decisions: [[1, 1059], [1, 1059]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.5773310661315918 with beta sum per layer: [0.0, 0.22422143816947937, 0.0]
optimal alpha/beta time: 0.006824493408203125
This batch time : update_bounds func: 0.0087	 prepare: 0.0011	 bound: 0.0069	 transfer: 0.0003	 finalize: 0.0003
Accumulated time: update_bounds func: 13.1014	 prepare: 0.1546	 bound: 12.8236	 transfer: 0.0003	 finalize: 0.0726
batch bounding time:  0.008735895156860352
Current worst domains: []
length of domains: 0
Total time: 0.0251	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.0088	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 7 verify end, Time cost: 3.2178783416748047
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3], [2, 999, 24, 2.207261323928833, 0, 4], [2, 999, 736, 4.868577718734741, 0, 5], [2, 999, 94, 2.4485983848571777, 0, 6], [2, 999, 178, 3.2178783416748047, 0, 7]]
##### [0:2] Tested against 8 ######
beta splits: True
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.546382427215576 with beta sum per layer: []
optimal alpha/beta time: 0.7381057739257812
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5464]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.546382427215576
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
splitting decisions: [[2, 47]]
single_node_split: True
best_l after optimization: 3.7425222396850586 with beta sum per layer: [0.0, 0.0, 0.37966856360435486]
optimal alpha/beta time: 0.17285919189453125
This batch time : update_bounds func: 0.1744	 prepare: 0.0009	 bound: 0.1730	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 13.2759	 prepare: 0.1555	 bound: 12.9966	 transfer: 0.0003	 finalize: 0.0728
batch bounding time:  0.17447257041931152
Current worst domains: [-2.3968846797943115, -1.345637559890747]
length of domains: 2
Total time: 0.1907	 pickout: 0.0005	 decision: 0.0156	 get_bound: 0.1745	 add_domain: 0.0001
Current lb:-2.3968846797943115
2 neurons visited

splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
best_l after optimization: 3.8463573455810547 with beta sum per layer: [0.0, 0.0, 2.175375461578369]
optimal alpha/beta time: 0.17453527450561523
This batch time : update_bounds func: 0.1764	 prepare: 0.0011	 bound: 0.1746	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 13.4523	 prepare: 0.1566	 bound: 13.1712	 transfer: 0.0004	 finalize: 0.0731
batch bounding time:  0.17642974853515625
Current worst domains: [-2.2356350421905518, -1.0251624584197998, -0.9734317064285278]
length of domains: 3
Total time: 0.1928	 pickout: 0.0006	 decision: 0.0157	 get_bound: 0.1764	 add_domain: 0.0001
Current lb:-2.2356350421905518
6 neurons visited

splitting decisions: [[2, 38], [2, 38], [2, 38]]
single_node_split: True
best_l after optimization: 4.437426567077637 with beta sum per layer: [0.0, 0.0, 2.566013813018799]
optimal alpha/beta time: 0.1750779151916504
This batch time : update_bounds func: 0.1772	 prepare: 0.0012	 bound: 0.1752	 transfer: 0.0004	 finalize: 0.0004
Accumulated time: update_bounds func: 13.6294	 prepare: 0.1578	 bound: 13.3464	 transfer: 0.0004	 finalize: 0.0735
batch bounding time:  0.17720842361450195
Current worst domains: [-2.0455660820007324, -1.322099208831787, -0.427750825881958, -0.27042722702026367, -0.237839937210083, -0.1337432861328125]
length of domains: 6
Total time: 0.1938	 pickout: 0.0007	 decision: 0.0157	 get_bound: 0.1772	 add_domain: 0.0002
Current lb:-2.0455660820007324
12 neurons visited

splitting decisions: [[2, 67], [2, 67], [2, 67], [2, 67], [2, 22], [2, 22]]
single_node_split: True
best_l after optimization: 1.7555400133132935 with beta sum per layer: [0.0, 0.0, 5.7080183029174805]
optimal alpha/beta time: 0.17681646347045898
This batch time : update_bounds func: 0.1797	 prepare: 0.0016	 bound: 0.1769	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 13.8091	 prepare: 0.1594	 bound: 13.5234	 transfer: 0.0005	 finalize: 0.0741
batch bounding time:  0.17972779273986816
Current worst domains: [-1.7456556558609009, -0.9808390140533447, -0.8839044570922852, -0.46465635299682617]
length of domains: 4
Total time: 0.1972	 pickout: 0.0009	 decision: 0.0164	 get_bound: 0.1798	 add_domain: 0.0001
Current lb:-1.7456556558609009
24 neurons visited

splitting decisions: [[2, 22], [2, 22], [2, 85], [2, 22]]
single_node_split: True
best_l after optimization: 3.2236528396606445 with beta sum per layer: [0.0, 0.0, 2.6769351959228516]
optimal alpha/beta time: 0.17646121978759766
This batch time : update_bounds func: 0.1788	 prepare: 0.0013	 bound: 0.1766	 transfer: 0.0004	 finalize: 0.0005
Accumulated time: update_bounds func: 13.9880	 prepare: 0.1607	 bound: 13.6999	 transfer: 0.0004	 finalize: 0.0746
batch bounding time:  0.17891478538513184
Current worst domains: [-1.5725810527801514, -0.8027386665344238, -0.7850831747055054, -0.4911379814147949, -0.2540855407714844]
length of domains: 5
Total time: 0.1962	 pickout: 0.0007	 decision: 0.0163	 get_bound: 0.1789	 add_domain: 0.0002
Current lb:-1.5725810527801514
32 neurons visited

splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 415], [2, 85]]
single_node_split: True
best_l after optimization: 2.6505637168884277 with beta sum per layer: [0.0, 0.0, 3.3236610889434814]
optimal alpha/beta time: 0.17973685264587402
This batch time : update_bounds func: 0.1826	 prepare: 0.0016	 bound: 0.1799	 transfer: 0.0004	 finalize: 0.0007
Accumulated time: update_bounds func: 14.1706	 prepare: 0.1623	 bound: 13.8798	 transfer: 0.0004	 finalize: 0.0753
batch bounding time:  0.18264532089233398
Current worst domains: [-1.2130283117294312, -0.9047167301177979, -0.3598330020904541, -0.3364269733428955, -0.17671632766723633, -0.13303816318511963]
length of domains: 6
Total time: 0.2004	 pickout: 0.0009	 decision: 0.0166	 get_bound: 0.1827	 add_domain: 0.0002
Current lb:-1.2130283117294312
42 neurons visited

splitting decisions: [[1, 430], [1, 430], [1, 430], [1, 430], [2, 22], [1, 430]]
single_node_split: True
best_l after optimization: 2.4625096321105957 with beta sum per layer: [0.0, 0.12819232046604156, 3.521890640258789]
optimal alpha/beta time: 0.1792910099029541
This batch time : update_bounds func: 0.1823	 prepare: 0.0017	 bound: 0.1794	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 14.3529	 prepare: 0.1640	 bound: 14.0592	 transfer: 0.0005	 finalize: 0.0760
batch bounding time:  0.18231821060180664
Current worst domains: [-1.1192494630813599, -0.8050580024719238, -0.7456884384155273, -0.34751009941101074, -0.2148038148880005, -0.11488771438598633, -0.03284025192260742]
length of domains: 7
Total time: 0.2003	 pickout: 0.0009	 decision: 0.0167	 get_bound: 0.1823	 add_domain: 0.0003
Current lb:-1.1192494630813599
54 neurons visited

splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41]]
single_node_split: True
best_l after optimization: 2.773463726043701 with beta sum per layer: [0.0, 0.1522321105003357, 3.4406473636627197]
optimal alpha/beta time: 0.1798858642578125
This batch time : update_bounds func: 0.1832	 prepare: 0.0018	 bound: 0.1800	 transfer: 0.0005	 finalize: 0.0009
Accumulated time: update_bounds func: 14.5361	 prepare: 0.1658	 bound: 14.2392	 transfer: 0.0005	 finalize: 0.0768
batch bounding time:  0.18324589729309082
Current worst domains: [-0.9189379215240479, -0.7360434532165527, -0.6009256839752197, -0.5112354755401611, -0.41907668113708496, -0.36641550064086914, -0.09792590141296387, -0.04695487022399902]
length of domains: 8
Total time: 0.2019	 pickout: 0.0011	 decision: 0.0172	 get_bound: 0.1833	 add_domain: 0.0003
Current lb:-0.9189379215240479
68 neurons visited

splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [2, 81]]
single_node_split: True
best_l after optimization: 3.6110434532165527 with beta sum per layer: [0.0, 0.3562246561050415, 2.040435314178467]
optimal alpha/beta time: 0.17752766609191895
This batch time : update_bounds func: 0.1813	 prepare: 0.0021	 bound: 0.1776	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 14.7173	 prepare: 0.1678	 bound: 14.4169	 transfer: 0.0005	 finalize: 0.0778
batch bounding time:  0.1812887191772461
Current worst domains: [-0.7457900047302246, -0.6510429382324219, -0.5174951553344727, -0.45172977447509766, -0.4196474552154541, -0.3250429630279541, -0.30296754837036133, -0.22528529167175293, -0.18899250030517578, -0.1337261199951172]
length of domains: 12
Total time: 0.2002	 pickout: 0.0011	 decision: 0.0173	 get_bound: 0.1813	 add_domain: 0.0005
Current lb:-0.7457900047302246
84 neurons visited

splitting decisions: [[2, 81], [1, 268], [2, 81], [1, 415], [1, 268], [1, 268], [2, 81], [1, 415], [2, 81], [1, 415]]
single_node_split: True
best_l after optimization: 3.3526031970977783 with beta sum per layer: [0.0, 1.1974670886993408, 2.9264941215515137]
optimal alpha/beta time: 0.17881083488464355
This batch time : update_bounds func: 0.1836	 prepare: 0.0026	 bound: 0.1789	 transfer: 0.0006	 finalize: 0.0013
Accumulated time: update_bounds func: 14.9009	 prepare: 0.1705	 bound: 14.5958	 transfer: 0.0006	 finalize: 0.0791
batch bounding time:  0.18360328674316406
Current worst domains: [-0.5961437225341797, -0.5928734540939331, -0.44493532180786133, -0.3610372543334961, -0.35973644256591797, -0.34225940704345703, -0.34183335304260254, -0.2587815523147583, -0.23009848594665527, -0.16303634643554688]
length of domains: 16
Total time: 0.2039	 pickout: 0.0015	 decision: 0.0180	 get_bound: 0.1837	 add_domain: 0.0007
Current lb:-0.5961437225341797
108 neurons visited

splitting decisions: [[1, 415], [2, 81], [1, 268], [2, 81], [2, 81], [1, 415], [2, 81], [2, 81], [1, 1207], [2, 81]]
single_node_split: True
best_l after optimization: 2.0770444869995117 with beta sum per layer: [0.0, 1.790281057357788, 3.6401867866516113]
optimal alpha/beta time: 0.1801929473876953
This batch time : update_bounds func: 0.1860	 prepare: 0.0031	 bound: 0.1803	 transfer: 0.0007	 finalize: 0.0017
Accumulated time: update_bounds func: 15.0869	 prepare: 0.1736	 bound: 14.7761	 transfer: 0.0007	 finalize: 0.0809
batch bounding time:  0.18600106239318848
Current worst domains: [-0.5021007061004639, -0.4279751777648926, -0.3750894069671631, -0.3504730463027954, -0.24774622917175293, -0.23601222038269043, -0.20017004013061523, -0.19312167167663574, -0.16947150230407715, -0.16787219047546387]
length of domains: 19
Total time: 0.2068	 pickout: 0.0019	 decision: 0.0180	 get_bound: 0.1861	 add_domain: 0.0009
Current lb:-0.5021007061004639
140 neurons visited

splitting decisions: [[1, 268], [1, 415], [1, 1198], [1, 1198], [1, 268], [1, 1207], [1, 415], [1, 1198], [1, 415], [1, 1207]]
single_node_split: True
best_l after optimization: 1.1154708862304688 with beta sum per layer: [0.0, 2.593136787414551, 4.41386604309082]
optimal alpha/beta time: 0.18137145042419434
This batch time : update_bounds func: 0.1880	 prepare: 0.0034	 bound: 0.1815	 transfer: 0.0009	 finalize: 0.0020
Accumulated time: update_bounds func: 15.2748	 prepare: 0.1770	 bound: 14.9576	 transfer: 0.0009	 finalize: 0.0829
batch bounding time:  0.1880199909210205
Current worst domains: [-0.4377174377441406, -0.3639565706253052, -0.3120839595794678, -0.29303133487701416, -0.24010825157165527, -0.114898681640625, -0.1078181266784668, -0.09965431690216064, -0.08725762367248535, -0.08018922805786133]
length of domains: 20
Total time: 0.2102	 pickout: 0.0022	 decision: 0.0187	 get_bound: 0.1881	 add_domain: 0.0012
Current lb:-0.4377174377441406
178 neurons visited

splitting decisions: [[1, 1198], [1, 1198], [1, 415], [1, 415], [1, 1198], [1, 415], [1, 1059], [1, 1198], [1, 1198], [1, 1198]]
single_node_split: True
best_l after optimization: -0.9465512037277222 with beta sum per layer: [0.0, 5.053868770599365, 3.789795160293579]
optimal alpha/beta time: 0.18043184280395508
This batch time : update_bounds func: 0.1872	 prepare: 0.0036	 bound: 0.1806	 transfer: 0.0009	 finalize: 0.0021
Accumulated time: update_bounds func: 15.4620	 prepare: 0.1806	 bound: 15.1382	 transfer: 0.0009	 finalize: 0.0850
batch bounding time:  0.18720674514770508
Current worst domains: [-0.376971960067749, -0.32166945934295654, -0.2652837038040161, -0.24248480796813965, -0.18284392356872559, -0.13831043243408203, -0.07687807083129883, -0.06788873672485352, -0.04785585403442383, -0.013193130493164062]
length of domains: 13
Total time: 0.2082	 pickout: 0.0023	 decision: 0.0180	 get_bound: 0.1873	 add_domain: 0.0007
Current lb:-0.376971960067749
218 neurons visited

splitting decisions: [[2, 79], [2, 79], [1, 618], [1, 618], [2, 79], [2, 79], [2, 79], [2, 79], [1, 618], [2, 79]]
single_node_split: True
best_l after optimization: -0.04660165309906006 with beta sum per layer: [0.0, 3.2541468143463135, 1.8144868612289429]bab_verification_eran.py:104: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  model = LiRPAConvNet(model_ori, torch.tensor(pred), target, solve_slope=args.solve_slope, device=args.device,

optimal alpha/beta time: 0.1804041862487793
This batch time : update_bounds func: 0.1854	 prepare: 0.0028	 bound: 0.1805	 transfer: 0.0006	 finalize: 0.0014
Accumulated time: update_bounds func: 15.6474	 prepare: 0.1834	 bound: 15.3187	 transfer: 0.0006	 finalize: 0.0864
batch bounding time:  0.18547701835632324
Current worst domains: [-0.26273059844970703, -0.20949184894561768, -0.1987764835357666, -0.17624235153198242, -0.17356300354003906, -0.11733627319335938, -0.06608843803405762, -0.023530006408691406]
length of domains: 8
Total time: 0.2047	 pickout: 0.0017	 decision: 0.0171	 get_bound: 0.1855	 add_domain: 0.0005
Current lb:-0.26273059844970703
244 neurons visited

splitting decisions: [[1, 1059], [1, 1059], [1, 914], [1, 905], [1, 914], [1, 1207], [1, 1059], [1, 1059]]
single_node_split: True
best_l after optimization: 0.3127807378768921 with beta sum per layer: [0.0, 0.9567364454269409, 0.860931396484375]
optimal alpha/beta time: 0.17902016639709473
This batch time : update_bounds func: 0.1827	 prepare: 0.0020	 bound: 0.1791	 transfer: 0.0005	 finalize: 0.0010
Accumulated time: update_bounds func: 15.8301	 prepare: 0.1854	 bound: 15.4978	 transfer: 0.0005	 finalize: 0.0874
batch bounding time:  0.1826925277709961
Current worst domains: [-0.21160340309143066, -0.15813231468200684, -0.14727449417114258, -0.11990618705749512, -0.10948801040649414, -0.03418755531311035, -0.020992040634155273, -0.011967182159423828]
length of domains: 8
Total time: 0.2013	 pickout: 0.0012	 decision: 0.0169	 get_bound: 0.1827	 add_domain: 0.0005
Current lb:-0.21160340309143066
260 neurons visited

splitting decisions: [[1, 1207], [1, 1207], [2, 79], [2, 79], [1, 1207], [1, 277], [1, 1207], [1, 1207]]
single_node_split: True
best_l after optimization: -0.026671171188354492 with beta sum per layer: [0.0, 0.591944694519043, 1.0609513521194458]
optimal alpha/beta time: 0.17760753631591797
This batch time : update_bounds func: 0.1813	 prepare: 0.0020	 bound: 0.1777	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 16.0114	 prepare: 0.1874	 bound: 15.6756	 transfer: 0.0006	 finalize: 0.0883
batch bounding time:  0.18135809898376465
Current worst domains: [-0.15002036094665527, -0.09554553031921387, -0.053339481353759766, -0.040171146392822266, -0.03377056121826172, -0.015563726425170898]
length of domains: 6
Total time: 0.1997	 pickout: 0.0011	 decision: 0.0168	 get_bound: 0.1814	 add_domain: 0.0004
Current lb:-0.15002036094665527
276 neurons visited

splitting decisions: [[1, 914], [1, 914], [1, 914], [1, 1059], [1, 1059], [1, 1207]]
single_node_split: True
best_l after optimization: -0.5472886562347412 with beta sum per layer: [0.0, 0.0, 0.7228378653526306]
optimal alpha/beta time: 0.17656612396240234
This batch time : update_bounds func: 0.1796	 prepare: 0.0017	 bound: 0.1767	 transfer: 0.0005	 finalize: 0.0007
Accumulated time: update_bounds func: 16.1909	 prepare: 0.1891	 bound: 15.8523	 transfer: 0.0005	 finalize: 0.0890
batch bounding time:  0.1795961856842041
Current worst domains: [-0.09335160255432129, -0.039243340492248535]
length of domains: 2
Total time: 0.1972	 pickout: 0.0010	 decision: 0.0164	 get_bound: 0.1796	 add_domain: 0.0002
Current lb:-0.09335160255432129
288 neurons visited

splitting decisions: [[1, 618], [1, 618]]
single_node_split: True
best_l after optimization: -0.1480879783630371 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.17328190803527832
This batch time : update_bounds func: 0.1752	 prepare: 0.0011	 bound: 0.1734	 transfer: 0.0004	 finalize: 0.0003
Accumulated time: update_bounds func: 16.3662	 prepare: 0.1902	 bound: 16.0257	 transfer: 0.0004	 finalize: 0.0893
batch bounding time:  0.17525458335876465
Current worst domains: [-0.028885841369628906]
length of domains: 1
Total time: 0.1918	 pickout: 0.0006	 decision: 0.0158	 get_bound: 0.1753	 add_domain: 0.0001
Current lb:-0.028885841369628906
292 neurons visited

splitting decisions: [[1, 277]]
single_node_split: True

all verified at 0th iter
best_l after optimization: -0.10874533653259277 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.006716728210449219
This batch time : update_bounds func: 0.0083	 prepare: 0.0010	 bound: 0.0068	 transfer: 0.0003	 finalize: 0.0002
Accumulated time: update_bounds func: 16.3745	 prepare: 0.1912	 bound: 16.0325	 transfer: 0.0003	 finalize: 0.0895
batch bounding time:  0.008373737335205078
Current worst domains: []
length of domains: 0
Total time: 0.0245	 pickout: 0.0005	 decision: 0.0157	 get_bound: 0.0084	 add_domain: 0.0000
No domains left, verification finished!
Image 2 pidx 8 verify end, Time cost: 4.4210731983184814
2 999
[[2, 0, 0, 5.318796157836914, 0, -1], [2, 999, 20, 2.5690436363220215, 0, 0], [2, 999, 4, 1.045989990234375, 0, 1], [2, 999, 70, 2.4551780223846436, 0, 2], [2, 999, 134, 3.2460899353027344, 0, 3], [2, 999, 24, 2.207261323928833, 0, 4], [2, 999, 736, 4.868577718734741, 0, 5], [2, 999, 94, 2.4485983848571777, 0, 6], [2, 999, 178, 3.2178783416748047, 0, 7], [2, 999, 294, 4.4210731983184814, 0, 8]]
##### [0:2] Tested against 9 ######
correct label, skip!
[[  2.           0.           0.           5.31879616   0.
   -1.        ]
 [  2.         999.          20.           2.56904364   0.
    0.        ]
 [  2.         999.           4.           1.04598999   0.
    1.        ]
 [  2.         999.          70.           2.45517802   0.
    2.        ]
 [  2.         999.         134.           3.24608994   0.
    3.        ]
 [  2.         999.          24.           2.20726132   0.
    4.        ]
 [  2.         999.         736.           4.86857772   0.
    5.        ]
 [  2.         999.          94.           2.44859838   0.
    6.        ]
 [  2.         999.         178.           3.21787834   0.
    7.        ]
 [  2.         999.         294.           4.4210732    0.
    8.        ]
 [  2.           0.           0.           0.           0.
    9.        ]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [total:1]: 31.798486709594727
mean time [cnt:1]: 31.798486709594727

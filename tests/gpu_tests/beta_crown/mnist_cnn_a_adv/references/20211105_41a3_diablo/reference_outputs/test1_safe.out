Experiments at Wed Apr 13 17:22:27 2022 on diablo.cs.ucla.edu
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.1340)
############################
epsilon after preprocession: 0.30000001192092896, data_max = tensor([[[[1.]]]]), data_min = tensor([[[[0.]]]])
Task length: 1
saving results to Verified_ret_[mnist_cnn_4layer]_start=2_end=3_iter=20_b=1024_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  9  correct label  9 logits tensor([-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
        -1.0512,  3.9617], device='cuda:0', grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 9, Tested against: ['all'] ######
pgd prediction: tensor([-5.3246, -6.1902, -3.9761, -3.1825,  2.2820, -2.8912, -3.6656, -1.6136,
        -2.1519,  3.0546], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([8.3792, 9.2448, 7.0308, 6.2371, 0.7726, 5.9458, 6.7202, 4.6682, 5.2065,
           inf], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-4.1401, -3.4078, -5.1113, -5.2829, -1.5644, -6.7596, -6.7052, -4.9598,
         -4.3621]], device='cuda:0') None
best_l after optimization: 21.559581756591797 with beta sum per layer: []
optimal alpha/beta time: 5.811116456985474
initial alpha-CROWN bounds: tensor([[-1.6260, -0.6048, -2.5603, -2.6631, -0.8632, -3.7282, -3.4871, -3.4827,
         -2.5443]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:2] Tested against 4 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.8620259761810303 with beta sum per layer: []
optimal alpha/beta time: 1.451237678527832
alpha-CROWN with fixed intermediate bounds: tensor([[-0.8620]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.8620259761810303
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.23692214488983154 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.6601572036743164
This batch time : update_bounds func: 0.6628	 prepare: 0.0016	 bound: 0.6604	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 0.6628	 prepare: 0.0016	 bound: 0.6604	 transfer: 0.0005	 finalize: 0.0003
batch bounding time:  0.6628880500793457
Current worst splitting domains [lb, ub] (depth):
[-0.72522, 98.137978] (1), 
length of domains: 1
Total time: 0.6836	 pickout: 0.0008	 decision: 0.0197	 get_bound: 0.6629	 add_domain: 0.0001
Current lb:-0.7252212762832642
2 neurons visited
0 diving domains visited
Cumulative time: 2.5634822845458984

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1046]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.8592009544372559 with beta sum per layer: [0.0, 0.27736642956733704, 0.0]
optimal alpha/beta time: 0.24979639053344727
This batch time : update_bounds func: 0.2525	 prepare: 0.0016	 bound: 0.2500	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 0.9152	 prepare: 0.0032	 bound: 0.9104	 transfer: 0.0005	 finalize: 0.0005
batch bounding time:  0.2525808811187744
Current worst splitting domains [lb, ub] (depth):
[-0.67223, 98.137978] (2), [-0.18697, 98.137978] (2), 
length of domains: 2
Total time: 0.2726	 pickout: 0.0007	 decision: 0.0192	 get_bound: 0.2526	 add_domain: 0.0001
Current lb:-0.6722345352172852
4 neurons visited
0 diving domains visited
Cumulative time: 2.8361735343933105

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 45]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.2625136375427246 with beta sum per layer: [0.0, 0.5026470422744751, 0.3157650828361511]
optimal alpha/beta time: 0.2513086795806885
This batch time : update_bounds func: 0.2544	 prepare: 0.0019	 bound: 0.2515	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 1.1696	 prepare: 0.0051	 bound: 1.1620	 transfer: 0.0005	 finalize: 0.0009
batch bounding time:  0.2545127868652344
Current worst splitting domains [lb, ub] (depth):
[-0.60965, 98.137978] (3), [-0.09604, 98.137978] (3), 
length of domains: 2
Total time: 0.2750	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2545	 add_domain: 0.0001
Current lb:-0.6096483469009399
8 neurons visited
0 diving domains visited
Cumulative time: 3.1113169193267822

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11], [2, 11]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.012992501258850098 with beta sum per layer: [0.0, 0.45056119561195374, 0.0]
optimal alpha/beta time: 0.2503335475921631
This batch time : update_bounds func: 0.2534	 prepare: 0.0019	 bound: 0.2506	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 1.4230	 prepare: 0.0069	 bound: 1.4125	 transfer: 0.0006	 finalize: 0.0013
batch bounding time:  0.25353527069091797
Current worst splitting domains [lb, ub] (depth):
[-0.29359, 98.137978] (4), [-0.19216, 98.137978] (4), 
length of domains: 2
Total time: 0.2744	 pickout: 0.0009	 decision: 0.0198	 get_bound: 0.2536	 add_domain: 0.0001
Current lb:-0.2935885190963745
12 neurons visited
0 diving domains visited
Cumulative time: 3.38578724861145

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 556], [1, 556]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.07185661792755127 with beta sum per layer: [0.0, 0.39705345034599304, 0.0]
optimal alpha/beta time: 0.25043725967407227
This batch time : update_bounds func: 0.2535	 prepare: 0.0018	 bound: 0.2507	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 1.6765	 prepare: 0.0088	 bound: 1.6632	 transfer: 0.0005	 finalize: 0.0017
batch bounding time:  0.25362277030944824
Current worst splitting domains [lb, ub] (depth):
[-0.12344, 98.137978] (5), [-0.08214, 98.137978] (5), 
length of domains: 2
Total time: 0.2743	 pickout: 0.0009	 decision: 0.0196	 get_bound: 0.2536	 add_domain: 0.0001
Current lb:-0.1234363317489624
16 neurons visited
0 diving domains visited
Cumulative time: 3.6601526737213135

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 648], [1, 606]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.08303570747375488 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.24815130233764648
This batch time : update_bounds func: 0.2512	 prepare: 0.0019	 bound: 0.2484	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 1.9277	 prepare: 0.0107	 bound: 1.9116	 transfer: 0.0005	 finalize: 0.0021
batch bounding time:  0.2513265609741211
Current worst splitting domains [lb, ub] (depth):
[-0.09114, 98.137978] (6), 
length of domains: 1
Total time: 0.2719	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2513	 add_domain: 0.0001
Current lb:-0.09114110469818115
20 neurons visited
0 diving domains visited
Cumulative time: 3.9321138858795166

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 655]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 0.0013318061828613281 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.24138617515563965
This batch time : update_bounds func: 0.2441	 prepare: 0.0017	 bound: 0.2416	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 2.1719	 prepare: 0.0123	 bound: 2.1532	 transfer: 0.0005	 finalize: 0.0023
batch bounding time:  0.244246244430542
Current worst splitting domains [lb, ub] (depth):
[-0.02459, 98.137978] (7), 
length of domains: 1
Total time: 0.2646	 pickout: 0.0008	 decision: 0.0195	 get_bound: 0.2443	 add_domain: 0.0001
Current lb:-0.024585962295532227
22 neurons visited
0 diving domains visited
Cumulative time: 4.19685959815979

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 606]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.1848902702331543 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008909940719604492
This batch time : update_bounds func: 0.0116	 prepare: 0.0017	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 2.1834	 prepare: 0.0140	 bound: 2.1624	 transfer: 0.0005	 finalize: 0.0026
batch bounding time:  0.011620283126831055
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0320	 pickout: 0.0008	 decision: 0.0196	 get_bound: 0.0116	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 4.228953838348389

Image 2 pidx 4 verify end, final lower bound 999, upper bound 98.13797760009766, time: 4.288525819778442
2 999
##### [0:2] Tested against 7 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.4810714721679688 with beta sum per layer: []
optimal alpha/beta time: 0.9902298450469971
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4811]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.4810714721679688
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.712133407592773 with beta sum per layer: [0.0, 0.0, 0.01748429238796234]
optimal alpha/beta time: 0.24644899368286133
This batch time : update_bounds func: 0.2490	 prepare: 0.0015	 bound: 0.2467	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 2.4324	 prepare: 0.0155	 bound: 2.4090	 transfer: 0.0005	 finalize: 0.0028
batch bounding time:  0.24908757209777832
Current worst splitting domains [lb, ub] (depth):
[-2.74407, 95.518929] (1), [-1.96807, 95.518929] (1), 
length of domains: 2
Total time: 0.2692	 pickout: 0.0007	 decision: 0.0192	 get_bound: 0.2491	 add_domain: 0.0001
Current lb:-2.744068145751953
2 neurons visited
0 diving domains visited
Cumulative time: 1.2750270366668701

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 4.445436477661133 with beta sum per layer: [0.0, 0.0, 1.39104425907135]
optimal alpha/beta time: 0.24962711334228516
This batch time : update_bounds func: 0.2525	 prepare: 0.0017	 bound: 0.2499	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 2.6849	 prepare: 0.0173	 bound: 2.6589	 transfer: 0.0005	 finalize: 0.0032
batch bounding time:  0.2526509761810303
Current worst splitting domains [lb, ub] (depth):
[-2.55874, 95.518929] (2), [-1.84217, 95.518929] (2), [-0.49330, 95.518929] (2), 
length of domains: 3
Total time: 0.2732	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2527	 add_domain: 0.0001
Current lb:-2.558736801147461
6 neurons visited
0 diving domains visited
Cumulative time: 1.5483217239379883

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1052], [1, 415], [2, 67]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 5.755728721618652 with beta sum per layer: [0.0, 0.21704089641571045, 1.597550868988037]
optimal alpha/beta time: 0.25209832191467285
This batch time : update_bounds func: 0.2556	 prepare: 0.0021	 bound: 0.2523	 transfer: 0.0006	 finalize: 0.0005
Accumulated time: update_bounds func: 2.9405	 prepare: 0.0194	 bound: 2.9112	 transfer: 0.0006	 finalize: 0.0038
batch bounding time:  0.25571441650390625
Current worst splitting domains [lb, ub] (depth):
[-2.25777, 95.518929] (3), [-1.93885, 95.518929] (3), [-1.35983, 95.518929] (3), [-1.02231, 95.518929] (3), 
length of domains: 4
Total time: 0.2767	 pickout: 0.0011	 decision: 0.0198	 get_bound: 0.2557	 add_domain: 0.0002
Current lb:-2.25777006149292
12 neurons visited
0 diving domains visited
Cumulative time: 1.825171709060669

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11], [2, 11], [2, 67], [2, 11]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 8.409299850463867 with beta sum per layer: [0.0, 0.3270840644836426, 2.2456932067871094]
optimal alpha/beta time: 0.2532024383544922
This batch time : update_bounds func: 0.2571	 prepare: 0.0022	 bound: 0.2534	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 3.1975	 prepare: 0.0216	 bound: 3.1647	 transfer: 0.0006	 finalize: 0.0045
batch bounding time:  0.2571830749511719
Current worst splitting domains [lb, ub] (depth):
[-2.07648, 95.518929] (4), [-1.73790, 95.518929] (4), [-1.34531, 95.518929] (4), [-1.04146, 95.518929] (4), [-0.83614, 95.518929] (4), [-0.74611, 95.518929] (4), [-0.64332, 95.518929] (4), 
length of domains: 7
Total time: 0.2786	 pickout: 0.0012	 decision: 0.0199	 get_bound: 0.2572	 add_domain: 0.0003
Current lb:-2.0764827728271484
20 neurons visited
0 diving domains visited
Cumulative time: 2.1038901805877686

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 11], [2, 11]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 8.756942749023438 with beta sum per layer: [0.0, 0.933464527130127, 3.846764087677002]
optimal alpha/beta time: 0.25595712661743164
This batch time : update_bounds func: 0.2610	 prepare: 0.0027	 bound: 0.2562	 transfer: 0.0010	 finalize: 0.0010
Accumulated time: update_bounds func: 3.4586	 prepare: 0.0243	 bound: 3.4209	 transfer: 0.0010	 finalize: 0.0055
batch bounding time:  0.2612152099609375
Current worst splitting domains [lb, ub] (depth):
[-1.57640, 95.518929] (5), [-1.48254, 95.518929] (5), [-1.14109, 95.518929] (5), [-1.14009, 95.518929] (5), [-0.99383, 95.518929] (5), [-0.67518, 95.518929] (5), [-0.57854, 95.518929] (5), [-0.45586, 95.518929] (5), [-0.43548, 95.518929] (5), [-0.25626, 95.518929] (5), [-0.23052, 95.518929] (5), 
length of domains: 11
Total time: 0.2843	 pickout: 0.0016	 decision: 0.0208	 get_bound: 0.2612	 add_domain: 0.0007
Current lb:-1.5763983726501465
34 neurons visited
0 diving domains visited
Cumulative time: 2.3883936405181885

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 415], [1, 415], [1, 415], [1, 415], [2, 67], [2, 67], [2, 38], [2, 38], [2, 67], [2, 38]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 4.2659759521484375 with beta sum per layer: [0.0, 4.756383895874023, 6.994500160217285]
optimal alpha/beta time: 0.2552051544189453
This batch time : update_bounds func: 0.2619	 prepare: 0.0036	 bound: 0.2555	 transfer: 0.0012	 finalize: 0.0016
Accumulated time: update_bounds func: 3.7205	 prepare: 0.0280	 bound: 3.6763	 transfer: 0.0012	 finalize: 0.0071
batch bounding time:  0.2620270252227783
Current worst splitting domains [lb, ub] (depth):
[-1.25025, 95.518929] (6), [-1.19874, 95.518929] (6), [-0.93531, 95.518929] (6), [-0.79424, 95.518929] (6), [-0.76318, 95.518929] (6), [-0.49128, 95.518929] (6), [-0.44329, 95.518929] (6), [-0.28566, 95.518929] (6), [-0.12829, 95.518929] (6), [-0.08968, 95.518929] (6), [-0.04676, 95.518929] (6), 
length of domains: 11
Total time: 0.2872	 pickout: 0.0023	 decision: 0.0223	 get_bound: 0.2621	 add_domain: 0.0005
Current lb:-1.2502467632293701
56 neurons visited
0 diving domains visited
Cumulative time: 2.6758005619049072

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [2, 38], [1, 618], [2, 38], [1, 618], [1, 1052]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 3.7646327018737793 with beta sum per layer: [0.0, 6.499419212341309, 2.8860602378845215]
optimal alpha/beta time: 0.2575552463531494
This batch time : update_bounds func: 0.2640	 prepare: 0.0036	 bound: 0.2579	 transfer: 0.0009	 finalize: 0.0015
Accumulated time: update_bounds func: 3.9845	 prepare: 0.0315	 bound: 3.9342	 transfer: 0.0009	 finalize: 0.0086
batch bounding time:  0.26412010192871094
Current worst splitting domains [lb, ub] (depth):
[-0.83035, 95.518929] (7), [-0.77920, 95.518929] (7), [-0.76199, 95.518929] (7), [-0.62429, 95.518929] (7), [-0.53172, 95.518929] (7), [-0.44139, 95.518929] (7), [-0.37950, 95.518929] (7), [-0.31362, 95.518929] (7), [-0.26792, 95.518929] (7), [-0.18316, 95.518929] (7), [-0.17075, 95.518929] (7), 
length of domains: 11
Total time: 0.2881	 pickout: 0.0022	 decision: 0.0210	 get_bound: 0.2642	 add_domain: 0.0006
Current lb:-0.8303537368774414
78 neurons visited
0 diving domains visited
Cumulative time: 2.964130401611328

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 661], [1, 618], [1, 661], [1, 618], [1, 618], [1, 618], [1, 618], [1, 661], [1, 618], [1, 618]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 3.235994577407837 with beta sum per layer: [0.0, 5.803145885467529, 1.1090400218963623]
optimal alpha/beta time: 0.2542426586151123
This batch time : update_bounds func: 0.2604	 prepare: 0.0035	 bound: 0.2545	 transfer: 0.0009	 finalize: 0.0015
Accumulated time: update_bounds func: 4.2449	 prepare: 0.0350	 bound: 4.1886	 transfer: 0.0009	 finalize: 0.0101
batch bounding time:  0.26057863235473633
Current worst splitting domains [lb, ub] (depth):
[-0.72746, 95.518929] (8), [-0.57471, 95.518929] (8), [-0.50426, 95.518929] (8), [-0.37893, 95.518929] (8), [-0.36697, 95.518929] (8), [-0.29720, 95.518929] (8), [-0.24726, 95.518929] (8), [-0.17831, 95.518929] (8), [-0.16438, 95.518929] (8), [-0.15602, 95.518929] (8), [-0.13800, 95.518929] (8), [-0.09106, 95.518929] (8), [-0.03988, 95.518929] (8), [-0.02635, 95.518929] (8), 
length of domains: 14
Total time: 0.2845	 pickout: 0.0023	 decision: 0.0209	 get_bound: 0.2606	 add_domain: 0.0007
Current lb:-0.7274556159973145
100 neurons visited
0 diving domains visited
Cumulative time: 3.248931646347046

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 618], [1, 618], [1, 1059], [1, 618], [1, 661], [1, 612], [1, 661], [1, 618], [1, 1059], [1, 618]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: 0.14506149291992188 with beta sum per layer: [0.0, 7.067643642425537, 0.23910140991210938]
optimal alpha/beta time: 0.2550215721130371
This batch time : update_bounds func: 0.2622	 prepare: 0.0040	 bound: 0.2553	 transfer: 0.0009	 finalize: 0.0019
Accumulated time: update_bounds func: 4.5070	 prepare: 0.0390	 bound: 4.4439	 transfer: 0.0009	 finalize: 0.0120
batch bounding time:  0.26229166984558105
Current worst splitting domains [lb, ub] (depth):
[-0.44983, 95.518929] (9), [-0.31627, 95.518929] (9), [-0.31341, 95.518929] (9), [-0.26604, 95.518929] (9), [-0.21164, 95.518929] (9), [-0.21009, 95.518929] (9), [-0.16571, 95.518929] (9), [-0.14069, 95.518929] (9), [-0.10503, 95.518929] (9), [-0.05709, 95.518929] (9), 
length of domains: 10
Total time: 0.2882	 pickout: 0.0027	 decision: 0.0226	 get_bound: 0.2623	 add_domain: 0.0005
Current lb:-0.449826717376709
128 neurons visited
0 diving domains visited
Cumulative time: 3.5374081134796143

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 612], [1, 612], [1, 612], [1, 612], [1, 1059], [1, 905], [1, 612], [1, 612], [1, 612], [1, 612]]
single_node_split: True
regular batch size: 2*10, diving batch size 1*0
best_l after optimization: 0.3532431125640869 with beta sum per layer: [0.0, 2.2181200981140137, 0.07521377503871918]
optimal alpha/beta time: 0.2544078826904297
This batch time : update_bounds func: 0.2602	 prepare: 0.0033	 bound: 0.2546	 transfer: 0.0008	 finalize: 0.0014
Accumulated time: update_bounds func: 4.7672	 prepare: 0.0423	 bound: 4.6986	 transfer: 0.0008	 finalize: 0.0134
batch bounding time:  0.2603480815887451
Current worst splitting domains [lb, ub] (depth):
[-0.37287, 95.518929] (10), [-0.21631, 95.518929] (10), [-0.18751, 95.518929] (10), [-0.18510, 95.518929] (10), [-0.08639, 95.518929] (10), [-0.05470, 95.518929] (10), [-0.04663, 95.518929] (10), [-0.04217, 95.518929] (10), 
length of domains: 8
Total time: 0.2840	 pickout: 0.0021	 decision: 0.0210	 get_bound: 0.2604	 add_domain: 0.0005
Current lb:-0.37286949157714844
148 neurons visited
0 diving domains visited
Cumulative time: 3.8216185569763184

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47], [2, 47], [2, 47], [2, 47], [1, 73], [2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -1.1400747299194336 with beta sum per layer: [0.0, 1.0961363315582275, 0.33961033821105957]
optimal alpha/beta time: 0.2587621212005615
This batch time : update_bounds func: 0.2643	 prepare: 0.0031	 bound: 0.2590	 transfer: 0.0007	 finalize: 0.0014
Accumulated time: update_bounds func: 5.0315	 prepare: 0.0454	 bound: 4.9576	 transfer: 0.0007	 finalize: 0.0148
batch bounding time:  0.2644016742706299
Current worst splitting domains [lb, ub] (depth):
[-0.24882, 95.518929] (11), [-0.08656, 95.518929] (11), [-0.07651, 95.518929] (11), [-0.06520, 95.518929] (11), 
length of domains: 4
Total time: 0.2872	 pickout: 0.0018	 decision: 0.0207	 get_bound: 0.2644	 add_domain: 0.0003
Current lb:-0.248823881149292
164 neurons visited
0 diving domains visited
Cumulative time: 4.109079122543335

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 46], [2, 46], [1, 661], [1, 73]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: -2.1057727336883545 with beta sum per layer: [0.0, 0.150178462266922, 0.0]
optimal alpha/beta time: 0.24802422523498535
This batch time : update_bounds func: 0.2519	 prepare: 0.0024	 bound: 0.2483	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 5.2834	 prepare: 0.0478	 bound: 5.2059	 transfer: 0.0006	 finalize: 0.0154
batch bounding time:  0.25211095809936523
Current worst splitting domains [lb, ub] (depth):
[-0.17843, 95.518929] (12), [-0.00791, 95.518929] (12), 
length of domains: 2
Total time: 0.2736	 pickout: 0.0012	 decision: 0.0201	 get_bound: 0.2521	 add_domain: 0.0002
Current lb:-0.17842674255371094
172 neurons visited
0 diving domains visited
Cumulative time: 4.38284707069397

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1059], [1, 1059]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5826492309570312 with beta sum per layer: [0.0, 0.21349936723709106, 0.0]
optimal alpha/beta time: 0.008980989456176758
This batch time : update_bounds func: 0.0120	 prepare: 0.0019	 bound: 0.0092	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 5.2954	 prepare: 0.0496	 bound: 5.2151	 transfer: 0.0005	 finalize: 0.0158
batch bounding time:  0.012036800384521484
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0325	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.0121	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 4.415470123291016

Image 2 pidx 7 verify end, final lower bound 999, upper bound 95.51892852783203, time: 4.4730963706970215
2 999
##### [0:2] Tested against 8 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.5426430702209473 with beta sum per layer: []
optimal alpha/beta time: 1.002305507659912
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5426]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.5426430702209473
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 3.7372689247131348 with beta sum per layer: [0.0, 0.0, 0.3803929388523102]
optimal alpha/beta time: 0.24973440170288086
This batch time : update_bounds func: 0.2523	 prepare: 0.0015	 bound: 0.2500	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 5.5477	 prepare: 0.0511	 bound: 5.4650	 transfer: 0.0005	 finalize: 0.0160
batch bounding time:  0.25238656997680664
Current worst splitting domains [lb, ub] (depth):
[-2.39369, 96.457359] (1), [-1.34358, 96.457359] (1), 
length of domains: 2
Total time: 0.2725	 pickout: 0.0008	 decision: 0.0193	 get_bound: 0.2524	 add_domain: 0.0001
Current lb:-2.393691062927246
2 neurons visited
0 diving domains visited
Cumulative time: 1.291184902191162

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 3.8357954025268555 with beta sum per layer: [0.0, 0.0, 2.1701693534851074]
optimal alpha/beta time: 0.2558443546295166
This batch time : update_bounds func: 0.2587	 prepare: 0.0017	 bound: 0.2561	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 5.8064	 prepare: 0.0529	 bound: 5.7211	 transfer: 0.0005	 finalize: 0.0164
batch bounding time:  0.25884032249450684
Current worst splitting domains [lb, ub] (depth):
[-2.23225, 96.457359] (2), [-1.02262, 96.457359] (2), [-0.96618, 96.457359] (2), 
length of domains: 3
Total time: 0.2793	 pickout: 0.0009	 decision: 0.0194	 get_bound: 0.2589	 add_domain: 0.0002
Current lb:-2.2322540283203125
6 neurons visited
0 diving domains visited
Cumulative time: 1.5705504417419434

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38], [2, 38]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 4.408347129821777 with beta sum per layer: [0.0, 0.0, 2.5838308334350586]
optimal alpha/beta time: 0.2610287666320801
This batch time : update_bounds func: 0.2642	 prepare: 0.0019	 bound: 0.2613	 transfer: 0.0005	 finalize: 0.0005
Accumulated time: update_bounds func: 6.0707	 prepare: 0.0548	 bound: 5.9823	 transfer: 0.0005	 finalize: 0.0169
batch bounding time:  0.26431846618652344
Current worst splitting domains [lb, ub] (depth):
[-2.04251, 96.457359] (3), [-1.31754, 96.457359] (3), [-0.42428, 96.457359] (3), [-0.26311, 96.457359] (3), [-0.23015, 96.457359] (3), [-0.13075, 96.457359] (3), 
length of domains: 6
Total time: 0.2850	 pickout: 0.0010	 decision: 0.0194	 get_bound: 0.2643	 add_domain: 0.0002
Current lb:-2.0425071716308594
12 neurons visited
0 diving domains visited
Cumulative time: 1.8556466102600098

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 67], [2, 67], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 1.723685383796692 with beta sum per layer: [0.0, 0.0, 5.717055320739746]
optimal alpha/beta time: 0.26022911071777344
This batch time : update_bounds func: 0.2643	 prepare: 0.0024	 bound: 0.2604	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 6.3350	 prepare: 0.0572	 bound: 6.2428	 transfer: 0.0006	 finalize: 0.0177
batch bounding time:  0.26441168785095215
Current worst splitting domains [lb, ub] (depth):
[-1.74238, 96.457359] (4), [-0.97613, 96.457359] (4), [-0.87839, 96.457359] (4), [-0.46098, 96.457359] (4), 
length of domains: 4
Total time: 0.2865	 pickout: 0.0015	 decision: 0.0204	 get_bound: 0.2644	 add_domain: 0.0002
Current lb:-1.7423784732818604
24 neurons visited
0 diving domains visited
Cumulative time: 2.14235520362854

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22], [2, 85], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 3.156892776489258 with beta sum per layer: [0.0, 0.0, 2.7087748050689697]
optimal alpha/beta time: 0.2593061923980713
This batch time : update_bounds func: 0.2628	 prepare: 0.0021	 bound: 0.2595	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 6.5978	 prepare: 0.0593	 bound: 6.5023	 transfer: 0.0006	 finalize: 0.0183
batch bounding time:  0.26288771629333496
Current worst splitting domains [lb, ub] (depth):
[-1.56919, 96.457359] (5), [-0.79759, 96.457359] (5), [-0.78213, 96.457359] (5), [-0.48726, 96.457359] (5), [-0.24892, 96.457359] (5), 
length of domains: 5
Total time: 0.2842	 pickout: 0.0012	 decision: 0.0199	 get_bound: 0.2629	 add_domain: 0.0002
Current lb:-1.5691864490509033
32 neurons visited
0 diving domains visited
Cumulative time: 2.426647424697876

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 415], [2, 85]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 2.598701000213623 with beta sum per layer: [0.0, 0.0, 3.344770908355713]
optimal alpha/beta time: 0.2643580436706543
This batch time : update_bounds func: 0.2685	 prepare: 0.0024	 bound: 0.2646	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 6.8663	 prepare: 0.0617	 bound: 6.7669	 transfer: 0.0006	 finalize: 0.0191
batch bounding time:  0.26863956451416016
Current worst splitting domains [lb, ub] (depth):
[-1.20944, 96.457359] (6), [-0.90398, 96.457359] (6), [-0.35520, 96.457359] (6), [-0.33147, 96.457359] (6), [-0.17048, 96.457359] (6), [-0.13143, 96.457359] (6), 
length of domains: 6
Total time: 0.2905	 pickout: 0.0013	 decision: 0.0202	 get_bound: 0.2687	 add_domain: 0.0003
Current lb:-1.209437608718872
42 neurons visited
0 diving domains visited
Cumulative time: 2.717311143875122

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [1, 430], [1, 430], [1, 430], [2, 22], [1, 430]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 2.4367308616638184 with beta sum per layer: [0.0, 0.12450085580348969, 3.4327914714813232]
optimal alpha/beta time: 0.2636682987213135
This batch time : update_bounds func: 0.2680	 prepare: 0.0026	 bound: 0.2639	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 7.1344	 prepare: 0.0643	 bound: 7.0308	 transfer: 0.0006	 finalize: 0.0199
batch bounding time:  0.2681238651275635
Current worst splitting domains [lb, ub] (depth):
[-1.11729, 96.457359] (7), [-0.80178, 96.457359] (7), [-0.74323, 96.457359] (7), [-0.34586, 96.457359] (7), [-0.21382, 96.457359] (7), [-0.11081, 96.457359] (7), [-0.02716, 96.457359] (7), 
length of domains: 7
Total time: 0.2903	 pickout: 0.0015	 decision: 0.0204	 get_bound: 0.2682	 add_domain: 0.0003
Current lb:-1.1172893047332764
54 neurons visited
0 diving domains visited
Cumulative time: 3.0077807903289795

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41], [2, 41]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 2.7585675716400146 with beta sum per layer: [0.0, 0.14015710353851318, 3.368603229522705]
optimal alpha/beta time: 0.2632267475128174
This batch time : update_bounds func: 0.2680	 prepare: 0.0028	 bound: 0.2635	 transfer: 0.0007	 finalize: 0.0010
Accumulated time: update_bounds func: 7.4024	 prepare: 0.0671	 bound: 7.2943	 transfer: 0.0007	 finalize: 0.0210
batch bounding time:  0.2680850028991699
Current worst splitting domains [lb, ub] (depth):
[-0.91501, 96.457359] (8), [-0.73459, 96.457359] (8), [-0.59830, 96.457359] (8), [-0.50998, 96.457359] (8), [-0.41557, 96.457359] (8), [-0.36573, 96.457359] (8), [-0.09766, 96.457359] (8), [-0.04526, 96.457359] (8), 
length of domains: 8
Total time: 0.2909	 pickout: 0.0016	 decision: 0.0207	 get_bound: 0.2681	 add_domain: 0.0004
Current lb:-0.9150084257125854
68 neurons visited
0 diving domains visited
Cumulative time: 3.298847198486328

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [1, 414], [2, 81]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 3.5789289474487305 with beta sum per layer: [0.0, 0.37721478939056396, 2.0258240699768066]
optimal alpha/beta time: 0.2617220878601074
This batch time : update_bounds func: 0.2670	 prepare: 0.0031	 bound: 0.2619	 transfer: 0.0007	 finalize: 0.0012
Accumulated time: update_bounds func: 7.6693	 prepare: 0.0702	 bound: 7.5562	 transfer: 0.0007	 finalize: 0.0222
batch bounding time:  0.26706433296203613
Current worst splitting domains [lb, ub] (depth):
[-0.74242, 96.457359] (9), [-0.64783, 96.457359] (9), [-0.51587, 96.457359] (9), [-0.45000, 96.457359] (9), [-0.41627, 96.457359] (9), [-0.32264, 96.457359] (9), [-0.30008, 96.457359] (9), [-0.22460, 96.457359] (9), [-0.18905, 96.457359] (9), [-0.13017, 96.457359] (9), [-0.11965, 96.457359] (9), [-0.06613, 96.457359] (9), 
length of domains: 12
Total time: 0.2907	 pickout: 0.0018	 decision: 0.0212	 get_bound: 0.2671	 add_domain: 0.0006
Current lb:-0.7424237728118896
84 neurons visited
0 diving domains visited
Cumulative time: 3.5896692276000977

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 268], [1, 268], [2, 81], [1, 415], [1, 268], [1, 268], [2, 81], [1, 415], [2, 81], [1, 415]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: 3.4126243591308594 with beta sum per layer: [0.0, 1.279208779335022, 2.7943849563598633]
optimal alpha/beta time: 0.2664649486541748
This batch time : update_bounds func: 0.2730	 prepare: 0.0038	 bound: 0.2667	 transfer: 0.0008	 finalize: 0.0016
Accumulated time: update_bounds func: 7.9424	 prepare: 0.0740	 bound: 7.8229	 transfer: 0.0008	 finalize: 0.0238
batch bounding time:  0.2731328010559082
Current worst splitting domains [lb, ub] (depth):
[-0.67339, 96.457359] (10), [-0.59017, 96.457359] (10), [-0.49286, 96.457359] (10), [-0.35943, 96.457359] (10), [-0.35374, 96.457359] (10), [-0.33736, 96.457359] (10), [-0.33634, 96.457359] (10), [-0.25537, 96.457359] (10), [-0.22429, 96.457359] (10), [-0.15881, 96.457359] (10), [-0.14271, 96.457359] (10), [-0.13485, 96.457359] (10), [-0.07030, 96.457359] (10), [-0.02822, 96.457359] (10), [-0.01323, 96.457359] (10), [-0.00407, 96.457359] (10), 
length of domains: 16
Total time: 0.2983	 pickout: 0.0024	 decision: 0.0219	 get_bound: 0.2732	 add_domain: 0.0008
Current lb:-0.6733872890472412
108 neurons visited
0 diving domains visited
Cumulative time: 3.8881683349609375

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 81], [2, 81], [2, 81], [2, 81], [1, 415], [2, 81], [1, 1207], [2, 81]]
single_node_split: True
regular batch size: 2*16, diving batch size 1*0
best_l after optimization: 2.116533041000366 with beta sum per layer: [0.0, 1.6430375576019287, 3.626209020614624]
optimal alpha/beta time: 0.26514601707458496
This batch time : update_bounds func: 0.2731	 prepare: 0.0045	 bound: 0.2654	 transfer: 0.0010	 finalize: 0.0021
Accumulated time: update_bounds func: 8.2155	 prepare: 0.0785	 bound: 8.0883	 transfer: 0.0010	 finalize: 0.0258
batch bounding time:  0.27321910858154297
Current worst splitting domains [lb, ub] (depth):
[-0.52060, 96.457359] (11), [-0.42611, 96.457359] (11), [-0.39433, 96.457359] (11), [-0.34512, 96.457359] (11), [-0.34256, 96.457359] (11), [-0.23511, 96.457359] (11), [-0.21085, 96.457359] (11), [-0.19454, 96.457359] (11), [-0.16673, 96.457359] (11), [-0.16643, 96.457359] (11), [-0.10332, 96.457359] (11), [-0.09902, 96.457359] (11), [-0.08693, 96.457359] (11), [-0.08303, 96.457359] (11), [-0.07639, 96.457359] (11), [-0.07619, 96.457359] (11), [-0.05092, 96.457359] (11), [-0.02515, 96.457359] (11), [-0.00640, 96.457359] (11), 
length of domains: 19
Total time: 0.3002	 pickout: 0.0030	 decision: 0.0230	 get_bound: 0.2733	 add_domain: 0.0011
Current lb:-0.5206005573272705
140 neurons visited
0 diving domains visited
Cumulative time: 4.1886773109436035

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 415], [1, 415], [1, 1198], [1, 1198], [1, 415], [1, 1207], [1, 1198], [1, 415], [1, 1207], [1, 415]]
single_node_split: True
regular batch size: 2*19, diving batch size 1*0
best_l after optimization: 1.1972038745880127 with beta sum per layer: [0.0, 2.537724494934082, 4.279266834259033]
optimal alpha/beta time: 0.2659156322479248
This batch time : update_bounds func: 0.2749	 prepare: 0.0048	 bound: 0.2661	 transfer: 0.0014	 finalize: 0.0024
Accumulated time: update_bounds func: 8.4903	 prepare: 0.0834	 bound: 8.3544	 transfer: 0.0014	 finalize: 0.0282
batch bounding time:  0.2749824523925781
Current worst splitting domains [lb, ub] (depth):
[-0.43362, 96.457359] (12), [-0.36103, 96.457359] (12), [-0.31452, 96.457359] (12), [-0.29104, 96.457359] (12), [-0.23875, 96.457359] (12), [-0.11732, 96.457359] (12), [-0.11533, 96.457359] (12), [-0.10618, 96.457359] (12), [-0.09889, 96.457359] (12), [-0.07661, 96.457359] (12), [-0.07538, 96.457359] (12), [-0.07214, 96.457359] (12), [-0.06809, 96.457359] (12), [-0.05236, 96.457359] (12), [-0.04699, 96.457359] (12), [-0.03726, 96.457359] (12), [-0.02486, 96.457359] (12), [-0.01377, 96.457359] (12), [-0.00319, 96.457359] (12), [-0.00318, 96.457359] (12), 
length of domains: 20
Total time: 0.3023	 pickout: 0.0034	 decision: 0.0224	 get_bound: 0.2751	 add_domain: 0.0015
Current lb:-0.4336240291595459
178 neurons visited
0 diving domains visited
Cumulative time: 4.491338014602661

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1198], [1, 1198], [1, 415], [1, 415], [1, 1198], [1, 1198], [1, 415], [1, 1059], [1, 1198], [1, 415]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: -0.898719310760498 with beta sum per layer: [0.0, 4.764996528625488, 3.7470669746398926]
optimal alpha/beta time: 0.2687094211578369
This batch time : update_bounds func: 0.2786	 prepare: 0.0051	 bound: 0.2690	 transfer: 0.0018	 finalize: 0.0026
Accumulated time: update_bounds func: 8.7689	 prepare: 0.0884	 bound: 8.6234	 transfer: 0.0018	 finalize: 0.0308
batch bounding time:  0.27873754501342773
Current worst splitting domains [lb, ub] (depth):
[-0.37294, 96.457359] (13), [-0.31804, 96.457359] (13), [-0.26329, 96.457359] (13), [-0.24709, 96.457359] (13), [-0.18035, 96.457359] (13), [-0.13273, 96.457359] (13), [-0.07485, 96.457359] (13), [-0.06506, 96.457359] (13), [-0.05108, 96.457359] (13), [-0.01240, 96.457359] (13), [-0.00792, 96.457359] (13), [-0.00727, 96.457359] (13), [-0.00404, 96.457359] (13), 
length of domains: 13
Total time: 0.3059	 pickout: 0.0035	 decision: 0.0227	 get_bound: 0.2788	 add_domain: 0.0009
Current lb:-0.3729374408721924
218 neurons visited
0 diving domains visited
Cumulative time: 4.7976768016815186

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [1, 618], [1, 618], [2, 79], [2, 79], [2, 79], [2, 79], [1, 618], [2, 79]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: -0.17555773258209229 with beta sum per layer: [0.0, 3.4329771995544434, 1.617438554763794]
optimal alpha/beta time: 0.265228271484375
This batch time : update_bounds func: 0.2726	 prepare: 0.0040	 bound: 0.2655	 transfer: 0.0013	 finalize: 0.0017
Accumulated time: update_bounds func: 9.0415	 prepare: 0.0925	 bound: 8.8889	 transfer: 0.0013	 finalize: 0.0325
batch bounding time:  0.27266454696655273
Current worst splitting domains [lb, ub] (depth):
[-0.25977, 96.457359] (14), [-0.20668, 96.457359] (14), [-0.19772, 96.457359] (14), [-0.17450, 96.457359] (14), [-0.17420, 96.457359] (14), [-0.11285, 96.457359] (14), [-0.06067, 96.457359] (14), [-0.02052, 96.457359] (14), 
length of domains: 8
Total time: 0.2974	 pickout: 0.0026	 decision: 0.0215	 get_bound: 0.2727	 add_domain: 0.0006
Current lb:-0.25977277755737305
244 neurons visited
0 diving domains visited
Cumulative time: 5.09537672996521

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1059], [1, 1059], [2, 79], [1, 914], [1, 905], [1, 1207], [1, 1059], [1, 1059]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 0.223280668258667 with beta sum per layer: [0.0, 0.7559801936149597, 0.8635427355766296]
optimal alpha/beta time: 0.2651197910308838
This batch time : update_bounds func: 0.2707	 prepare: 0.0033	 bound: 0.2653	 transfer: 0.0008	 finalize: 0.0012
Accumulated time: update_bounds func: 9.3122	 prepare: 0.0957	 bound: 9.1542	 transfer: 0.0008	 finalize: 0.0337
batch bounding time:  0.2707846164703369
Current worst splitting domains [lb, ub] (depth):
[-0.20907, 96.457359] (15), [-0.15492, 96.457359] (15), [-0.11920, 96.457359] (15), [-0.10831, 96.457359] (15), [-0.08922, 96.457359] (15), [-0.02792, 96.457359] (15), [-0.01606, 96.457359] (15), [-0.01131, 96.457359] (15), 
length of domains: 8
Total time: 0.2938	 pickout: 0.0018	 decision: 0.0206	 get_bound: 0.2708	 add_domain: 0.0006
Current lb:-0.20907187461853027
260 neurons visited
0 diving domains visited
Cumulative time: 5.389411449432373

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1207], [1, 1207], [2, 79], [1, 1207], [1, 914], [1, 277], [1, 1207], [1, 1207]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: -0.12672960758209229 with beta sum per layer: [0.0, 0.5318672060966492, 0.9895719289779663]
optimal alpha/beta time: 0.2613058090209961
This batch time : update_bounds func: 0.2665	 prepare: 0.0030	 bound: 0.2615	 transfer: 0.0007	 finalize: 0.0011
Accumulated time: update_bounds func: 9.5787	 prepare: 0.0988	 bound: 9.4157	 transfer: 0.0007	 finalize: 0.0348
batch bounding time:  0.2665984630584717
Current worst splitting domains [lb, ub] (depth):
[-0.14762, 96.457359] (16), [-0.09335, 96.457359] (16), [-0.05145, 96.457359] (16), [-0.03762, 96.457359] (16), [-0.02240, 96.457359] (16), [-0.01412, 96.457359] (16), 
length of domains: 6
Total time: 0.2896	 pickout: 0.0018	 decision: 0.0207	 get_bound: 0.2666	 add_domain: 0.0005
Current lb:-0.14761567115783691
276 neurons visited
0 diving domains visited
Cumulative time: 5.679214954376221

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 914], [1, 914], [1, 914], [1, 1059], [1, 1059], [1, 1207]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -0.5730412006378174 with beta sum per layer: [0.0, 0.0, 0.7004589438438416]
optimal alpha/beta time: 0.258697509765625
This batch time : update_bounds func: 0.2631	 prepare: 0.0026	 bound: 0.2589	 transfer: 0.0007	 finalize: 0.0008
Accumulated time: update_bounds func: 9.8417	 prepare: 0.1014	 bound: 9.6747	 transfer: 0.0007	 finalize: 0.0356
batch bounding time:  0.2631490230560303
Current worst splitting domains [lb, ub] (depth):
[-0.09190, 96.457359] (17), [-0.03779, 96.457359] (17), 
length of domains: 2
Total time: 0.2850	 pickout: 0.0015	 decision: 0.0201	 get_bound: 0.2632	 add_domain: 0.0002
Current lb:-0.09190130233764648
288 neurons visited
0 diving domains visited
Cumulative time: 5.964371919631958

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 618], [1, 618]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.1542491912841797 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.255307674407959
This batch time : update_bounds func: 0.2584	 prepare: 0.0019	 bound: 0.2555	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 10.1001	 prepare: 0.1032	 bound: 9.9302	 transfer: 0.0005	 finalize: 0.0360
batch bounding time:  0.2584500312805176
Current worst splitting domains [lb, ub] (depth):
[-0.02715, 96.457359] (18), 
length of domains: 1
Total time: 0.2792	 pickout: 0.0009	 decision: 0.0197	 get_bound: 0.2585	 add_domain: 0.0001
Current lb:-0.02715277671813965
292 neurons visited
0 diving domains visited
Cumulative time: 6.243656396865845

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 277]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.11221325397491455 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008925676345825195
This batch time : update_bounds func: 0.0116	 prepare: 0.0017	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 10.1117	 prepare: 0.1049	 bound: 9.9394	 transfer: 0.0005	 finalize: 0.0362
batch bounding time:  0.011611223220825195
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0320	 pickout: 0.0008	 decision: 0.0196	 get_bound: 0.0116	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 6.275747776031494

Image 2 pidx 8 verify end, final lower bound 999, upper bound 96.45735931396484, time: 6.334305763244629
2 999
##### [0:2] Tested against 5 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.7250211238861084 with beta sum per layer: []
optimal alpha/beta time: 1.0862410068511963
alpha-CROWN with fixed intermediate bounds: tensor([[-3.7250]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.7250211238861084
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 5.704807281494141 with beta sum per layer: [0.0, 0.0, 0.037107523530721664]
optimal alpha/beta time: 0.2568790912628174
This batch time : update_bounds func: 0.2594	 prepare: 0.0015	 bound: 0.2571	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 10.3711	 prepare: 0.1064	 bound: 10.1965	 transfer: 0.0005	 finalize: 0.0365
batch bounding time:  0.25952887535095215
Current worst splitting domains [lb, ub] (depth):
[-3.41211, 95.274979] (1), [-2.29270, 95.274979] (1), 
length of domains: 2
Total time: 0.2798	 pickout: 0.0008	 decision: 0.0194	 get_bound: 0.2595	 add_domain: 0.0001
Current lb:-3.412111520767212
2 neurons visited
0 diving domains visited
Cumulative time: 1.3823597431182861

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 6.539678573608398 with beta sum per layer: [0.0, 0.0, 1.5361151695251465]
optimal alpha/beta time: 0.25772786140441895
This batch time : update_bounds func: 0.2606	 prepare: 0.0017	 bound: 0.2579	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 10.6317	 prepare: 0.1082	 bound: 10.4544	 transfer: 0.0005	 finalize: 0.0369
batch bounding time:  0.2606816291809082
Current worst splitting domains [lb, ub] (depth):
[-3.24988, 95.274979] (2), [-2.02681, 95.274979] (2), [-0.95127, 95.274979] (2), [-0.31172, 95.274979] (2), 
length of domains: 4
Total time: 0.2812	 pickout: 0.0009	 decision: 0.0194	 get_bound: 0.2607	 add_domain: 0.0002
Current lb:-3.249875545501709
6 neurons visited
0 diving domains visited
Cumulative time: 1.6636536121368408

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 7.321883201599121 with beta sum per layer: [0.0, 0.0, 3.939302921295166]
optimal alpha/beta time: 0.25968098640441895
This batch time : update_bounds func: 0.2632	 prepare: 0.0021	 bound: 0.2599	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 10.8949	 prepare: 0.1102	 bound: 10.7143	 transfer: 0.0006	 finalize: 0.0375
batch bounding time:  0.26325178146362305
Current worst splitting domains [lb, ub] (depth):
[-2.89239, 95.274979] (3), [-2.04880, 95.274979] (3), [-1.61685, 95.274979] (3), [-0.86007, 95.274979] (3), [-0.35929, 95.274979] (3), [-0.05941, 95.274979] (3), 
length of domains: 6
Total time: 0.2844	 pickout: 0.0012	 decision: 0.0198	 get_bound: 0.2633	 add_domain: 0.0003
Current lb:-2.892394542694092
14 neurons visited
0 diving domains visited
Cumulative time: 1.9481885433197021

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1194], [2, 81], [1, 1194], [2, 85], [1, 1194], [2, 81]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 10.032051086425781 with beta sum per layer: [0.0, 0.0, 5.533442497253418]
optimal alpha/beta time: 0.26392507553100586
This batch time : update_bounds func: 0.2683	 prepare: 0.0026	 bound: 0.2642	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 11.1632	 prepare: 0.1128	 bound: 10.9785	 transfer: 0.0006	 finalize: 0.0383
batch bounding time:  0.26837897300720215
Current worst splitting domains [lb, ub] (depth):
[-2.49482, 95.274979] (4), [-2.27084, 95.274979] (4), [-1.61397, 95.274979] (4), [-1.51154, 95.274979] (4), [-1.18436, 95.274979] (4), [-1.10007, 95.274979] (4), [-0.58089, 95.274979] (4), [-0.10266, 95.274979] (4), 
length of domains: 8
Total time: 0.2907	 pickout: 0.0014	 decision: 0.0206	 get_bound: 0.2684	 add_domain: 0.0003
Current lb:-2.4948158264160156
26 neurons visited
0 diving domains visited
Cumulative time: 2.2390525341033936

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [1, 1194], [1, 1194], [2, 81], [2, 85], [2, 81], [2, 81]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 14.602986335754395 with beta sum per layer: [0.0, 0.0, 5.003713130950928]
optimal alpha/beta time: 0.2635526657104492
This batch time : update_bounds func: 0.2687	 prepare: 0.0030	 bound: 0.2638	 transfer: 0.0007	 finalize: 0.0012
Accumulated time: update_bounds func: 11.4319	 prepare: 0.1158	 bound: 11.2422	 transfer: 0.0007	 finalize: 0.0395
batch bounding time:  0.268841028213501
Current worst splitting domains [lb, ub] (depth):
[-2.11502, 95.274979] (5), [-1.90776, 95.274979] (5), [-1.88968, 95.274979] (5), [-1.68799, 95.274979] (5), [-1.36147, 95.274979] (5), [-1.25019, 95.274979] (5), [-1.24225, 95.274979] (5), [-1.09271, 95.274979] (5), [-0.83554, 95.274979] (5), [-0.69835, 95.274979] (5), [-0.61008, 95.274979] (5), [-0.29106, 95.274979] (5), [-0.17462, 95.274979] (5), [-0.01597, 95.274979] (5), 
length of domains: 14
Total time: 0.2921	 pickout: 0.0017	 decision: 0.0209	 get_bound: 0.2689	 add_domain: 0.0006
Current lb:-2.115023612976074
42 neurons visited
0 diving domains visited
Cumulative time: 2.5312931537628174

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [1, 430], [2, 85], [2, 81], [2, 85]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: 18.772064208984375 with beta sum per layer: [0.0, 0.5185841917991638, 9.444355010986328]
optimal alpha/beta time: 0.2655651569366455
This batch time : update_bounds func: 0.2728	 prepare: 0.0042	 bound: 0.2658	 transfer: 0.0009	 finalize: 0.0018
Accumulated time: update_bounds func: 11.7047	 prepare: 0.1200	 bound: 11.5080	 transfer: 0.0009	 finalize: 0.0413
batch bounding time:  0.27286744117736816
Current worst splitting domains [lb, ub] (depth):
[-1.87148, 95.274979] (6), [-1.66121, 95.274979] (6), [-1.64590, 95.274979] (6), [-1.52531, 95.274979] (6), [-1.44316, 95.274979] (6), [-1.37086, 95.274979] (6), [-1.27804, 95.274979] (6), [-1.19703, 95.274979] (6), [-1.12904, 95.274979] (6), [-1.07022, 95.274979] (6), [-1.06418, 95.274979] (6), [-0.85650, 95.274979] (6), [-0.70643, 95.274979] (6), [-0.61444, 95.274979] (6), [-0.58681, 95.274979] (6), [-0.42015, 95.274979] (6), [-0.41174, 95.274979] (6), [-0.36133, 95.274979] (6), [-0.33164, 95.274979] (6), [-0.30526, 95.274979] (6), 
length of domains: 20
Total time: 0.2992	 pickout: 0.0026	 decision: 0.0229	 get_bound: 0.2729	 add_domain: 0.0008
Current lb:-1.8714842796325684
70 neurons visited
0 diving domains visited
Cumulative time: 2.83072566986084

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [1, 410], [1, 410], [1, 430], [1, 410], [1, 430], [1, 430], [2, 85], [1, 430], [2, 85]]
single_node_split: True
regular batch size: 2*20, diving batch size 1*0
best_l after optimization: 22.986642837524414 with beta sum per layer: [0.0, 1.4462192058563232, 13.622160911560059]
optimal alpha/beta time: 0.26799988746643066
This batch time : update_bounds func: 0.2772	 prepare: 0.0052	 bound: 0.2682	 transfer: 0.0012	 finalize: 0.0025
Accumulated time: update_bounds func: 11.9819	 prepare: 0.1253	 bound: 11.7763	 transfer: 0.0012	 finalize: 0.0438
batch bounding time:  0.277357816696167
Current worst splitting domains [lb, ub] (depth):
[-1.74984, 95.274979] (7), [-1.42399, 95.274979] (7), [-1.29326, 95.274979] (7), [-1.24790, 95.274979] (7), [-1.24789, 95.274979] (7), [-1.24385, 95.274979] (7), [-1.19348, 95.274979] (7), [-1.18422, 95.274979] (7), [-1.04867, 95.274979] (7), [-1.03014, 95.274979] (7), [-0.98462, 95.274979] (7), [-0.97412, 95.274979] (7), [-0.94037, 95.274979] (7), [-0.89913, 95.274979] (7), [-0.83878, 95.274979] (7), [-0.82845, 95.274979] (7), [-0.81772, 95.274979] (7), [-0.67640, 95.274979] (7), [-0.63687, 95.274979] (7), [-0.55129, 95.274979] (7), 
length of domains: 30
Total time: 0.3054	 pickout: 0.0035	 decision: 0.0231	 get_bound: 0.2774	 add_domain: 0.0014
Current lb:-1.7498359680175781
110 neurons visited
0 diving domains visited
Cumulative time: 3.1364505290985107

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 410], [1, 410], [2, 41], [1, 430], [1, 430], [2, 41], [1, 430], [2, 41], [1, 430], [2, 41]]
single_node_split: True
regular batch size: 2*30, diving batch size 1*0
best_l after optimization: 25.465221405029297 with beta sum per layer: [0.0, 2.409884452819824, 18.987754821777344]
optimal alpha/beta time: 0.26711463928222656
This batch time : update_bounds func: 0.2801	 prepare: 0.0071	 bound: 0.2673	 transfer: 0.0018	 finalize: 0.0037
Accumulated time: update_bounds func: 12.2620	 prepare: 0.1324	 bound: 12.0436	 transfer: 0.0018	 finalize: 0.0475
batch bounding time:  0.2802553176879883
Current worst splitting domains [lb, ub] (depth):
[-1.37384, 95.274979] (8), [-1.33217, 95.274979] (8), [-1.13002, 95.274979] (8), [-1.12324, 95.274979] (8), [-1.05711, 95.274979] (8), [-1.01444, 95.274979] (8), [-0.97313, 95.274979] (8), [-0.95745, 95.274979] (8), [-0.93817, 95.274979] (8), [-0.92615, 95.274979] (8), [-0.86346, 95.274979] (8), [-0.84174, 95.274979] (8), [-0.81362, 95.274979] (8), [-0.80017, 95.274979] (8), [-0.79231, 95.274979] (8), [-0.77889, 95.274979] (8), [-0.77645, 95.274979] (8), [-0.70872, 95.274979] (8), [-0.67628, 95.274979] (8), [-0.67348, 95.274979] (8), 
length of domains: 45
Total time: 0.3117	 pickout: 0.0050	 decision: 0.0243	 get_bound: 0.2804	 add_domain: 0.0021
Current lb:-1.373835563659668
170 neurons visited
0 diving domains visited
Cumulative time: 3.4485268592834473

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 67], [2, 41], [2, 41], [2, 41], [2, 41], [2, 67], [2, 67], [1, 410]]
single_node_split: True
regular batch size: 2*45, diving batch size 1*0
best_l after optimization: 15.693802833557129 with beta sum per layer: [0.0, 4.341312885284424, 28.976472854614258]
optimal alpha/beta time: 0.2688744068145752
This batch time : update_bounds func: 0.2871	 prepare: 0.0097	 bound: 0.2691	 transfer: 0.0027	 finalize: 0.0054
Accumulated time: update_bounds func: 12.5492	 prepare: 0.1421	 bound: 12.3127	 transfer: 0.0027	 finalize: 0.0528
batch bounding time:  0.28727173805236816
Current worst splitting domains [lb, ub] (depth):
[-1.05983, 95.274979] (9), [-1.04059, 95.274979] (9), [-0.99899, 95.274979] (9), [-0.92046, 95.274979] (9), [-0.86095, 95.274979] (9), [-0.83944, 95.274979] (9), [-0.83297, 95.274979] (9), [-0.80640, 95.274979] (9), [-0.75744, 95.274979] (9), [-0.72389, 95.274979] (9), [-0.67122, 95.274979] (9), [-0.67110, 95.274979] (9), [-0.65277, 95.274979] (9), [-0.64966, 95.274979] (9), [-0.62626, 95.274979] (9), [-0.62221, 95.274979] (9), [-0.59393, 95.274979] (9), [-0.59020, 95.274979] (9), [-0.57888, 95.274979] (9), [-0.52345, 95.274979] (9), 
length of domains: 52
Total time: 0.3228	 pickout: 0.0071	 decision: 0.0258	 get_bound: 0.2874	 add_domain: 0.0026
Current lb:-1.0598349571228027
260 neurons visited
0 diving domains visited
Cumulative time: 3.771998643875122

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 47], [2, 67], [2, 67], [2, 67], [2, 47], [2, 41], [2, 67], [2, 41]]
single_node_split: True
regular batch size: 2*52, diving batch size 1*0
best_l after optimization: 2.6046764850616455 with beta sum per layer: [0.0, 3.2729649543762207, 27.406017303466797]
optimal alpha/beta time: 0.2718825340270996
This batch time : update_bounds func: 0.2922	 prepare: 0.0109	 bound: 0.2721	 transfer: 0.0028	 finalize: 0.0061
Accumulated time: update_bounds func: 12.8413	 prepare: 0.1529	 bound: 12.5848	 transfer: 0.0028	 finalize: 0.0589
batch bounding time:  0.292316198348999
Current worst splitting domains [lb, ub] (depth):
[-0.89404, 95.274979] (10), [-0.88019, 95.274979] (10), [-0.86756, 95.274979] (10), [-0.70240, 95.274979] (10), [-0.70064, 95.274979] (10), [-0.67405, 95.274979] (10), [-0.62445, 95.274979] (10), [-0.58798, 95.274979] (10), [-0.54318, 95.274979] (10), [-0.53333, 95.274979] (10), [-0.51547, 95.274979] (10), [-0.48577, 95.274979] (10), [-0.48156, 95.274979] (10), [-0.47249, 95.274979] (10), [-0.46622, 95.274979] (10), [-0.41759, 95.274979] (10), [-0.40506, 95.274979] (10), [-0.39045, 95.274979] (10), [-0.36340, 95.274979] (10), [-0.33708, 95.274979] (10), 
length of domains: 45
Total time: 0.3317	 pickout: 0.0081	 decision: 0.0288	 get_bound: 0.2925	 add_domain: 0.0023
Current lb:-0.8940424919128418
364 neurons visited
0 diving domains visited
Cumulative time: 4.104473114013672

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47], [2, 41], [2, 47], [2, 45], [2, 47], [2, 47], [2, 47], [2, 45], [2, 45]]
single_node_split: True
regular batch size: 2*45, diving batch size 1*0
best_l after optimization: -3.3362932205200195 with beta sum per layer: [0.0, 2.773597002029419, 19.015094757080078]
optimal alpha/beta time: 0.2679901123046875
This batch time : update_bounds func: 0.2854	 prepare: 0.0096	 bound: 0.2682	 transfer: 0.0018	 finalize: 0.0055
Accumulated time: update_bounds func: 13.1267	 prepare: 0.1626	 bound: 12.8531	 transfer: 0.0018	 finalize: 0.0644
batch bounding time:  0.28554773330688477
Current worst splitting domains [lb, ub] (depth):
[-0.76857, 95.274979] (11), [-0.75368, 95.274979] (11), [-0.60269, 95.274979] (11), [-0.57433, 95.274979] (11), [-0.57368, 95.274979] (11), [-0.55135, 95.274979] (11), [-0.48868, 95.274979] (11), [-0.45463, 95.274979] (11), [-0.45395, 95.274979] (11), [-0.44464, 95.274979] (11), [-0.44348, 95.274979] (11), [-0.39766, 95.274979] (11), [-0.35859, 95.274979] (11), [-0.33955, 95.274979] (11), [-0.32120, 95.274979] (11), [-0.29679, 95.274979] (11), [-0.28371, 95.274979] (11), [-0.20396, 95.274979] (11), [-0.20203, 95.274979] (11), [-0.19858, 95.274979] (11), 
length of domains: 39
Total time: 0.3203	 pickout: 0.0071	 decision: 0.0254	 get_bound: 0.2857	 add_domain: 0.0021
Current lb:-0.7685661315917969
454 neurons visited
0 diving domains visited
Cumulative time: 4.42545485496521

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 45], [1, 430], [2, 45], [2, 45], [2, 45], [2, 78], [2, 45], [1, 410], [2, 45]]
single_node_split: True
regular batch size: 2*39, diving batch size 1*0
best_l after optimization: -12.700183868408203 with beta sum per layer: [0.0, 2.233444929122925, 12.086213111877441]
optimal alpha/beta time: 0.26831722259521484
This batch time : update_bounds func: 0.2833	 prepare: 0.0086	 bound: 0.2686	 transfer: 0.0015	 finalize: 0.0046
Accumulated time: update_bounds func: 13.4100	 prepare: 0.1711	 bound: 13.1216	 transfer: 0.0015	 finalize: 0.0690
batch bounding time:  0.28345346450805664
Current worst splitting domains [lb, ub] (depth):
[-0.66236, 95.274979] (12), [-0.63920, 95.274979] (12), [-0.50133, 95.274979] (12), [-0.47943, 95.274979] (12), [-0.45132, 95.274979] (12), [-0.44093, 95.274979] (12), [-0.34510, 95.274979] (12), [-0.31045, 95.274979] (12), [-0.30105, 95.274979] (12), [-0.25811, 95.274979] (12), [-0.24801, 95.274979] (12), [-0.21815, 95.274979] (12), [-0.20275, 95.274979] (12), [-0.19975, 95.274979] (12), [-0.19840, 95.274979] (12), [-0.15883, 95.274979] (12), [-0.14920, 95.274979] (12), [-0.11742, 95.274979] (12), [-0.11545, 95.274979] (12), [-0.10590, 95.274979] (12), 
length of domains: 33
Total time: 0.3170	 pickout: 0.0063	 decision: 0.0253	 get_bound: 0.2836	 add_domain: 0.0018
Current lb:-0.6623592376708984
532 neurons visited
0 diving domains visited
Cumulative time: 4.743062257766724

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 78], [2, 45]]
single_node_split: True
regular batch size: 2*33, diving batch size 1*0
best_l after optimization: -3.1536686420440674 with beta sum per layer: [0.0, 1.5069713592529297, 8.837939262390137]
optimal alpha/beta time: 0.26950526237487793
This batch time : update_bounds func: 0.2831	 prepare: 0.0077	 bound: 0.2698	 transfer: 0.0013	 finalize: 0.0041
Accumulated time: update_bounds func: 13.6931	 prepare: 0.1788	 bound: 13.3914	 transfer: 0.0013	 finalize: 0.0731
batch bounding time:  0.2832143306732178
Current worst splitting domains [lb, ub] (depth):
[-0.44128, 95.274979] (13), [-0.41759, 95.274979] (13), [-0.39609, 95.274979] (13), [-0.37040, 95.274979] (13), [-0.30781, 95.274979] (13), [-0.27783, 95.274979] (13), [-0.23792, 95.274979] (13), [-0.23293, 95.274979] (13), [-0.21603, 95.274979] (13), [-0.18424, 95.274979] (13), [-0.18064, 95.274979] (13), [-0.13950, 95.274979] (13), [-0.12827, 95.274979] (13), [-0.12497, 95.274979] (13), [-0.12296, 95.274979] (13), [-0.11690, 95.274979] (13), [-0.11408, 95.274979] (13), [-0.08496, 95.274979] (13), [-0.06838, 95.274979] (13), [-0.01493, 95.274979] (13), 
length of domains: 22
Total time: 0.3144	 pickout: 0.0054	 decision: 0.0242	 get_bound: 0.2833	 add_domain: 0.0014
Current lb:-0.44127941131591797
598 neurons visited
0 diving domains visited
Cumulative time: 5.058006763458252

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414], [1, 414], [1, 414], [1, 414], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 414]]
single_node_split: True
regular batch size: 2*22, diving batch size 1*0
best_l after optimization: -0.11128020286560059 with beta sum per layer: [0.0, 0.3796822130680084, 3.191175937652588]
optimal alpha/beta time: 0.26331186294555664
This batch time : update_bounds func: 0.2730	 prepare: 0.0055	 bound: 0.2636	 transfer: 0.0010	 finalize: 0.0027
Accumulated time: update_bounds func: 13.9661	 prepare: 0.1843	 bound: 13.6550	 transfer: 0.0010	 finalize: 0.0758
batch bounding time:  0.2730729579925537
Current worst splitting domains [lb, ub] (depth):
[-0.29211, 95.274979] (14), [-0.26697, 95.274979] (14), [-0.25551, 95.274979] (14), [-0.24030, 95.274979] (14), [-0.23739, 95.274979] (14), [-0.22376, 95.274979] (14), [-0.14680, 95.274979] (14), [-0.12559, 95.274979] (14), [-0.11496, 95.274979] (14), [-0.08392, 95.274979] (14), [-0.07367, 95.274979] (14), [-0.06773, 95.274979] (14), [-0.05979, 95.274979] (14), [-0.05312, 95.274979] (14), [-0.02443, 95.274979] (14), [-0.02029, 95.274979] (14), [-0.01990, 95.274979] (14), [-0.01441, 95.274979] (14), 
length of domains: 18
Total time: 0.3004	 pickout: 0.0038	 decision: 0.0224	 get_bound: 0.2731	 add_domain: 0.0011
Current lb:-0.2921113967895508
642 neurons visited
0 diving domains visited
Cumulative time: 5.35880708694458

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 263], [1, 1207], [1, 269], [1, 1195], [1, 1195]]
single_node_split: True
regular batch size: 2*18, diving batch size 1*0
best_l after optimization: -2.648921012878418 with beta sum per layer: [0.0, 0.2546451687812805, 1.5020835399627686]
optimal alpha/beta time: 0.26588892936706543
This batch time : update_bounds func: 0.2741	 prepare: 0.0047	 bound: 0.2661	 transfer: 0.0009	 finalize: 0.0022
Accumulated time: update_bounds func: 14.2402	 prepare: 0.1890	 bound: 13.9211	 transfer: 0.0009	 finalize: 0.0780
batch bounding time:  0.2742154598236084
Current worst splitting domains [lb, ub] (depth):
[-0.10139, 95.274979] (15), [-0.10015, 95.274979] (15), [-0.09123, 95.274979] (15), [-0.08081, 95.274979] (15), [-0.07734, 95.274979] (15), [-0.07592, 95.274979] (15), [-0.06827, 95.274979] (15), [-0.06270, 95.274979] (15), [-0.05787, 95.274979] (15), [-0.05399, 95.274979] (15), [-0.05195, 95.274979] (15), [-0.04971, 95.274979] (15), [-0.04396, 95.274979] (15), [-0.04181, 95.274979] (15), [-0.03936, 95.274979] (15), [-0.03604, 95.274979] (15), [-0.02718, 95.274979] (15), [-0.01922, 95.274979] (15), 
length of domains: 18
Total time: 0.3005	 pickout: 0.0032	 decision: 0.0218	 get_bound: 0.2743	 add_domain: 0.0012
Current lb:-0.10138797760009766
678 neurons visited
0 diving domains visited
Cumulative time: 5.659593105316162

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 1195], [1, 269], [1, 1195], [1, 1195], [1, 1195], [1, 1195]]
single_node_split: True
regular batch size: 2*18, diving batch size 1*0
best_l after optimization: -7.048889636993408 with beta sum per layer: [0.0, 0.11645247787237167, 0.6910423040390015]
optimal alpha/beta time: 0.2605583667755127
This batch time : update_bounds func: 0.2688	 prepare: 0.0047	 bound: 0.2608	 transfer: 0.0009	 finalize: 0.0022
Accumulated time: update_bounds func: 14.5090	 prepare: 0.1938	 bound: 14.1819	 transfer: 0.0009	 finalize: 0.0803
batch bounding time:  0.26891660690307617
Current worst splitting domains [lb, ub] (depth):
[-0.07286, 95.274979] (16), [-0.07085, 95.274979] (16), [-0.05840, 95.274979] (16), [-0.05400, 95.274979] (16), [-0.05040, 95.274979] (16), [-0.03241, 95.274979] (16), [-0.03237, 95.274979] (16), [-0.03008, 95.274979] (16), [-0.02471, 95.274979] (16), [-0.02414, 95.274979] (16), [-0.01321, 95.274979] (16), [-0.00833, 95.274979] (16), [-0.00635, 95.274979] (16), 
length of domains: 13
Total time: 0.2948	 pickout: 0.0032	 decision: 0.0217	 get_bound: 0.2690	 add_domain: 0.0009
Current lb:-0.0728597640991211
714 neurons visited
0 diving domains visited
Cumulative time: 5.954692602157593

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 711], [1, 711], [1, 269], [2, 22], [2, 22], [2, 22], [1, 269], [1, 269], [1, 711], [1, 711]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0

all verified at 3th iter
best_l after optimization: -2.7258920669555664 with beta sum per layer: [0.0, 0.10988456010818481, 0.16752727329730988]
optimal alpha/beta time: 0.043801069259643555
This batch time : update_bounds func: 0.0507	 prepare: 0.0040	 bound: 0.0440	 transfer: 0.0008	 finalize: 0.0017
Accumulated time: update_bounds func: 14.5596	 prepare: 0.1978	 bound: 14.2259	 transfer: 0.0008	 finalize: 0.0820
batch bounding time:  0.050775766372680664
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0746	 pickout: 0.0025	 decision: 0.0212	 get_bound: 0.0508	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 6.029609203338623

Image 2 pidx 5 verify end, final lower bound 999, upper bound 95.27497863769531, time: 6.087777853012085
2 999
##### [0:2] Tested against 3 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.660759449005127 with beta sum per layer: []
optimal alpha/beta time: 1.0276966094970703
alpha-CROWN with fixed intermediate bounds: tensor([[-2.6608]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.660759449005127
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 3.0408859252929688 with beta sum per layer: [0.0, 0.0, 0.7082006335258484]
optimal alpha/beta time: 0.2587597370147705
This batch time : update_bounds func: 0.2613	 prepare: 0.0015	 bound: 0.2590	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 14.8210	 prepare: 0.1993	 bound: 14.4849	 transfer: 0.0005	 finalize: 0.0822
batch bounding time:  0.26152467727661133
Current worst splitting domains [lb, ub] (depth):
[-2.48005, 96.339241] (1), [-0.56083, 96.339241] (1), 
length of domains: 2
Total time: 0.2815	 pickout: 0.0007	 decision: 0.0191	 get_bound: 0.2615	 add_domain: 0.0001
Current lb:-2.4800543785095215
2 neurons visited
0 diving domains visited
Cumulative time: 1.3254194259643555

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 3.7497141361236572 with beta sum per layer: [0.0, 0.0, 1.9492902755737305]
optimal alpha/beta time: 0.25728869438171387
This batch time : update_bounds func: 0.2603	 prepare: 0.0017	 bound: 0.2575	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 15.0813	 prepare: 0.2011	 bound: 14.7424	 transfer: 0.0006	 finalize: 0.0826
batch bounding time:  0.2603445053100586
Current worst splitting domains [lb, ub] (depth):
[-2.19139, 96.339241] (2), [-1.54902, 96.339241] (2), [-0.04558, 96.339241] (2), 
length of domains: 3
Total time: 0.2807	 pickout: 0.0009	 decision: 0.0193	 get_bound: 0.2604	 add_domain: 0.0001
Current lb:-2.191389560699463
6 neurons visited
0 diving domains visited
Cumulative time: 1.606234073638916

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: 4.343841552734375 with beta sum per layer: [0.0, 0.0, 2.913428783416748]
optimal alpha/beta time: 0.2610025405883789
This batch time : update_bounds func: 0.2643	 prepare: 0.0019	 bound: 0.2612	 transfer: 0.0006	 finalize: 0.0005
Accumulated time: update_bounds func: 15.3456	 prepare: 0.2030	 bound: 15.0037	 transfer: 0.0006	 finalize: 0.0831
batch bounding time:  0.2644383907318115
Current worst splitting domains [lb, ub] (depth):
[-1.88233, 96.339241] (3), [-1.29197, 96.339241] (3), [-1.19106, 96.339241] (3), [-0.78832, 96.339241] (3), 
length of domains: 4
Total time: 0.2852	 pickout: 0.0010	 decision: 0.0195	 get_bound: 0.2645	 add_domain: 0.0002
Current lb:-1.8823268413543701
12 neurons visited
0 diving domains visited
Cumulative time: 1.8915576934814453

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 78], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 4.681314468383789 with beta sum per layer: [0.0, 0.0, 3.7551023960113525]
optimal alpha/beta time: 0.2593669891357422
This batch time : update_bounds func: 0.2631	 prepare: 0.0021	 bound: 0.2596	 transfer: 0.0006	 finalize: 0.0007
Accumulated time: update_bounds func: 15.6087	 prepare: 0.2050	 bound: 15.2632	 transfer: 0.0006	 finalize: 0.0839
batch bounding time:  0.2631802558898926
Current worst splitting domains [lb, ub] (depth):
[-1.70985, 96.339241] (4), [-0.99501, 96.339241] (4), [-0.82147, 96.339241] (4), [-0.62707, 96.339241] (4), [-0.58996, 96.339241] (4), [-0.40645, 96.339241] (4), 
length of domains: 6
Total time: 0.2844	 pickout: 0.0012	 decision: 0.0197	 get_bound: 0.2632	 add_domain: 0.0003
Current lb:-1.7098500728607178
20 neurons visited
0 diving domains visited
Cumulative time: 2.176074266433716

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 78], [2, 78], [2, 22], [2, 41], [2, 78], [2, 78]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 4.132386207580566 with beta sum per layer: [0.0, 0.0, 4.903109073638916]
optimal alpha/beta time: 0.2590978145599365
This batch time : update_bounds func: 0.2633	 prepare: 0.0024	 bound: 0.2593	 transfer: 0.0008	 finalize: 0.0008
Accumulated time: update_bounds func: 15.8720	 prepare: 0.2074	 bound: 15.5226	 transfer: 0.0008	 finalize: 0.0847
batch bounding time:  0.26343560218811035
Current worst splitting domains [lb, ub] (depth):
[-1.30425, 96.339241] (5), [-1.13022, 96.339241] (5), [-0.65296, 96.339241] (5), [-0.63764, 96.339241] (5), [-0.23986, 96.339241] (5), [-0.22903, 96.339241] (5), [-0.17074, 96.339241] (5), [-0.10251, 96.339241] (5), 
length of domains: 8
Total time: 0.2856	 pickout: 0.0014	 decision: 0.0203	 get_bound: 0.2635	 add_domain: 0.0004
Current lb:-1.3042521476745605
32 neurons visited
0 diving domains visited
Cumulative time: 2.4617927074432373

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 41], [2, 41], [1, 905], [2, 41], [2, 41], [1, 415]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 1.8677186965942383 with beta sum per layer: [0.0, 0.0, 5.726227760314941]
optimal alpha/beta time: 0.2633647918701172
This batch time : update_bounds func: 0.2686	 prepare: 0.0029	 bound: 0.2636	 transfer: 0.0009	 finalize: 0.0011
Accumulated time: update_bounds func: 16.1406	 prepare: 0.2104	 bound: 15.7862	 transfer: 0.0009	 finalize: 0.0857
batch bounding time:  0.2686629295349121
Current worst splitting domains [lb, ub] (depth):
[-0.97891, 96.339241] (6), [-0.80259, 96.339241] (6), [-0.78390, 96.339241] (6), [-0.60441, 96.339241] (6), [-0.31044, 96.339241] (6), [-0.25639, 96.339241] (6), [-0.14762, 96.339241] (6), [-0.08402, 96.339241] (6), 
length of domains: 8
Total time: 0.2915	 pickout: 0.0017	 decision: 0.0207	 get_bound: 0.2687	 add_domain: 0.0004
Current lb:-0.9789094924926758
48 neurons visited
0 diving domains visited
Cumulative time: 2.753476142883301

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430], [2, 85], [1, 414], [2, 85], [2, 85], [1, 905], [1, 415], [2, 85]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 2.216388463973999 with beta sum per layer: [0.0, 0.12880101799964905, 3.9146652221679688]
optimal alpha/beta time: 0.2626461982727051
This batch time : update_bounds func: 0.2679	 prepare: 0.0029	 bound: 0.2629	 transfer: 0.0008	 finalize: 0.0012
Accumulated time: update_bounds func: 16.4085	 prepare: 0.2133	 bound: 16.0490	 transfer: 0.0008	 finalize: 0.0869
batch bounding time:  0.26795434951782227
Current worst splitting domains [lb, ub] (depth):
[-0.85252, 96.339241] (7), [-0.55219, 96.339241] (7), [-0.53917, 96.339241] (7), [-0.50986, 96.339241] (7), [-0.43309, 96.339241] (7), [-0.33286, 96.339241] (7), [-0.26504, 96.339241] (7), [-0.07797, 96.339241] (7), [-0.07529, 96.339241] (7), 
length of domains: 9
Total time: 0.2905	 pickout: 0.0017	 decision: 0.0204	 get_bound: 0.2680	 add_domain: 0.0004
Current lb:-0.8525152206420898
64 neurons visited
0 diving domains visited
Cumulative time: 3.0441787242889404

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [1, 430], [2, 85], [2, 85], [2, 85], [1, 430], [1, 430], [1, 430], [2, 45]]
single_node_split: True
regular batch size: 2*9, diving batch size 1*0
best_l after optimization: 1.120802402496338 with beta sum per layer: [0.0, 0.189435213804245, 2.4125828742980957]
optimal alpha/beta time: 0.2643589973449707
This batch time : update_bounds func: 0.2699	 prepare: 0.0032	 bound: 0.2646	 transfer: 0.0008	 finalize: 0.0013
Accumulated time: update_bounds func: 16.6784	 prepare: 0.2165	 bound: 16.3136	 transfer: 0.0008	 finalize: 0.0882
batch bounding time:  0.26999664306640625
Current worst splitting domains [lb, ub] (depth):
[-0.63428, 96.339241] (8), [-0.42589, 96.339241] (8), [-0.36014, 96.339241] (8), [-0.29520, 96.339241] (8), [-0.28727, 96.339241] (8), [-0.21019, 96.339241] (8), [-0.19003, 96.339241] (8), [-0.13406, 96.339241] (8), [-0.07629, 96.339241] (8), [-0.05164, 96.339241] (8), [-0.00714, 96.339241] (8), 
length of domains: 11
Total time: 0.2934	 pickout: 0.0019	 decision: 0.0209	 get_bound: 0.2700	 add_domain: 0.0005
Current lb:-0.6342825889587402
82 neurons visited
0 diving domains visited
Cumulative time: 3.337730646133423

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 45], [2, 45], [2, 79], [2, 45], [1, 430], [1, 430], [2, 45], [2, 45], [1, 430], [2, 45]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: -4.213314056396484 with beta sum per layer: [0.0, 0.35094165802001953, 1.9800384044647217]
optimal alpha/beta time: 0.26106810569763184
This batch time : update_bounds func: 0.2674	 prepare: 0.0037	 bound: 0.2613	 transfer: 0.0009	 finalize: 0.0015
Accumulated time: update_bounds func: 16.9458	 prepare: 0.2201	 bound: 16.5749	 transfer: 0.0009	 finalize: 0.0897
batch bounding time:  0.26750946044921875
Current worst splitting domains [lb, ub] (depth):
[-0.51964, 96.339241] (9), [-0.29020, 96.339241] (9), [-0.19914, 96.339241] (9), [-0.16646, 96.339241] (9), [-0.11957, 96.339241] (9), [-0.08179, 96.339241] (9), [-0.04271, 96.339241] (9), 
length of domains: 7
Total time: 0.2913	 pickout: 0.0022	 decision: 0.0211	 get_bound: 0.2675	 add_domain: 0.0004
Current lb:-0.519639253616333
104 neurons visited
0 diving domains visited
Cumulative time: 3.6292777061462402

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 45], [2, 79], [2, 45], [2, 45], [2, 79]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: -2.7871768474578857 with beta sum per layer: [0.0, 0.24303436279296875, 1.1773855686187744]
optimal alpha/beta time: 0.2617213726043701
This batch time : update_bounds func: 0.2664	 prepare: 0.0028	 bound: 0.2620	 transfer: 0.0007	 finalize: 0.0009
Accumulated time: update_bounds func: 17.2122	 prepare: 0.2229	 bound: 16.8369	 transfer: 0.0007	 finalize: 0.0906
batch bounding time:  0.26648950576782227
Current worst splitting domains [lb, ub] (depth):
[-0.29348, 96.339241] (10), [-0.13959, 96.339241] (10), [-0.08095, 96.339241] (10), [-0.06820, 96.339241] (10), 
length of domains: 4
Total time: 0.2891	 pickout: 0.0016	 decision: 0.0207	 get_bound: 0.2665	 add_domain: 0.0003
Current lb:-0.29347705841064453
118 neurons visited
0 diving domains visited
Cumulative time: 3.918605089187622

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 75], [2, 75], [2, 75], [2, 79]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: -1.0599360466003418 with beta sum per layer: [0.0, 0.0, 0.34783077239990234]
optimal alpha/beta time: 0.255626916885376
This batch time : update_bounds func: 0.2593	 prepare: 0.0022	 bound: 0.2559	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 17.4715	 prepare: 0.2251	 bound: 17.0927	 transfer: 0.0006	 finalize: 0.0912
batch bounding time:  0.2594029903411865
Current worst splitting domains [lb, ub] (depth):
[-0.19071, 96.339241] (11), [-0.02358, 96.339241] (11), 
length of domains: 2
Total time: 0.2810	 pickout: 0.0012	 decision: 0.0202	 get_bound: 0.2594	 add_domain: 0.0002
Current lb:-0.19071006774902344
126 neurons visited
0 diving domains visited
Cumulative time: 4.19971227645874

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5], [1, 414]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -1.0846903324127197 with beta sum per layer: [0.0, 0.0, 0.12946413457393646]
optimal alpha/beta time: 0.2551689147949219
This batch time : update_bounds func: 0.2584	 prepare: 0.0020	 bound: 0.2554	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 17.7299	 prepare: 0.2271	 bound: 17.3481	 transfer: 0.0006	 finalize: 0.0916
batch bounding time:  0.25849080085754395
Current worst splitting domains [lb, ub] (depth):
[-0.09452, 96.339241] (12), 
length of domains: 1
Total time: 0.2791	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2585	 add_domain: 0.0001
Current lb:-0.09452223777770996
130 neurons visited
0 diving domains visited
Cumulative time: 4.478874444961548

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 414]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.354353666305542 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008939981460571289
This batch time : update_bounds func: 0.0116	 prepare: 0.0017	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 17.7415	 prepare: 0.2288	 bound: 17.3573	 transfer: 0.0005	 finalize: 0.0918
batch bounding time:  0.011672019958496094
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0320	 pickout: 0.0008	 decision: 0.0195	 get_bound: 0.0117	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 4.510976552963257

Image 2 pidx 3 verify end, final lower bound 999, upper bound 96.33924102783203, time: 4.569205045700073
2 999
##### [0:2] Tested against 6 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 3.481382369995117 with beta sum per layer: []
optimal alpha/beta time: 1.0462894439697266
alpha-CROWN with fixed intermediate bounds: tensor([[-3.4814]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-3.481382369995117
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 2.9235892295837402 with beta sum per layer: [0.0, 0.0, 0.6712828874588013]
optimal alpha/beta time: 0.2588813304901123
This batch time : update_bounds func: 0.2614	 prepare: 0.0015	 bound: 0.2591	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 18.0029	 prepare: 0.2303	 bound: 17.6164	 transfer: 0.0005	 finalize: 0.0921
batch bounding time:  0.26146888732910156
Current worst splitting domains [lb, ub] (depth):
[-3.30013, 95.518616] (1), 
length of domains: 1
Total time: 0.2814	 pickout: 0.0007	 decision: 0.0191	 get_bound: 0.2615	 add_domain: 0.0001
Current lb:-3.3001298904418945
2 neurons visited
0 diving domains visited
Cumulative time: 1.343984603881836

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.67624568939209 with beta sum per layer: [0.0, 0.0, 0.03157392516732216]
optimal alpha/beta time: 0.2568840980529785
This batch time : update_bounds func: 0.2595	 prepare: 0.0016	 bound: 0.2571	 transfer: 0.0005	 finalize: 0.0002
Accumulated time: update_bounds func: 18.2623	 prepare: 0.2319	 bound: 17.8735	 transfer: 0.0005	 finalize: 0.0923
batch bounding time:  0.2595512866973877
Current worst splitting domains [lb, ub] (depth):
[-2.57554, 95.518616] (2), [-2.10071, 95.518616] (2), 
length of domains: 2
Total time: 0.2795	 pickout: 0.0007	 decision: 0.0191	 get_bound: 0.2596	 add_domain: 0.0001
Current lb:-2.5755391120910645
4 neurons visited
0 diving domains visited
Cumulative time: 1.6235344409942627

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 410], [2, 41]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 6.950456142425537 with beta sum per layer: [0.0, 0.08768413960933685, 0.168626606464386]
optimal alpha/beta time: 0.2613201141357422
This batch time : update_bounds func: 0.2644	 prepare: 0.0019	 bound: 0.2615	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 18.5268	 prepare: 0.2338	 bound: 18.1350	 transfer: 0.0005	 finalize: 0.0927
batch bounding time:  0.2645084857940674
Current worst splitting domains [lb, ub] (depth):
[-1.98342, 95.518616] (3), [-1.87660, 95.518616] (3), [-1.73853, 95.518616] (3), [-1.35190, 95.518616] (3), 
length of domains: 4
Total time: 0.2852	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2645	 add_domain: 0.0002
Current lb:-1.9834232330322266
8 neurons visited
0 diving domains visited
Cumulative time: 1.9087636470794678

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 8.143202781677246 with beta sum per layer: [0.0, 0.133326917886734, 1.545766830444336]
optimal alpha/beta time: 0.2634880542755127
This batch time : update_bounds func: 0.2671	 prepare: 0.0022	 bound: 0.2637	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 18.7939	 prepare: 0.2360	 bound: 18.3987	 transfer: 0.0006	 finalize: 0.0933
batch bounding time:  0.26723146438598633
Current worst splitting domains [lb, ub] (depth):
[-1.55511, 95.518616] (4), [-1.48498, 95.518616] (4), [-1.44995, 95.518616] (4), [-1.34853, 95.518616] (4), [-1.22350, 95.518616] (4), [-1.08615, 95.518616] (4), [-0.10328, 95.518616] (4), 
length of domains: 7
Total time: 0.2887	 pickout: 0.0012	 decision: 0.0200	 get_bound: 0.2673	 add_domain: 0.0003
Current lb:-1.555109977722168
16 neurons visited
0 diving domains visited
Cumulative time: 2.1975467205047607

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67], [2, 83], [2, 67], [2, 67], [2, 83], [2, 38]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 4.066568374633789 with beta sum per layer: [0.0, 0.6059355735778809, 5.47560977935791]
optimal alpha/beta time: 0.2634429931640625
This batch time : update_bounds func: 0.2681	 prepare: 0.0027	 bound: 0.2637	 transfer: 0.0007	 finalize: 0.0009
Accumulated time: update_bounds func: 19.0620	 prepare: 0.2387	 bound: 18.6624	 transfer: 0.0007	 finalize: 0.0942
batch bounding time:  0.26815271377563477
Current worst splitting domains [lb, ub] (depth):
[-1.27976, 95.518616] (5), [-1.24530, 95.518616] (5), [-1.20687, 95.518616] (5), [-1.08873, 95.518616] (5), [-0.95224, 95.518616] (5), [-0.87836, 95.518616] (5), 
length of domains: 6
Total time: 0.2909	 pickout: 0.0016	 decision: 0.0208	 get_bound: 0.2682	 add_domain: 0.0003
Current lb:-1.279764175415039
30 neurons visited
0 diving domains visited
Cumulative time: 2.488645315170288

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [1, 410], [2, 83], [2, 83], [2, 83], [2, 38]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 3.399658679962158 with beta sum per layer: [0.0, 0.18463024497032166, 2.7966437339782715]
optimal alpha/beta time: 0.2635183334350586
This batch time : update_bounds func: 0.2681	 prepare: 0.0027	 bound: 0.2638	 transfer: 0.0006	 finalize: 0.0010
Accumulated time: update_bounds func: 19.3301	 prepare: 0.2414	 bound: 18.9262	 transfer: 0.0006	 finalize: 0.0952
batch bounding time:  0.26818251609802246
Current worst splitting domains [lb, ub] (depth):
[-1.09312, 95.518616] (6), [-1.01943, 95.518616] (6), [-0.89520, 95.518616] (6), [-0.74888, 95.518616] (6), [-0.74490, 95.518616] (6), [-0.65740, 95.518616] (6), [-0.46835, 95.518616] (6), [-0.10173, 95.518616] (6), 
length of domains: 8
Total time: 0.2903	 pickout: 0.0015	 decision: 0.0202	 get_bound: 0.2682	 add_domain: 0.0004
Current lb:-1.0931248664855957
42 neurons visited
0 diving domains visited
Cumulative time: 2.7790989875793457

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 1194], [1, 1194], [2, 38], [2, 38], [2, 38], [2, 38], [2, 75], [1, 410]]
single_node_split: True
regular batch size: 2*8, diving batch size 1*0
best_l after optimization: 3.5964674949645996 with beta sum per layer: [0.0, 0.2292352020740509, 3.342617988586426]
optimal alpha/beta time: 0.263660192489624
This batch time : update_bounds func: 0.2689	 prepare: 0.0031	 bound: 0.2639	 transfer: 0.0007	 finalize: 0.0012
Accumulated time: update_bounds func: 19.5989	 prepare: 0.2445	 bound: 19.1901	 transfer: 0.0007	 finalize: 0.0964
batch bounding time:  0.2689673900604248
Current worst splitting domains [lb, ub] (depth):
[-0.55471, 95.518616] (7), [-0.54050, 95.518616] (7), [-0.53462, 95.518616] (7), [-0.46512, 95.518616] (7), [-0.45818, 95.518616] (7), [-0.34791, 95.518616] (7), [-0.33405, 95.518616] (7), [-0.29069, 95.518616] (7), [-0.23577, 95.518616] (7), [-0.15473, 95.518616] (7), [-0.11747, 95.518616] (7), [-0.05162, 95.518616] (7), [-0.00096, 95.518616] (7), 
length of domains: 13
Total time: 0.2924	 pickout: 0.0018	 decision: 0.0210	 get_bound: 0.2690	 add_domain: 0.0006
Current lb:-0.5547122955322266
58 neurons visited
0 diving domains visited
Cumulative time: 3.071638822555542

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 38], [2, 38], [1, 1194], [2, 38], [1, 1194], [2, 85], [1, 410], [1, 1194], [2, 85]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: -2.8702640533447266 with beta sum per layer: [0.0, 0.48449021577835083, 4.053647994995117]
optimal alpha/beta time: 0.2645695209503174
This batch time : update_bounds func: 0.2715	 prepare: 0.0040	 bound: 0.2648	 transfer: 0.0009	 finalize: 0.0017
Accumulated time: update_bounds func: 19.8704	 prepare: 0.2485	 bound: 19.4549	 transfer: 0.0009	 finalize: 0.0981
batch bounding time:  0.2716066837310791
Current worst splitting domains [lb, ub] (depth):
[-0.16029, 95.518616] (8), [-0.14784, 95.518616] (8), [-0.10858, 95.518616] (8), [-0.08069, 95.518616] (8), [-0.03769, 95.518616] (8), 
length of domains: 5
Total time: 0.2971	 pickout: 0.0025	 decision: 0.0227	 get_bound: 0.2717	 add_domain: 0.0003
Current lb:-0.16028881072998047
84 neurons visited
0 diving domains visited
Cumulative time: 3.3690218925476074

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 85], [1, 1194], [1, 655]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -2.218109607696533 with beta sum per layer: [0.0, 0.05203957110643387, 0.0]
optimal alpha/beta time: 0.008913993835449219
This batch time : update_bounds func: 0.0130	 prepare: 0.0025	 bound: 0.0091	 transfer: 0.0006	 finalize: 0.0007
Accumulated time: update_bounds func: 19.8835	 prepare: 0.2510	 bound: 19.4640	 transfer: 0.0006	 finalize: 0.0988
batch bounding time:  0.013080596923828125
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0346	 pickout: 0.0014	 decision: 0.0201	 get_bound: 0.0131	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.403806209564209

Image 2 pidx 6 verify end, final lower bound 999, upper bound 95.51861572265625, time: 3.462141990661621
2 999
##### [0:2] Tested against 2 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 2.5558817386627197 with beta sum per layer: []
optimal alpha/beta time: 1.033290147781372
alpha-CROWN with fixed intermediate bounds: tensor([[-2.5559]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-2.5558817386627197
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 905]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 4.056895732879639 with beta sum per layer: [0.0, 0.1352521926164627, 0.0]
optimal alpha/beta time: 0.24773693084716797
This batch time : update_bounds func: 0.2503	 prepare: 0.0015	 bound: 0.2479	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 20.1337	 prepare: 0.2525	 bound: 19.7119	 transfer: 0.0005	 finalize: 0.0990
batch bounding time:  0.2503550052642822
Current worst splitting domains [lb, ub] (depth):
[-2.34691, 96.444115] (1), [-1.70999, 96.444115] (1), 
length of domains: 2
Total time: 0.2704	 pickout: 0.0007	 decision: 0.0192	 get_bound: 0.2504	 add_domain: 0.0001
Current lb:-2.3469090461730957
2 neurons visited
0 diving domains visited
Cumulative time: 1.319908618927002

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 5.166149139404297 with beta sum per layer: [0.0, 0.33944642543792725, 0.0]
optimal alpha/beta time: 0.2638678550720215
This batch time : update_bounds func: 0.2668	 prepare: 0.0018	 bound: 0.2641	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 20.4006	 prepare: 0.2543	 bound: 19.9760	 transfer: 0.0005	 finalize: 0.0994
batch bounding time:  0.26691675186157227
Current worst splitting domains [lb, ub] (depth):
[-1.68236, 96.444115] (2), [-1.64263, 96.444115] (2), [-1.01623, 96.444115] (2), [-0.82493, 96.444115] (2), 
length of domains: 4
Total time: 0.2873	 pickout: 0.0009	 decision: 0.0193	 get_bound: 0.2669	 add_domain: 0.0002
Current lb:-1.6823644638061523
6 neurons visited
0 diving domains visited
Cumulative time: 1.6072430610656738

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [2, 22], [2, 22], [2, 22]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 2.0655674934387207 with beta sum per layer: [0.0, 0.5665742754936218, 1.0836200714111328]
optimal alpha/beta time: 0.2628626823425293
This batch time : update_bounds func: 0.2665	 prepare: 0.0022	 bound: 0.2631	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 20.6671	 prepare: 0.2565	 bound: 20.2391	 transfer: 0.0006	 finalize: 0.1000
batch bounding time:  0.2665998935699463
Current worst splitting domains [lb, ub] (depth):
[-1.50305, 96.444115] (3), [-1.49604, 96.444115] (3), [-0.82283, 96.444115] (3), [-0.62571, 96.444115] (3), 
length of domains: 4
Total time: 0.2875	 pickout: 0.0012	 decision: 0.0195	 get_bound: 0.2666	 add_domain: 0.0002
Current lb:-1.503054141998291
14 neurons visited
0 diving domains visited
Cumulative time: 1.8948688507080078

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 38]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 4.353830337524414 with beta sum per layer: [0.0, 0.7283948063850403, 0.3671056628227234]
optimal alpha/beta time: 0.2630620002746582
This batch time : update_bounds func: 0.2668	 prepare: 0.0022	 bound: 0.2633	 transfer: 0.0006	 finalize: 0.0007
Accumulated time: update_bounds func: 20.9339	 prepare: 0.2588	 bound: 20.5024	 transfer: 0.0006	 finalize: 0.1007
batch bounding time:  0.26693153381347656
Current worst splitting domains [lb, ub] (depth):
[-1.30348, 96.444115] (4), [-0.86203, 96.444115] (4), [-0.85420, 96.444115] (4), [-0.69904, 96.444115] (4), [-0.61800, 96.444115] (4), [-0.02657, 96.444115] (4), [-0.00517, 96.444115] (4), 
length of domains: 7
Total time: 0.2878	 pickout: 0.0012	 decision: 0.0194	 get_bound: 0.2670	 add_domain: 0.0003
Current lb:-1.3034753799438477
22 neurons visited
0 diving domains visited
Cumulative time: 2.182828664779663

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 38], [2, 47], [2, 47], [2, 41], [2, 38], [2, 47], [2, 38]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 1.1702191829681396 with beta sum per layer: [0.0, 1.0228878259658813, 1.2852973937988281]
optimal alpha/beta time: 0.26544642448425293
This batch time : update_bounds func: 0.2701	 prepare: 0.0027	 bound: 0.2657	 transfer: 0.0007	 finalize: 0.0009
Accumulated time: update_bounds func: 21.2040	 prepare: 0.2615	 bound: 20.7681	 transfer: 0.0007	 finalize: 0.1016
batch bounding time:  0.2701544761657715
Current worst splitting domains [lb, ub] (depth):
[-0.84666, 96.444115] (5), [-0.64277, 96.444115] (5), [-0.60247, 96.444115] (5), [-0.59481, 96.444115] (5), [-0.27354, 96.444115] (5), [-0.07531, 96.444115] (5), 
length of domains: 6
Total time: 0.2927	 pickout: 0.0016	 decision: 0.0206	 get_bound: 0.2702	 add_domain: 0.0003
Current lb:-0.8466570377349854
36 neurons visited
0 diving domains visited
Cumulative time: 2.4757025241851807

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [1, 415], [2, 41], [2, 41], [2, 38], [2, 41]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: 0.16843438148498535 with beta sum per layer: [0.0, 0.7040279507637024, 1.2847850322723389]
optimal alpha/beta time: 0.26314330101013184
This batch time : update_bounds func: 0.2677	 prepare: 0.0027	 bound: 0.2634	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 21.4717	 prepare: 0.2642	 bound: 21.0315	 transfer: 0.0006	 finalize: 0.1026
batch bounding time:  0.267833948135376
Current worst splitting domains [lb, ub] (depth):
[-0.67426, 96.444115] (6), [-0.30593, 96.444115] (6), [-0.15053, 96.444115] (6), [-0.13757, 96.444115] (6), [-0.01768, 96.444115] (6), [-0.01265, 96.444115] (6), 
length of domains: 6
Total time: 0.2897	 pickout: 0.0015	 decision: 0.0201	 get_bound: 0.2679	 add_domain: 0.0003
Current lb:-0.6742644309997559
48 neurons visited
0 diving domains visited
Cumulative time: 2.7655701637268066

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41], [2, 11], [2, 83], [2, 11], [2, 83]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -1.6096301078796387 with beta sum per layer: [0.0, 0.0, 0.11950688064098358]
optimal alpha/beta time: 0.2630960941314697
This batch time : update_bounds func: 0.2674	 prepare: 0.0026	 bound: 0.2633	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 21.7391	 prepare: 0.2668	 bound: 21.2948	 transfer: 0.0006	 finalize: 0.1034
batch bounding time:  0.2675156593322754
Current worst splitting domains [lb, ub] (depth):
[-0.21769, 96.444115] (7), [-0.12290, 96.444115] (7), [-0.03914, 96.444115] (7), 
length of domains: 3
Total time: 0.2894	 pickout: 0.0015	 decision: 0.0202	 get_bound: 0.2675	 add_domain: 0.0002
Current lb:-0.21769189834594727
60 neurons visited
0 diving domains visited
Cumulative time: 3.0551750659942627

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 75], [2, 11], [2, 83]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.9135322570800781 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2516028881072998
This batch time : update_bounds func: 0.2551	 prepare: 0.0020	 bound: 0.2518	 transfer: 0.0007	 finalize: 0.0005
Accumulated time: update_bounds func: 21.9942	 prepare: 0.2689	 bound: 21.5466	 transfer: 0.0007	 finalize: 0.1039
batch bounding time:  0.255218505859375
Current worst splitting domains [lb, ub] (depth):
[-0.09114, 96.444115] (8), 
length of domains: 1
Total time: 0.2761	 pickout: 0.0010	 decision: 0.0198	 get_bound: 0.2552	 add_domain: 0.0001
Current lb:-0.0911402702331543
66 neurons visited
0 diving domains visited
Cumulative time: 3.3314602375030518

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 11]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.36182141304016113 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008874654769897461
This batch time : update_bounds func: 0.0116	 prepare: 0.0017	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 22.0058	 prepare: 0.2705	 bound: 21.5557	 transfer: 0.0005	 finalize: 0.1041
batch bounding time:  0.011658668518066406
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0317	 pickout: 0.0008	 decision: 0.0192	 get_bound: 0.0117	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 3.3632078170776367

Image 2 pidx 2 verify end, final lower bound 999, upper bound 96.4441146850586, time: 3.4209811687469482
2 999
##### [0:2] Tested against 0 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.6236119270324707 with beta sum per layer: []
optimal alpha/beta time: 1.060333251953125
alpha-CROWN with fixed intermediate bounds: tensor([[-1.6236]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.6236119270324707
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.4114224910736084 with beta sum per layer: [0.0, 0.0, 0.7153064012527466]
optimal alpha/beta time: 0.25748634338378906
This batch time : update_bounds func: 0.2600	 prepare: 0.0015	 bound: 0.2577	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 22.2658	 prepare: 0.2721	 bound: 21.8134	 transfer: 0.0005	 finalize: 0.1044
batch bounding time:  0.2600746154785156
Current worst splitting domains [lb, ub] (depth):
[-1.39180, 97.376389] (1), [-0.01962, 97.376389] (1), 
length of domains: 2
Total time: 0.2803	 pickout: 0.0008	 decision: 0.0193	 get_bound: 0.2601	 add_domain: 0.0001
Current lb:-1.3918027877807617
2 neurons visited
0 diving domains visited
Cumulative time: 1.3570082187652588

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 22], [1, 563]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.2301630973815918 with beta sum per layer: [0.0, 0.0, 1.90501070022583]
optimal alpha/beta time: 0.26143479347229004
This batch time : update_bounds func: 0.2645	 prepare: 0.0019	 bound: 0.2617	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 22.5303	 prepare: 0.2740	 bound: 22.0751	 transfer: 0.0005	 finalize: 0.1048
batch bounding time:  0.26462626457214355
Current worst splitting domains [lb, ub] (depth):
[-1.23397, 97.376389] (2), 
length of domains: 1
Total time: 0.2851	 pickout: 0.0009	 decision: 0.0195	 get_bound: 0.2646	 add_domain: 0.0001
Current lb:-1.2339739799499512
6 neurons visited
0 diving domains visited
Cumulative time: 1.6421871185302734

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 563]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.476008415222168 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.2578587532043457
This batch time : update_bounds func: 0.2605	 prepare: 0.0016	 bound: 0.2581	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 22.7908	 prepare: 0.2756	 bound: 22.3331	 transfer: 0.0005	 finalize: 0.1050
batch bounding time:  0.2605922222137451
Current worst splitting domains [lb, ub] (depth):
[-0.90509, 97.376389] (3), [-0.57091, 97.376389] (3), 
length of domains: 2
Total time: 0.2805	 pickout: 0.0007	 decision: 0.0190	 get_bound: 0.2606	 add_domain: 0.0001
Current lb:-0.9050936698913574
8 neurons visited
0 diving domains visited
Cumulative time: 1.9227654933929443

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67], [2, 67]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.7324848175048828 with beta sum per layer: [0.0, 0.0, 0.4334355294704437]
optimal alpha/beta time: 0.26468563079833984
This batch time : update_bounds func: 0.2678	 prepare: 0.0018	 bound: 0.2649	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 23.0586	 prepare: 0.2775	 bound: 22.5981	 transfer: 0.0006	 finalize: 0.1054
batch bounding time:  0.2678518295288086
Current worst splitting domains [lb, ub] (depth):
[-0.60235, 97.376389] (4), [-0.28484, 97.376389] (4), 
length of domains: 2
Total time: 0.2882	 pickout: 0.0009	 decision: 0.0193	 get_bound: 0.2679	 add_domain: 0.0001
Current lb:-0.6023497581481934
12 neurons visited
0 diving domains visited
Cumulative time: 2.211089849472046

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: -0.12250256538391113 with beta sum per layer: [0.0, 0.0, 0.2569752633571625]
optimal alpha/beta time: 0.26147007942199707
This batch time : update_bounds func: 0.2645	 prepare: 0.0019	 bound: 0.2617	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 23.3231	 prepare: 0.2793	 bound: 22.8598	 transfer: 0.0006	 finalize: 0.1058
batch bounding time:  0.26461243629455566
Current worst splitting domains [lb, ub] (depth):
[-0.19501, 97.376389] (5), 
length of domains: 1
Total time: 0.2851	 pickout: 0.0010	 decision: 0.0195	 get_bound: 0.2646	 add_domain: 0.0001
Current lb:-0.1950063705444336
16 neurons visited
0 diving domains visited
Cumulative time: 2.496328115463257

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 612]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.2841019630432129 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.25345492362976074
This batch time : update_bounds func: 0.2562	 prepare: 0.0017	 bound: 0.2537	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 23.5793	 prepare: 0.2810	 bound: 23.1134	 transfer: 0.0005	 finalize: 0.1060
batch bounding time:  0.25624537467956543
Current worst splitting domains [lb, ub] (depth):
[-0.01142, 97.376389] (6), 
length of domains: 1
Total time: 0.2762	 pickout: 0.0008	 decision: 0.0191	 get_bound: 0.2563	 add_domain: 0.0001
Current lb:-0.011418342590332031
18 neurons visited
0 diving domains visited
Cumulative time: 2.7725772857666016

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 430]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5039272308349609 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008858680725097656
This batch time : update_bounds func: 0.0115	 prepare: 0.0017	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 23.5908	 prepare: 0.2827	 bound: 23.1225	 transfer: 0.0005	 finalize: 0.1063
batch bounding time:  0.011572122573852539
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0316	 pickout: 0.0008	 decision: 0.0192	 get_bound: 0.0116	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 2.80424427986145

Image 2 pidx 0 verify end, final lower bound 999, upper bound 97.37638854980469, time: 2.86234712600708
2 999
##### [0:2] Tested against 1 ######
Model prediction is: tensor([[-4.2674, -7.4374, -3.7629, -2.6753,  1.5492, -3.0144, -6.5095, -0.8245,
         -1.0512,  3.9617]], device='cuda:0', grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.6014018058776855 with beta sum per layer: []
optimal alpha/beta time: 1.056823492050171
alpha-CROWN with fixed intermediate bounds: tensor([[-0.6014]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.6014018058776855
layer 0 size torch.Size([3136]) unstable 1253
layer 1 size torch.Size([1568]) unstable 191
layer 2 size torch.Size([100]) unstable 25
# of unstable neurons: 1469
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 67]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: -0.36266040802001953 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.23758697509765625
This batch time : update_bounds func: 0.2401	 prepare: 0.0015	 bound: 0.2378	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 23.8309	 prepare: 0.2842	 bound: 23.3603	 transfer: 0.0005	 finalize: 0.1065
batch bounding time:  0.24017953872680664
Current worst splitting domains [lb, ub] (depth):
[-0.05071, 98.398598] (1), 
length of domains: 1
Total time: 0.2602	 pickout: 0.0008	 decision: 0.0192	 get_bound: 0.2402	 add_domain: 0.0001
Current lb:-0.050713539123535156
2 neurons visited
0 diving domains visited
Cumulative time: 1.3332233428955078

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.876251220703125 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.01073002815246582
This batch time : update_bounds func: 0.0133	 prepare: 0.0016	 bound: 0.0109	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 23.8442	 prepare: 0.2858	 bound: 23.3712	 transfer: 0.0005	 finalize: 0.1068
batch bounding time:  0.013310670852661133
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0331	 pickout: 0.0007	 decision: 0.0191	 get_bound: 0.0133	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.3664326667785645

Image 2 pidx 1 verify end, final lower bound 999, upper bound 98.39859771728516, time: 1.4245522022247314
2 999
##### [0:2] Tested against 9 ######
correct label, skip!
[[  2.           0.           0.           0.79609466   0.
   -3.                  inf          inf]
 [  2.           0.           0.           6.57268977   0.
   -1.                  inf          inf]
 [  2.         999.          24.           4.28852582   0.
    4.          98.1379776    0.77258754]
 [  2.         999.         176.           4.47309637   0.
    7.          95.51892853   4.66824436]
 [  2.         999.         294.           6.33430576   0.
    8.          96.45735931   5.20651436]
 [  2.         999.         740.           6.08777785   0.
    5.          95.27497864   5.94579363]
 [  2.         999.         132.           4.56920505   0.
    3.          96.33924103   6.23713207]
 [  2.         999.          94.           3.46214199   0.
    6.          95.51861572   6.72018194]
 [  2.         999.          68.           3.42098117   0.
    2.          96.44411469   7.03076267]
 [  2.         999.          20.           2.86234713   0.
    0.          97.37638855   8.37918186]
 [  2.         999.           4.           1.4245522    0.
    1.          98.39859772   9.24479961]
 [  2.           0.           0.           0.           0.
    9.                  inf          inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 43.49562311172485

Experiments at Wed Apr 13 17:23:16 2022 on diablo.cs.ucla.edu
Sequential(
  (0): Conv2d(1, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten()
  (5): Linear(in_features=1568, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
############################
Shape: torch.Size([200, 1, 28, 28]) torch.Size([200]) torch.Size([200])
X range: tensor(1.) tensor(0.) tensor(0.1340)
############################
epsilon after preprocession: 0.30000001192092896, data_max = tensor([[[[1.]]]]), data_min = tensor([[[[0.]]]])
Task length: 1
saving results to Verified_ret_[mnist_cnn_4layer]_start=69_end=70_iter=20_b=1024_int-beta=False_timeout=180_branching=kfsb-max-3_lra-init=0.1_lra=0.01_lrb=0.05_PGD=before.npy

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0 img ID: 69 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
predicted label  7  correct label  7 logits tensor([ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
          5.7896,  -0.5153,   2.6719], device='cuda:0',
       grad_fn=<SelectBackward>)
False
##### PGD attack: True label: 7, Tested against: ['all'] ######
pgd prediction: tensor([-3.6780, -5.7255, -4.6645, -2.1563, -0.6830, -3.7120, -9.9873,  2.8896,
         0.2425,  2.2644], device='cuda:0', grad_fn=<SqueezeBackward1>)
attack margin tensor([ 6.5677,  8.6151,  7.5542,  5.0460,  3.5727,  6.6017, 12.8769,     inf,
         2.6471,  0.6252], device='cuda:0', grad_fn=<RsubBackward1>)
untargeted pgd failed
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
initial CROWN bounds: tensor([[-1.3933, -1.4213, -0.7456, -1.7482, -3.3693, -3.1006, -1.6072, -4.8603,
         -3.6773]], device='cuda:0') None
best_l after optimization: -7.237631797790527 with beta sum per layer: []
optimal alpha/beta time: 5.771698951721191
initial alpha-CROWN bounds: tensor([[ 1.1497,  2.7644,  2.1774,  0.3949, -0.0446,  0.2932,  3.9427, -1.8660,
         -1.5741]], device='cuda:0', grad_fn=<AsStridedBackward>) None
##### [0:69] Tested against 9 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.5717655420303345 with beta sum per layer: []
optimal alpha/beta time: 1.4438354969024658
alpha-CROWN with fixed intermediate bounds: tensor([[-1.5718]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.5717655420303345
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 2.0560221672058105 with beta sum per layer: [0.0, 0.0, 0.2850477993488312]
optimal alpha/beta time: 0.6606998443603516
This batch time : update_bounds func: 0.6634	 prepare: 0.0016	 bound: 0.6609	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 0.6634	 prepare: 0.0016	 bound: 0.6609	 transfer: 0.0005	 finalize: 0.0003
batch bounding time:  0.6634683609008789
Current worst splitting domains [lb, ub] (depth):
[-1.40523, 97.428238] (1), [-0.65079, 97.428238] (1), 
length of domains: 2
Total time: 0.6844	 pickout: 0.0008	 decision: 0.0199	 get_bound: 0.6635	 add_domain: 0.0001
Current lb:-1.4052319526672363
2 neurons visited
0 diving domains visited
Cumulative time: 2.5584018230438232

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83], [2, 83]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 2.517888069152832 with beta sum per layer: [0.0, 0.0, 1.1467969417572021]
optimal alpha/beta time: 0.24791622161865234
This batch time : update_bounds func: 0.2508	 prepare: 0.0018	 bound: 0.2482	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 0.9142	 prepare: 0.0034	 bound: 0.9091	 transfer: 0.0005	 finalize: 0.0007
batch bounding time:  0.25095701217651367
Current worst splitting domains [lb, ub] (depth):
[-1.31700, 97.428238] (2), [-0.67290, 97.428238] (2), [-0.45913, 97.428238] (2), [-0.06885, 97.428238] (2), 
length of domains: 4
Total time: 0.2717	 pickout: 0.0009	 decision: 0.0197	 get_bound: 0.2510	 add_domain: 0.0002
Current lb:-1.3170032501220703
6 neurons visited
0 diving domains visited
Cumulative time: 2.8302114009857178

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 56], [2, 56], [2, 56], [2, 56]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 2.6958346366882324 with beta sum per layer: [0.0, 0.0, 3.099933385848999]
optimal alpha/beta time: 0.24967694282531738
This batch time : update_bounds func: 0.2534	 prepare: 0.0021	 bound: 0.2499	 transfer: 0.0006	 finalize: 0.0007
Accumulated time: update_bounds func: 1.1676	 prepare: 0.0055	 bound: 1.1590	 transfer: 0.0006	 finalize: 0.0014
batch bounding time:  0.25351905822753906
Current worst splitting domains [lb, ub] (depth):
[-1.17383, 97.428238] (3), [-0.95870, 97.428238] (3), [-0.44604, 97.428238] (3), [-0.32375, 97.428238] (3), [-0.23248, 97.428238] (3), 
length of domains: 5
Total time: 0.2746	 pickout: 0.0011	 decision: 0.0197	 get_bound: 0.2535	 add_domain: 0.0002
Current lb:-1.1738349199295044
14 neurons visited
0 diving domains visited
Cumulative time: 3.1049282550811768

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 96], [2, 96], [2, 85], [2, 85], [2, 85]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: 3.052182674407959 with beta sum per layer: [0.0, 0.0, 4.317168712615967]
optimal alpha/beta time: 0.24948477745056152
This batch time : update_bounds func: 0.2534	 prepare: 0.0023	 bound: 0.2497	 transfer: 0.0006	 finalize: 0.0007
Accumulated time: update_bounds func: 1.4210	 prepare: 0.0078	 bound: 1.4087	 transfer: 0.0006	 finalize: 0.0021
batch bounding time:  0.25351548194885254
Current worst splitting domains [lb, ub] (depth):
[-1.09439, 97.428238] (4), [-0.86721, 97.428238] (4), [-0.74166, 97.428238] (4), [-0.29337, 97.428238] (4), [-0.28458, 97.428238] (4), [-0.14984, 97.428238] (4), [-0.08904, 97.428238] (4), 
length of domains: 7
Total time: 0.2751	 pickout: 0.0013	 decision: 0.0200	 get_bound: 0.2535	 add_domain: 0.0003
Current lb:-1.0943922996520996
24 neurons visited
0 diving domains visited
Cumulative time: 3.380155086517334

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 33], [2, 85], [2, 85], [2, 85], [2, 96], [2, 33], [2, 96]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 3.8836371898651123 with beta sum per layer: [0.0, 0.0, 5.425819396972656]
optimal alpha/beta time: 0.25061750411987305
This batch time : update_bounds func: 0.2552	 prepare: 0.0026	 bound: 0.2508	 transfer: 0.0007	 finalize: 0.0011
Accumulated time: update_bounds func: 1.6762	 prepare: 0.0104	 bound: 1.6595	 transfer: 0.0007	 finalize: 0.0032
batch bounding time:  0.2553725242614746
Current worst splitting domains [lb, ub] (depth):
[-0.94828, 97.428238] (5), [-0.86302, 97.428238] (5), [-0.69838, 97.428238] (5), [-0.53643, 97.428238] (5), [-0.49736, 97.428238] (5), [-0.32910, 97.428238] (5), [-0.15745, 97.428238] (5), [-0.06228, 97.428238] (5), [-0.03398, 97.428238] (5), 
length of domains: 9
Total time: 0.2790	 pickout: 0.0016	 decision: 0.0216	 get_bound: 0.2554	 add_domain: 0.0005
Current lb:-0.9482779502868652
38 neurons visited
0 diving domains visited
Cumulative time: 3.6593377590179443

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 85], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33], [2, 33]]
single_node_split: True
regular batch size: 2*9, diving batch size 1*0
best_l after optimization: 4.191390037536621 with beta sum per layer: [0.0, 0.0, 7.712863922119141]
optimal alpha/beta time: 0.24963068962097168
This batch time : update_bounds func: 0.2549	 prepare: 0.0029	 bound: 0.2499	 transfer: 0.0007	 finalize: 0.0013
Accumulated time: update_bounds func: 1.9311	 prepare: 0.0133	 bound: 1.9094	 transfer: 0.0007	 finalize: 0.0045
batch bounding time:  0.2550199031829834
Current worst splitting domains [lb, ub] (depth):
[-0.76404, 97.428238] (6), [-0.70707, 97.428238] (6), [-0.68228, 97.428238] (6), [-0.62464, 97.428238] (6), [-0.58326, 97.428238] (6), [-0.34119, 97.428238] (6), [-0.33209, 97.428238] (6), [-0.30706, 97.428238] (6), [-0.22076, 97.428238] (6), [-0.12572, 97.428238] (6), [-0.07823, 97.428238] (6), [-0.02727, 97.428238] (6), [-0.00717, 97.428238] (6), 
length of domains: 13
Total time: 0.2787	 pickout: 0.0018	 decision: 0.0212	 get_bound: 0.2551	 add_domain: 0.0006
Current lb:-0.7640355825424194
56 neurons visited
0 diving domains visited
Cumulative time: 3.938201427459717

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 603], [1, 16], [1, 72], [1, 72], [1, 603], [1, 603], [1, 72], [1, 603], [1, 603], [1, 603]]
single_node_split: True
regular batch size: 2*13, diving batch size 1*0
best_l after optimization: 6.547237396240234 with beta sum per layer: [0.0, 0.4419696629047394, 10.201753616333008]
optimal alpha/beta time: 0.2534768581390381
This batch time : update_bounds func: 0.2600	 prepare: 0.0036	 bound: 0.2537	 transfer: 0.0008	 finalize: 0.0017
Accumulated time: update_bounds func: 2.1911	 prepare: 0.0169	 bound: 2.1631	 transfer: 0.0008	 finalize: 0.0062
batch bounding time:  0.2601768970489502
Current worst splitting domains [lb, ub] (depth):
[-0.71247, 97.428238] (7), [-0.64836, 97.428238] (7), [-0.62494, 97.428238] (7), [-0.57379, 97.428238] (7), [-0.54791, 97.428238] (7), [-0.52788, 97.428238] (7), [-0.50439, 97.428238] (7), [-0.49012, 97.428238] (7), [-0.48893, 97.428238] (7), [-0.42466, 97.428238] (7), [-0.27678, 97.428238] (7), [-0.23910, 97.428238] (7), [-0.21120, 97.428238] (7), [-0.18641, 97.428238] (7), [-0.15840, 97.428238] (7), [-0.14753, 97.428238] (7), [-0.14075, 97.428238] (7), [-0.04540, 97.428238] (7), [-0.01077, 97.428238] (7), 
length of domains: 19
Total time: 0.2854	 pickout: 0.0023	 decision: 0.0220	 get_bound: 0.2602	 add_domain: 0.0009
Current lb:-0.7124712467193604
82 neurons visited
0 diving domains visited
Cumulative time: 4.2238547801971436

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 16], [1, 72], [1, 16], [1, 16], [1, 16], [1, 16], [1, 16], [1, 72], [1, 16], [1, 72]]
single_node_split: True
regular batch size: 2*19, diving batch size 1*0
best_l after optimization: 8.91871452331543 with beta sum per layer: [0.0, 4.413714408874512, 10.549345016479492]
optimal alpha/beta time: 0.2561016082763672
This batch time : update_bounds func: 0.2648	 prepare: 0.0050	 bound: 0.2563	 transfer: 0.0010	 finalize: 0.0024
Accumulated time: update_bounds func: 2.4560	 prepare: 0.0219	 bound: 2.4195	 transfer: 0.0010	 finalize: 0.0087
batch bounding time:  0.2649657726287842
Current worst splitting domains [lb, ub] (depth):
[-0.66089, 97.428238] (8), [-0.56824, 97.428238] (8), [-0.53635, 97.428238] (8), [-0.52949, 97.428238] (8), [-0.50343, 97.428238] (8), [-0.50125, 97.428238] (8), [-0.47905, 97.428238] (8), [-0.47663, 97.428238] (8), [-0.45293, 97.428238] (8), [-0.44819, 97.428238] (8), [-0.43261, 97.428238] (8), [-0.37338, 97.428238] (8), [-0.36252, 97.428238] (8), [-0.32264, 97.428238] (8), [-0.31728, 97.428238] (8), [-0.30906, 97.428238] (8), [-0.30371, 97.428238] (8), [-0.29856, 97.428238] (8), [-0.29106, 97.428238] (8), [-0.23777, 97.428238] (8), 
length of domains: 29
Total time: 0.2960	 pickout: 0.0033	 decision: 0.0262	 get_bound: 0.2650	 add_domain: 0.0015
Current lb:-0.6608895063400269
120 neurons visited
0 diving domains visited
Cumulative time: 4.5201416015625

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 72], [1, 72], [1, 603], [1, 603], [1, 603], [1, 603], [1, 72], [1, 72], [2, 8], [1, 72]]
single_node_split: True
regular batch size: 2*29, diving batch size 1*0
best_l after optimization: 11.435519218444824 with beta sum per layer: [0.0, 6.27147912979126, 11.95765209197998]
optimal alpha/beta time: 0.25644874572753906
This batch time : update_bounds func: 0.2687	 prepare: 0.0070	 bound: 0.2567	 transfer: 0.0013	 finalize: 0.0035
Accumulated time: update_bounds func: 2.7246	 prepare: 0.0289	 bound: 2.6762	 transfer: 0.0013	 finalize: 0.0122
batch bounding time:  0.2688298225402832
Current worst splitting domains [lb, ub] (depth):
[-0.55847, 97.428238] (9), [-0.53348, 97.428238] (9), [-0.48301, 97.428238] (9), [-0.47644, 97.428238] (9), [-0.46632, 97.428238] (9), [-0.45121, 97.428238] (9), [-0.44920, 97.428238] (9), [-0.43950, 97.428238] (9), [-0.39445, 97.428238] (9), [-0.39240, 97.428238] (9), [-0.38877, 97.428238] (9), [-0.37867, 97.428238] (9), [-0.37794, 97.428238] (9), [-0.36951, 97.428238] (9), [-0.36451, 97.428238] (9), [-0.36285, 97.428238] (9), [-0.35837, 97.428238] (9), [-0.34532, 97.428238] (9), [-0.29994, 97.428238] (9), [-0.28541, 97.428238] (9), 
length of domains: 44
Total time: 0.2998	 pickout: 0.0046	 decision: 0.0240	 get_bound: 0.2689	 add_domain: 0.0022
Current lb:-0.5584665536880493
178 neurons visited
0 diving domains visited
Cumulative time: 4.820383787155151

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 8], [2, 81]]
single_node_split: True
regular batch size: 2*44, diving batch size 1*0
best_l after optimization: 11.382020950317383 with beta sum per layer: [0.0, 13.29220199584961, 16.351947784423828]
optimal alpha/beta time: 0.26119375228881836
This batch time : update_bounds func: 0.2781	 prepare: 0.0097	 bound: 0.2614	 transfer: 0.0016	 finalize: 0.0051
Accumulated time: update_bounds func: 3.0027	 prepare: 0.0385	 bound: 2.9376	 transfer: 0.0016	 finalize: 0.0173
batch bounding time:  0.27825069427490234
Current worst splitting domains [lb, ub] (depth):
[-0.49950, 97.428238] (10), [-0.47242, 97.428238] (10), [-0.42096, 97.428238] (10), [-0.41794, 97.428238] (10), [-0.40713, 97.428238] (10), [-0.39461, 97.428238] (10), [-0.38426, 97.428238] (10), [-0.38146, 97.428238] (10), [-0.33988, 97.428238] (10), [-0.33210, 97.428238] (10), [-0.32863, 97.428238] (10), [-0.32378, 97.428238] (10), [-0.32126, 97.428238] (10), [-0.31483, 97.428238] (10), [-0.31452, 97.428238] (10), [-0.30747, 97.428238] (10), [-0.30436, 97.428238] (10), [-0.29445, 97.428238] (10), [-0.28310, 97.428238] (10), [-0.28126, 97.428238] (10), 
length of domains: 67
Total time: 0.3147	 pickout: 0.0066	 decision: 0.0262	 get_bound: 0.2784	 add_domain: 0.0036
Current lb:-0.4994983673095703
266 neurons visited
0 diving domains visited
Cumulative time: 5.135693073272705

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 275], [1, 275], [2, 81], [2, 81], [1, 275], [2, 81], [2, 81], [1, 275], [1, 603], [2, 81]]
single_node_split: True
regular batch size: 2*67, diving batch size 1*0
best_l after optimization: 4.969913482666016 with beta sum per layer: [0.0, 17.86863899230957, 30.14311981201172]
optimal alpha/beta time: 0.2607705593109131
This batch time : update_bounds func: 0.2880	 prepare: 0.0137	 bound: 0.2610	 transfer: 0.0052	 finalize: 0.0077
Accumulated time: update_bounds func: 3.2907	 prepare: 0.0523	 bound: 3.1986	 transfer: 0.0052	 finalize: 0.0250
batch bounding time:  0.2882120609283447
Current worst splitting domains [lb, ub] (depth):
[-0.45577, 97.428238] (11), [-0.42771, 97.428238] (11), [-0.37572, 97.428238] (11), [-0.37104, 97.428238] (11), [-0.36429, 97.428238] (11), [-0.36330, 97.428238] (11), [-0.34558, 97.428238] (11), [-0.34429, 97.428238] (11), [-0.33637, 97.428238] (11), [-0.32840, 97.428238] (11), [-0.28688, 97.428238] (11), [-0.28553, 97.428238] (11), [-0.28130, 97.428238] (11), [-0.27153, 97.428238] (11), [-0.26954, 97.428238] (11), [-0.26225, 97.428238] (11), [-0.26046, 97.428238] (11), [-0.25697, 97.428238] (11), [-0.25398, 97.428238] (11), [-0.24862, 97.428238] (11), 
length of domains: 67
Total time: 0.3335	 pickout: 0.0096	 decision: 0.0317	 get_bound: 0.2885	 add_domain: 0.0037
Current lb:-0.4557732343673706
400 neurons visited
0 diving domains visited
Cumulative time: 5.4702043533325195

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 81], [1, 613], [1, 613], [2, 81], [1, 613], [2, 81], [2, 81], [1, 613]]
single_node_split: True
regular batch size: 2*67, diving batch size 1*0
best_l after optimization: 7.270801544189453 with beta sum per layer: [0.0, 18.177026748657227, 18.449758529663086]
optimal alpha/beta time: 0.2624526023864746
This batch time : update_bounds func: 0.2890	 prepare: 0.0136	 bound: 0.2627	 transfer: 0.0048	 finalize: 0.0075
Accumulated time: update_bounds func: 3.5797	 prepare: 0.0659	 bound: 3.4614	 transfer: 0.0048	 finalize: 0.0325
batch bounding time:  0.2892332077026367
Current worst splitting domains [lb, ub] (depth):
[-0.40341, 97.428238] (12), [-0.37330, 97.428238] (12), [-0.32162, 97.428238] (12), [-0.31016, 97.428238] (12), [-0.28850, 97.428238] (12), [-0.28780, 97.428238] (12), [-0.28116, 97.428238] (12), [-0.27980, 97.428238] (12), [-0.26313, 97.428238] (12), [-0.26285, 97.428238] (12), [-0.26132, 97.428238] (12), [-0.24523, 97.428238] (12), [-0.24264, 97.428238] (12), [-0.23577, 97.428238] (12), [-0.23046, 97.428238] (12), [-0.21742, 97.428238] (12), [-0.20174, 97.428238] (12), [-0.19744, 97.428238] (12), [-0.19702, 97.428238] (12), [-0.19328, 97.428238] (12), 
length of domains: 71
Total time: 0.3341	 pickout: 0.0096	 decision: 0.0310	 get_bound: 0.2894	 add_domain: 0.0041
Current lb:-0.4034104347229004
534 neurons visited
0 diving domains visited
Cumulative time: 5.805318593978882

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 38], [1, 613], [1, 613], [1, 38], [1, 275], [1, 38], [1, 275], [1, 275], [1, 275]]
single_node_split: True
regular batch size: 2*71, diving batch size 1*0
best_l after optimization: 9.341171264648438 with beta sum per layer: [0.0, 14.133530616760254, 12.979456901550293]
optimal alpha/beta time: 0.25970983505249023
This batch time : update_bounds func: 0.2844	 prepare: 0.0141	 bound: 0.2600	 transfer: 0.0022	 finalize: 0.0078
Accumulated time: update_bounds func: 3.8641	 prepare: 0.0800	 bound: 3.7213	 transfer: 0.0022	 finalize: 0.0403
batch bounding time:  0.28460001945495605
Current worst splitting domains [lb, ub] (depth):
[-0.33275, 97.428238] (13), [-0.32562, 97.428238] (13), [-0.29951, 97.428238] (13), [-0.27303, 97.428238] (13), [-0.24814, 97.428238] (13), [-0.24551, 97.428238] (13), [-0.24371, 97.428238] (13), [-0.23803, 97.428238] (13), [-0.23134, 97.428238] (13), [-0.23100, 97.428238] (13), [-0.22608, 97.428238] (13), [-0.22366, 97.428238] (13), [-0.22102, 97.428238] (13), [-0.21765, 97.428238] (13), [-0.20897, 97.428238] (13), [-0.20763, 97.428238] (13), [-0.20763, 97.428238] (13), [-0.20680, 97.428238] (13), [-0.19969, 97.428238] (13), [-0.18055, 97.428238] (13), 
length of domains: 94
Total time: 0.3339	 pickout: 0.0103	 decision: 0.0331	 get_bound: 0.2848	 add_domain: 0.0057
Current lb:-0.33275091648101807
676 neurons visited
0 diving domains visited
Cumulative time: 6.140233039855957

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 416], [1, 38], [1, 416], [1, 416], [2, 79], [1, 38], [1, 163], [1, 416], [1, 416], [1, 416]]
single_node_split: True
regular batch size: 2*94, diving batch size 1*0
best_l after optimization: 6.2375407218933105 with beta sum per layer: [0.0, 21.240474700927734, 13.44854736328125]
optimal alpha/beta time: 0.27123117446899414
This batch time : update_bounds func: 0.3065	 prepare: 0.0188	 bound: 0.2715	 transfer: 0.0052	 finalize: 0.0107
Accumulated time: update_bounds func: 4.1706	 prepare: 0.0988	 bound: 3.9928	 transfer: 0.0052	 finalize: 0.0510
batch bounding time:  0.30681610107421875
Current worst splitting domains [lb, ub] (depth):
[-0.30415, 97.428238] (14), [-0.28323, 97.428238] (14), [-0.27012, 97.428238] (14), [-0.24708, 97.428238] (14), [-0.22914, 97.428238] (14), [-0.21392, 97.428238] (14), [-0.21384, 97.428238] (14), [-0.21161, 97.428238] (14), [-0.20454, 97.428238] (14), [-0.19668, 97.428238] (14), [-0.19427, 97.428238] (14), [-0.19063, 97.428238] (14), [-0.18902, 97.428238] (14), [-0.18459, 97.428238] (14), [-0.18314, 97.428238] (14), [-0.18105, 97.428238] (14), [-0.17960, 97.428238] (14), [-0.17754, 97.428238] (14), [-0.17727, 97.428238] (14), [-0.17615, 97.428238] (14), 
length of domains: 100
Total time: 0.3647	 pickout: 0.0136	 decision: 0.0375	 get_bound: 0.3071	 add_domain: 0.0065
Current lb:-0.30414879322052
864 neurons visited
0 diving domains visited
Cumulative time: 6.5062830448150635

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 269], [1, 269], [1, 38], [1, 269], [1, 269], [1, 38], [2, 41], [1, 269], [1, 269], [1, 269]]
single_node_split: True
regular batch size: 2*100, diving batch size 1*0
best_l after optimization: 4.303550720214844 with beta sum per layer: [0.0, 18.753141403198242, 11.129441261291504]
optimal alpha/beta time: 0.28193187713623047
This batch time : update_bounds func: 0.3203	 prepare: 0.0197	 bound: 0.2822	 transfer: 0.0067	 finalize: 0.0112
Accumulated time: update_bounds func: 4.4908	 prepare: 0.1185	 bound: 4.2750	 transfer: 0.0067	 finalize: 0.0622
batch bounding time:  0.3205447196960449
Current worst splitting domains [lb, ub] (depth):
[-0.27482, 97.428238] (15), [-0.24558, 97.428238] (15), [-0.22634, 97.428238] (15), [-0.21397, 97.428238] (15), [-0.18789, 97.428238] (15), [-0.18196, 97.428238] (15), [-0.17595, 97.428238] (15), [-0.17582, 97.428238] (15), [-0.17414, 97.428238] (15), [-0.16782, 97.428238] (15), [-0.16724, 97.428238] (15), [-0.16416, 97.428238] (15), [-0.15432, 97.428238] (15), [-0.15124, 97.428238] (15), [-0.14956, 97.428238] (15), [-0.14796, 97.428238] (15), [-0.14744, 97.428238] (15), [-0.14304, 97.428238] (15), [-0.14273, 97.428238] (15), [-0.14140, 97.428238] (15), 
length of domains: 100
Total time: 0.3767	 pickout: 0.0143	 decision: 0.0350	 get_bound: 0.3208	 add_domain: 0.0066
Current lb:-0.2748152017593384
1064 neurons visited
0 diving domains visited
Cumulative time: 6.884459495544434

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 416], [1, 269], [1, 613], [1, 416], [1, 613], [1, 163], [1, 613], [1, 613], [2, 79]]
single_node_split: True
regular batch size: 2*100, diving batch size 1*0
best_l after optimization: 1.2379399538040161 with beta sum per layer: [0.0, 16.595151901245117, 8.01453685760498]
optimal alpha/beta time: 0.28335022926330566
This batch time : update_bounds func: 0.3219	 prepare: 0.0197	 bound: 0.2836	 transfer: 0.0066	 finalize: 0.0115
Accumulated time: update_bounds func: 4.8128	 prepare: 0.1382	 bound: 4.5586	 transfer: 0.0066	 finalize: 0.0737
batch bounding time:  0.32219457626342773
Current worst splitting domains [lb, ub] (depth):
[-0.20614, 97.428238] (16), [-0.19244, 97.428238] (16), [-0.18980, 97.428238] (16), [-0.18097, 97.428238] (16), [-0.15598, 97.428238] (16), [-0.15329, 97.428238] (16), [-0.15034, 97.428238] (16), [-0.14883, 97.428238] (16), [-0.13955, 97.428238] (16), [-0.12985, 97.428238] (16), [-0.12488, 97.428238] (16), [-0.11743, 97.428238] (16), [-0.11618, 97.428238] (16), [-0.11437, 97.428238] (16), [-0.11304, 97.428238] (16), [-0.11118, 97.428238] (16), [-0.11084, 97.428238] (16), [-0.10984, 97.428238] (16), [-0.10775, 97.428238] (16), [-0.10469, 97.428238] (16), 
length of domains: 93
Total time: 0.3776	 pickout: 0.0143	 decision: 0.0344	 get_bound: 0.3225	 add_domain: 0.0064
Current lb:-0.20614200830459595
1264 neurons visited
0 diving domains visited
Cumulative time: 7.263624906539917

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [1, 710], [1, 269], [2, 79], [1, 723]]
single_node_split: True
regular batch size: 2*93, diving batch size 1*0
best_l after optimization: -5.326117038726807 with beta sum per layer: [0.0, 13.350465774536133, 4.439914703369141]
optimal alpha/beta time: 0.2670447826385498
This batch time : update_bounds func: 0.2988	 prepare: 0.0183	 bound: 0.2673	 transfer: 0.0024	 finalize: 0.0103
Accumulated time: update_bounds func: 5.1115	 prepare: 0.1566	 bound: 4.8259	 transfer: 0.0024	 finalize: 0.0839
batch bounding time:  0.29904770851135254
Current worst splitting domains [lb, ub] (depth):
[-0.16872, 97.428238] (17), [-0.15663, 97.428238] (17), [-0.14985, 97.428238] (17), [-0.13729, 97.428238] (17), [-0.12699, 97.428238] (17), [-0.12367, 97.428238] (17), [-0.11502, 97.428238] (17), [-0.10724, 97.428238] (17), [-0.10370, 97.428238] (17), [-0.10277, 97.428238] (17), [-0.09851, 97.428238] (17), [-0.08618, 97.428238] (17), [-0.08618, 97.428238] (17), [-0.08211, 97.428238] (17), [-0.07743, 97.428238] (17), [-0.07544, 97.428238] (17), [-0.07447, 97.428238] (17), [-0.07311, 97.428238] (17), [-0.07250, 97.428238] (17), [-0.06839, 97.428238] (17), 
length of domains: 68
Total time: 0.3544	 pickout: 0.0136	 decision: 0.0367	 get_bound: 0.2993	 add_domain: 0.0049
Current lb:-0.16872119903564453
1450 neurons visited
0 diving domains visited
Cumulative time: 7.619552850723267

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 710], [1, 710], [1, 163], [1, 163], [2, 41], [1, 710], [1, 163], [1, 38], [1, 710], [1, 163]]
single_node_split: True
regular batch size: 2*68, diving batch size 1*0
best_l after optimization: -3.0333645343780518 with beta sum per layer: [0.0, 8.443653106689453, 2.3923463821411133]
optimal alpha/beta time: 0.2653687000274658
This batch time : update_bounds func: 0.2908	 prepare: 0.0147	 bound: 0.2656	 transfer: 0.0020	 finalize: 0.0081
Accumulated time: update_bounds func: 5.4024	 prepare: 0.1713	 bound: 5.0915	 transfer: 0.0020	 finalize: 0.0920
batch bounding time:  0.2910933494567871
Current worst splitting domains [lb, ub] (depth):
[-0.14145, 97.428238] (18), [-0.13092, 97.428238] (18), [-0.12264, 97.428238] (18), [-0.11137, 97.428238] (18), [-0.09857, 97.428238] (18), [-0.08802, 97.428238] (18), [-0.07955, 97.428238] (18), [-0.07952, 97.428238] (18), [-0.07537, 97.428238] (18), [-0.07505, 97.428238] (18), [-0.06407, 97.428238] (18), [-0.05918, 97.428238] (18), [-0.05861, 97.428238] (18), [-0.05783, 97.428238] (18), [-0.05410, 97.428238] (18), [-0.05223, 97.428238] (18), [-0.04919, 97.428238] (18), [-0.04629, 97.428238] (18), [-0.04609, 97.428238] (18), [-0.04577, 97.428238] (18), 
length of domains: 48
Total time: 0.3647	 pickout: 0.0099	 decision: 0.0599	 get_bound: 0.2913	 add_domain: 0.0037
Current lb:-0.1414516568183899
1586 neurons visited
0 diving domains visited
Cumulative time: 7.985523700714111

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 163], [1, 163], [1, 710], [1, 710], [2, 41], [1, 710], [1, 702], [1, 710], [1, 422], [2, 41]]
single_node_split: True
regular batch size: 2*48, diving batch size 1*0
best_l after optimization: -2.7582199573516846 with beta sum per layer: [0.0, 4.588149070739746, 1.5321931838989258]
optimal alpha/beta time: 0.26166701316833496
This batch time : update_bounds func: 0.2803	 prepare: 0.0109	 bound: 0.2620	 transfer: 0.0017	 finalize: 0.0056
Accumulated time: update_bounds func: 5.6827	 prepare: 0.1822	 bound: 5.3535	 transfer: 0.0017	 finalize: 0.0976
batch bounding time:  0.2805039882659912
Current worst splitting domains [lb, ub] (depth):
[-0.11497, 97.428238] (19), [-0.10631, 97.428238] (19), [-0.09665, 97.428238] (19), [-0.09000, 97.428238] (19), [-0.06278, 97.428238] (19), [-0.05827, 97.428238] (19), [-0.05469, 97.428238] (19), [-0.05279, 97.428238] (19), [-0.05183, 97.428238] (19), [-0.02790, 97.428238] (19), [-0.02709, 97.428238] (19), [-0.02234, 97.428238] (19), [-0.02203, 97.428238] (19), [-0.01936, 97.428238] (19), [-0.01879, 97.428238] (19), [-0.01767, 97.428238] (19), [-0.01757, 97.428238] (19), [-0.01523, 97.428238] (19), [-0.01404, 97.428238] (19), [-0.01089, 97.428238] (19), 
length of domains: 29
Total time: 0.3167	 pickout: 0.0074	 decision: 0.0264	 get_bound: 0.2807	 add_domain: 0.0022
Current lb:-0.11496579647064209
1682 neurons visited
0 diving domains visited
Cumulative time: 8.303083181381226

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 723], [2, 41], [1, 723], [1, 723], [2, 41], [0, 2455], [2, 41], [1, 571], [0, 2455], [1, 710]]
single_node_split: True
regular batch size: 2*29, diving batch size 1*0
best_l after optimization: -1.5666160583496094 with beta sum per layer: [0.0, 2.423978090286255, 0.37960007786750793]
optimal alpha/beta time: 0.2620565891265869
This batch time : update_bounds func: 0.2756	 prepare: 0.0073	 bound: 0.2623	 transfer: 0.0022	 finalize: 0.0036
Accumulated time: update_bounds func: 5.9583	 prepare: 0.1895	 bound: 5.6158	 transfer: 0.0022	 finalize: 0.1012
batch bounding time:  0.275831937789917
Current worst splitting domains [lb, ub] (depth):
[-0.08611, 97.428238] (20), [-0.07051, 97.428238] (20), [-0.06375, 97.428238] (20), [-0.05972, 97.428238] (20), [-0.05700, 97.428238] (20), [-0.05013, 97.428238] (20), [-0.03728, 97.428238] (20), [-0.02667, 97.428238] (20), [-0.01984, 97.428238] (20), [-0.01859, 97.428238] (20), [-0.01719, 97.428238] (20), [-0.01709, 97.428238] (20), [-0.01411, 97.428238] (20), [-0.00953, 97.428238] (20), [-0.00790, 97.428238] (20), [-0.00592, 97.428238] (20), [-0.00530, 97.428238] (20), [-0.00294, 97.428238] (20), 
length of domains: 18
Total time: 0.3055	 pickout: 0.0048	 decision: 0.0233	 get_bound: 0.2759	 add_domain: 0.0015
Current lb:-0.08610773086547852
1740 neurons visited
0 diving domains visited
Cumulative time: 8.609238624572754

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 422], [0, 2455], [0, 2455], [0, 2455], [1, 38], [1, 422], [1, 558], [1, 422], [0, 2455], [1, 571]]
single_node_split: True
regular batch size: 2*18, diving batch size 1*0
best_l after optimization: -0.9606751799583435 with beta sum per layer: [0.0, 0.46556779742240906, 0.2932581305503845]
optimal alpha/beta time: 0.25727152824401855
This batch time : update_bounds func: 0.2668	 prepare: 0.0052	 bound: 0.2575	 transfer: 0.0016	 finalize: 0.0024
Accumulated time: update_bounds func: 6.2251	 prepare: 0.1947	 bound: 5.8734	 transfer: 0.0016	 finalize: 0.1036
batch bounding time:  0.26691508293151855
Current worst splitting domains [lb, ub] (depth):
[-0.06944, 97.428238] (21), [-0.06329, 97.428238] (21), [-0.05964, 97.428238] (21), [-0.01900, 97.428238] (21), [-0.01824, 97.428238] (21), [-0.01710, 97.428238] (21), [-0.01518, 97.428238] (21), [-0.00946, 97.428238] (21), [-0.00760, 97.428238] (21), [-0.00318, 97.428238] (21), [-0.00064, 97.428238] (21), 
length of domains: 11
Total time: 0.2934	 pickout: 0.0034	 decision: 0.0221	 get_bound: 0.2670	 add_domain: 0.0010
Current lb:-0.06943750381469727
1776 neurons visited
0 diving domains visited
Cumulative time: 8.903065204620361

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 422], [2, 41], [1, 723], [1, 422], [1, 422], [1, 723], [1, 919], [2, 41], [1, 723], [1, 558]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: -0.5679755806922913 with beta sum per layer: [0.0, 0.27167046070098877, 0.059240929782390594]
optimal alpha/beta time: 0.2513706684112549
This batch time : update_bounds func: 0.2581	 prepare: 0.0039	 bound: 0.2516	 transfer: 0.0009	 finalize: 0.0016
Accumulated time: update_bounds func: 6.4832	 prepare: 0.1986	 bound: 6.1250	 transfer: 0.0009	 finalize: 0.1052
batch bounding time:  0.2582399845123291
Current worst splitting domains [lb, ub] (depth):
[-0.03299, 97.428238] (22), [-0.01706, 97.428238] (22), 
length of domains: 2
Total time: 0.2823	 pickout: 0.0023	 decision: 0.0214	 get_bound: 0.2583	 add_domain: 0.0003
Current lb:-0.03298759460449219
1798 neurons visited
0 diving domains visited
Cumulative time: 9.18576717376709

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 919], [1, 422]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.0980345606803894 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.009054183959960938
This batch time : update_bounds func: 0.0122	 prepare: 0.0020	 bound: 0.0093	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 6.4954	 prepare: 0.2006	 bound: 6.1343	 transfer: 0.0005	 finalize: 0.1055
batch bounding time:  0.012272357940673828
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0332	 pickout: 0.0010	 decision: 0.0199	 get_bound: 0.0123	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 9.21910309791565

Image 69 pidx 9 verify end, final lower bound 999, upper bound 97.42823791503906, time: 9.278393268585205
69 999
##### [0:69] Tested against 8 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 1.8631706237792969 with beta sum per layer: []
optimal alpha/beta time: 1.0264432430267334
alpha-CROWN with fixed intermediate bounds: tensor([[-1.8632]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-1.8631706237792969
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 83]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.6728019714355469 with beta sum per layer: [0.0, 0.0, 0.6077194809913635]
optimal alpha/beta time: 0.2460498809814453
This batch time : update_bounds func: 0.2486	 prepare: 0.0016	 bound: 0.2463	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.7441	 prepare: 0.2022	 bound: 6.3806	 transfer: 0.0005	 finalize: 0.1058
batch bounding time:  0.24876689910888672
Current worst splitting domains [lb, ub] (depth):
[-1.68278, 97.136826] (1), 
length of domains: 1
Total time: 0.2689	 pickout: 0.0008	 decision: 0.0193	 get_bound: 0.2488	 add_domain: 0.0001
Current lb:-1.6827805042266846
2 neurons visited
0 diving domains visited
Cumulative time: 1.311795949935913

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 5]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0
best_l after optimization: 1.9008733034133911 with beta sum per layer: [0.0, 0.0, 0.6256159543991089]
optimal alpha/beta time: 0.250446081161499
This batch time : update_bounds func: 0.2531	 prepare: 0.0016	 bound: 0.2507	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 6.9972	 prepare: 0.2038	 bound: 6.6313	 transfer: 0.0005	 finalize: 0.1061
batch bounding time:  0.2532382011413574
Current worst splitting domains [lb, ub] (depth):
[-1.44413, 97.136826] (2), [-0.45675, 97.136826] (2), 
length of domains: 2
Total time: 0.2734	 pickout: 0.0007	 decision: 0.0193	 get_bound: 0.2533	 add_domain: 0.0001
Current lb:-1.4441273212432861
4 neurons visited
0 diving domains visited
Cumulative time: 1.585296869277954

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47], [2, 47]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 0.5231592655181885 with beta sum per layer: [0.0, 0.0, 1.7363277673721313]
optimal alpha/beta time: 0.24690842628479004
This batch time : update_bounds func: 0.2499	 prepare: 0.0018	 bound: 0.2471	 transfer: 0.0006	 finalize: 0.0004
Accumulated time: update_bounds func: 7.2471	 prepare: 0.2056	 bound: 6.8784	 transfer: 0.0006	 finalize: 0.1064
batch bounding time:  0.2500336170196533
Current worst splitting domains [lb, ub] (depth):
[-1.33810, 97.136826] (3), [-0.26280, 97.136826] (3), 
length of domains: 2
Total time: 0.2708	 pickout: 0.0009	 decision: 0.0197	 get_bound: 0.2501	 add_domain: 0.0001
Current lb:-1.3380982875823975
8 neurons visited
0 diving domains visited
Cumulative time: 1.8562171459197998

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 85], [2, 81]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.2141954898834229 with beta sum per layer: [0.0, 0.0, 1.2972607612609863]
optimal alpha/beta time: 0.24471831321716309
This batch time : update_bounds func: 0.2477	 prepare: 0.0018	 bound: 0.2449	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 7.4948	 prepare: 0.2074	 bound: 7.1233	 transfer: 0.0005	 finalize: 0.1068
batch bounding time:  0.24782371520996094
Current worst splitting domains [lb, ub] (depth):
[-0.94893, 97.136826] (4), [-0.62188, 97.136826] (4), [-0.13312, 97.136826] (4), 
length of domains: 3
Total time: 0.2685	 pickout: 0.0009	 decision: 0.0196	 get_bound: 0.2478	 add_domain: 0.0002
Current lb:-0.9489288330078125
12 neurons visited
0 diving domains visited
Cumulative time: 2.124798536300659

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 81], [2, 81], [2, 85]]
single_node_split: True
regular batch size: 2*3, diving batch size 1*0
best_l after optimization: -0.14032602310180664 with beta sum per layer: [0.0, 0.0, 1.7124905586242676]
optimal alpha/beta time: 0.25171875953674316
This batch time : update_bounds func: 0.2550	 prepare: 0.0019	 bound: 0.2519	 transfer: 0.0006	 finalize: 0.0005
Accumulated time: update_bounds func: 7.7498	 prepare: 0.2093	 bound: 7.3753	 transfer: 0.0006	 finalize: 0.1073
batch bounding time:  0.2551276683807373
Current worst splitting domains [lb, ub] (depth):
[-0.84179, 97.136826] (5), [-0.52142, 97.136826] (5), 
length of domains: 2
Total time: 0.2764	 pickout: 0.0010	 decision: 0.0201	 get_bound: 0.2551	 add_domain: 0.0001
Current lb:-0.8417868614196777
18 neurons visited
0 diving domains visited
Cumulative time: 2.401329755783081

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 41], [2, 41]]
single_node_split: True
regular batch size: 2*2, diving batch size 1*0
best_l after optimization: 1.4088016748428345 with beta sum per layer: [0.0, 0.0, 0.25814223289489746]
optimal alpha/beta time: 0.24644994735717773
This batch time : update_bounds func: 0.2494	 prepare: 0.0018	 bound: 0.2467	 transfer: 0.0005	 finalize: 0.0004
Accumulated time: update_bounds func: 7.9992	 prepare: 0.2111	 bound: 7.6220	 transfer: 0.0005	 finalize: 0.1077
batch bounding time:  0.24955272674560547
Current worst splitting domains [lb, ub] (depth):
[-0.56013, 97.136826] (6), [-0.46186, 97.136826] (6), [-0.23813, 97.136826] (6), [-0.14868, 97.136826] (6), 
length of domains: 4
Total time: 0.2706	 pickout: 0.0009	 decision: 0.0200	 get_bound: 0.2496	 add_domain: 0.0002
Current lb:-0.5601317882537842
22 neurons visited
0 diving domains visited
Cumulative time: 2.672072649002075

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 571], [1, 571], [1, 613], [1, 927]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0
best_l after optimization: 1.6694567203521729 with beta sum per layer: [0.0, 0.3042892813682556, 0.5867418646812439]
optimal alpha/beta time: 0.25160789489746094
This batch time : update_bounds func: 0.2555	 prepare: 0.0022	 bound: 0.2519	 transfer: 0.0006	 finalize: 0.0008
Accumulated time: update_bounds func: 8.2547	 prepare: 0.2132	 bound: 7.8738	 transfer: 0.0006	 finalize: 0.1085
batch bounding time:  0.25565242767333984
Current worst splitting domains [lb, ub] (depth):
[-0.49543, 97.136826] (7), [-0.39990, 97.136826] (7), [-0.28972, 97.136826] (7), [-0.18226, 97.136826] (7), [-0.11141, 97.136826] (7), [-0.11048, 97.136826] (7), [-0.08868, 97.136826] (7), 
length of domains: 7
Total time: 0.2772	 pickout: 0.0012	 decision: 0.0199	 get_bound: 0.2557	 add_domain: 0.0004
Current lb:-0.4954254627227783
30 neurons visited
0 diving domains visited
Cumulative time: 2.949371576309204

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 613], [1, 603], [1, 613], [1, 603], [1, 416], [1, 416], [1, 603]]
single_node_split: True
regular batch size: 2*7, diving batch size 1*0
best_l after optimization: 1.661522626876831 with beta sum per layer: [0.0, 0.6276137828826904, 1.0766710042953491]
optimal alpha/beta time: 0.2501213550567627
This batch time : update_bounds func: 0.2549	 prepare: 0.0028	 bound: 0.2504	 transfer: 0.0007	 finalize: 0.0009
Accumulated time: update_bounds func: 8.5096	 prepare: 0.2160	 bound: 8.1242	 transfer: 0.0007	 finalize: 0.1094
batch bounding time:  0.25503969192504883
Current worst splitting domains [lb, ub] (depth):
[-0.37178, 97.136826] (8), [-0.36121, 97.136826] (8), [-0.32653, 97.136826] (8), [-0.22818, 97.136826] (8), [-0.16239, 97.136826] (8), [-0.14840, 97.136826] (8), [-0.10553, 97.136826] (8), [-0.03112, 97.136826] (8), [-0.02597, 97.136826] (8), [-0.01290, 97.136826] (8), [-0.00610, 97.136826] (8), 
length of domains: 11
Total time: 0.2783	 pickout: 0.0016	 decision: 0.0209	 get_bound: 0.2551	 add_domain: 0.0007
Current lb:-0.3717799186706543
44 neurons visited
0 diving domains visited
Cumulative time: 3.2278242111206055

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 72], [1, 72], [1, 908], [1, 908], [1, 72], [1, 72], [1, 908], [1, 908], [1, 908], [1, 908]]
single_node_split: True
regular batch size: 2*11, diving batch size 1*0
best_l after optimization: 0.9341363310813904 with beta sum per layer: [0.0, 1.5296001434326172, 1.5657823085784912]
optimal alpha/beta time: 0.25095701217651367
This batch time : update_bounds func: 0.2571	 prepare: 0.0035	 bound: 0.2512	 transfer: 0.0008	 finalize: 0.0015
Accumulated time: update_bounds func: 8.7667	 prepare: 0.2196	 bound: 8.3754	 transfer: 0.0008	 finalize: 0.1109
batch bounding time:  0.2572600841522217
Current worst splitting domains [lb, ub] (depth):
[-0.27367, 97.136826] (9), [-0.25449, 97.136826] (9), [-0.25018, 97.136826] (9), [-0.23495, 97.136826] (9), [-0.23132, 97.136826] (9), [-0.16743, 97.136826] (9), [-0.11050, 97.136826] (9), [-0.05598, 97.136826] (9), [-0.04973, 97.136826] (9), [-0.03035, 97.136826] (9), [-0.02753, 97.136826] (9), [-0.01229, 97.136826] (9), [-0.00284, 97.136826] (9), [-0.00216, 97.136826] (9), 
length of domains: 14
Total time: 0.2820	 pickout: 0.0022	 decision: 0.0218	 get_bound: 0.2573	 add_domain: 0.0008
Current lb:-0.27367448806762695
66 neurons visited
0 diving domains visited
Cumulative time: 3.510054349899292

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 927], [1, 908], [1, 908], [1, 908], [1, 908], [1, 927], [1, 613], [1, 613], [1, 908], [1, 908]]
single_node_split: True
regular batch size: 2*14, diving batch size 1*0
best_l after optimization: -0.22165191173553467 with beta sum per layer: [0.0, 2.642587900161743, 1.2893412113189697]
optimal alpha/beta time: 0.2543339729309082
This batch time : update_bounds func: 0.2616	 prepare: 0.0043	 bound: 0.2546	 transfer: 0.0008	 finalize: 0.0018
Accumulated time: update_bounds func: 9.0283	 prepare: 0.2238	 bound: 8.6300	 transfer: 0.0008	 finalize: 0.1127
batch bounding time:  0.26178574562072754
Current worst splitting domains [lb, ub] (depth):
[-0.21702, 97.136826] (10), [-0.21647, 97.136826] (10), [-0.19616, 97.136826] (10), [-0.18546, 97.136826] (10), [-0.16539, 97.136826] (10), [-0.11062, 97.136826] (10), [-0.07590, 97.136826] (10), [-0.03237, 97.136826] (10), [-0.02230, 97.136826] (10), [-0.01613, 97.136826] (10), [-0.01121, 97.136826] (10), [-0.00261, 97.136826] (10), 
length of domains: 12
Total time: 0.2874	 pickout: 0.0026	 decision: 0.0223	 get_bound: 0.2618	 add_domain: 0.0007
Current lb:-0.21701622009277344
94 neurons visited
0 diving domains visited
Cumulative time: 3.797774314880371

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79], [2, 79]]
single_node_split: True
regular batch size: 2*12, diving batch size 1*0
best_l after optimization: -1.6846601963043213 with beta sum per layer: [0.0, 1.296008825302124, 0.7705415487289429]
optimal alpha/beta time: 0.2460184097290039
This batch time : update_bounds func: 0.2525	 prepare: 0.0037	 bound: 0.2463	 transfer: 0.0008	 finalize: 0.0016
Accumulated time: update_bounds func: 9.2808	 prepare: 0.2275	 bound: 8.8763	 transfer: 0.0008	 finalize: 0.1143
batch bounding time:  0.25260043144226074
Current worst splitting domains [lb, ub] (depth):
[-0.15021, 97.136826] (11), [-0.14733, 97.136826] (11), [-0.13177, 97.136826] (11), [-0.11576, 97.136826] (11), [-0.09802, 97.136826] (11), [-0.03975, 97.136826] (11), 
length of domains: 6
Total time: 0.2764	 pickout: 0.0023	 decision: 0.0211	 get_bound: 0.2526	 add_domain: 0.0004
Current lb:-0.1502089500427246
118 neurons visited
0 diving domains visited
Cumulative time: 4.074477672576904

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 92], [2, 92], [2, 92], [2, 92], [2, 92], [2, 92]]
single_node_split: True
regular batch size: 2*6, diving batch size 1*0
best_l after optimization: -3.2079262733459473 with beta sum per layer: [0.0, 0.070948027074337, 0.45468151569366455]
optimal alpha/beta time: 0.24816417694091797
This batch time : update_bounds func: 0.2526	 prepare: 0.0026	 bound: 0.2484	 transfer: 0.0007	 finalize: 0.0008
Accumulated time: update_bounds func: 9.5334	 prepare: 0.2302	 bound: 9.1247	 transfer: 0.0007	 finalize: 0.1152
batch bounding time:  0.25272369384765625
Current worst splitting domains [lb, ub] (depth):
[-0.10264, 97.136826] (12), [-0.09987, 97.136826] (12), [-0.08817, 97.136826] (12), [-0.07036, 97.136826] (12), [-0.05543, 97.136826] (12), 
length of domains: 5
Total time: 0.2748	 pickout: 0.0015	 decision: 0.0202	 get_bound: 0.2528	 add_domain: 0.0004
Current lb:-0.10263800621032715
130 neurons visited
0 diving domains visited
Cumulative time: 4.349423885345459

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 603], [1, 613], [1, 603], [1, 16], [1, 16]]
single_node_split: True
regular batch size: 2*5, diving batch size 1*0
best_l after optimization: -0.14162838459014893 with beta sum per layer: [0.0, 0.0, 0.22311659157276154]
optimal alpha/beta time: 0.2481980323791504
This batch time : update_bounds func: 0.2524	 prepare: 0.0024	 bound: 0.2484	 transfer: 0.0006	 finalize: 0.0009
Accumulated time: update_bounds func: 9.7858	 prepare: 0.2326	 bound: 9.3731	 transfer: 0.0006	 finalize: 0.1160
batch bounding time:  0.2525763511657715
Current worst splitting domains [lb, ub] (depth):
[-0.02975, 97.136826] (13), [-0.02652, 97.136826] (13), [-0.01910, 97.136826] (13), [-0.01275, 97.136826] (13), 
length of domains: 4
Total time: 0.2744	 pickout: 0.0013	 decision: 0.0201	 get_bound: 0.2526	 add_domain: 0.0003
Current lb:-0.029752731323242188
140 neurons visited
0 diving domains visited
Cumulative time: 4.623930931091309

remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[1, 16], [1, 603], [1, 16], [1, 603]]
single_node_split: True
regular batch size: 2*4, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -0.5598382949829102 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008955955505371094
This batch time : update_bounds func: 0.0126	 prepare: 0.0023	 bound: 0.0092	 transfer: 0.0006	 finalize: 0.0006
Accumulated time: update_bounds func: 9.7985	 prepare: 0.2349	 bound: 9.3823	 transfer: 0.0006	 finalize: 0.1166
batch bounding time:  0.012679576873779297
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0339	 pickout: 0.0012	 decision: 0.0199	 get_bound: 0.0127	 add_domain: 0.0001
No domains left, verification finished!
Cumulative time: 4.657959699630737

Image 69 pidx 8 verify end, final lower bound 999, upper bound 97.13682556152344, time: 4.716399908065796
69 999
##### [0:69] Tested against 4 ######
Model prediction is: tensor([[ -3.7638,  -6.5174,  -4.7464,  -2.7490,  -0.8870,  -4.4974, -11.8775,
           5.7896,  -0.5153,   2.6719]], device='cuda:0',
       grad_fn=<AddBackward0>)
alpha-CROWN optimizable variables initialized.
setting alpha for layer /10 start_node /11
setting alpha for layer /10 start_node /21
not setting layer /10 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 16, 14, 14]) != torch.Size([2, 9, 1, 16, 14, 14]))
setting alpha for layer /12 start_node /21
not setting layer /12 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 32, 7, 7]) != torch.Size([2, 9, 1, 32, 7, 7]))
not setting layer /22 start_node /23 because shape mismatch (torch.Size([2, 1, 1, 100]) != torch.Size([2, 9, 1, 100]))
0 /9 torch.Size([1, 16, 14, 14])
1 /11 torch.Size([1, 32, 7, 7])
2 /21 torch.Size([1, 100])
best_l after optimization: 0.03995323181152344 with beta sum per layer: []
optimal alpha/beta time: 1.0140612125396729
alpha-CROWN with fixed intermediate bounds: tensor([[-0.0400]], device='cuda:0', grad_fn=<AsStridedBackward>) None
-0.03995323181152344
layer 0 size torch.Size([3136]) unstable 1172
layer 1 size torch.Size([1568]) unstable 159
layer 2 size torch.Size([100]) unstable 18
# of unstable neurons: 1349
remaining dive domains: 0/-1, dive_rate:0.0
splitting decisions: [[2, 47]]
single_node_split: True
regular batch size: 2*1, diving batch size 1*0

all verified at 0th iter
best_l after optimization: -1.0523722171783447 with beta sum per layer: [0.0, 0.0, 0.0]
optimal alpha/beta time: 0.008895397186279297
This batch time : update_bounds func: 0.0114	 prepare: 0.0016	 bound: 0.0091	 transfer: 0.0005	 finalize: 0.0003
Accumulated time: update_bounds func: 9.8099	 prepare: 0.2364	 bound: 9.3914	 transfer: 0.0005	 finalize: 0.1169
batch bounding time:  0.0114898681640625
Current worst splitting domains [lb, ub] (depth):

length of domains: 0
Total time: 0.0317	 pickout: 0.0008	 decision: 0.0194	 get_bound: 0.0115	 add_domain: 0.0000
No domains left, verification finished!
Cumulative time: 1.062148094177246

Image 69 pidx 4 verify end, final lower bound 999, upper bound 98.96004486083984, time: 1.1203076839447021
69 999
##### [0:69] Tested against 3 ######
Initial alpha-CROWN verified for label 3 with bound 0.3949403762817383
Image 69 pidx 3 verify end, final lower bound 0.3949403762817383, upper bound inf, time: 0.0005552768707275391
69 0.3949403762817383
##### [0:69] Tested against 0 ######
Initial alpha-CROWN verified for label 0 with bound 1.1497211456298828
Image 69 pidx 0 verify end, final lower bound 1.1497211456298828, upper bound inf, time: 0.0004985332489013672
69 1.1497211456298828
##### [0:69] Tested against 5 ######
Initial alpha-CROWN verified for label 5 with bound 0.2931690216064453
Image 69 pidx 5 verify end, final lower bound 0.2931690216064453, upper bound inf, time: 0.0005116462707519531
69 0.2931690216064453
##### [0:69] Tested against 2 ######
Initial alpha-CROWN verified for label 2 with bound 2.177354097366333
Image 69 pidx 2 verify end, final lower bound 2.177354097366333, upper bound inf, time: 0.0005044937133789062
69 2.177354097366333
##### [0:69] Tested against 1 ######
Initial alpha-CROWN verified for label 1 with bound 2.7644100189208984
Image 69 pidx 1 verify end, final lower bound 2.7644100189208984, upper bound inf, time: 0.0005006790161132812
69 2.7644100189208984
##### [0:69] Tested against 6 ######
Initial alpha-CROWN verified for label 6 with bound 3.9427428245544434
Image 69 pidx 6 verify end, final lower bound 3.9427428245544434, upper bound inf, time: 0.0004954338073730469
69 3.9427428245544434
##### [0:69] Tested against 7 ######
correct label, skip!
[[  69.            0.            0.            0.81513929    0.
    -3.                   inf           inf]
 [  69.            0.            0.            6.53552604    0.
    -1.                   inf           inf]
 [  69.          999.         1802.            9.27839327    0.
     9.           97.42823792    0.62520194]
 [  69.          999.          148.            4.71639991    0.
     8.           97.13682556    2.6471436 ]
 [  69.          999.            2.            1.12030768    0.
     4.           98.96004486    3.57266712]
 [  69.            0.39494038    0.            0.00055528    0.
     3.                   inf    5.04596519]
 [  69.            1.14972115    0.            0.00049853    0.
     0.                   inf    6.56765842]
 [  69.            0.29316902    0.            0.00051165    0.
     5.                   inf    6.60167408]
 [  69.            2.1773541     0.            0.00050449    0.
     2.                   inf    7.55416918]
 [  69.            2.76441002    0.            0.00050068    0.
     1.                   inf    8.61511898]
 [  69.            3.94274282    0.            0.00049543    0.
     6.                   inf   12.8769474 ]
 [  69.            0.            0.            0.            0.
     7.                   inf           inf]]
final verified acc: 100.0%[1]
Total verification count: 1 total verified: 1
mean time [cnt:1] (excluding attack success): 21.653692960739136

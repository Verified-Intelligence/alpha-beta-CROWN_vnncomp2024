/home/zhouxingshi/Verifier_Development/complete_verifier/abcrown.py:111: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  c = torch.tensor(specs[0][0]).unsqueeze(0).to(data)
Configurations:

general:
  device: cuda
  seed: 100
  conv_mode: patches
  deterministic: false
  double_fp: false
  loss_reduction_func: sum
  sparse_alpha: true
  sparse_interm: true
  save_adv_example: false
  eval_adv_example: false
  show_adv_example: false
  precompile_jit: false
  complete_verifier: bab
  enable_incomplete_verification: true
  csv_name: null
  results_file: out.txt
  root_path: ''
  deterministic_opt: false
  graph_optimizer: 'Customized("custom_graph_optimizer", "default_optimizer")'
  buffer_has_batchdim: false
  save_output: true
  output_file: /home/zhouxingshi/Verifier_Development/tests/gpu_tests/gcp_crown/oval_wide_cplex/master_outputs/3.pkl
  return_optimized_model: false
model:
  name: cifar_model_wide
  path: models/oval/cifar_wide.pth
  onnx_path: null
  onnx_path_prefix: ''
  cache_onnx_conversion: false
  debug_onnx: false
  onnx_quirks: null
  input_shape: null
  onnx_loader: default_onnx_and_vnnlib_loader
  onnx_optimization_flags: none
  onnx_vnnlib_joint_optimization_flags: none
  check_optmized: false
  flatten_final_output: false
  optimize_graph: null
  with_jacobian: false
data:
  start: 89
  end: 90
  select_instance: null
  num_outputs: 10
  mean: [0.485, 0.456, 0.406]
  std: [0.225, 0.225, 0.225]
  pkl_path: models/oval/wide_100.pkl
  dataset: CIFAR
  data_filter_path: null
  data_idx_file: null
specification:
  type: lp
  robustness_type: specify-target
  norm: .inf
  epsilon: null
  epsilon_min: 0.0
  vnnlib_path: null
  vnnlib_path_prefix: ''
  rhs_offset: null
solver:
  batch_size: 1024
  auto_enlarge_batch_size: false
  min_batch_size_ratio: 0.1
  use_float64_in_last_iteration: false
  early_stop_patience: 10
  start_save_best: 0.5
  bound_prop_method: alpha-crown
  init_bound_prop_method: same
  prune_after_crown: false
  optimize_disjuncts_separately: false
  crown:
    batch_size: 1000000000
    max_crown_size: 1000000000
    relu_option: adaptive
  alpha-crown:
    alpha: true
    lr_alpha: 0.1
    iteration: 100
    share_alphas: false
    lr_decay: 0.98
    full_conv_alpha: true
    max_coeff_mul: .inf
    matmul_share_alphas: false
    disable_optimization: []
  invprop:
    apply_output_constraints_to: []
    tighten_input_bounds: false
    best_of_oc_and_no_oc: false
    directly_optimize: []
    oc_lr: 0.1
    share_gammas: false
  beta-crown:
    lr_alpha: 0.01
    lr_beta: 0.03
    lr_decay: 0.96
    optimizer: adam
    iteration: 20
    beta: true
    beta_warmup: true
    enable_opt_interm_bounds: false
    all_node_split_LP: false
  forward:
    refine: false
    dynamic: false
    max_dim: 10000
    reset_threshold: 1.0
  intermediate_refinement:
    enabled: false
    batch_size: 10
    opt_coeffs: false
    opt_bias: false
    lr: 0.05
    layers: [-1]
    max_domains: 1000
  multi_class:
    label_batch_size: 32
    skip_with_refined_bound: true
  mip:
    parallel_solvers: null
    solver_threads: 1
    refine_neuron_timeout: 15
    refine_neuron_time_percentage: 0.8
    early_stop: true
    adv_warmup: true
    mip_solver: gurobi
    skip_unsafe: false
bab:
  initial_max_domains: 1
  max_domains: .inf
  decision_thresh: 0
  timeout: 3600
  timeout_scale: 1
  max_iterations: -1
  override_timeout: null
  get_upper_bound: false
  pruning_in_iteration: true
  pruning_in_iteration_ratio: 0.2
  sort_targets: false
  batched_domain_list: true
  optimized_interm: ''
  interm_transfer: true
  recompute_interm: false
  sort_domain_interval: -1
  vanilla_crown: false
  cut:
    enabled: true
    implication: false
    bab_cut: true
    lp_cut: false
    method: null
    lr: 0.01
    lr_decay: 0.8
    iteration: 200
    bab_iteration: 50
    early_stop_patience: -1
    lr_beta: 0.01
    number_cuts: 50
    topk_cuts_in_filter: 1000
    batch_size_primal: 100
    max_num: 1000000000
    patches_cut: false
    cplex_cuts: true
    cplex_cuts_wait: 0
    cplex_cuts_revpickup: true
    cut_reference_bounds: true
    fix_intermediate_bounds: false
    _tmp_cuts: null
    fixed_cuts: false
    add_implied_cuts: false
    add_input_cuts: false
  branching:
    method: kfsb
    candidates: 10
    reduceop: min
    enable_intermediate_bound_opt: false
    branching_input_and_activation: false
    branching_input_and_activation_order: [input, relu]
    branching_input_iterations: 30
    branching_relu_iterations: 50
    nonlinear_split:
      method: shortcut
      branching_point_method: uniform
      num_branches: 2
      filter: false
      filter_beta: false
      filter_batch_size: 10000
      filter_iterations: 25
      use_min: false
      loose_tanh_threshold: null
      dynamic_bbps: false
      dynamic_options: [uniform, three_left, three_right]
      branching_point_node: ''
      branching_point_db: []
    input_split:
      enable: false
      enhanced_bound_prop_method: alpha-crown
      enhanced_branching_method: naive
      enhanced_bound_patience: 100000000.0
      attack_patience: 100000000.0
      adv_check: 0
      split_partitions: 2
      sb_margin_weight: 1.0
      sb_sum: false
      bf_backup_thresh: -1
      bf_rhs_offset: 0
      bf_iters: 1000000000.0
      bf_batch_size: 100000
      bf_zero_crossing_score: false
      touch_zero_score: 0
      ibp_enhancement: false
      catch_assertion: false
      compare_with_old_bounds: false
      update_rhs_with_attack: false
      sb_coeff_thresh: 0.001
      sort_index: null
      sort_descending: true
      show_progress: false
  attack:
    enabled: false
    beam_candidates: 8
    beam_depth: 7
    max_dive_fix_ratio: 0.8
    min_local_free_ratio: 0.2
    mip_start_iteration: 5
    mip_timeout: 30.0
    adv_pool_threshold: null
    refined_mip_attacker: false
    refined_batch_size: null
attack:
  pgd_order: skip
  pgd_steps: 100
  pgd_restarts: 30
  pgd_batch_size: 100000000
  pgd_early_stop: true
  pgd_lr_decay: 0.99
  pgd_alpha: auto
  pgd_alpha_scale: false
  pgd_loss_mode: null
  enable_mip_attack: false
  adv_saver: default_adv_saver
  early_stop_condition: default_early_stop_condition
  adv_example_finalizer: default_adv_example_finalizer
  pgd_loss: default_pgd_loss
  cex_path: ./test_cex.txt
  attack_mode: PGD
  attack_tolerance: 0.0
  attack_func: attack_with_general_specs
  gama_lambda: 10.0
  gama_decay: 0.9
  check_clean: false
  input_split:
    pgd_steps: 100
    pgd_restarts: 30
    pgd_alpha: auto
  input_split_enhanced:
    pgd_steps: 200
    pgd_restarts: 500000
    pgd_alpha: auto
  input_split_check_adv:
    pgd_steps: 5
    pgd_restarts: 5
    pgd_alpha: auto
    max_num_domains: 10
debug:
  view_model: false
  lp_test: null
  rescale_vnnlib_ptb: null
  test_optimized_bounds: false
  test_optimized_bounds_after_n_iterations: 0
  print_verbose_decisions: false

Experiments at Thu Apr 11 12:44:50 2024 on valla.cs.ucla.edu
Sequential(
  (0): Conv2d(3, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (1): ReLU()
  (2): Conv2d(16, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (3): ReLU()
  (4): Flatten(start_dim=1, end_dim=-1)
  (5): Linear(in_features=2048, out_features=100, bias=True)
  (6): ReLU()
  (7): Linear(in_features=100, out_features=10, bias=True)
)
Parameters:
  0.weight: shape torch.Size([16, 3, 4, 4])
  0.bias: shape torch.Size([16])
  2.weight: shape torch.Size([32, 16, 4, 4])
  2.bias: shape torch.Size([32])
  5.weight: shape torch.Size([100, 2048])
  5.bias: shape torch.Size([100])
  7.weight: shape torch.Size([10, 100])
  7.bias: shape torch.Size([10])
Files already downloaded and verified
Overwrite epsilon that saved in .pkl file, they should be after normalized!
Internal results will be saved to out.txt.

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% idx: 0, vnnlib ID: 89 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Model: BoundedModule(
  (/input.1): BoundInput(name=/input.1, inputs=[], perturbed=True)
  (/1): BoundParams(name=/1, inputs=[], perturbed=False)
  (/2): BoundParams(name=/2, inputs=[], perturbed=False)
  (/3): BoundParams(name=/3, inputs=[], perturbed=False)
  (/4): BoundParams(name=/4, inputs=[], perturbed=False)
  (/5): BoundParams(name=/5, inputs=[], perturbed=False)
  (/6): BoundParams(name=/6, inputs=[], perturbed=False)
  (/7): BoundParams(name=/7, inputs=[], perturbed=False)
  (/8): BoundParams(name=/8, inputs=[], perturbed=False)
  (/input): BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True)
  (/input.4): BoundRelu(name=/input.4, inputs=[/input], perturbed=True)
  (/input.8): BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True)
  (/12): BoundRelu(name=/12, inputs=[/input.8], perturbed=True)
  (/13): BoundFlatten(name=/13, inputs=[/12], perturbed=True)
  (/input.12): BoundLinear(name=/input.12, inputs=[/13, /5, /6], perturbed=True)
  (/15): BoundRelu(name=/15, inputs=[/input.12], perturbed=True)
  (/16): BoundLinear(name=/16, inputs=[/15, /7, /8], perturbed=True)
)
Original output: tensor([[ 0.68757623,  2.27914310, -0.18833995, -1.39834094, -0.09461196,
         -1.34401011,  0.01063116, -1.75955629,  0.76542842,  1.04207742]],
       device='cuda:0')
Split layers:
  BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True): [(BoundRelu(name=/input.4, inputs=[/input], perturbed=True), 0)]
  BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True): [(BoundRelu(name=/12, inputs=[/input.8], perturbed=True), 0)]
  BoundLinear(name=/input.12, inputs=[/13, /5, /6], perturbed=True): [(BoundRelu(name=/15, inputs=[/input.12], perturbed=True), 0)]
Nonlinear functions:
   BoundRelu(name=/input.4, inputs=[/input], perturbed=True)
   BoundRelu(name=/12, inputs=[/input.8], perturbed=True)
   BoundRelu(name=/15, inputs=[/input.12], perturbed=True)
layer /input.4 using sparse-features alpha with shape [612]; unstable size 612; total size 4096 ([1, 16, 16, 16])
layer /input.4 start_node /input.8 using sparse-spec alpha [2, 269, 1, 612] with unstable size 268 total_size 2048 output_shape (32, 8, 8)
layer /input.4 start_node /input.12 using sparse-spec alpha [2, 32, 1, 612] with unstable size 31 total_size 100 output_shape torch.Size([100])
layer /input.4 start_node /16 using full alpha [2, 1, 1, 612] with unstable size None total_size 1 output_shape 1
layer /12 using sparse-features alpha with shape [268]; unstable size 268; total size 2048 ([1, 32, 8, 8])
layer /12 start_node /input.12 using sparse-spec alpha [2, 32, 1, 268] with unstable size 31 total_size 100 output_shape torch.Size([100])
layer /12 start_node /16 using full alpha [2, 1, 1, 268] with unstable size None total_size 1 output_shape 1
layer /15 using sparse-features alpha with shape [31]; unstable size 31; total size 100 ([1, 100])
layer /15 start_node /16 using full alpha [2, 1, 1, 31] with unstable size None total_size 1 output_shape 1
Optimizable variables initialized.
initial CROWN bounds: tensor([[-0.79606342]], device='cuda:0') None
best_l after optimization: -0.6379709243774414
alpha/beta optimization time: 8.317240953445435
initial alpha-crown bounds: tensor([[-0.63797092]], device='cuda:0')
Worst class: (+ rhs) -0.6379709243774414
preset mip_multi_proc as default setting: 40
Set parameter WLSAccessID
Set parameter WLSSecret
Set parameter LicenseID to value 2482314
Academic license 2482314 - for non-commercial use only - registered to z.___@g.ucla.edu
mip_multi_proc: 40, mip_threads: 1, total threads used: 40
mip solver model built in 1.8627 seconds.
lower bounds for all target labels: [-0.6379709243774414]
Starting MIP solver for these labels: [0]
start creating model mps for candidates: ['lay/16_0']
Total VNNLIB file length: 1, max property batch size: 1, total number of batches: 1
lA shape: [torch.Size([1, 1, 16, 16, 16]), torch.Size([1, 1, 32, 8, 8]), torch.Size([1, 1, 100])]

Properties batch 0, size 1
Remaining timeout: 3589.155544281006
##### Instance 0 first 10 spec matrices: 
tensor([[[-1.,  1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.]]])
thresholds: tensor([0.], device='cuda:0') ######
Model prediction is: tensor([ 0.68757623,  2.27914310, -0.18833995, -1.39834094, -0.09461196,
        -1.34401011,  0.01063116, -1.75955629,  0.76542842,  1.04207742],
       device='cuda:0')
build_with_refined_bounds batch [1/1]
setting alpha for layer /input.4 start_node /16 with alignment adjustment
setting alpha for layer /12 start_node /16 with alignment adjustment
setting alpha for layer /15 start_node /16 with alignment adjustment
all alpha initialized
directly get lb and ub from refined bounds
c shape: torch.Size([1, 1, 10])
lA shapes: [torch.Size([1, 1, 16, 16, 16]), torch.Size([1, 1, 32, 8, 8]), torch.Size([1, 1, 100])]
(alpha-)CROWN with fixed intermediate bounds: tensor([[-0.63797092]], device='cuda:0') tensor([[inf]], device='cuda:0')
Intermediate layers: /input,/input.8,/input.12,/16
Keeping alphas for these layers: ['/16']
Keeping alphas for these layers: ['/16']
Node /input.4 input 0: size torch.Size([16, 16, 16]) unstable 612
Node /12 input 0: size torch.Size([32, 8, 8]) unstable 260
Node /15 input 0: size torch.Size([100]) unstable 31
-----------------
# of unstable neurons: 903
-----------------

======================Cut verification begins======================
Fetch cut process: mps for current label is not ready yet
Cut time: 0.0009334087371826172
======================Cut verification ends======================
BaB round 1
Fetch cut process: mps for current label is not ready yet
batch: 1
splitting decisions: 
split level 0: [/input.12, 85] 
split level 1: [/input.12, 43] 
split level 2: [/input.12, 31] 
split level 3: [/input.12, 10] 
split level 4: [/input.12, 98] 
split level 5: [/input.12, 89] 
pruning_in_iteration open status: True
ratio of positive domain = 49 / 64 = 0.765625
pruning-in-iteration extra time: 0.012734174728393555
Time: prepare 0.0068    bound 0.5049    transfer 0.0017    finalize 0.0072    func 0.5206    
Accumulated time: func 0.5206    prepare 0.0081    bound 0.5049    transfer 0.0017    finalize 0.0072    
Current worst splitting domains lb-rhs (depth):
-0.20181 (6), -0.19539 (6), -0.18656 (6), -0.17203 (6), -0.17094 (6), -0.16612 (6), -0.15325 (6), -0.15112 (6), -0.04231 (6), -0.03854 (6), -0.03421 (6), -0.03162 (6), -0.01973 (6), -0.01123 (6), -0.00528 (6), 
Length of domains: 15
Time: pickout 0.0014    decision 0.1388    set_bounds 0.0113    solve 0.5207    add 0.0023    
Accumulated time: pickout 0.0014    decision 0.1388    set_bounds 0.0113    solve 0.5207    add 0.0023    
Current (lb-rhs): -0.20180511474609375
15 domains visited
Cumulative time: 0.7318620681762695

BaB round 2
Fetch cut process: mps for current label is not ready yet
batch: 15
splitting decisions: 
split level 0: [/input.12, 6] [/input.12, 34] [/input.12, 6] [/input.12, 34] [/input.12, 6] [/input.12, 6] [/input.12, 6] [/input.12, 34] [/input.12, 6] [/input.12, 34] 
split level 1: [/input.12, 34] [/input.12, 6] [/input.12, 34] [/input.12, 6] [/input.12, 34] [/input.12, 34] [/input.12, 34] [/input.12, 6] [/input.12, 34] [/input.12, 6] 
pruning_in_iteration open status: True
ratio of positive domain = 45 / 60 = 0.75
pruning-in-iteration extra time: 0.01255345344543457
Time: prepare 0.0078    bound 0.2783    transfer 0.0006    finalize 0.0043    func 0.2910    
Accumulated time: func 0.8116    prepare 0.0172    bound 0.7831    transfer 0.0023    finalize 0.0115    
Current worst splitting domains lb-rhs (depth):
-0.14807 (8), -0.14117 (8), -0.13035 (8), -0.11502 (8), -0.11169 (8), -0.10769 (8), -0.09470 (8), -0.09114 (8), -0.03389 (8), -0.03080 (8), -0.02739 (8), -0.01980 (8), -0.01539 (8), -0.00465 (8), -0.00329 (8), 
Length of domains: 15
Time: pickout 0.0012    decision 0.0730    set_bounds 0.0063    solve 0.2911    add 0.0020    
Accumulated time: pickout 0.0026    decision 0.2118    set_bounds 0.0175    solve 0.8117    add 0.0043    
Current (lb-rhs): -0.1480722427368164
30 domains visited
Cumulative time: 1.106196641921997

BaB round 3
Fetch cut process: mps for current label is not ready yet
batch: 15
splitting decisions: 
split level 0: [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] [/input.12, 66] 
split level 1: [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] [/input.12, 50] 
pruning_in_iteration open status: True
ratio of positive domain = 52 / 60 = 0.8666666666666667
pruning-in-iteration extra time: 0.012526273727416992
Time: prepare 0.0078    bound 0.2757    transfer 0.0007    finalize 0.0043    func 0.2884    
Accumulated time: func 1.1000    prepare 0.0262    bound 1.0588    transfer 0.0029    finalize 0.0158    
Current worst splitting domains lb-rhs (depth):
-0.10846 (10), -0.10091 (10), -0.09020 (10), -0.07448 (10), -0.07052 (10), -0.06642 (10), -0.05243 (10), -0.04926 (10), 
Length of domains: 8
Time: pickout 0.0011    decision 0.0719    set_bounds 0.0063    solve 0.2885    add 0.0016    
Accumulated time: pickout 0.0037    decision 0.2837    set_bounds 0.0238    solve 1.1002    add 0.0059    
Current (lb-rhs): -0.10846376419067383
38 domains visited
Cumulative time: 1.4763462543487549

BaB round 4
Fetch cut process: mps for current label is not ready yet
batch: 8
splitting decisions: 
split level 0: [/input.12, 59] [/input.12, 59] [/input.12, 59] [/input.12, 59] [/input.12, 59] [/input.12, 59] [/input.12, 59] [/input.12, 59] 
split level 1: [/input.12, 88] [/input.12, 88] [/input.12, 88] [/input.12, 88] [/input.12, 88] [/input.12, 88] [/input.12, 88] [/input.12, 88] 
split level 2: [/input.8, 820] [/input.8, 793] [/input.8, 793] [/input.8, 793] [/input.8, 820] [/input.8, 793] [/input.8, 793] [/input.8, 793] 
pruning_in_iteration open status: True
ratio of positive domain = 48 / 64 = 0.75
pruning-in-iteration extra time: 0.011954307556152344
Time: prepare 0.0145    bound 0.2759    transfer 0.0007    finalize 0.0063    func 0.2974    
Accumulated time: func 1.3974    prepare 0.0420    bound 1.3347    transfer 0.0036    finalize 0.0221    
Current worst splitting domains lb-rhs (depth):
-0.08939 (13), -0.08880 (13), -0.08156 (13), -0.08046 (13), -0.06979 (13), -0.06965 (13), -0.05443 (13), -0.05371 (13), -0.04900 (13), -0.04896 (13), -0.04577 (13), -0.04546 (13), -0.03190 (13), -0.03114 (13), -0.02896 (13), -0.02636 (13), 
Length of domains: 16
Time: pickout 0.0011    decision 0.0707    set_bounds 0.0086    solve 0.2975    add 0.0021    
Accumulated time: pickout 0.0048    decision 0.3544    set_bounds 0.0324    solve 1.3977    add 0.0080    
Current (lb-rhs): -0.08939075469970703
54 domains visited
Cumulative time: 1.8571372032165527

BaB round 5
Fetch cut process: mps for current label is not ready yet
batch: 16
splitting decisions: 
split level 0: [/input.8, 793] [/input.8, 820] [/input.8, 820] [/input.8, 820] [/input.8, 1449] [/input.8, 1449] [/input.8, 820] [/input.8, 1449] [/input.8, 793] [/input.8, 820] 
split level 1: [/input.8, 533] [/input.8, 533] [/input.8, 533] [/input.8, 533] [/input.8, 793] [/input.8, 820] [/input.8, 1449] [/input.8, 417] [/input.8, 533] [/input.8, 533] 
pruning_in_iteration open status: False
ratio of positive domain = 0 / 64 = 0.0
pruning-in-iteration extra time: 0.00011968612670898438
Time: prepare 0.0143    bound 0.2287    transfer 0.0005    finalize 0.0057    func 0.2494    
Accumulated time: func 1.6468    prepare 0.0576    bound 1.5634    transfer 0.0041    finalize 0.0278    
Current worst splitting domains lb-rhs (depth):
-0.07847 (15), -0.07788 (15), -0.07781 (15), -0.07722 (15), -0.07307 (15), -0.07248 (15), -0.07241 (15), -0.07182 (15), -0.07086 (15), -0.07004 (15), -0.06976 (15), -0.06894 (15), -0.06590 (15), -0.06509 (15), -0.06480 (15), -0.06398 (15), -0.05755 (15), parallel save mip model to /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.mps
/home/zhouxingshi/Verifier_Development/complete_verifier/lp_mip_solver.py:1120: ResourceWarning: unclosed file <_io.TextIOWrapper name='/home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.log' mode='w' encoding='ANSI_X3.4-1968'>
  proc, logfile = run_get_cuts_subprocess(model_filename_stamped)
ResourceWarning: Enable tracemalloc to get the object allocation traceback
/home/zhouxingshi/miniconda3/envs/torch2.2/lib/python3.11/subprocess.py:1127: ResourceWarning: subprocess 40801 is still running
  _warn("subprocess %s is still running" % self.pid,
ResourceWarning: Enable tracemalloc to get the object allocation traceback
parallel mps save finish
-0.05738 (15), -0.05736 (15), -0.05719 (15), 
Length of domains: 64
Time: pickout 0.0011    decision 0.0731    set_bounds 0.0065    solve 0.2494    add 0.0040    
Accumulated time: pickout 0.0059    decision 0.4275    set_bounds 0.0389    solve 1.6471    add 0.0120    
Current (lb-rhs): -0.07846832275390625
118 domains visited
Cumulative time: 2.191918134689331

BaB round 6
Fetch cut process: mps for current label is not ready yet
batch: 64
splitting decisions: 
split level 0: [/input.8, 1776] [/input.8, 1449] [/input.8, 1776] [/input.8, 1776] [/input.8, 533] [/input.8, 417] [/input.8, 813] [/input.8, 820] [/input.8, 1776] [/input.8, 1449] 
pruning_in_iteration open status: False
ratio of positive domain = 3 / 128 = 0.0234375
pruning-in-iteration extra time: 0.00012731552124023438
Time: prepare 0.0284    bound 0.2327    transfer 0.0007    finalize 0.0141    func 0.2760    
Accumulated time: func 1.9228    prepare 0.0873    bound 1.7960    transfer 0.0047    finalize 0.0420    
Current worst splitting domains lb-rhs (depth):
-0.07420 (16), -0.07359 (16), -0.07355 (16), -0.07294 (16), -0.06981 (16), -0.06920 (16), -0.06915 (16), -0.06859 (16), -0.06854 (16), -0.06798 (16), -0.06794 (16), -0.06733 (16), -0.06604 (16), -0.06534 (16), -0.06526 (16), -0.06493 (16), -0.06450 (16), -0.06423 (16), -0.06420 (16), -0.06417 (16), 
Length of domains: 124
Time: pickout 0.0012    decision 0.0853    set_bounds 0.0091    solve 0.2761    add 0.0064    
Accumulated time: pickout 0.0071    decision 0.5128    set_bounds 0.0480    solve 1.9232    add 0.0184    
Current (lb-rhs): -0.07420015335083008
242 domains visited
Cumulative time: 2.5709025859832764

BaB round 7
Fetch cut process: mps for current label is not ready yet
batch: 124
splitting decisions: 
split level 0: [/input.8, 2041] [/input.12, 60] [/input.8, 539] [/input.8, 1638] [/input.8, 813] [/input.8, 533] [/input.8, 533] [/input.8, 533] [/input.8, 539] [/input.12, 60] 
pruning_in_iteration open status: False
ratio of positive domain = 31 / 248 = 0.125
pruning-in-iteration extra time: 0.0001232624053955078
Time: prepare 0.0582    bound 0.2301    transfer 0.0009    finalize 0.0281    func 0.3173    
Accumulated time: func 2.2401    prepare 0.1467    bound 2.0261    transfer 0.0056    finalize 0.0700    
Current worst splitting domains lb-rhs (depth):
-0.07018 (17), -0.06959 (17), -0.06953 (17), -0.06893 (17), -0.06515 (17), -0.06457 (17), -0.06449 (17), -0.06436 (17), -0.06391 (17), -0.06376 (17), -0.06370 (17), -0.06311 (17), -0.06175 (17), -0.06110 (17), -0.06101 (17), -0.06065 (17), -0.06026 (17), -0.05991 (17), -0.05990 (17), -0.05932 (17), 
Length of domains: 216
Time: pickout 0.0014    decision 0.1092    set_bounds 0.0167    solve 0.3174    add 0.0095    
Accumulated time: pickout 0.0085    decision 0.6220    set_bounds 0.0647    solve 2.2406    add 0.0279    
Current (lb-rhs): -0.07018423080444336
458 domains visited
Cumulative time: 3.026280164718628

BaB round 8
Fetch cut process: mps for current label is not ready yet
batch: 216
splitting decisions: 
split level 0: [/input.8, 539] [/input.8, 1638] [/input.8, 539] [/input.8, 417] [/input.8, 813] [/input.8, 813] [/input.8, 1449] [/input.8, 1638] [/input.8, 539] [/input.8, 417] 
pruning_in_iteration open status: False
ratio of positive domain = 53 / 432 = 0.12268518518518523
pruning-in-iteration extra time: 0.00012612342834472656
Time: prepare 0.1047    bound 0.2384    transfer 0.0013    finalize 0.0512    func 0.3957    
Accumulated time: func 2.6358    prepare 0.2527    bound 2.2645    transfer 0.0069    finalize 0.1212    
Current worst splitting domains lb-rhs (depth):
-0.06602 (18), -0.06554 (18), -0.06542 (18), -0.06539 (18), -0.06494 (18), -0.06488 (18), -0.06479 (18), -0.06429 (18), -0.06083 (18), -0.06018 (18), -0.06014 (18), -0.06011 (18), -0.06010 (18), -0.05960 (18), -0.05951 (18), -0.05948 (18), -0.05945 (18), -0.05945 (18), -0.05900 (18), -0.05893 (18), 
Length of domains: 376
Time: pickout 0.0016    decision 0.1692    set_bounds 0.0263    solve 0.3959    add 0.0162    
Accumulated time: pickout 0.0101    decision 0.7912    set_bounds 0.0910    solve 2.6365    add 0.0441    
Current (lb-rhs): -0.06602191925048828
834 domains visited
Cumulative time: 3.637179136276245

BaB round 9
Fetch cut process: mps for current label is not ready yet
batch: 376
splitting decisions: 
split level 0: [/input.8, 1449] [/input.12, 60] [/input.8, 419] [/input.8, 419] [/input.8, 419] [/input.12, 60] [/input.12, 60] [/input.8, 419] [/input.8, 419] [/input.8, 419] 
pruning_in_iteration open status: True
ratio of positive domain = 236 / 752 = 0.31382978723404253
pruning-in-iteration extra time: 0.012853860855102539
Time: prepare 0.1819    bound 0.3409    transfer 0.0022    finalize 0.0872    func 0.6123    
Accumulated time: func 3.2481    prepare 0.4361    bound 2.6055    transfer 0.0091    finalize 0.2084    
Current worst splitting domains lb-rhs (depth):
-0.06123 (19), -0.06120 (19), -0.06099 (19), -0.06096 (19), -0.06093 (19), -0.06066 (19), -0.06066 (19), -0.06064 (19), -0.06054 (19), -0.06038 (19), -0.06033 (19), -0.06021 (19), -0.06008 (19), -0.05603 (19), -0.05575 (19), -0.05552 (19), -0.05550 (19), -0.05534 (19), -0.05532 (19), -0.05524 (19), 
Length of domains: 516
Time: pickout 0.0021    decision 0.2244    set_bounds 0.0469    solve 0.6126    add 0.0212    
Accumulated time: pickout 0.0122    decision 1.0157    set_bounds 0.1378    solve 3.2491    add 0.0653    
Current (lb-rhs): -0.0612330436706543
1350 domains visited
Cumulative time: 4.54730224609375

BaB round 10
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts have not been generated yet.
cuts preparing time: 0.0024
batch: 516
splitting decisions: 
split level 0: [/input.12, 60] [/input.8, 700] [/input.8, 700] [/input.12, 60] [/input.8, 700] [/input.12, 60] [/input.8, 700] [/input.8, 419] [/input.12, 60] [/input.8, 700] 
pruning_in_iteration open status: True
ratio of positive domain = 376 / 1032 = 0.3643410852713178
pruning-in-iteration extra time: 0.012970447540283203
Time: prepare 0.2785    bound 0.3138    transfer 0.0028    finalize 0.1149    func 0.7101    
Accumulated time: func 3.9582    prepare 0.7159    bound 2.9192    transfer 0.0119    finalize 0.3232    
Current worst splitting domains lb-rhs (depth):
-0.05705 (20), -0.05691 (20), -0.05678 (20), -0.05672 (20), -0.05663 (20), -0.05646 (20), -0.05645 (20), -0.05638 (20), -0.05632 (20), -0.05629 (20), -0.05618 (20), -0.05611 (20), -0.05606 (20), -0.05606 (20), -0.05604 (20), -0.05595 (20), -0.05580 (20), -0.05579 (20), -0.05567 (20), -0.05562 (20), 
Length of domains: 656
Time: pickout 0.0025    decision 0.2836    set_bounds 0.0564    solve 0.7114    add 0.0269    
Accumulated time: pickout 0.0147    decision 1.2992    set_bounds 0.1942    solve 3.9605    add 0.0922    
Current (lb-rhs): -0.057050228118896484
2006 domains visited
Cumulative time: 5.640719652175903

BaB round 11
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts have not been generated yet.
cuts preparing time: 0.0015
batch: 656
splitting decisions: 
split level 0: [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.12, 60] [/input.8, 539] [/input.12, 60] 
pruning_in_iteration open status: True
ratio of positive domain = 357 / 1312 = 0.27210365853658536
pruning-in-iteration extra time: 0.013204574584960938
Time: prepare 0.3782    bound 0.3642    transfer 0.0121    finalize 0.1778    func 0.9324    
Accumulated time: func 4.8906    prepare 1.0954    bound 3.2834    transfer 0.0239    finalize 0.5010    
Current worst splitting domains lb-rhs (depth):
-0.05287 (21), -0.05287 (21), -0.05272 (21), -0.05267 (21), -0.05267 (21), -0.05260 (21), -0.05255 (21), -0.05242 (21), -0.05235 (21), -0.05228 (21), -0.05223 (21), -0.05211 (21), -0.05210 (21), -0.05209 (21), -0.05209 (21), -0.05208 (21), -0.05191 (21), -0.05191 (21), -0.05189 (21), -0.05186 (21), 
Length of domains: 955
Time: pickout 0.0029    decision 0.3493    set_bounds 0.0758    solve 0.9329    add 0.0415    
Accumulated time: pickout 0.0176    decision 1.6485    set_bounds 0.2700    solve 4.8934    add 0.1337    
Current (lb-rhs): -0.05287456512451172
2961 domains visited
Cumulative time: 7.057330131530762

BaB round 12
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts have not been generated yet.
cuts preparing time: 0.0014
batch: 955
splitting decisions: 
split level 0: [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] [/input, 227] 
pruning_in_iteration open status: False
ratio of positive domain = 339 / 1910 = 0.17748691099476444
pruning-in-iteration extra time: 0.00012803077697753906
Time: prepare 0.6238    bound 0.4534    transfer 0.0250    finalize 0.2547    func 1.3571    
Accumulated time: func 6.2477    prepare 1.7207    bound 3.7368    transfer 0.0489    finalize 0.7557    
Current worst splitting domains lb-rhs (depth):
-0.04920 (22), -0.04909 (22), -0.04902 (22), -0.04884 (22), -0.04876 (22), -0.04867 (22), -0.04865 (22), -0.04865 (22), -0.04857 (22), -0.04856 (22), -0.04852 (22), -0.04852 (22), -0.04841 (22), -0.04839 (22), -0.04836 (22), -0.04827 (22), -0.04823 (22), -0.04823 (22), -0.04814 (22), -0.04810 (22), 
Length of domains: 1568
Time: pickout 0.0041    decision 0.6378    set_bounds 0.1106    solve 1.3578    add 0.1590    
Accumulated time: pickout 0.0217    decision 2.2862    set_bounds 0.3806    solve 6.2511    add 0.2926    
Current (lb-rhs): -0.04919910430908203
4529 domains visited
Cumulative time: 9.343242645263672

BaB round 13
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts have not been generated yet.
cuts preparing time: 0.0013
batch: 1024
splitting decisions: 
split level 0: [/input.8, 813] [/input.8, 841] [/input.8, 841] [/input.8, 813] [/input, 1749] [/input, 1749] [/input.8, 700] [/input, 1749] [/input.8, 700] [/input.8, 841] 
pruning_in_iteration open status: False
ratio of positive domain = 366 / 2048 = 0.1787109375
pruning-in-iteration extra time: 0.00013971328735351562
Time: prepare 0.6821    bound 0.4811    transfer 0.0266    finalize 0.2939    func 1.4839    
Accumulated time: func 7.7316    prepare 2.4041    bound 4.2178    transfer 0.0755    finalize 1.0495    
Current worst splitting domains lb-rhs (depth):
-0.04852 (22), -0.04827 (22), -0.04810 (22), -0.04790 (22), -0.04770 (22), -0.04768 (22), -0.04746 (22), -0.04745 (22), -0.04726 (22), -0.04717 (22), -0.04706 (22), -0.04701 (22), -0.04701 (22), -0.04612 (22), -0.04557 (23), -0.04553 (22), -0.04547 (22), -0.04546 (23), -0.04537 (23), -0.04530 (23), 
Length of domains: 2223
Time: pickout 0.0042    decision 0.5207    set_bounds 0.1228    solve 1.4846    add 0.2498    
Accumulated time: pickout 0.0259    decision 2.8070    set_bounds 0.5034    solve 7.7358    add 0.5424    
Current (lb-rhs): -0.048516273498535156
6208 domains visited
Cumulative time: 11.74341082572937

BaB round 14
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts have not been generated yet.
cuts preparing time: 0.0013
batch: 1024
splitting decisions: 
split level 0: [/input.8, 1638] [/input.8, 1638] [/input.8, 1638] [/input, 1749] [/input, 1765] [/input, 1765] [/input, 997] [/input.8, 841] [/input.8, 841] [/input.8, 841] 
pruning_in_iteration open status: False
ratio of positive domain = 251 / 2048 = 0.12255859375
pruning-in-iteration extra time: 0.0001304149627685547
Time: prepare 0.7066    bound 0.4826    transfer 0.0134    finalize 0.3849    func 1.5879    
Accumulated time: func 9.3194    prepare 3.1123    bound 4.7005    transfer 0.0890    finalize 1.4344    
Current worst splitting domains lb-rhs (depth):
-0.04852 (22), -0.04827 (22), -0.04810 (22), -0.04790 (22), -0.04770 (22), -0.04768 (22), -0.04746 (22), -0.04745 (22), -0.04726 (22), -0.04717 (22), -0.04706 (22), -0.04701 (22), -0.04701 (22), -0.04612 (22), -0.04553 (22), -0.04547 (22), -0.04537 (23), -0.04512 (23), -0.04507 (22), -0.04492 (22), 
Length of domains: 2994
Time: pickout 0.0043    decision 0.5267    set_bounds 0.1245    solve 1.5891    add 0.0614    
Accumulated time: pickout 0.0302    decision 3.3337    set_bounds 0.6279    solve 9.3249    add 0.6038    
Current (lb-rhs): -0.048516273498535156
8003 domains visited
Cumulative time: 14.059056282043457

BaB round 15
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
CPLEX cuts names loaded.
cut /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts: total 425 constraints, 29777 nonzero elements
all start nodes to check full crown or not: [BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True), BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True), BoundLinear(name=/input.12, inputs=[/13, /5, /6], perturbed=True), BoundLinear(name=/16, inputs=[/15, /7, /8], perturbed=True)]
use patches cut:  False
skip cut beta crown opt for patches layer: BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True)
skip cut beta crown opt for patches layer: BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True)
cuts preparing time: 0.8223
batch: 1024
cut disabled for branching node selection
splitting decisions: 
split level 0: [/input.8, 417] [/input, 227] [/input, 998] [/input, 227] [/input.8, 417] [/input.8, 417] [/input, 227] [/input.8, 419] [/input.8, 417] [/input.8, 417] 
cut re-enabled after branching node selection
0 lb beta sum: 0.0, worst -0.03762960433959961

all verified at 3th iter
pruning_in_iteration open status: False
ratio of positive domain = 2048 / 2048 = 1.0
pruning-in-iteration extra time: 0.00012350082397460938
Time: prepare 0.6945    bound 3.3835    transfer 0.0050    finalize 0.2312    func 4.3593    
Accumulated time: func 13.6788    prepare 3.8080    bound 8.0840    transfer 0.0940    finalize 1.6656    
Current worst splitting domains lb-rhs (depth):
-0.04852 (22), -0.04827 (22), -0.04810 (22), -0.04790 (22), -0.04770 (22), -0.04768 (22), -0.04746 (22), -0.04745 (22), -0.04726 (22), -0.04717 (22), -0.04706 (22), -0.04701 (22), -0.04701 (22), -0.04612 (22), -0.04553 (22), -0.04547 (22), -0.04537 (23), -0.04512 (23), -0.04507 (22), -0.04492 (22), 
Length of domains: 1970
Time: pickout 0.0043    decision 0.5163    set_bounds 0.1229    solve 4.3601    add 0.0010    
Accumulated time: pickout 0.0345    decision 3.8500    set_bounds 0.7508    solve 13.6849    add 0.6048    
Current (lb-rhs): -0.048516273498535156
8003 domains visited
Cumulative time: 19.89942741394043

BaB round 16
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
cut /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts: total 870 constraints, 49896 nonzero elements
all start nodes to check full crown or not: [BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True), BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True), BoundLinear(name=/input.12, inputs=[/13, /5, /6], perturbed=True), BoundLinear(name=/16, inputs=[/15, /7, /8], perturbed=True)]
use patches cut:  False
skip cut beta crown opt for patches layer: BoundConv(name=/input, inputs=[/input.1, /1, /2], perturbed=True)
skip cut beta crown opt for patches layer: BoundConv(name=/input.8, inputs=[/input.4, /3, /4], perturbed=True)
cuts preparing time: 1.5592
batch: 1024
cut disabled for branching node selection
splitting decisions: 
split level 0: [/input, 997] [/input.8, 1638] [/input.8, 1466] [/input.8, 1638] [/input.8, 813] [/input.8, 1638] [/input.8, 1466] [/input.8, 1638] [/input, 997] [/input.8, 1638] 
cut re-enabled after branching node selection
0 lb beta sum: 0.0, worst -0.040479183197021484

all verified at 4th iter
pruning_in_iteration open status: True
ratio of positive domain = 2048 / 2048 = 1.0
pruning-in-iteration extra time: 0.0006382465362548828
Time: prepare 0.7013    bound 0.6651    transfer 0.0051    finalize 0.2288    func 1.6438    
Accumulated time: func 15.3226    prepare 4.5107    bound 8.7491    transfer 0.0991    finalize 1.8944    
Current worst splitting domains lb-rhs (depth):
-0.04852 (22), -0.04827 (22), -0.04810 (22), -0.04790 (22), -0.04770 (22), -0.04768 (22), -0.04746 (22), -0.04745 (22), -0.04726 (22), -0.04717 (22), -0.04706 (22), -0.04701 (22), -0.04701 (22), -0.04612 (22), -0.04553 (22), -0.04547 (22), -0.04537 (23), -0.04512 (23), -0.04507 (22), -0.04492 (22), 
Length of domains: 946
Time: pickout 0.0042    decision 0.5156    set_bounds 0.1229    solve 1.6445    add 0.0010    
Accumulated time: pickout 0.0387    decision 4.3656    set_bounds 0.8737    solve 15.3295    add 0.6058    
Current (lb-rhs): -0.048516273498535156
8003 domains visited
Cumulative time: 23.763251066207886

BaB round 17
Matched cut cplex process, internal label idx = 0
Trying to loading cuts from /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
Cuts have not been updated in CPLEX; still using old cuts.
cuts preparing time: 0.0033
batch: 946
cut disabled for branching node selection
splitting decisions: 
split level 0: [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] [/input, 998] 
cut re-enabled after branching node selection
0 lb beta sum: 0.0, worst -0.044882774353027344

all verified at 4th iter
pruning_in_iteration open status: True
ratio of positive domain = 1892 / 1892 = 1.0
pruning-in-iteration extra time: 0.0007128715515136719
Time: prepare 0.8177    bound 0.6217    transfer 0.0047    finalize 0.3466    func 1.8302    
Accumulated time: func 17.1528    prepare 5.3298    bound 9.3708    transfer 0.1038    finalize 2.2410    
Length of domains: 0
Time: pickout 0.0040    decision 0.4793    set_bounds 0.1172    solve 1.8309    add 0.0002    
Accumulated time: pickout 0.0428    decision 4.8449    set_bounds 0.9908    solve 17.1603    add 0.6060    
No domains left, verification finished!
Current (lb-rhs): 1.0000000116860974e-07
8003 domains visited
Cumulative time: 26.270820140838623

found process to kill: terminal indx = 0
removing /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.mps
removing /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.cuts
removing /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.indx
removing /home/zhouxingshi/Verifier_Development/complete_verifier/cuts/CPLEX_cuts/cplexmip_lay-16_starttime=1712864687_idx=0_spec=0_86470713.log
found process for pidx=0
kill process for pidx=0
Result: safe in 37.6030 seconds
############# Summary #############
Final verified acc: 100.0% (total 1 examples)
Problem instances count: 1 , total verified (safe/unsat): 1 , total falsified (unsafe/sat): 0 , timeout: 0
mean time for ALL instances (total 1):37.60264535683195, max time: 37.60302138328552
mean time for verified SAFE instances(total 1): 37.60302138328552, max time: 37.60302138328552
safe (total 1), index: [0]
Result dict saved to /home/zhouxingshi/Verifier_Development/tests/gpu_tests/gcp_crown/oval_wide_cplex/master_outputs/3.pkl.
